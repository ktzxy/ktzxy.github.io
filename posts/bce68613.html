<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MySQL基础 | 蓝桉`Blog</title><meta name="author" content="蓝桉,kt_zxh@163.com"><meta name="copyright" content="蓝桉"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="# 1. MySQL 的版本 1.1. 版本分类MySQL 服务端提供了以下版本：  MySQL Community Server：社区版本，免费，但是MySQL不提供官方技术支持。 MySQL Enterprise Edition：商业版，该版本是收费版本，可以试用30天，官方提供技术支持 MySQL Cluster：集群版，开源免费，可将几个MySQL Server封装成一个Server。">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL基础">
<meta property="og:url" content="https://ktzxy.github.io/posts/bce68613.html">
<meta property="og:site_name" content="蓝桉&#96;Blog">
<meta property="og:description" content="# 1. MySQL 的版本 1.1. 版本分类MySQL 服务端提供了以下版本：  MySQL Community Server：社区版本，免费，但是MySQL不提供官方技术支持。 MySQL Enterprise Edition：商业版，该版本是收费版本，可以试用30天，官方提供技术支持 MySQL Cluster：集群版，开源免费，可将几个MySQL Server封装成一个Server。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ktzxy.github.io/bg/Image00026.webp">
<meta property="article:published_time" content="2025-07-09T17:28:46.000Z">
<meta property="article:modified_time" content="2025-07-13T15:45:18.453Z">
<meta property="article:author" content="蓝桉">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ktzxy.github.io/bg/Image00026.webp"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MySQL基础",
  "url": "https://ktzxy.github.io/posts/bce68613.html",
  "image": "https://ktzxy.github.io/bg/Image00026.webp",
  "datePublished": "2025-07-09T17:28:46.000Z",
  "dateModified": "2025-07-13T15:45:18.453Z",
  "author": [
    {
      "@type": "Person",
      "name": "蓝桉",
      "url": "https://ktzxy.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ktzxy.github.io/posts/bce68613.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL基础',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4379924_273fk05h86zi.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/progress_bar/progress_bar.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/windmill/windmill.css"><link rel="stylesheet" href="/css/cat.css"><link rel="stylesheet" href="/css/meting/music_lanan.css"><div id="myscoll"></div><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="/css/runtime/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="蓝桉`Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/bg.webp);"></div><div id="an_music_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">264</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">37</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-zhuye-"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zhuye-"></use></svg><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shijianzhou"></use></svg><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/essay/"><i class="fa-fw icon-xiaoxi"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xiaoxi"></use></svg><span> 闲言碎语</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/music/"><i class="fa-fw icon-music"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/fcircle/"><i class="fa-fw icon-pengyouquan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pengyouquan"></use></svg><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-xinfeng"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinfeng"></use></svg><span> 留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> 友人帐</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:randomPost();"><i class="fa-fw icon-wodezhuifan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wodezhuifan"></use></svg><span> 随机访问</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon-guanyuwomen2"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guanyuwomen2"></use></svg><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/bg/Image00026.webp);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">蓝桉`Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">MySQL基础</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-zhuye-"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zhuye-"></use></svg><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shijianzhou"></use></svg><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/essay/"><i class="fa-fw icon-xiaoxi"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xiaoxi"></use></svg><span> 闲言碎语</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/music/"><i class="fa-fw icon-music"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/fcircle/"><i class="fa-fw icon-pengyouquan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pengyouquan"></use></svg><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-xinfeng"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinfeng"></use></svg><span> 留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> 友人帐</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:randomPost();"><i class="fa-fw icon-wodezhuifan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wodezhuifan"></use></svg><span> 随机访问</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon-guanyuwomen2"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guanyuwomen2"></use></svg><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">MySQL基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-13T15:45:18.453Z" title="更新于 2025-07-13 15:45:18">2025-07-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>﻿# 1. MySQL 的版本</p>
<h2 id="1-1-版本分类"><a href="#1-1-版本分类" class="headerlink" title="1.1. 版本分类"></a>1.1. 版本分类</h2><p>MySQL 服务端提供了以下版本：</p>
<ul>
<li>MySQL Community Server：社区版本，免费，但是MySQL不提供官方技术支持。</li>
<li>MySQL Enterprise Edition：商业版，该版本是收费版本，可以试用30天，官方提供技术支持</li>
<li>MySQL Cluster：集群版，开源免费，可将几个MySQL Server封装成一个Server。</li>
<li>MySQL Cluster CGE：高级集群版，需付费。</li>
</ul>
<p>MySQL 的图形化客户端 MySQL Workbench（GUI TOOL）：一款专为MySQL设计的ER/数据库建模工具。又分为两个版本：</p>
<ul>
<li>社区版（MySQL Workbench OSS）</li>
<li>商用版（MySQL Workbench SE）</li>
</ul>
<h2 id="1-2-版本号"><a href="#1-2-版本号" class="headerlink" title="1.2. 版本号"></a>1.2. 版本号</h2><p>MySQL的命名机制使用由3个数字和一个后缀组成的版本号。例如，mysql-8.0.26的版本号的含义如下：</p>
<ul>
<li>第1个数字(8)是主版本号，描述了文件格式。所有版本5的发行都有相同的文件格式。</li>
<li>第2个数字(0)是发行级别。主版本号和发行级别组合到一起便构成了发行序列号。</li>
<li>第3个数字(26)是在此发行系列的版本号，随每个新分发版递增。</li>
</ul>
<h2 id="1-3-查询当前-MySQL-的版本"><a href="#1-3-查询当前-MySQL-的版本" class="headerlink" title="1.3. 查询当前 MySQL 的版本"></a>1.3. 查询当前 MySQL 的版本</h2><p>使用 MySQL 客户端登陆后，输入 <code>select version();</code> 命令，即可查询当前 mysql 的版本号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> version();</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+</span></span><br><span class="line"><span class="operator">|</span> version() <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">8.0</span><span class="number">.30</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.02</span> sec)</span><br></pre></td></tr></table></figure>
<h1 id="2-常见数据库及其概念"><a href="#2-常见数据库及其概念" class="headerlink" title="2.常见数据库及其概念"></a>2.常见数据库及其概念</h1><ul>
<li>Oracle（神谕）：甲骨文</li>
<li>DB2：IBM</li>
<li>SQL Server：微软</li>
<li>Sybase：塞尔斯</li>
<li>MySQL：甲骨文</li>
</ul>
<p><strong>数据库系统：DBS</strong></p>
<p>数据库系统DBS (DataBase System,简称DBS)通常由软件、数据库和数据管理员组成。其软件主要包括操作系统、各种宿主语言、实用程序以及数据库管理系统。</p>
<p>数据库由数据库管理系统统-管理，数据的插入、修改和检索均要通过数据库管理系统进行。</p>
<p>数据管理员负责创建、监控和维护整个数据库,使数据能被任何有权使用的人有效使用。数据库管理员一般是由业务水平较高、资历较深的人员担任。</p>
<p><strong>关系型数据库: SQL和DBMS</strong></p>
<p>●结构化查询语言（Structured Query Language，SQL）允许用户在高层数据结构上工作，用于存放数据以及查询、更新和管理关系型数据库系统。</p>
<p>●由于SQL语言结构简洁、功能强大、简单易学，因此是大型数据库系统的标准语言。</p>
<p>●DBMS( DataBase Management System)是一种创建和管理数据库的系统软件,能够给用户和程序员提供一种系统地创建、回收、更新、管理数据的方式,本质上就是一种服务于数据库和终端用户或者应用程序的接口。</p>
<p><strong>非关系型数据库: NoSQL</strong></p>
<p>●非关系型数据库常常用于超大规模数据的存储,因为这些大规模的数据没有固定的模式，因此可以相对容易地进行横向扩展。</p>
<p>●在云数据库中，NoSQL所具有的容易拓展、结构简单的特点使得大规模分布式开发变得更加方便,因此成为云数据库的宠儿。</p>
<p><strong>分布式数据库/内存数据库</strong></p>
<p>●分布式数据库(Distributed DataBase)通常使用多个存储节点构建一个完整的、全局的逻辑上集中、物理上分布的大型数据库，每个节点都有其独立的数据库或全局数据库的部分副本。</p>
<p>●分布式数据库管理系统是一种管理分布式数据库系统的应用，它能够周期性地同步数据,从而保证不同的用户能够访问同样的数据，以及对于数据的操作能够同步到分布式数据库系统的其他部分中。</p>
<p>●内存数据库(Main Memory DataBasee)就是将数据库放在内存中直接操作的数据库。采用内存数据库主要有两个方面的原因:</p>
<p>➢内存比磁盘读写速度更快，能够极大提高数据库性能</p>
<p>➢内存数据库抛弃了磁盘数据管理的传统方式，基于全部数据在内存中重新设计了体系结构</p>
<h1 id="3-数据完整性"><a href="#3-数据完整性" class="headerlink" title="3.数据完整性"></a>3.数据完整性</h1><p>作用：保证用户输入的数据保存到数据库中是正确的。</p>
<p>确保数据的完整性 = 在创建表时给表中添加约束</p>
<p>完整性的分类：</p>
<ul>
<li>实体完整性:</li>
<li>域完整性:</li>
<li>引用完整性:</li>
</ul>
<h3 id="3-1-实体完整性"><a href="#3-1-实体完整性" class="headerlink" title="3.1 实体完整性"></a>3.1 实体完整性</h3><p>实体：即表中的一行(一条记录)代表一个实体（entity）</p>
<p>实体完整性的作用：标识每一行数据不重复。</p>
<p>约束类型：</p>
<p><strong>主键约束（primary key）</strong></p>
<p><strong>唯一约束(unique)</strong></p>
<p><strong>自动增长列(auto_increment)</strong></p>
<h3 id="3-2-域完整性"><a href="#3-2-域完整性" class="headerlink" title="3.2 域完整性"></a>3.2 域完整性</h3><p>域完整性的作用：限制此单元格的数据正确，不对照此列的其它单元格比较</p>
<p>域代表当前单元格</p>
<p>约束类型：</p>
<p><strong>数据类型</strong> </p>
<p><strong>非空约束（not null）</strong> </p>
<p><strong>默认值约束(default)</strong></p>
<h3 id="3-3-引用完整性（参照完整性）"><a href="#3-3-引用完整性（参照完整性）" class="headerlink" title="3.3 引用完整性（参照完整性）"></a>3.3 引用完整性（参照完整性）</h3><p>外键约束：FOREIGN KEY </p>
<h1 id="4-SQL语句分类："><a href="#4-SQL语句分类：" class="headerlink" title="4.SQL语句分类："></a>4.SQL语句分类：</h1><p>DDL（Data Definition Language）：数据定义语言，用来定义数据库对象：库、表、列等；创建、删除、修改：库、表结构。</p>
<p>DML（Data Manipulation Language）：数据操作语言，用来定义数据库记录（数据）：增添，删除，修改:表记录。</p>
<p>DCL（Data Control Language）：数据控制语言，用来定义访问权限和安全级别；</p>
<p>DQL（Data Query Language）：数据查询语言，用来查询记录（数据）。</p>
<p>TCL    (Transaction Control Language)  :  事务控制语言</p>
<h1 id="5-数据类型"><a href="#5-数据类型" class="headerlink" title="5.数据类型"></a>5.数据类型</h1><h3 id="1-数值类型"><a href="#1-数值类型" class="headerlink" title="1. 数值类型"></a>1. 数值类型</h3><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">大小(byte)</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>TINYINT</code></td>
<td style="text-align:center">1</td>
<td><font color=red>很小的整数型，默认长度4</font></td>
</tr>
<tr>
<td style="text-align:center"><code>SMALLINT</code></td>
<td style="text-align:center">2</td>
<td>小的整型，默认长度6</td>
</tr>
<tr>
<td style="text-align:center"><code>MEDIUMINT</code></td>
<td style="text-align:center">3</td>
<td>中等大小的整数，默认长度9</td>
</tr>
<tr>
<td style="text-align:center"><code>INT</code>或<code>INTEGER</code></td>
<td style="text-align:center">4</td>
<td><font color=red>普通大小的整数（占4字节），默认长度11</font></td>
</tr>
<tr>
<td style="text-align:center"><code>BIGINT</code></td>
<td style="text-align:center">8</td>
<td>占用的8个字节，默认长度20</td>
</tr>
<tr>
<td style="text-align:center"><code>FLOAT(m,d)</code></td>
<td style="text-align:center">4</td>
<td>单精度浮点型小数</td>
</tr>
<tr>
<td style="text-align:center"><code>DOUBLE(m,d)</code></td>
<td style="text-align:center">8</td>
<td><font color=red>双精度浮点型小数 d代表小数位数，m代表总位数 (整数位=m-d);</font><br/>比如：DOUBLE(5.2)， 数值共5位，其中小数为2位。</td>
</tr>
<tr>
<td style="text-align:center"><code>DECIMAL(m,d)</code></td>
<td style="text-align:center"></td>
<td><font color=red>压缩严格的定点数，取值范围与double相同，但有效取值范围由M(精度)与D(标度)决定</font></td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>Tips: 当字段用记录年龄时，因为不会存在负数与数值的范围不会太大，可以设置为 <code>age tinyint unsigned</code></p>
</blockquote>
<h4 id="1-1-整型类型的长度设置"><a href="#1-1-整型类型的长度设置" class="headerlink" title="1.1. 整型类型的长度设置"></a>1.1. 整型类型的长度设置</h4><p>MySQL 中 <code>int(10)</code> 中的 10 表示的是显示数据的长度，不足 10 位以 0 填充。也就是说，<u><code>int(1)</code> 和 <code>int(10)</code> 所能存储的数字大小以及占用的空间都是相同的</u>。</p>
<blockquote>
<p>关联知识：字符串类型 <code>char(10)</code> 的 10 表示的是存储数据的长度。</p>
</blockquote>
<h4 id="1-2-Decimal-类型和-Float、Double-等区别"><a href="#1-2-Decimal-类型和-Float、Double-等区别" class="headerlink" title="1.2. Decimal 类型和 Float、Double 等区别"></a>1.2. Decimal 类型和 Float、Double 等区别</h4><p>MySQL 中存在 float, double 等非标准数据类型，可以存浮点数（即小数类型），但是 float 有个坏处，当给定的数据是整数的时候，那么它就以整数处理。这样在存取货币值的时候自然遇到问题，default 值为 0.00 而实际存储是 0，同样存取货币为 12.00，实际存储是 12。</p>
<p>为了解决上面的问题，MySQL 提供了1种标准数据类型：<code>decimal</code>。decimal 类型被 MySQL 以同样的类型实现，这在 SQL92 标准中是允许的。它们用于保存对准确精度有重要要求的值，例如与金钱有关的数据。</p>
<p>其中 Decimal 类型和 Float、Double 主要区别在于：float，double 等非标准类型，在 DB 中保存的是近似值；而 Decimal 则以字符串的形式保存数值。</p>
<h3 id="2-字符串类型"><a href="#2-字符串类型" class="headerlink" title="2.字符串类型"></a>2.字符串类型</h3><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">大小(byte)</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>CHAR(M)</code></td>
<td style="text-align:center">0-255</td>
<td><code>CHAR(x)</code>，定长的字符串。<strong>性能较好</strong></td>
</tr>
<tr>
<td style="text-align:center"><code>VARCHAR(M)</code></td>
<td style="text-align:center">0-65535</td>
<td><font color=red>可变长的字符串，注意数据不能超过X位数</font><strong>性能较差</strong></td>
</tr>
<tr>
<td style="text-align:center"><code>TINYBLOB</code></td>
<td style="text-align:center">0-255</td>
<td>不超过 255 个字符的二进制字符串</td>
</tr>
<tr>
<td style="text-align:center"><code>BLOB</code></td>
<td style="text-align:center">0-65535</td>
<td><font color=red>二进制形式的长文本数据。（图片、视频、音频）</font></td>
</tr>
<tr>
<td style="text-align:center"><code>MEDIUMBLOB</code></td>
<td style="text-align:center">0-16M</td>
<td>二进制形式的中等长度文本数据</td>
</tr>
<tr>
<td style="text-align:center"><code>LONGBLOB</code></td>
<td style="text-align:center">0-4G</td>
<td>二进制形式的长文本数据</td>
</tr>
<tr>
<td style="text-align:center"><code>TINYTEXT</code></td>
<td style="text-align:center">0-255</td>
<td>短文本字符串</td>
</tr>
<tr>
<td style="text-align:center"><code>TEXT</code></td>
<td style="text-align:center">0-65535</td>
<td>长文本数据</td>
</tr>
<tr>
<td style="text-align:center"><code>MEDIUMTEXT</code></td>
<td style="text-align:center">0-16M</td>
<td>中等长度文本数据</td>
</tr>
<tr>
<td style="text-align:center"><code>LONGTEXT</code></td>
<td style="text-align:center">0-4G</td>
<td>极大文本数据</td>
</tr>
<tr>
<td style="text-align:center"><code>VARBINARY(M)</code></td>
<td style="text-align:center"></td>
<td>允许长度0~M个字节的变长字节字符串</td>
</tr>
<tr>
<td style="text-align:center"><code>BINARY(M)</code></td>
<td style="text-align:center"></td>
<td>允许长度0~M个字节的定长字节字符串</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>Notes: 其中 <code>TINYTEXT</code>、<code>TEXT</code>、<code>MEDIUMTEXT</code>、<code>LONGTEXT</code> 是非标准字符串类型</p>
</blockquote>
<h4 id="2-1-char-和-vachar-的区别"><a href="#2-1-char-和-vachar-的区别" class="headerlink" title="2.1. char 和 vachar 的区别"></a>2.1. char 和 vachar 的区别</h4><p><code>char</code> 与 <code>varchar</code> 都可以描述字符串，两者主要有以下区别：</p>
<ul>
<li>char 最大长度是 255 字符；varchar 最大长度是 65535 个字节。</li>
<li>char 是定长字符串，指定长度多长，就占用多少个字符，和字段值的长度无关，不足的部分用隐藏空格填充；varchar 是变长字符串，指定的长度为最大占用长度。</li>
<li>相对而言，char 会浪费空间；varchar 会更加节省空间。</li>
<li>对于查找效率而言，char 的查找效率会更高些；varchar 查找效率会更低。因此 varchar 需要计算内容占用的长度，而 char 不需要，所以char 的效率稍高一些。</li>
</ul>
<p>总结：<code>char</code> 的性能会更高些。当存储的字符串长度是固定时，优先选择 <code>char</code> 类型。</p>
<h4 id="2-2字符中的分隔字符处理"><a href="#2-2字符中的分隔字符处理" class="headerlink" title="2.2字符中的分隔字符处理"></a>2.2字符中的分隔字符处理</h4><p><code>char</code>、<code>varchar</code> 和 <code>text</code> 等字符串类型都可以存储路径，但使用 <code>\</code> 会被过滤，所以路径中用 <code>/</code> 或 <code>\\</code> 来代替，MySQL 就不会自动过滤路径的分隔字符，完整的表示路径。</p>
<h4 id="2-3-BLOB-和-TEXT-的区别"><a href="#2-3-BLOB-和-TEXT-的区别" class="headerlink" title="2.3. BLOB 和 TEXT 的区别"></a>2.3. BLOB 和 TEXT 的区别</h4><p>一般情况下，数据库中不直接存储图片和音频文件，而是存储图片与文件的路径。如果存储文件，则选择 <code>blob</code> 类型。</p>
<ul>
<li>BLOB 类型是一个二进制对象，可以容纳可变数量的数据；</li>
<li>TEXT 类型是一个不区分大小写的 BLOB 类型。</li>
</ul>
<p>两种类型之间的主要的区别是：<strong>BLOB 值进行排序和比较时区分大小写；对 TEXT 值不区分大小写</strong>。</p>
<h3 id="3-日期时间类型"><a href="#3-日期时间类型" class="headerlink" title="3.日期时间类型"></a>3.日期时间类型</h3><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">大小(byte)</th>
<th>范围</th>
<th>格式</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>YEAR</code></td>
<td style="text-align:center">1</td>
<td>1901~2155</td>
<td>YYYY</td>
<td>年份值</td>
</tr>
<tr>
<td style="text-align:center"><code>TIME</code></td>
<td style="text-align:center">3</td>
<td>-838:59:59~838:59:59</td>
<td>HH:MM:SS</td>
<td>时间值或持续时间</td>
</tr>
<tr>
<td style="text-align:center"><code>DATE</code></td>
<td style="text-align:center">3</td>
<td>1000-01-01~9999-12-31</td>
<td>YYYY-MM-DD</td>
<td><font color=red>日期值(只有年月日，没有时分秒)</font></td>
</tr>
<tr>
<td style="text-align:center"><code>DATETIME</code></td>
<td style="text-align:center">8</td>
<td>1000-01-01 00:00:00~ 9999-12-31 23:59:59</td>
<td>YYYY-MM-DD HH:MM:SS</td>
<td><font color=red>混合日期和时间值</font></td>
</tr>
<tr>
<td style="text-align:center"><code>TIMESTAMP</code></td>
<td style="text-align:center">4</td>
<td>1970~01~01 00:00:01 UTC~2038-01-19 03:14:07UTC</td>
<td>YYYYMMDD HHMMSS</td>
<td><font color=red>混合日期和时间值，时间戳</font></td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>Notes: 尽量使用 timestamp，空间效率高于 datetime，用整数保存时间戳通常不方便处理。若需要存储微秒，可以使用 bigint 存储。其中 <code>DATETIME</code> 类型与时区无关；<code>TIMESTAMP</code> 显示依赖于所指定得时区，默认在第一个列行的数据修改时可以自动得修改</p>
</blockquote>
<h3 id="4-字段类型优先级选择"><a href="#4-字段类型优先级选择" class="headerlink" title="4.字段类型优先级选择"></a>4.字段类型优先级选择</h3><p>优先考虑数字类型，其次是日期或者二进制类型，最后是字符串类型，同级别得数据类型，应该优先选择占用空间小的数据类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">整形 &gt; date,time &gt; enum,char &gt; varchar &gt; blob,text</span><br></pre></td></tr></table></figure>
<h3 id="5-关于-Null-类型的特别说明"><a href="#5-关于-Null-类型的特别说明" class="headerlink" title="5. 关于 Null 类型的特别说明"></a>5. 关于 Null 类型的特别说明</h3><p>MySQL 对 null 值的处理，有以下三种：</p>
<ol>
<li>NULL 值代表一个未确定的值，每个 null 都是独一无二。MySQL 认为任何和 NULL 值做比较的表达式的值都为 NULL，包括 <code>select null = null;</code> 和 <code>select null != null;</code></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="keyword">null</span> <span class="operator">=</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">null</span> <span class="operator">=</span> <span class="keyword">null</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="keyword">null</span> <span class="operator">!=</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">null</span> <span class="operator">!=</span> <span class="keyword">null</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br></pre></td></tr></table></figure>
<ol>
<li>NULL 值在业务上就是代表没有，所有的 NULL 值和起来算一份</li>
<li>NULL 完全没有意义，所以在统计数量不会将其算进去</li>
</ol>
<blockquote>
<p>假设一个表中某个列 c1 的记录为(2, 1000, null, null)，在第一种情况下，表中 c1 的记录数为4，第二种表中 c1 的记录数为3，第三种表中 c1 的记录数为2。</p>
</blockquote>
<p>MySQL 专门提供了一个 <code>innodb_stats_method</code> 的系统变量，专门针对统计索引列不重复值的数量时如何对待 NULL 值。此系统变量有三个候选值：</p>
<ul>
<li><code>nulls_equal</code>：认为所有 NULL 值都是相等的。这个值也是 <code>innodb_stats_method</code> 的默认值。如果某个索引列中 NULL 值特别多的话，这种统计方式会让优化器认为某个列中平均一个值重复次数特别多，所以倾向于不使用索引进行访问。</li>
<li><code>nulls_unequal</code>：认为所有 NULL 值都是不相等的。如果某个索引列中 NULL 值特别多的话，这种统计方式会让优化器认为某个列中平均一个值重复次数特别少，所以倾向于使用索引进行访问。</li>
<li><code>nulls_ignored</code>：直接把 NULL 值忽略掉。</li>
</ul>
<blockquote>
<p>详见官网：<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/innodb-parameters.html#sysvar_innodb_stats_method">https://dev.mysql.com/doc/refman/5.7/en/innodb-parameters.html#sysvar_innodb_stats_method</a></p>
<p>有迹象表明，在 MySQL 5.7.22 以后的版本，对这个<code>innodb_stats_method</code>的修改不起作用，MySQL 把这个值在代码里写死为<code>nulls_equal</code>。也就是说 MySQL在进行索引列的数据统计行为又把 null 视为第二种情况（NULL 值在业务上就是代表没有，所有的 NULL 值和起来算一份），MySQL 对 Null 值的处理比较飘忽。所以总的来说，对于列的声明尽可能的不要允许为null。</p>
</blockquote>
<h3 id="6-枚举和集合"><a href="#6-枚举和集合" class="headerlink" title="6.枚举和集合"></a>6.枚举和集合</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">a.枚举(enum)</span><br><span class="line">enum(val1, val2, val3...)</span><br><span class="line">    在已知的值中进行单选。最大数量为65535.</span><br><span class="line">    枚举值在保存时，以2个字节的整型(smallint)保存。每个枚举值，按保存的位置顺序，从1开始逐一递增。</span><br><span class="line">    表现为字符串类型，存储却是整型。</span><br><span class="line">    NULL值的索引是NULL。</span><br><span class="line">    空字符串错误值的索引值是0。</span><br><span class="line"></span><br><span class="line">b.集合（set）</span><br><span class="line">set(val1, val2, val3...)</span><br><span class="line">    create table tab ( gender set(&#x27;男&#x27;, &#x27;女&#x27;, &#x27;无&#x27;) );</span><br><span class="line">    insert into tab values (&#x27;男, 女&#x27;);</span><br><span class="line">    最多可以有64个不同的成员。以bigint存储，共8个字节。采取位运算的形式。</span><br><span class="line">    当创建表时，SET成员值的尾部空格将自动被删除。</span><br></pre></td></tr></table></figure>
<h1 id="6-SQL语句"><a href="#6-SQL语句" class="headerlink" title="6.SQL语句"></a>6.SQL语句</h1><h2 id="6-1-连接到服务器并断开与服务器的连接"><a href="#6-1-连接到服务器并断开与服务器的连接" class="headerlink" title="6.1 连接到服务器并断开与服务器的连接"></a>6.1 连接到服务器并断开与服务器的连接</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1.连接到服务器</span><br><span class="line">mysql -h 地址 -P 端口 -u 用户名 -p 密码</span><br><span class="line">2.断开服务器</span><br><span class="line">quit</span><br><span class="line">3.启动MySQL</span><br><span class="line">net start mysql</span><br><span class="line">4.关闭MySQL</span><br><span class="line">net stop mysql</span><br><span class="line">5.跳过权限验证登录MySQL</span><br><span class="line">mysqld --skip-grant-tables</span><br></pre></td></tr></table></figure>
<h2 id="6-2-DDL-数据定义语言"><a href="#6-2-DDL-数据定义语言" class="headerlink" title="6.2 DDL:数据定义语言"></a>6.2 DDL:数据定义语言</h2><h3 id="库操作："><a href="#库操作：" class="headerlink" title="库操作："></a><strong>库操作</strong>：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1.查看当前数据库</span><br><span class="line">SELECT DATABASE();</span><br><span class="line">2.显示当前时间、用户名、数据库版本</span><br><span class="line">SELECT now(), user(), version();</span><br><span class="line">3.创建库</span><br><span class="line">CREATE DATABASE[ IF NOT EXISTS] 数据库名 数据库选项</span><br><span class="line">    数据库选项：</span><br><span class="line">        CHARACTER SET charset_name</span><br><span class="line">        COLLATE collation_name</span><br><span class="line">4.查看已有库</span><br><span class="line">SHOW DATABASES;</span><br><span class="line">5.查看当前库信息</span><br><span class="line">SHOW CREATE DATABASE 数据库名</span><br><span class="line">6.修改库的选项信息</span><br><span class="line">ALTER DATABASE 库名 选项信息</span><br><span class="line">7.删除库</span><br><span class="line">DROP DATABASE[ IF EXISTS] 数据库名</span><br><span class="line">同时删除该数据库相关的目录及其目录内容</span><br></pre></td></tr></table></figure>
<h3 id="表操作"><a href="#表操作" class="headerlink" title="表操作"></a><strong>表操作</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">1.创建表</span><br><span class="line">CREATE [TEMPORARY] TABLE[ IF NOT EXISTS] [库名.]表名 ( 表的结构定义 )[ 表选项]</span><br><span class="line">        每个字段必须有数据类型</span><br><span class="line">        最后一个字段后不能有逗号</span><br><span class="line">        TEMPORARY 临时表，会话结束时表自动消失</span><br><span class="line">        对于字段的定义：</span><br><span class="line">        	字段名 数据类型 [NOT NULL | NULL] 非空 |空</span><br><span class="line">        	[DEFAULT default_value] 默认值</span><br><span class="line">        	[AUTO_INCREMENT] 自动增长</span><br><span class="line">        	[UNIQUE [KEY] | [PRIMARY] KEY] 唯一键| 主键</span><br><span class="line">        	[COMMENT &#x27;string&#x27;] 表注释</span><br><span class="line">-- 表选项</span><br><span class="line">    -- 字符集</span><br><span class="line">        CHARSET = charset_name</span><br><span class="line">        如果表没有设定，则使用数据库字符集</span><br><span class="line">    -- 存储引擎</span><br><span class="line">        ENGINE = engine_name</span><br><span class="line">        表在管理数据时采用的不同的数据结构，结构不同会导致处理方式、提供的特性操作等不同</span><br><span class="line">        常见的引擎：InnoDB MyISAM Memory/Heap BDB Merge Example CSV MaxDB Archive</span><br><span class="line">        不同的引擎在保存表的结构和数据时采用不同的方式</span><br><span class="line">        MyISAM表文件含义：.frm表定义，.MYD表数据，.MYI表索引</span><br><span class="line">        InnoDB表文件含义：.frm表定义，表空间数据和日志文件</span><br><span class="line">        SHOW ENGINES -- 显示存储引擎的状态信息</span><br><span class="line">        SHOW ENGINE 引擎名 &#123;LOGS|STATUS&#125; -- 显示存储引擎的日志或状态信息</span><br><span class="line">    -- 自增起始数</span><br><span class="line">        AUTO_INCREMENT = 行数</span><br><span class="line">    -- 数据文件目录</span><br><span class="line">        DATA DIRECTORY = &#x27;目录&#x27;</span><br><span class="line">    -- 索引文件目录</span><br><span class="line">        INDEX DIRECTORY = &#x27;目录&#x27;</span><br><span class="line">    -- 表注释</span><br><span class="line">        COMMENT = &#x27;string&#x27;</span><br><span class="line">    -- 分区选项</span><br><span class="line">        PARTITION BY ... (详细见手册)</span><br><span class="line">2.查看所有表</span><br><span class="line">SHOW TABLES FROM 表名</span><br><span class="line">3.查看表结构</span><br><span class="line">SHOW CREATE TABLE 表名 （信息更详细）</span><br><span class="line">DESC 表名 / DESCRIBE 表名 / EXPLAIN 表名 / SHOW COLUMNS FROM 表名</span><br><span class="line">4.修改表</span><br><span class="line">	a.修改表本身的选项</span><br><span class="line">		ALTER TABLE 表名 表的选项</span><br><span class="line">		eg: ALTER TABLE 表名 ENGINE=MYISAM;</span><br><span class="line">	b.对表进行重命名</span><br><span class="line">		RENAME TABLE 原表名 TO 新表名</span><br><span class="line">		RENAME TABLE 原表名 TO 库名.表名 （可将表移动到另一个数据库）</span><br><span class="line">	c.修改表的字段机构（13.1.2. ALTER TABLE语法）</span><br><span class="line">		ALTER TABLE 表名 操作名</span><br><span class="line">        -- 操作名</span><br><span class="line">            ADD[ COLUMN] 字段定义       -- 增加字段</span><br><span class="line">                AFTER 字段名          -- 表示增加在该字段名后面</span><br><span class="line">                FIRST               -- 表示增加在第一个</span><br><span class="line">            ADD PRIMARY KEY(字段名)   -- 创建主键</span><br><span class="line">            ADD UNIQUE [索引名](字段名)-- 创建唯一索引</span><br><span class="line">            ADD INDEX [索引名](字段名) -- 创建普通索引</span><br><span class="line">            DROP[ COLUMN] 字段名      -- 删除字段</span><br><span class="line">            MODIFY[ COLUMN] 字段名 字段属性     -- 支持对字段属性进行修改，不能修改字段名(所有原有属性也需写上)</span><br><span class="line">            CHANGE[ COLUMN] 原字段名 新字段名 字段属性      -- 支持对字段名修改</span><br><span class="line">            DROP PRIMARY KEY    -- 删除主键(删除主键前需删除其AUTO_INCREMENT属性)</span><br><span class="line">            DROP INDEX 索引名 -- 删除索引</span><br><span class="line">            DROP FOREIGN KEY 外键    -- 删除外键</span><br><span class="line">5.删除表</span><br><span class="line">DROP TABLE[ IF EXISTS] 表名</span><br><span class="line">6.清空表数据</span><br><span class="line">TRUNCATE [TABLE] 表名</span><br><span class="line">7.复制表结构</span><br><span class="line">CREATE TABLE 表名 LIKE 要复制的表名</span><br><span class="line">8.复制表结构和数据</span><br><span class="line">CREATE TABLE 表名 [AS] SELECT * FROM 要复制的表名</span><br></pre></td></tr></table></figure>
<h2 id="6-3-DML-数据操作语言"><a href="#6-3-DML-数据操作语言" class="headerlink" title="6.3 DML:数据操作语言"></a>6.3 DML:数据操作语言</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">1.增添数据</span><br><span class="line">a.INSERT [INTO] 表名 [(字段列表)] VALUES (值列表)[, (值列表), ...]</span><br><span class="line">        -- 如果要插入的值列表包含所有字段并且顺序一致，则可以省略字段列表。</span><br><span class="line">        -- 可同时插入多条数据记录！</span><br><span class="line">        REPLACE 与 INSERT 完全一样，可互换。</span><br><span class="line">b.INSERT [INTO] 表名 SET 字段名=值[, 字段名=值, ...]</span><br><span class="line">2.查询数据</span><br><span class="line">SELECT 字段列表 FROM 表名[ 其他子句]</span><br><span class="line">        -- 可来自多个表的多个字段</span><br><span class="line">        -- 字段列表可以用*代替，表示所有字段</span><br><span class="line">3.删除数据</span><br><span class="line">DELETE FROM 表名[WHERE ...] [ORDER BY ...] [LIMIT ...]</span><br><span class="line">	没有条件子句，则会删除全部</span><br><span class="line">	按照条件删除。where</span><br><span class="line">	指定删除的最多记录数。limit</span><br><span class="line">	可以通过排序条件删除。order by + limit</span><br><span class="line">TRUNCATE TABLE 表名：TRUNCATE是DDL语句，它是先删除drop该表，再create该表，而且无法回滚。</span><br><span class="line">区别：</span><br><span class="line">	1，truncate 是删除表再创建，delete 是逐条删除</span><br><span class="line">	2，truncate 重置auto_increment的值。而delete不会</span><br><span class="line">	3，truncate 不知道删除了几条，而delete知道。</span><br><span class="line">	4，当被用于带分区的表时，truncate 会保留分区</span><br><span class="line">4.修改数据</span><br><span class="line">UPDATE 表名 SET 字段名=新值[, 字段名=新值] [更新条件]</span><br></pre></td></tr></table></figure>
<h2 id="6-4-DCL-数据控制语言"><a href="#6-4-DCL-数据控制语言" class="headerlink" title="6.4 DCL:数据控制语言"></a>6.4 DCL:数据控制语言</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">1.root密码重置</span><br><span class="line">	a. 停止MySQL服务</span><br><span class="line">	b.  [Linux] /usr/local/mysql/bin/safe_mysqld --skip-grant-tables &amp;</span><br><span class="line">    	[Windows] mysqld --skip-grant-tables</span><br><span class="line">	c. use mysql;</span><br><span class="line">	d. UPDATE `user` SET PASSWORD=PASSWORD(&quot;密码&quot;) WHERE `user` = &quot;root&quot;;</span><br><span class="line">	e. FLUSH PRIVILEGES;</span><br><span class="line"></span><br><span class="line">用户信息表：mysql.user</span><br><span class="line"></span><br><span class="line">2.刷新权限</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line">3.创建用户</span><br><span class="line">*一个项目创建一个用户！一个项目对应的数据库只有一个！</span><br><span class="line">*这个用户只能对这个数据库有权限，其它数据库就操作不了了！</span><br><span class="line">CREATE USER 用户名@IP地址 IDENTIFIED BY [PASSWORD] 密码(字符串)</span><br><span class="line">    - 必须拥有mysql数据库的全局CREATE USER权限，或拥有INSERT权限。</span><br><span class="line">    - 只能创建用户，不能赋予权限。</span><br><span class="line">    - 用户名，注意引号：如 &#x27;user_name&#x27;@&#x27;192.168.1.1&#x27;</span><br><span class="line">    - 密码也需引号，纯数字密码也要加引号</span><br><span class="line">    - 要在纯文本中指定密码，需忽略PASSWORD关键词。要把密码指定为由PASSWORD()函数返回的混编值，需包含关键字PASSWORD</span><br><span class="line">4.重命名用户</span><br><span class="line">RENAME USER old_user TO new_user</span><br><span class="line">5.设置密码</span><br><span class="line">SET PASSWORD = PASSWORD(&#x27;密码&#x27;)  -- 为当前用户设置密码</span><br><span class="line">SET PASSWORD FOR 用户名 = PASSWORD(&#x27;密码&#x27;) -- 为指定用户设置密码</span><br><span class="line">6.删除用户</span><br><span class="line">DROP USER 用户名</span><br><span class="line">7.分配权限/添加用户</span><br><span class="line">GRANT 权限列表 ON 库名.表名 TO 用户名@IP地址 [IDENTIFIED BY [PASSWORD] &#x27;password&#x27;]</span><br><span class="line">    - all privileges 表示所有权限</span><br><span class="line">    - *.* 表示所有库的所有表</span><br><span class="line">    - 库名.表名 表示某库下面的某表</span><br><span class="line">    eg:GRANT ALL PRIVILEGES ON `pms`.* TO &#x27;pms&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;pms0817&#x27;;</span><br><span class="line">8.查看权限</span><br><span class="line">SHOW GRANTS FOR 用户名</span><br><span class="line">    -- 查看当前用户权限</span><br><span class="line">    SHOW GRANTS; 或 SHOW GRANTS FOR CURRENT_USER; 或 SHOW GRANTS FOR CURRENT_USER();</span><br><span class="line">9.撤消权限</span><br><span class="line">REVOKE 权限列表 ON 表名 FROM 用户名@IP地址</span><br><span class="line">REVOKE ALL PRIVILEGES, GRANT OPTION FROM 用户名   -- 撤销所有权限</span><br><span class="line">#权限层级</span><br><span class="line">#要使用GRANT或REVOKE，您必须拥有GRANT OPTION权限，并且您必须用于您正在授予或撤销的权限。</span><br><span class="line">#全局层级：全局权限适用于一个给定服务器中的所有数据库，mysql.user</span><br><span class="line">    GRANT ALL ON *.*和 REVOKE ALL ON *.*只授予和撤销全局权限。</span><br><span class="line">#数据库层级：数据库权限适用于一个给定数据库中的所有目标，mysql.db, mysql.host</span><br><span class="line">    GRANT ALL ON db_name.*和REVOKE ALL ON db_name.*只授予和撤销数据库权限。</span><br><span class="line">#表层级：表权限适用于一个给定表中的所有列，mysql.talbes_priv</span><br><span class="line">    GRANT ALL ON db_name.tbl_name和REVOKE ALL ON db_name.tbl_name只授予和撤销表权限。</span><br><span class="line">#列层级：列权限适用于一个给定表中的单一列，mysql.columns_priv</span><br><span class="line">    当使用REVOKE时，您必须指定与被授权列相同的列。</span><br><span class="line">#权限列表</span><br><span class="line">ALL [PRIVILEGES]    -- 设置除GRANT OPTION之外的所有简单权限</span><br><span class="line">ALTER   -- 允许使用ALTER TABLE</span><br><span class="line">ALTER ROUTINE   -- 更改或取消已存储的子程序</span><br><span class="line">CREATE  -- 允许使用CREATE TABLE</span><br><span class="line">CREATE ROUTINE  -- 创建已存储的子程序</span><br><span class="line">CREATE TEMPORARY TABLES     -- 允许使用CREATE TEMPORARY TABLE</span><br><span class="line">CREATE USER     -- 允许使用CREATE USER, DROP USER, RENAME USER和REVOKE ALL PRIVILEGES。</span><br><span class="line">CREATE VIEW     -- 允许使用CREATE VIEW</span><br><span class="line">DELETE  -- 允许使用DELETE</span><br><span class="line">DROP    -- 允许使用DROP TABLE</span><br><span class="line">EXECUTE     -- 允许用户运行已存储的子程序</span><br><span class="line">FILE    -- 允许使用SELECT...INTO OUTFILE和LOAD DATA INFILE</span><br><span class="line">INDEX   -- 允许使用CREATE INDEX和DROP INDEX</span><br><span class="line">INSERT  -- 允许使用INSERT</span><br><span class="line">LOCK TABLES     -- 允许对您拥有SELECT权限的表使用LOCK TABLES</span><br><span class="line">PROCESS     -- 允许使用SHOW FULL PROCESSLIST</span><br><span class="line">REFERENCES  -- 未被实施</span><br><span class="line">RELOAD  -- 允许使用FLUSH</span><br><span class="line">REPLICATION CLIENT  -- 允许用户询问从属服务器或主服务器的地址</span><br><span class="line">REPLICATION SLAVE   -- 用于复制型从属服务器（从主服务器中读取二进制日志事件）</span><br><span class="line">SELECT  -- 允许使用SELECT</span><br><span class="line">SHOW DATABASES  -- 显示所有数据库</span><br><span class="line">SHOW VIEW   -- 允许使用SHOW CREATE VIEW</span><br><span class="line">SHUTDOWN    -- 允许使用mysqladmin shutdown</span><br><span class="line">SUPER   -- 允许使用CHANGE MASTER, KILL, PURGE MASTER LOGS和SET GLOBAL语句，mysqladmin debug命令；允许您连接（一次），即使已达到max_connections。</span><br><span class="line">UPDATE  -- 允许使用UPDATE</span><br><span class="line">USAGE   -- “无权限”的同义词</span><br><span class="line">GRANT OPTION    -- 允许授予权限</span><br></pre></td></tr></table></figure>
<h2 id="6-5-DQL-数据查询语言"><a href="#6-5-DQL-数据查询语言" class="headerlink" title="6.5 DQL:数据查询语言"></a>6.5 DQL:数据查询语言</h2><h3 id="查询语法格式"><a href="#查询语法格式" class="headerlink" title="查询语法格式"></a>查询语法格式</h3><p>mysql 查询数据有两种方式</p>
<h4 id="SELECT-语法"><a href="#SELECT-语法" class="headerlink" title="SELECT 语法"></a>SELECT 语法</h4><p>语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">all</span><span class="operator">|</span><span class="keyword">distinct</span>] <span class="operator">|</span>top 数字[<span class="keyword">percent</span>]</span><br><span class="line">    [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span> <span class="operator">|</span> DISTINCTROW ]</span><br><span class="line">    </span><br><span class="line">	字段 <span class="keyword">as</span> 常量 <span class="operator">|</span> 包含字段表达式 <span class="operator">|</span> 函数(如：sum, max) <span class="operator">|</span> 常量</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	表或结果集</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	条件： 逻辑<span class="operator">|</span>空值<span class="operator">|</span>多条件<span class="operator">|</span>模糊<span class="operator">|</span>范围</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">	字段</span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line">	筛选条件</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">	字段 <span class="keyword">ASC</span> <span class="operator">|</span> <span class="keyword">DESC</span></span><br><span class="line">LIMIT</span><br><span class="line">    开始索引, 每页大小</span><br></pre></td></tr></table></figure>
<p><strong>sql的执行顺序：<code>from -&gt; where -&gt; group by -&gt; having -&gt; select -&gt; order by</code></strong></p>
<h4 id="SELECT-INTO-语法"><a href="#SELECT-INTO-语法" class="headerlink" title="SELECT INTO 语法"></a>SELECT INTO 语法</h4><p><code>select into</code> 通常用来把旧表数据插入到新表中，请求格式如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	字段等</span><br><span class="line"><span class="keyword">INTO</span></span><br><span class="line">    表名</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	数据源</span><br><span class="line">	其他子句</span><br></pre></td></tr></table></figure>
<h3 id="查询数据-select"><a href="#查询数据-select" class="headerlink" title="查询数据 select"></a>查询数据 select</h3><h4 id="查询所有列"><a href="#查询所有列" class="headerlink" title="查询所有列"></a>查询所有列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>
<blockquote>
<font color=red>**Tips: `*` 号代表查询所有字段，在实际开发中尽量少用（不直观、影响效率）。**</font>

</blockquote>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询 student 表所有数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>
<h4 id="查询指定列"><a href="#查询指定列" class="headerlink" title="查询指定列"></a>查询指定列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名<span class="number">1</span>, 列名<span class="number">2</span>, ……… <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询 student 表的 NAME、gender 列</span></span><br><span class="line"><span class="keyword">SELECT</span> NAME,gender <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>
<h4 id="查询时指定列的别名"><a href="#查询时指定列的别名" class="headerlink" title="查询时指定列的别名"></a>查询时指定列的别名</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名<span class="number">1</span> <span class="keyword">AS</span> 别名<span class="number">1</span>, 列名<span class="number">2</span> <span class="keyword">AS</span> 别名<span class="number">2</span>,…… <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips: <code>AS</code> 关键字可以省略</p>
</blockquote>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> NAME <span class="keyword">AS</span> <span class="string">&#x27;姓名&#x27;</span>,gender <span class="keyword">AS</span> <span class="string">&#x27;性别&#x27;</span> <span class="keyword">FROM</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- AS 可以省略</span></span><br><span class="line"><span class="keyword">SELECT</span> NAME <span class="string">&#x27;姓名&#x27;</span>,gender <span class="string">&#x27;性别&#x27;</span> <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>
<h4 id="合并列查询"><a href="#合并列查询" class="headerlink" title="合并列查询"></a>合并列查询</h4><p>查询时可以对数值类型的列进行合并运算，并将结果新增一列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span>,(数值类型的列名<span class="number">1</span><span class="operator">+</span>数值类型的列名<span class="number">2</span><span class="operator">+</span>……) <span class="keyword">as</span> 别名 <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意事项：</p>
<ul>
<li>合并列必须是数值类型</li>
<li>合并非数值类型是没有意义，合并后也是输出数据类型的值</li>
</ul>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>, (math<span class="operator">+</span>english) <span class="string">&#x27;总成绩&#x27;</span> <span class="keyword">FROM</span> student;</span><br><span class="line"><span class="comment">-- 合并非数值类型</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>, (math<span class="operator">+</span>NAME) <span class="string">&#x27;总成绩&#x27;</span> <span class="keyword">FROM</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询所有员工的薪资,年薪,以及姓名，也可以选择列后直接进行算术运算</span></span><br><span class="line"><span class="keyword">SELECT</span> uname,salary,(salary<span class="operator">*</span><span class="number">12</span>) <span class="keyword">AS</span> <span class="string">&#x27;年薪&#x27;</span> <span class="keyword">FROM</span> users;</span><br></pre></td></tr></table></figure>
<h4 id="查询时添加常量列"><a href="#查询时添加常量列" class="headerlink" title="查询时添加常量列"></a>查询时添加常量列</h4><p>使用<code>&#39;&#39;</code>单引号包裹的内容会当成常量列，在查询时新增一列到原表。语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span>,<span class="string">&#x27;添加的内容&#x27;</span> <span class="keyword">as</span> 别名 <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>, <span class="string">&#x27;JavaEE 就业班&#x27;</span> <span class="keyword">AS</span> <span class="string">&#x27;班级&#x27;</span> <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+----+------+------+------+---------+--------+</span><br><span class="line">| ID | NAME | AGE  | MATH | ENGLISH |  班级   |</span><br><span class="line">+----+------+------+------+---------+--------+</span><br><span class="line">| 1  | 张三  | 17   | 88   |  98     | JavaEE |</span><br><span class="line">+----+------+------+------+---------+--------+</span><br><span class="line">| 2  | 李四  | 19   | 99   |  86     | JavaEE |</span><br><span class="line">+----+------+------+------+---------+--------+</span><br><span class="line">| 2  | jack | 30   | 78   |  83     | JavaEE |</span><br><span class="line">+----+------+------+------+---------+--------+</span><br></pre></td></tr></table></figure>
<h4 id="去除重复数据"><a href="#去除重复数据" class="headerlink" title="去除重复数据"></a>去除重复数据</h4><p>查询时使用 <code>DISTINCT</code> 关键字可以去除重复数据。</p>
<ul>
<li>根据某一列的内容去掉重复的值，只保留其中一个内容</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> 列名 <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> address <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>
<ul>
<li>根据多列的内容去掉重复的值，要多个列的内容同时一致才去掉。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> 列名<span class="number">1</span>,列名<span class="number">2</span>,…… <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span>(address) <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>
<h3 id="条件查询-where"><a href="#条件查询-where" class="headerlink" title="条件查询 where"></a>条件查询 where</h3><h4 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h4><p>where语句表条件过滤。满足条件操作，不满足不操作，多用于数据的查询与修改。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表名 <span class="keyword">WHERE</span> 条件;</span><br></pre></td></tr></table></figure>
<h4 id="MySQL支持4种运算符"><a href="#MySQL支持4种运算符" class="headerlink" title="MySQL支持4种运算符"></a>MySQL支持4种运算符</h4><ul>
<li>算术运算符</li>
<li>比较运算符</li>
<li>逻辑运算符</li>
<li>位运算符</li>
</ul>
<h4 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">算术运算符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>+</code></td>
<td>加法运算</td>
</tr>
<tr>
<td style="text-align:center"><code>-</code></td>
<td>减法运算</td>
</tr>
<tr>
<td style="text-align:center"><code>*</code></td>
<td>乘法运算</td>
</tr>
<tr>
<td style="text-align:center"><code>/</code> 或 <code>DIV</code></td>
<td>除法运算，返回商</td>
</tr>
<tr>
<td style="text-align:center"><code>%</code> 或 <code>MOD</code></td>
<td>求余运算，返回余数</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 将每件商品的价格加10</span></span><br><span class="line"><span class="keyword">select</span> name,price <span class="operator">+</span> <span class="number">10</span> <span class="keyword">as</span> new_price <span class="keyword">from</span> product;</span><br><span class="line"><span class="comment">-- 将所有商品的价格上调10%</span></span><br><span class="line"><span class="keyword">select</span> pname,price <span class="operator">*</span> <span class="number">1.1</span> <span class="keyword">as</span> new_price <span class="keyword">from</span> product;</span><br></pre></td></tr></table></figure>
<h4 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">比较运算符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>=</code></td>
<td>等于</td>
</tr>
<tr>
<td style="text-align:center"><code>&lt;</code>  和  <code>&lt;=</code></td>
<td>小于和小于等于</td>
</tr>
<tr>
<td style="text-align:center"><code>&gt;</code>  和  <code>&gt;=</code></td>
<td>大于和大于等于</td>
</tr>
<tr>
<td style="text-align:center"><code>&lt;=&gt;</code></td>
<td>安全的等于，两个操作码均为 NULL 时，其所得值为1；而当一个操作码为NULL时，其所得值为0</td>
</tr>
<tr>
<td style="text-align:center"><code>&lt;&gt;</code> 或<code>!=</code></td>
<td>不等于</td>
</tr>
<tr>
<td style="text-align:center"><code>IS NULL</code> 或 <code>ISNULL</code></td>
<td>判断一个值是否为  NULL</td>
</tr>
<tr>
<td style="text-align:center"><code>IS NOT NULL</code></td>
<td>判断一个值是否不为  NULL</td>
</tr>
<tr>
<td style="text-align:center"><code>LEAST</code></td>
<td>当有两个或多个参数时，返回最小值</td>
</tr>
<tr>
<td style="text-align:center"><code>GREATEST</code></td>
<td>当有两个或多个参数时，返回最大值；若比较值中有一个null值，则返回null</td>
</tr>
<tr>
<td style="text-align:center"><code>BETWEEN .. AND ..</code></td>
<td>判断一个值是否落在两个值之间，显示在某一区间的值(包头包尾)</td>
</tr>
<tr>
<td style="text-align:center"><code>IN</code></td>
<td>判断一个值是 IN 列表中的任意一个值</td>
</tr>
<tr>
<td style="text-align:center"><code>NOT IN</code></td>
<td>判断一个值不是 IN 列表中的任意一个值</td>
</tr>
<tr>
<td style="text-align:center"><code>LIKE</code></td>
<td>通配符匹配。模糊查询，Like语句中有两个通配符：<br/><code>%</code>：用来匹配多个字符<br/> <code>_</code>：用来匹配一个字符</td>
</tr>
<tr>
<td style="text-align:center"><code>REGEXP</code></td>
<td>正则表达式匹配</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p><strong>注：mysql中用<code>&lt;&gt;</code>与<code>!=</code>都是可以的，但sqlserver中不识别<code>!=</code>，所以建议用<code>&lt;&gt;</code>；但是<code>!=</code>在sql2000中用到，则是语法错误，不兼容的</strong></p>
</blockquote>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询 math 字段值在 [80, 88] 区间的记录</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> math<span class="operator">&gt;=</span><span class="number">80</span> <span class="keyword">AND</span> math<span class="operator">&lt;=</span><span class="number">88</span>;</span><br><span class="line"><span class="comment">-- 等价于上面</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> math <span class="keyword">BETWEEN</span> <span class="number">80</span> <span class="keyword">AND</span> <span class="number">88</span>; <span class="comment">-- (包前包后)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用least求最小值</span></span><br><span class="line"><span class="keyword">select</span> least(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>); <span class="comment">-- 10</span></span><br><span class="line"><span class="keyword">select</span> least(<span class="number">10</span>, <span class="keyword">null</span> , <span class="number">30</span>); <span class="comment">-- 当比较值中有一个null值，则直接返回null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用greatest求最大值</span></span><br><span class="line"><span class="keyword">select</span> greatest(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">select</span> greatest(<span class="number">10</span>, <span class="keyword">null</span>, <span class="number">30</span>); <span class="comment">-- 当比较值中有一个null值，则直接返回null</span></span><br></pre></td></tr></table></figure>
<h5 id="null-和空字符串的比较运算"><a href="#null-和空字符串的比较运算" class="headerlink" title="null 和空字符串的比较运算"></a>null 和空字符串的比较运算</h5><p><strong>null 和 空字符串的区别：</strong></p>
<ul>
<li><code>null</code>：没有数据。</li>
<li>空字符：有数据，数据就是空字符串。</li>
</ul>
<p><strong>判断是否为空串</strong>：</p>
<ul>
<li><code>= &#39;&#39;</code>: 是空串。（注意：这里不是用<code>==</code>）</li>
<li><code>&lt;&gt; &#39;&#39;</code>: 不是空串</li>
</ul>
<p><strong>判断是否为空(<code>null</code>)</strong>：</p>
<ul>
<li><code>is null</code>：判断是null</li>
<li><code>is not null</code>：判断不是null</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> address <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> address<span class="operator">=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> address <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">OR</span> address<span class="operator">=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> address <span class="keyword">IS</span> <span class="keyword">NOT NULL</span> <span class="keyword">AND</span> address<span class="operator">&lt;&gt;</span><span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h5 id="模糊查询：like"><a href="#模糊查询：like" class="headerlink" title="模糊查询：like"></a>模糊查询：like</h5><p>相关字符的含义：</p>
<ul>
<li><code>%</code>：表示匹配多个任意字符(0到多个)</li>
<li><code>_</code>：表示匹配一个任意字符</li>
</ul>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名 <span class="keyword">where</span> 列名 <span class="keyword">like</span> 条件;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询姓张的学生</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> NAME <span class="keyword">LIKE</span> <span class="string">&#x27;张%&#x27;</span>;</span><br><span class="line"><span class="comment">-- 查询姓名中包含&#x27;张&#x27;字的学生</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> NAME <span class="keyword">LIKE</span> <span class="string">&#x27;%张%&#x27;</span>;</span><br><span class="line"><span class="comment">-- 查询姓张，且姓名只有两个字的学生</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> NAME <span class="keyword">LIKE</span> <span class="string">&#x27;张__&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h5 id="模糊查询：in"><a href="#模糊查询：in" class="headerlink" title="模糊查询：in"></a>模糊查询：in</h5><p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名 <span class="keyword">where</span> 列名 <span class="keyword">in</span> (条件<span class="number">1</span>,条件<span class="number">2</span>,……);</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="number">1</span>,<span class="number">3</span>); <span class="comment">-- 这种效率更高</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">OR</span> id<span class="operator">=</span><span class="number">3</span>; <span class="comment">-- 等价于上面的sql</span></span><br></pre></td></tr></table></figure>
<h5 id="扩展-行行比较（SQL-92）"><a href="#扩展-行行比较（SQL-92）" class="headerlink" title="扩展 - 行行比较（SQL-92）"></a>扩展 - 行行比较（SQL-92）</h5><p>SQL-92 中加入了行与行比较的功能。如 <code>=</code>、<code>&lt;</code>、<code>&gt;</code> 和 <code>IN</code> 等比较运算符就不再只是标量值了，还可以是值列表。</p>
<p>案例需求：业务机构下销售商品，同个业务机构可以销售不同的商品，同个商品可以在不同的业务机构销售，也就说：业务机构与商品是多对多的关系。假设现在有 n 个机构，每个机构下有几个商品，如何查询出这几个门店下各自商品的销售情况？</p>
<p>具体的 SQL 类似如下：</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251016668.png" alt=""></p>
<p>Mybatis 的动态 SQL 实现，类似如下</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251016640.png" alt=""></p>
<p>此类型 SQL 同样能走索引</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251012226.png" alt=""></p>
<p>总结：行行比较是 SQL 规范，不是某个关系型数据库的规范，即关系型数据库都应该支持这种写法。行行比较是 SQL-92 中引入的，SQL-92 是 1992 年制定的规范，即该写法不是新特性，而是很早就存在的基础功能！</p>
<h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">逻辑运算符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>NOT</code> 或者 <code>!</code></td>
<td>逻辑非，条件不成立</td>
</tr>
<tr>
<td style="text-align:center"><code>AND</code> 或者 <code>&amp;&amp;</code></td>
<td>逻辑与，多个条件同时成立</td>
</tr>
<tr>
<td style="text-align:center"><code>OR</code> 或者 `</td>
<td></td>
<td>`</td>
<td>逻辑或，多个条件任一成立</td>
</tr>
<tr>
<td style="text-align:center"><code>XOR</code></td>
<td>逻辑异或</td>
</tr>
</tbody>
</table>
</div>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">3</span> <span class="keyword">AND</span> gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">3</span> <span class="keyword">OR</span> gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="位运算符-了解"><a href="#位运算符-了解" class="headerlink" title="位运算符(了解)"></a>位运算符(了解)</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">位运算符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">`</td>
<td>`</td>
<td>按位或</td>
</tr>
<tr>
<td style="text-align:center"><code>&amp;</code></td>
<td>按位与</td>
</tr>
<tr>
<td style="text-align:center"><code>^</code></td>
<td>按位异或</td>
</tr>
<tr>
<td style="text-align:center"><code>&lt;&lt;</code></td>
<td>按位左移</td>
</tr>
<tr>
<td style="text-align:center"><code>&gt;&gt;</code></td>
<td>按位右移</td>
</tr>
<tr>
<td style="text-align:center"><code>~</code></td>
<td>按位取反，反转所有比特</td>
</tr>
</tbody>
</table>
</div>
<p>位运算符是在二进制数上进行计算的运算符。位运算会先将操作数变成二进制数，进行位运算。然后再将计算结果从二进制数变回十进制数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">3</span><span class="operator">&amp;</span><span class="number">5</span>; <span class="comment">-- 位与</span></span><br><span class="line"><span class="keyword">select</span> <span class="number">3</span><span class="operator">|</span><span class="number">5</span>; <span class="comment">-- 位或</span></span><br><span class="line"><span class="keyword">select</span> <span class="number">3</span><span class="operator">^</span><span class="number">5</span>; <span class="comment">-- 位异或</span></span><br><span class="line"><span class="keyword">select</span> <span class="number">3</span><span class="operator">&gt;&gt;</span><span class="number">1</span>; <span class="comment">-- 位左移</span></span><br><span class="line"><span class="keyword">select</span> <span class="number">3</span><span class="operator">&lt;&lt;</span><span class="number">1</span>; <span class="comment">-- 位右移</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">~</span><span class="number">3</span>;   <span class="comment">-- 位取反</span></span><br></pre></td></tr></table></figure>
<h3 id="排序查询-order-by"><a href="#排序查询-order-by" class="headerlink" title="排序查询 order by"></a>排序查询 order by</h3><p><code>order by</code> 语句的作用是根据指定的列内容排序，排序的列可以是表中的列名，也可以是 <code>select</code> 语句后指定的列名。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    字段名<span class="number">1</span>，字段名<span class="number">2</span>，……</span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    表名</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> </span><br><span class="line">    字段名<span class="number">1</span> [<span class="keyword">asc</span><span class="operator">|</span><span class="keyword">desc</span>]，字段名<span class="number">2</span>[<span class="keyword">asc</span><span class="operator">|</span><span class="keyword">desc</span>]……</span><br></pre></td></tr></table></figure>
<p><strong>关键字解释</strong>：</p>
<ul>
<li><code>asc</code>：顺序（正序：数值：从小到大，字符串：字符 a-z）。不指定时默认<code>asc</code></li>
<li><code>desc</code>：倒序（正序：数值：从大到小，字符串：字符 z-a）</li>
</ul>
<p><strong>排序查询注意事项</strong>：</p>
<ul>
<li><strong><code>order by</code> 子句应位于 <code>select</code> 语句的结尾</strong>。<code>LIMIT</code> 子句除外</li>
<li><code>order by</code>用于子句中可以支持单个字段，多个字段，表达式，函数，别名</li>
<li><strong><code>order by</code> 后面指定的列名或别名必须存在，否则查询出错。</strong></li>
</ul>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1.使用价格排序(降序)</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> product <span class="keyword">order</span> <span class="keyword">by</span> price <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 2.在价格排序(降序)的基础上，以分类排序(降序)</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> product <span class="keyword">order</span> <span class="keyword">by</span> price <span class="keyword">desc</span>,category_id <span class="keyword">asc</span>;</span><br><span class="line"><span class="comment">-- 3.显示商品的价格(去重复)，并排序(降序)</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> price <span class="keyword">from</span> product <span class="keyword">order</span> <span class="keyword">by</span> price <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<h4 id="以表中的列名排序"><a href="#以表中的列名排序" class="headerlink" title="以表中的列名排序"></a>以表中的列名排序</h4><p>按表中的列名排序，如果不写(<code>asc</code>/<code>desc</code>)则默认是顺序(<code>asc</code>)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名 <span class="keyword">order</span> <span class="keyword">by</span> 列名(别名) <span class="keyword">asc</span><span class="operator">/</span><span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1) 对数学成绩从小到大排序后输出。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">ORDER</span> <span class="keyword">BY</span> math;</span><br><span class="line"><span class="comment">-- 2) 对总分按从高到低的顺序输出</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>, (math<span class="operator">+</span>english) <span class="keyword">AS</span> 总分 <span class="keyword">FROM</span> student <span class="keyword">ORDER</span> <span class="keyword">BY</span> 总分 <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>
<h4 id="以-select-语句后指定的列名排序"><a href="#以-select-语句后指定的列名排序" class="headerlink" title="以 select 语句后指定的列名排序"></a>以 select 语句后指定的列名排序</h4><p>按新的列名排序，如果出现 <code>where</code> 条件查询，则 <code>ORDER BY</code> 子句应位于 <code>SELECT</code> 语句的结尾。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span>,(列名<span class="number">1</span><span class="operator">+</span>列名<span class="number">2</span><span class="operator">+</span>……) <span class="keyword">as</span> 别名 <span class="keyword">from</span> 表名 <span class="keyword">order</span> <span class="keyword">by</span> 别名 <span class="keyword">asc</span><span class="operator">/</span><span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 3) 姓张的学生成绩从小到大排序输出</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>, (math<span class="operator">+</span>english) <span class="keyword">AS</span> 总分 <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> NAME <span class="keyword">LIKE</span> <span class="string">&#x27;张%&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> 总分;</span><br></pre></td></tr></table></figure>
<h4 id="order-by-排序内部原理"><a href="#order-by-排序内部原理" class="headerlink" title="order by 排序内部原理"></a>order by 排序内部原理</h4><p>MySQL 会为每个线程分配一个内存（sort-buffer）用于排序，该内存大小为参数 <code>sort_buffer_size</code> 的值。</p>
<ul>
<li>如果排序的数据量小于 <code>sort_buffer_size</code>，排序就会在内存中完成。内部排序分为两种：<ul>
<li>全字段排序：到索引树上找到满足条件的主键 ID，根据主键 ID 去取出数据放到 sort_buffer 然后进行快速排序。</li>
<li>rowid 排序：通过控制排序的行数据的长度来让 sort_buffer 中尽可能多的存放数据。</li>
</ul>
</li>
<li>如果数据量很大，内存中无法存下这么多，就会使用磁盘临时文件来辅助排序，称为<strong>外部排序</strong>。MySQL 会分成多份单独的临时文件来存放排序后的数据，一般是在磁盘文件中进行归并，然后将这些文件合并成一个大文件。</li>
</ul>
<h3 id="聚合查询"><a href="#聚合查询" class="headerlink" title="聚合查询"></a>聚合查询</h3><h4 id="定义与语法"><a href="#定义与语法" class="headerlink" title="定义与语法"></a>定义与语法</h4><p>聚合函数查询是纵向查询，它是对一列的值进行计算，然后返回一个单一的值。语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 聚合函数名称(数值列名) <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Notes: </p>
<ul>
<li><font color=red><strong>聚合函数会排除空值(<code>null</code>)的数据</strong></font>。</li>
<li>按聚合函数的结果来查询，列必须是数值列（<code>COUNT</code>函数除外），如果不是数值列，则结果为0</li>
</ul>
</blockquote>
<h4 id="常用的聚合函数"><a href="#常用的聚合函数" class="headerlink" title="常用的聚合函数"></a>常用的聚合函数</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">聚合函数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>count()</code></td>
<td>统计指定列不为NULL的记录行数；</td>
</tr>
<tr>
<td style="text-align:center"><code>sum()</code></td>
<td>计算指定列的数值和，如果指定列类型不是数值类型，那么计算结果为0</td>
</tr>
<tr>
<td style="text-align:center"><code>max()</code></td>
<td>计算指定列的最大值，如果指定列是字符串类型，那么使用字符串排序运算；</td>
</tr>
<tr>
<td style="text-align:center"><code>min()</code></td>
<td>计算指定列的最小值，如果指定列是字符串类型，那么使用字符串排序运算；</td>
</tr>
<tr>
<td style="text-align:center"><code>avg()</code></td>
<td>计算指定列的平均值，如果指定列类型不是数值类型，那么计算结果为0</td>
</tr>
</tbody>
</table>
</div>
<h4 id="聚合查询示例"><a href="#聚合查询示例" class="headerlink" title="聚合查询示例"></a>聚合查询示例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 需求： 查询所有学生 english 的总分</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(english) <span class="keyword">FROM</span> student;</span><br><span class="line"><span class="comment">-- 2. 需求： 查询所有学生 english 的平均分</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(english) <span class="keyword">FROM</span> student;</span><br><span class="line"><span class="comment">-- 3. 需求：查询最高的 english 分数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(english) <span class="keyword">FROM</span> student;</span><br><span class="line"><span class="comment">-- 4. 需求：查询最低的 english 分数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(english) <span class="keyword">FROM</span> student;</span><br><span class="line"><span class="comment">-- 5. 需求： 一共几个学生</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> student;    <span class="comment">-- 推荐使用</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(id) <span class="keyword">FROM</span> student;   <span class="comment">-- 效率会比 count(*)效率稍高</span></span><br><span class="line"><span class="comment">-- 注意： 聚合函数，如果列的值 为null，会排除 null 值的数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(address) <span class="keyword">FROM</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1 查询商品的总条数</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> product;</span><br><span class="line"><span class="comment">-- 2 查询价格大于200商品的总条数</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> product <span class="keyword">where</span> price <span class="operator">&gt;</span> <span class="number">200</span>;</span><br><span class="line"><span class="comment">-- 3 查询分类为&#x27;c001&#x27;的所有商品的总和</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(price) <span class="keyword">from</span> product <span class="keyword">where</span> category_id <span class="operator">=</span> <span class="string">&#x27;c001&#x27;</span>;</span><br><span class="line"><span class="comment">-- 4 查询商品的最大价格</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(price) <span class="keyword">from</span> product;</span><br><span class="line"><span class="comment">-- 5 查询商品的最小价格</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(price) <span class="keyword">from</span> product;</span><br><span class="line"><span class="comment">-- 6 查询分类为&#x27;c002&#x27;所有商品的平均价格</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(price) <span class="keyword">from</span> product <span class="keyword">where</span> category_id <span class="operator">=</span> <span class="string">&#x27;c002&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="聚合查询对-NULL-值的处理"><a href="#聚合查询对-NULL-值的处理" class="headerlink" title="聚合查询对 NULL 值的处理"></a>聚合查询对 NULL 值的处理</h4><ul>
<li><code>count</code> 函数对 <code>null</code> 值的处理逻辑是，如果<code>count</code>函数的参数为星号（<code>*</code>），则统计所有记录的个数。而如果参数为某字段，则统计不为<code>null</code>值的记录个数。</li>
<li><code>sum</code> 和 <code>avg</code> 函数是忽略 <code>null</code> 值的存在，就好象该条记录不存在一样。</li>
<li><code>max</code> 和 <code>min</code> 函数也同样忽略 <code>null</code> 值的存在。</li>
</ul>
<h3 id="分页查询-limit"><a href="#分页查询-limit" class="headerlink" title="分页查询 limit"></a>分页查询 limit</h3><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><p><code>limit</code> 关键字，用于分页查询数据。语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式1: 显示前面指定的n条记录</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名 limit n;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2: 分页显示，从起始索引m开始，查询指定n条的记录</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名 limit m, n;</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>m</code>：整数，表示从第几条索引开始，</li>
<li><code>n</code>：整数，表示查询多少条数据</li>
</ul>
<blockquote>
<p>Notes：</p>
<ul>
<li><strong>起始行数是从 0 开始</strong>，计算公式：<code>起始索引 = (当前页-1) * 每页显示记录数</code></li>
<li><strong>如果分页同时要进行排序，<code>limit</code> 语句要放在 <code>order by</code> 的后面。</strong></li>
<li><font color=red><strong>分页查询是数据库的方言，不同的数据库有不同的实现</strong></font>，MySQL 中是 <code>LIMIT</code></li>
</ul>
</blockquote>
<h4 id="分页查询示例"><a href="#分页查询示例" class="headerlink" title="分页查询示例"></a>分页查询示例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student;</span><br><span class="line"><span class="comment">-- 需求： 查询第 1,2 条数据（第 1 页数据）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">0</span>,<span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 需求： 查询第 3,4 条数据（第 2 页数据）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">2</span>,<span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 需求： 查询第 5,6 条数据（第 3 页数据）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">4</span>,<span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<h4 id="分页计算规律总结"><a href="#分页计算规律总结" class="headerlink" title="分页计算规律总结"></a>分页计算规律总结</h4><p>观察分页的开始索引，其实是等差数列。如：<code>0,2,4</code>。因此开始索引的计算公式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startIndex = (curPage-1)*pageSize</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>pageSize</code>：每页多少条</li>
<li><code>curPage</code>：当前页</li>
<li><code>startIndex</code>：查询的起始号</li>
</ul>
<h3 id="分组查询-group-by"><a href="#分组查询-group-by" class="headerlink" title="分组查询 group by"></a>分组查询 group by</h3><h4 id="语法规则"><a href="#语法规则" class="headerlink" title="语法规则"></a>语法规则</h4><p><code>group by</code> 关键字可以将查询结果按某个字段或多个字段进行分组。字段中值相等的为一组。语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段<span class="number">1</span>,字段<span class="number">2</span>… <span class="keyword">FROM</span> 表名 [ <span class="keyword">WHERE</span> 条件 ] <span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组字段名 [<span class="keyword">HAVING</span> 条件表达式][<span class="keyword">with</span> <span class="keyword">rollup</span>];</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>GROUP BY 分组字段名</code>：是指按照该字段的值进行分组。支持多字段分组，如：<code>group by columnA,columnB</code></li>
<li><code>having 条件表达式</code>：分组后过滤条件，用来限制分组后的显示内容，满足条件表达式的结果将显示</li>
<li><code>with rollup</code>：关键字将会在所有记录的最后加上一条记录。该记录是上面所有记录的总和</li>
</ul>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在分组查询的同时，统计人数。</span></span><br><span class="line"><span class="keyword">SELECT</span> gender,<span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="string">&#x27;人数&#x27;</span> <span class="keyword">FROM</span> student <span class="keyword">GROUP</span> <span class="keyword">BY</span> gender;</span><br></pre></td></tr></table></figure>
<p><strong>注：如果两个表关联，使用分组的话。group by 后面需要写上两个表的分组的列名，要以理解为，这样操作可以保持两个表的行数一致。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	m.courseid, c.`NAME`, round(<span class="built_in">avg</span>(m.score)) avgscore</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	t_mark m,</span><br><span class="line">	t_course c</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	m.courseid <span class="operator">=</span> c.id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">	m.courseid,</span><br><span class="line">	c.`NAME`</span><br></pre></td></tr></table></figure>
<h4 id="分组条件筛选-having"><a href="#分组条件筛选-having" class="headerlink" title="分组条件筛选 (having)"></a>分组条件筛选 (having)</h4><p><code>having</code> 关键字作用：用来对分组信息进行过滤，用法与<code>where</code>一样。但分组之后对统计结果进行筛选的话必须使用 <code>having</code>，不能使用 <code>where</code>。</p>
<p><code>where</code> 子句用来筛选 <code>FROM</code> 子句中指定的操作所产生的行；<code>group by</code> 子句用来分组 <code>WHERE</code> 子句的输出；<code>having</code> 子句用来从分组的结果中筛选行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名 <span class="keyword">group</span> <span class="keyword">by</span> 列名 <span class="keyword">having</span> 筛选条件;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> address,<span class="built_in">COUNT</span>(address) <span class="string">&#x27;人数&#x27;</span> <span class="keyword">FROM</span> student <span class="keyword">GROUP</span> <span class="keyword">BY</span> address;</span><br><span class="line"><span class="keyword">SELECT</span> address,<span class="built_in">COUNT</span>(address) <span class="string">&#x27;人数&#x27;</span> <span class="keyword">FROM</span> student <span class="keyword">GROUP</span> <span class="keyword">BY</span> address <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(address)<span class="operator">&gt;</span><span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.统计各个分类商品的个数,且只显示个数大于4的信息</span></span><br><span class="line"><span class="keyword">select</span> category_id ,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> product <span class="keyword">group</span> <span class="keyword">by</span> category_id <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">&gt;</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<h4 id="where-和-having-的区别"><a href="#where-和-having-的区别" class="headerlink" title="where 和 having 的区别"></a>where 和 having 的区别</h4><ul>
<li>执行时机不同：<code>where</code> 是分组之前进行过滤，不满足 <code>where</code> 条件，不参与分组；而 <code>having</code> 是分组之后对结果进行过滤。</li>
<li>判断条件不同：<code>where</code> 是对行记录进行筛选过滤，<code>where</code> 后<strong>不能跟聚合函数</strong>的(如:<code>count(*)</code>)；而 <code>having</code> 是对组信息进行筛选过滤，<code>having</code> 后<strong>可以跟聚合函数</strong>的。(如:<code>count(*)</code>)</li>
</ul>
<blockquote>
<p>Notes: 执行顺序是 where -&gt; 聚合函数 -&gt; having</p>
</blockquote>
<h4 id="with-rollup-关键字"><a href="#with-rollup-关键字" class="headerlink" title="with rollup 关键字"></a>with rollup 关键字</h4><p><code>with rollup</code> 关键字的作用是，在查询结果最后加上一条记录，并且该记录是上面所有分组记录的汇总。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> sex, <span class="built_in">COUNT</span>(sex) <span class="keyword">FROM</span> employee <span class="keyword">GROUP</span> <span class="keyword">BY</span> sex <span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------+</span></span><br><span class="line"><span class="operator">|</span> sex  <span class="operator">|</span> <span class="built_in">COUNT</span>(sex) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------+</span></span><br><span class="line"><span class="operator">|</span> 女   <span class="operator">|</span> <span class="number">1</span>          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 男   <span class="operator">|</span> <span class="number">3</span>          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="number">4</span>          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+----------- +</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> sex, GROUP_CONCAT(name) <span class="keyword">FROM</span> employee <span class="keyword">GROUP</span> <span class="keyword">BY</span> sex <span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> sex  <span class="operator">|</span> GROUP_CONCAT(name) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> 女   <span class="operator">|</span> 李四                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 男   <span class="operator">|</span> 张三,王五,Aric       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> 李四,张三,王五,Aric  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------------+</span></span><br></pre></td></tr></table></figure>
<p>上面示例中，最后一条记录 <code>NULL</code> 就是上面各个分组记录的汇总。</p>
<h4 id="GROUP-BY-使用规定"><a href="#GROUP-BY-使用规定" class="headerlink" title="GROUP BY 使用规定"></a>GROUP BY 使用规定</h4><ul>
<li><strong>GROUP BY 子句必须出现在 WHERE 子句之后，ORDER BY 子句之前</strong>。</li>
<li>使用 GROUP BY 子句进行分组，则 <code>SELECT</code> 子句之后，只能出现分组的字段和统计函数，其他的字段不能出现。</li>
<li>按照指定的列对象数据进行分组，查询的字段一般为分组字段与聚合函数（<code>COUNT()</code>、<code>SUM()</code>、<code>AVG()</code>、<code>MAX()</code>、<code>MIN()</code>）配合使用。如果 <code>group by</code> 不与上述函数一起使用，那么查询结果就是字段聚合的分组情况，字段中取值相同记录为一组，但只显示该组的第一条记录（这种使用意义不大）。</li>
<li>如果分组列中具有 NULL 值，则 NULL 将作为一个分组返回。如果列中有多行 NULL 值，它们将分为一组。</li>
<li>GROUP BY 子句可以包含任意数目的列。这使得能对分组进行嵌套，为数据分组提供更细致的控制。</li>
</ul>
<h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3><p>正则表达式(regular expression)描述了一种字符串匹配的规则，正则表达式本身就是一个字符串，使用这个字符串来描述、用来定义匹配规则，匹配一系列符合某个句法规则的字符串。在开发中，正则表达式通常被用来检索、替换那些符合某个规则的文本。</p>
<p>MySQL通过 <code>REGEXP</code> 关键字支持正则表达式进行字符串匹配。</p>
<h4 id="语法规则-1"><a href="#语法规则-1" class="headerlink" title="语法规则"></a>语法规则</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>^</code></td>
<td>匹配输入字符串的开始位置。</td>
</tr>
<tr>
<td style="text-align:center"><code>$</code></td>
<td>匹配输入字符串的结束位置。</td>
</tr>
<tr>
<td style="text-align:center"><code>.</code></td>
<td>匹配除 “<code>\n</code>“ 之外的任何单个字符。</td>
</tr>
<tr>
<td style="text-align:center"><code>[...]</code></td>
<td>字符集合。匹配所包含的任意一个字符。例如，’<code>[abc]</code>‘ 可以匹配  “plain” 中的  ‘a’。</td>
</tr>
<tr>
<td style="text-align:center"><code>[^...]</code></td>
<td>负值字符集合。匹配未包含的任意字符。例如，’<code>[^abc]</code>‘ 可以匹配  “plain” 中的 ‘p’。</td>
</tr>
<tr>
<td style="text-align:center">`p1</td>
<td>p2</td>
<td>p3`</td>
<td>匹配 p1 或 p2 或 p3。例如，’`z</td>
<td>food<code>&#39; 能匹配 &quot;z&quot; 或 &quot;food&quot;。&#39;</code>(z</td>
<td>f)ood`’ 则匹配 “zood” 或  “food”。</td>
</tr>
<tr>
<td style="text-align:center"><code>*</code></td>
<td>匹配前面的子表达式零次或多次。例如，<code>zo*</code> 能匹配 “z” 以及 “zoo”。<code>*</code> 等价于<code>&#123;0,&#125;</code>。</td>
</tr>
<tr>
<td style="text-align:center"><code>+</code></td>
<td>匹配前面的子表达式一次或多次。例如，’<code>zo+</code>‘ 能匹配   “zo” 以及 “zoo”，但不能匹配 “z”。<code>+</code> 等价于 <code>&#123;1,&#125;</code>。</td>
</tr>
<tr>
<td style="text-align:center"><code>&#123;n&#125;</code></td>
<td>n 是一个非负整数。匹配确定的 n 次。例如，’<code>o&#123;2&#125;</code>‘ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td>
</tr>
<tr>
<td style="text-align:center"><code>&#123;n,m&#125;</code></td>
<td>m 和 n 均为非负整数，其中<code>n &lt;= m</code>。最少匹配 n 次且最多匹配 m 次。</td>
</tr>
</tbody>
</table>
</div>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ^ 在字符串开始处进行匹配</span></span><br><span class="line"><span class="keyword">SELECT</span>  <span class="string">&#x27;abc&#x27;</span> REGEXP <span class="string">&#x27;^a&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- $ 在字符串末尾开始匹配</span></span><br><span class="line"><span class="keyword">SELECT</span>  <span class="string">&#x27;abc&#x27;</span> REGEXP <span class="string">&#x27;a$&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span>  <span class="string">&#x27;abc&#x27;</span> REGEXP <span class="string">&#x27;c$’;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- . 匹配任意字符</span></span><br><span class="line"><span class="string">SELECT  &#x27;</span>abc<span class="string">&#x27; REGEXP &#x27;</span>.b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT  &#x27;</span>abc<span class="string">&#x27; REGEXP &#x27;</span>.c<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT  &#x27;</span>abc<span class="string">&#x27; REGEXP &#x27;</span>a.<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- [...] 匹配括号内的任意单个字符</span></span><br><span class="line"><span class="string">SELECT  &#x27;</span>abc<span class="string">&#x27; REGEXP &#x27;</span>[xyz]<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT  &#x27;</span>abc<span class="string">&#x27; REGEXP &#x27;</span>[xaz]<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- [^...] 注意^符合只有在[]内才是取反的意思，在别的地方都是表示开始处匹配</span></span><br><span class="line"><span class="string">SELECT  &#x27;</span>a<span class="string">&#x27; REGEXP &#x27;</span>[<span class="operator">^</span>abc]<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT  &#x27;</span>x<span class="string">&#x27; REGEXP &#x27;</span>[<span class="operator">^</span>abc]<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT  &#x27;</span>abc<span class="string">&#x27; REGEXP &#x27;</span>[<span class="operator">^</span>a]<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- a* 匹配0个或多个a,包括空字符串。 可以作为占位符使用.有没有指定字符都可以匹配到数据</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>stab<span class="string">&#x27; REGEXP &#x27;</span>.ta<span class="operator">*</span>b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>stb<span class="string">&#x27; REGEXP &#x27;</span>.ta<span class="operator">*</span>b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;&#x27; REGEXP &#x27;</span>a<span class="operator">*</span><span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- a+  匹配1个或者多个a,但是不包括空字符</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>stab<span class="string">&#x27; REGEXP &#x27;</span>.ta<span class="operator">+</span>b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>stb<span class="string">&#x27; REGEXP &#x27;</span>.ta<span class="operator">+</span>b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- a?  匹配0个或者1个a</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>stb<span class="string">&#x27; REGEXP &#x27;</span>.ta?b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>stab<span class="string">&#x27; REGEXP &#x27;</span>.ta?b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>staab<span class="string">&#x27; REGEXP &#x27;</span>.ta?b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- a1|a2  匹配a1或者a2，</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>a<span class="string">&#x27; REGEXP &#x27;</span>a<span class="operator">|</span>b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>b<span class="string">&#x27; REGEXP &#x27;</span>a<span class="operator">|</span>b<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>b<span class="string">&#x27; REGEXP &#x27;</span><span class="operator">^</span>(a<span class="operator">|</span>b)<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>a<span class="string">&#x27; REGEXP &#x27;</span><span class="operator">^</span>(a<span class="operator">|</span>b)<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>c<span class="string">&#x27; REGEXP &#x27;</span><span class="operator">^</span>(a<span class="operator">|</span>b)<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- a&#123;m&#125; 匹配m个a</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>auuuuc<span class="string">&#x27; REGEXP &#x27;</span>au&#123;<span class="number">4</span>&#125;c<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>auuuuc<span class="string">&#x27; REGEXP &#x27;</span>au&#123;<span class="number">3</span>&#125;c<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- a&#123;m,n&#125; 匹配m到n个a,包含m和n</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>auuuuc<span class="string">&#x27; REGEXP &#x27;</span>au&#123;<span class="number">3</span>,<span class="number">5</span>&#125;c<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>auuuuc<span class="string">&#x27; REGEXP &#x27;</span>au&#123;<span class="number">4</span>,<span class="number">5</span>&#125;c<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>auuuuc<span class="string">&#x27; REGEXP &#x27;</span>au&#123;<span class="number">5</span>,<span class="number">10</span>&#125;c<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-- (abc) abc作为一个序列匹配，不用括号括起来都是用单个字符去匹配，如果要把多个字符作为一个整体去匹配就需要用到括号，所以括号适合上面的所有情况。</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>xababy<span class="string">&#x27; REGEXP &#x27;</span>x(abab)y<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>xababy<span class="string">&#x27; REGEXP &#x27;</span>x(ab)<span class="operator">*</span>y<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">SELECT &#x27;</span>xababy<span class="string">&#x27; REGEXP &#x27;</span>x(ab)&#123;<span class="number">1</span>,<span class="number">2</span>&#125;y<span class="string">&#x27;;</span></span><br></pre></td></tr></table></figure>
<h3 id="查询（select）语句执行顺序分析"><a href="#查询（select）语句执行顺序分析" class="headerlink" title="查询（select）语句执行顺序分析"></a>查询（select）语句执行顺序分析</h3><h4 id="执行顺序说明"><a href="#执行顺序说明" class="headerlink" title="执行顺序说明"></a>执行顺序说明</h4><p>DQL 语句在执行的顺序如下：</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251012230.png" alt=""></p>
<p>执行顺序文字说明：</p>
<ol>
<li>from 子句组装来自不同数据源的数据。</li>
<li>where 子句基于指定的条件对记录行进行筛选。</li>
<li>group by 子句将数据划分为多个分组。</li>
<li>对聚集函数进行计算。</li>
<li>having 子句对分组后筛选分组。</li>
<li>计算所有的表达式。</li>
<li>select 的字段列表的处理。</li>
<li>使用 order by 对结果集进行排序。</li>
<li>根据 limit 参数对结果集进行分页处理。</li>
</ol>
<p>综上所述，DQL 语句的执行顺序为：<code>from -&gt; where -&gt; group by -&gt; having -&gt; select -&gt; order by -&gt; limit</code></p>
<h4 id="验证过程"><a href="#验证过程" class="headerlink" title="验证过程"></a>验证过程</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询年龄大于15的员工姓名、年龄，并根据年龄进行升序排序。</span></span><br><span class="line"><span class="keyword">select</span> name, age <span class="keyword">from</span> emp <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>
<p>在查询时，给 emp 表起一个别名 e，然后在 select 及 where 中使用该别名。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.name, e.age <span class="keyword">from</span> emp e <span class="keyword">where</span> e.age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>
<p>执行上述SQL语句后，可以正常的查询到结果，此时就说明：from 先执行生成了别名，然后 where 和 select 可以使用别名并执行。</p>
<p>若给 select 后面的字段起别名，然后在 where 中使用这个别名，然后看看是否可以执行成功。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.name ename, e.age eage <span class="keyword">from</span> emp e <span class="keyword">where</span> eage <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>
<p>执行上述SQL报错了：</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251012229.png" alt=""></p>
<p>由此可以得出结论：from 先执行，然后执行 where，再执行 select。</p>
<p>接下来，再执行如下SQL语句，查看执行效果：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.name ename, e.age eage <span class="keyword">from</span> emp e <span class="keyword">where</span> e.age <span class="operator">&gt;</span> <span class="number">15</span> <span class="keyword">order</span> <span class="keyword">by</span> eage <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>
<p>结果执行成功。那么也就验证了：order by 是在 select 语句之后执行的。</p>
<h2 id="6-6-备份与恢复"><a href="#6-6-备份与恢复" class="headerlink" title="6.6 备份与恢复"></a>6.6 备份与恢复</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">1.数据库导出sQr脚本</span><br><span class="line">mysqldump -u用户名 -p密码 数据库名&gt;生成的脚本文件路径</span><br><span class="line">	eg:mysqldump -uroot -p123 mydb1&gt;C:\mydb1.sql(与mysq1.exe和myqld.exe一样，都在bin目录下)</span><br><span class="line">#注意,不要打分号，不要登录mysql，直接在cmd下运行</span><br><span class="line">#注意,生成的脚本文件中不包含create database语句</span><br><span class="line">2.执行sql脚本</span><br><span class="line">第一种方式</span><br><span class="line">mysgl -u用户名 -p密码 数据库&lt;脚本文件路径</span><br><span class="line">	eg:*先删除mydb1库,再重新创建mydb1库</span><br><span class="line">	   *mysgl -uroot -p123 mydb1&lt;C:\mydb1.sql</span><br><span class="line"></span><br><span class="line">第二种方式</span><br><span class="line">a.登录mysql</span><br><span class="line">b.source sQL脚本路径</span><br><span class="line">	eg:先册除mydb1库，再重新创建myab1库</span><br><span class="line">	   切换到mydb1库</span><br><span class="line">	   source c:\mydb1.sql</span><br><span class="line">3.其它用法</span><br><span class="line">a. 导出一张表</span><br><span class="line">　　mysqldump -u用户名 -p密码 库名 表名 &gt; 文件名(D:/a.sql)</span><br><span class="line">b. 导出多张表</span><br><span class="line">　　mysqldump -u用户名 -p密码 库名 表1 表2 表3 &gt; 文件名(D:/a.sql)</span><br><span class="line">c. 导出所有表</span><br><span class="line">　　mysqldump -u用户名 -p密码 库名 &gt; 文件名(D:/a.sql)</span><br><span class="line">d. 导出一个库</span><br><span class="line">　　mysqldump -u用户名 -p密码 --lock-all-tables --database 库名 &gt; 文件名(D:/a.sql)</span><br></pre></td></tr></table></figure>
<h1 id="7-字符集编码"><a href="#7-字符集编码" class="headerlink" title="7.字符集编码"></a>7.<em>字符集编码</em></h1><h3 id="7-1-字符集概述"><a href="#7-1-字符集概述" class="headerlink" title="7.1. 字符集概述"></a>7.1. 字符集概述</h3><p>MySQL 服务器支持多种字符集，常用的字符集有 UTF8、UTF8MB4、UTF16、UTF32 等。在同一台服务器、同一个数据库、甚至同一个表的不同字段都可以指定使用不同的字符集。</p>
<p>MySQL 的字符集包括字符集(CHARACTER)校对规则(COLLATION)等概念。</p>
<h4 id="7-1-1-查看支持的字符集"><a href="#7-1-1-查看支持的字符集" class="headerlink" title="7.1.1. 查看支持的字符集"></a>7.1.1. 查看支持的字符集</h4><p>可以使用 <code>show character set</code> 命令查看所有 MySQL 支持的字符集：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">character set</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+---------------------------------+---------------------+--------+</span></span><br><span class="line"><span class="operator">|</span> Charset  <span class="operator">|</span> Description                     <span class="operator">|</span> <span class="keyword">Default</span> <span class="keyword">collation</span>   <span class="operator">|</span> Maxlen <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+---------------------------------+---------------------+--------+</span></span><br><span class="line"><span class="operator">|</span> armscii8 <span class="operator">|</span> ARMSCII<span class="number">-8</span> Armenian              <span class="operator">|</span> armscii8_general_ci <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ascii    <span class="operator">|</span> US ASCII                        <span class="operator">|</span> ascii_general_ci    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> big5     <span class="operator">|</span> Big5 Traditional Chinese        <span class="operator">|</span> big5_chinese_ci     <span class="operator">|</span>      <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="type">binary</span>   <span class="operator">|</span> <span class="type">Binary</span> pseudo charset           <span class="operator">|</span> <span class="type">binary</span>              <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cp1250   <span class="operator">|</span> Windows Central European        <span class="operator">|</span> cp1250_general_ci   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cp1251   <span class="operator">|</span> Windows Cyrillic                <span class="operator">|</span> cp1251_general_ci   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cp1256   <span class="operator">|</span> Windows Arabic                  <span class="operator">|</span> cp1256_general_ci   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cp1257   <span class="operator">|</span> Windows Baltic                  <span class="operator">|</span> cp1257_general_ci   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cp850    <span class="operator">|</span> DOS West European               <span class="operator">|</span> cp850_general_ci    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cp852    <span class="operator">|</span> DOS Central European            <span class="operator">|</span> cp852_general_ci    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cp866    <span class="operator">|</span> DOS Russian                     <span class="operator">|</span> cp866_general_ci    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cp932    <span class="operator">|</span> SJIS <span class="keyword">for</span> Windows Japanese       <span class="operator">|</span> cp932_japanese_ci   <span class="operator">|</span>      <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> dec8     <span class="operator">|</span> <span class="type">DEC</span> West European               <span class="operator">|</span> dec8_swedish_ci     <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> eucjpms  <span class="operator">|</span> UJIS <span class="keyword">for</span> Windows Japanese       <span class="operator">|</span> eucjpms_japanese_ci <span class="operator">|</span>      <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> euckr    <span class="operator">|</span> EUC<span class="operator">-</span>KR Korean                   <span class="operator">|</span> euckr_korean_ci     <span class="operator">|</span>      <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gb18030  <span class="operator">|</span> China <span class="type">National</span> Standard GB18030 <span class="operator">|</span> gb18030_chinese_ci  <span class="operator">|</span>      <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gb2312   <span class="operator">|</span> GB2312 Simplified Chinese       <span class="operator">|</span> gb2312_chinese_ci   <span class="operator">|</span>      <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gbk      <span class="operator">|</span> GBK Simplified Chinese          <span class="operator">|</span> gbk_chinese_ci      <span class="operator">|</span>      <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> geostd8  <span class="operator">|</span> GEOSTD8 Georgian                <span class="operator">|</span> geostd8_general_ci  <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> greek    <span class="operator">|</span> ISO <span class="number">8859</span><span class="number">-7</span> Greek                <span class="operator">|</span> greek_general_ci    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> hebrew   <span class="operator">|</span> ISO <span class="number">8859</span><span class="number">-8</span> Hebrew               <span class="operator">|</span> hebrew_general_ci   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> hp8      <span class="operator">|</span> HP West European                <span class="operator">|</span> hp8_english_ci      <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> keybcs2  <span class="operator">|</span> DOS Kamenicky Czech<span class="operator">-</span>Slovak      <span class="operator">|</span> keybcs2_general_ci  <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> koi8r    <span class="operator">|</span> KOI8<span class="operator">-</span>R Relcom Russian           <span class="operator">|</span> koi8r_general_ci    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> koi8u    <span class="operator">|</span> KOI8<span class="operator">-</span>U Ukrainian                <span class="operator">|</span> koi8u_general_ci    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> latin1   <span class="operator">|</span> cp1252 West European            <span class="operator">|</span> latin1_swedish_ci   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> latin2   <span class="operator">|</span> ISO <span class="number">8859</span><span class="number">-2</span> Central European     <span class="operator">|</span> latin2_general_ci   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> latin5   <span class="operator">|</span> ISO <span class="number">8859</span><span class="number">-9</span> Turkish              <span class="operator">|</span> latin5_turkish_ci   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> latin7   <span class="operator">|</span> ISO <span class="number">8859</span><span class="number">-13</span> Baltic              <span class="operator">|</span> latin7_general_ci   <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> macce    <span class="operator">|</span> Mac Central European            <span class="operator">|</span> macce_general_ci    <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> macroman <span class="operator">|</span> Mac West European               <span class="operator">|</span> macroman_general_ci <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> sjis     <span class="operator">|</span> Shift<span class="operator">-</span>JIS Japanese              <span class="operator">|</span> sjis_japanese_ci    <span class="operator">|</span>      <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> swe7     <span class="operator">|</span> <span class="number">7</span>bit Swedish                    <span class="operator">|</span> swe7_swedish_ci     <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> tis620   <span class="operator">|</span> TIS620 Thai                     <span class="operator">|</span> tis620_thai_ci      <span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ucs2     <span class="operator">|</span> UCS<span class="number">-2</span> Unicode                   <span class="operator">|</span> ucs2_general_ci     <span class="operator">|</span>      <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ujis     <span class="operator">|</span> EUC<span class="operator">-</span>JP Japanese                 <span class="operator">|</span> ujis_japanese_ci    <span class="operator">|</span>      <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> utf16    <span class="operator">|</span> UTF<span class="number">-16</span> Unicode                  <span class="operator">|</span> utf16_general_ci    <span class="operator">|</span>      <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> utf16le  <span class="operator">|</span> UTF<span class="number">-16</span>LE Unicode                <span class="operator">|</span> utf16le_general_ci  <span class="operator">|</span>      <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> utf32    <span class="operator">|</span> UTF<span class="number">-32</span> Unicode                  <span class="operator">|</span> utf32_general_ci    <span class="operator">|</span>      <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> utf8mb3  <span class="operator">|</span> UTF<span class="number">-8</span> Unicode                   <span class="operator">|</span> utf8mb3_general_ci  <span class="operator">|</span>      <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> utf8mb4  <span class="operator">|</span> UTF<span class="number">-8</span> Unicode                   <span class="operator">|</span> utf8mb4_0900_ai_ci  <span class="operator">|</span>      <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+---------------------------------+---------------------+--------+</span></span><br></pre></td></tr></table></figure>
<h4 id="7-1-2-Unicode、UTF8-和-UTF8MB4"><a href="#7-1-2-Unicode、UTF8-和-UTF8MB4" class="headerlink" title="7.1.2. Unicode、UTF8 和 UTF8MB4"></a>7.1.2. Unicode、UTF8 和 UTF8MB4</h4><p>Unicode（统一码、万国码、单一码）是计算机科学领域里的一项业界标准，包括字符集、编码方案等。Unicode 是为了解决传统的字符编码方案的局限而产生的，它为每种语言中的每个字符设定了统一并且唯一的二进制编码，以满足跨语言、跨平台进行文本转换、处理的要求。UTF8、UTF16、UTF32 是 Unicode码 一种实现形式，都是属于 Unicode 编码。</p>
<p>UTF8 和 UTF8MB4 是常用的两种字符集，根据业务情况而决定选那种类型。UTF8MB4 兼容 UTF8，比 UTF8 能表示更多的字符。一般情况下 UTF8 就满足需求，如果考虑到以后扩展，比如考虑到以后存储 emoji 表情，则选择 UTF8MB4，否则只是浪费空间。个人建议还是选择 UTF8MB4</p>
<h3 id="7-2-校对规则-比较和排序规则-（COLLATE）"><a href="#7-2-校对规则-比较和排序规则-（COLLATE）" class="headerlink" title="7.2. 校对规则(比较和排序规则)（COLLATE）"></a>7.2. 校对规则(比较和排序规则)（COLLATE）</h3><h4 id="7-2-1-概念"><a href="#7-2-1-概念" class="headerlink" title="7.2.1. 概念"></a>7.2.1. 概念</h4><p>在 MySQL 中，<code>character set</code> 用于指定数据库默认的字符集；而 <code>collate</code> 是用于指定校对规则。</p>
<p>校对规则，（COLLATE）又叫『比较和排序规则』。它是一组规则，负责决定某一字符集下的字符进行比较和排序的结果。如：a,B,c,D，如果使用 utf-8 的编码，按照普通的字母顺序，而且不区分大小写。如果想使用字母的二进制比较和排序，则可以修改它的校对规则。</p>
<blockquote>
<p>Notes: </p>
<ul>
<li>utf8_general_ci：按照普通的字母顺序，而且不区分大小写（比如：a B c D）</li>
<li>utf8_bin：按照二进制排序（比如：A 排在 a 前面，B D a c）</li>
</ul>
</blockquote>
<h4 id="7-2-2-查看支持的校对规则"><a href="#7-2-2-查看支持的校对规则" class="headerlink" title="7.2.2. 查看支持的校对规则"></a>7.2.2. 查看支持的校对规则</h4><p>通过 <code>show collation</code> 命令查看校对规则。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 显示所有 utf-8</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">collation</span> <span class="keyword">like</span> <span class="string">&#x27;utf8%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------+---------+-----+---------+----------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Collation</span>                   <span class="operator">|</span> Charset <span class="operator">|</span> Id  <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Compiled <span class="operator">|</span> Sortlen <span class="operator">|</span> Pad_attribute <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------+---------+-----+---------+----------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> utf8mb3_general_ci          <span class="operator">|</span> utf8mb3 <span class="operator">|</span>  <span class="number">33</span> <span class="operator">|</span> Yes     <span class="operator">|</span> Yes      <span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span> PAD SPACE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> utf8mb3_unicode_ci          <span class="operator">|</span> utf8mb3 <span class="operator">|</span> <span class="number">192</span> <span class="operator">|</span>         <span class="operator">|</span> Yes      <span class="operator">|</span>       <span class="number">8</span> <span class="operator">|</span> PAD SPACE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> utf8mb4_general_ci          <span class="operator">|</span> utf8mb4 <span class="operator">|</span>  <span class="number">45</span> <span class="operator">|</span>         <span class="operator">|</span> Yes      <span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span> PAD SPACE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> utf8mb4_unicode_ci          <span class="operator">|</span> utf8mb4 <span class="operator">|</span> <span class="number">224</span> <span class="operator">|</span>         <span class="operator">|</span> Yes      <span class="operator">|</span>       <span class="number">8</span> <span class="operator">|</span> PAD SPACE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ...省略大部分内容                                                                            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------------------+---------+-----+---------+----------+---------+---------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 显示所有 GBK</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">collation</span> <span class="keyword">like</span> <span class="string">&#x27;gbk%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+----+---------+----------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Collation</span>      <span class="operator">|</span> Charset <span class="operator">|</span> Id <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Compiled <span class="operator">|</span> Sortlen <span class="operator">|</span> Pad_attribute <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+----+---------+----------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> gbk_bin        <span class="operator">|</span> gbk     <span class="operator">|</span> <span class="number">87</span> <span class="operator">|</span>         <span class="operator">|</span> Yes      <span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span> PAD SPACE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gbk_chinese_ci <span class="operator">|</span> gbk     <span class="operator">|</span> <span class="number">28</span> <span class="operator">|</span> Yes     <span class="operator">|</span> Yes      <span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span> PAD SPACE     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+----+---------+----------+---------+---------------+</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips: SQL 语句中的字符串一般都是使用单引号(<code>&#39;</code>)括起。</p>
</blockquote>
<h4 id="7-2-3-UTF8MB4-常用的排序规则"><a href="#7-2-3-UTF8MB4-常用的排序规则" class="headerlink" title="7.2.3. UTF8MB4 常用的排序规则"></a>7.2.3. UTF8MB4 常用的排序规则</h4><p>UTF8MB4 常用的排序规则：utf8mb4_unicode_ci、utf8mb4_general_ci、utf8mb4_bin</p>
<p><strong>从准确性的角度比较</strong></p>
<ul>
<li>utf8mb4_unicode_ci 是基于标准的 Unicode 来排序和比较，能够在各种语言之间精确排序，不区分大小写</li>
<li>utf8mb4_general_ci 没有实现 Unicode 排序规则，在遇到某些特殊语言或者字符集，排序结果可能不一致，不区分大小写</li>
</ul>
<p><strong>从性能的角度比较</strong></p>
<ul>
<li>utf8mb4_general_ci 在比较和排序的时候更快</li>
<li>utf8mb4_unicode_ci 在特殊情况下，Unicode 排序规则为了能够处理特殊字符的情况，实现了略微复杂的排序算法。相比选择哪一种 collation，使用者更应该关心字符集与排序规则在db里需要统一。</li>
<li>utf8mb4_bin 将字符串每个字符用二进制数据编译存储，区分大小写，而且可以存二进制的内容。</li>
</ul>
<blockquote>
<p>Tips: 总而言之，utf8mb4_general_ci 和 utf8mb4_unicode_ci 是最常使用的排序规则。utf8mb4_general_ci 校对速度快，但准确度稍差；utf8_unicode_ci 准确度高，但校对速度稍慢。两者都不区分大小写，选择那种类型按具体情况而定</p>
</blockquote>
<h3 id="7-3-指定数据库的默认字符集与校对规则"><a href="#7-3-指定数据库的默认字符集与校对规则" class="headerlink" title="7.3. 指定数据库的默认字符集与校对规则"></a>7.3. 指定数据库的默认字符集与校对规则</h3><p>例如：指定数据库的默认字符集为 gbk 和校对规则 gbk_chinese_ci。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database db4 <span class="keyword">default</span> <span class="keyword">character set</span> gbk <span class="keyword">collate</span> gbk_chinese_ci;</span><br></pre></td></tr></table></figure>
<h3 id="7-4-查看与修改当前字符集"><a href="#7-4-查看与修改当前字符集" class="headerlink" title="7.4. 查看与修改当前字符集"></a>7.4. 查看与修改当前字符集</h3><h4 id="7-4-1-查看字符集"><a href="#7-4-1-查看字符集" class="headerlink" title="7.4.1. 查看字符集"></a>7.4.1. 查看字符集</h4><p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;character%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>参数解释：</p>
<ul>
<li><code>show variables</code> 显示所有的全局变量</li>
<li><code>%</code> 代表通配符</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;character%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+-------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name            <span class="operator">|</span> <span class="keyword">Value</span>                                                 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+-------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> character_set_client     <span class="operator">|</span> utf8mb4                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_connection <span class="operator">|</span> utf8mb4                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_database   <span class="operator">|</span> utf8mb4                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_filesystem <span class="operator">|</span> <span class="type">binary</span>                                                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_results    <span class="operator">|</span> utf8mb4                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_server     <span class="operator">|</span> utf8mb3                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_system     <span class="operator">|</span> utf8mb3                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_sets_dir       <span class="operator">|</span> D:\development\MySQL\MySQL Server <span class="number">8.0</span>\share\charsets\ <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+-------------------------------------------------------+</span></span><br></pre></td></tr></table></figure>
<h4 id="7-4-2-修改字符集"><a href="#7-4-2-修改字符集" class="headerlink" title="7.4.2. 修改字符集"></a>7.4.2. 修改字符集</h4><p>以解决 DOS 命令行下汉字乱码的问题为例。DOS 命令行默认的字符集是 GBK，而数据库的字符集是 UTF-8，要将数据库中下列三项的字符集也改成 GBK。在命令行插入数据之前输入: <code>set names gbk;</code> 则等同于</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> character_set_connection<span class="operator">=</span>gbk; <span class="comment">-- 设置数据库连接使用的字符集</span></span><br><span class="line"><span class="keyword">set</span> character_set_results<span class="operator">=</span>gbk; <span class="comment">-- 设置查询结果的字符集</span></span><br><span class="line"><span class="keyword">set</span> character_set_client<span class="operator">=</span>gbk; <span class="comment">-- 设置客户端的字符集</span></span><br></pre></td></tr></table></figure>
<p>本次连接中修改字符集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> character_set_connection<span class="operator">=</span>gbk;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> character_set_results<span class="operator">=</span>gbk;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> character_set_client<span class="operator">=</span>gbk;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;character%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+-------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name            <span class="operator">|</span> <span class="keyword">Value</span>                                                 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+-------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> character_set_client     <span class="operator">|</span> gbk                                                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_connection <span class="operator">|</span> gbk                                                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_database   <span class="operator">|</span> utf8mb4                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_filesystem <span class="operator">|</span> <span class="type">binary</span>                                                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_results    <span class="operator">|</span> gbk                                                   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_server     <span class="operator">|</span> utf8mb3                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_system     <span class="operator">|</span> utf8mb3                                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_sets_dir       <span class="operator">|</span> D:\development\MySQL\MySQL Server <span class="number">8.0</span>\share\charsets\ <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+-------------------------------------------------------+</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Notes: <font color=purple><strong>上面只改变了本次运行时的数据库局部的字符集，重启后也会变回原来的模式</strong></font>。</p>
</blockquote>
<h3 id="7-5-字符集的选择原则"><a href="#7-5-字符集的选择原则" class="headerlink" title="7.5. 字符集的选择原则"></a>7.5. 字符集的选择原则</h3><p>建议在能够完全满足应用的前提下，尽量使用小的字符集。因为更小的字符集意味着能够节省空间、减少网络传输字节数，同时由于存储空间的较小间接的提高了系统的性能。</p>
<h1 id="8-导入导出"><a href="#8-导入导出" class="headerlink" title="8.导入导出"></a>8.<em>导入导出</em></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1.导出表数据</span><br><span class="line">select * into outfile 文件地址 [控制格式] from 表名; </span><br><span class="line">2.导入数据</span><br><span class="line">load data [local] infile 文件地址 [replace|ignore] into table 表名 [控制格式]; </span><br><span class="line">    生成的数据默认的分隔符是制表符</span><br><span class="line">    local未指定，则数据文件必须在服务器上</span><br><span class="line">    replace 和 ignore 关键词控制对现有的唯一键记录的重复的处理</span><br><span class="line">---控制格式</span><br><span class="line">*fields  控制字段格式</span><br><span class="line">默认：fields terminated by &#x27;\t&#x27; enclosed by &#x27;&#x27; escaped by &#x27;\\&#x27;</span><br><span class="line">    terminated by &#x27;string&#x27;  -- 终止</span><br><span class="line">    enclosed by &#x27;char&#x27;      -- 包裹</span><br><span class="line">    escaped by &#x27;char&#x27;       -- 转义</span><br><span class="line">    -- 示例：</span><br><span class="line">        SELECT a,b,a+b INTO OUTFILE &#x27;/tmp/result.text&#x27;</span><br><span class="line">        FIELDS TERMINATED BY &#x27;,&#x27; OPTIONALLY ENCLOSED BY &#x27;&quot;&#x27;</span><br><span class="line">        LINES TERMINATED BY &#x27;\n&#x27;</span><br><span class="line">        FROM test_table;</span><br><span class="line">*lines   控制行格式</span><br><span class="line">默认：lines terminated by &#x27;\n&#x27;</span><br><span class="line">    terminated by &#x27;string&#x27;  -- 终止</span><br></pre></td></tr></table></figure>
<h1 id="9-MySQL-的多表操作"><a href="#9-MySQL-的多表操作" class="headerlink" title="9. MySQL 的多表操作"></a>9. MySQL 的多表操作</h1><p>实际开发中，一个项目通常需要很多张表才能完成，且这些表的数据之间存在一定的关系。</p>
<h3 id="9-1-多表关系"><a href="#9-1-多表关系" class="headerlink" title="9.1. 多表关系"></a>9.1. 多表关系</h3><p>MySQL多表之间的关系可以概括为：一对一、一对多/多对一关系，多对多</p>
<h4 id="9-1-1-一对一-1-1"><a href="#9-1-1-一对一-1-1" class="headerlink" title="9.1.1. 一对一(1:1)"></a>9.1.1. 一对一(1:1)</h4><p>在实际的开发中应用不多，因为一对一可以创建成一张表。有两种建表原则：</p>
<ol>
<li>外键唯一：主表的主键和从表的外键（唯一），形成主外键关系，外键唯一，这其实是一种特殊的多对一的关系。<ul>
<li>注：如果是外键唯一这种方式，则需要外键的约束条件和主表的主键一致</li>
</ul>
</li>
<li>外键是主键：主表的主键和从表的主键，形成主外键关系</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 一对一关系： 外键唯一</span></span><br><span class="line"><span class="comment">-- 简历表</span></span><br><span class="line"><span class="keyword">create table</span> jl(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">	content <span class="type">varchar</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 学生表</span></span><br><span class="line"><span class="keyword">create table</span> s7(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">	jl_id <span class="type">int</span> <span class="keyword">unique</span>, <span class="comment">-- 外键唯一</span></span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">foreign key</span>(jl_id) <span class="keyword">references</span> jl(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 一对一关系：主键又是外键</span></span><br><span class="line"><span class="comment">-- 简历表：主表</span></span><br><span class="line"><span class="keyword">create table</span> jl(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">	content <span class="type">varchar</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 学生表：从表</span></span><br><span class="line"><span class="keyword">create table</span> s7(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">foreign key</span>(id) <span class="keyword">references</span> jl(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips: 其中设置从表的外键为唯一的(<code>UNIQUE</code>)是关键</p>
</blockquote>
<h4 id="9-1-2-一对多-1-n-重点"><a href="#9-1-2-一对多-1-n-重点" class="headerlink" title="9.1.2. 一对多(1:n)(重点)"></a>9.1.2. 一对多(1:n)(重点)</h4><ul>
<li>常见实例：客户和订单，分类和商品，部门和员工。</li>
<li>一对多建表原则：在从表(多方)创建一个字段，字段作为外键指向主表(一方)的主键。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建学科表格 主表</span></span><br><span class="line"><span class="keyword">create table</span> class(</span><br><span class="line">	cid <span class="type">int</span>,</span><br><span class="line">	sub <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not null</span> <span class="keyword">unique</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">-- 创建表完成之后添加主键</span></span><br><span class="line"><span class="keyword">alter table</span> class modify cid <span class="type">int</span> <span class="keyword">primary key</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建学生表格 从表</span></span><br><span class="line"><span class="keyword">create table</span> student(</span><br><span class="line">	sid <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">	sname <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not null</span>,</span><br><span class="line">	gender <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">not null</span>,</span><br><span class="line">	class_id <span class="type">int</span>,</span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">foreign key</span>(class_id) <span class="keyword">references</span> class(cid) <span class="keyword">on</span> <span class="keyword">update</span> cascade</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建后查看表清单</span></span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="keyword">desc</span> class;</span><br><span class="line"><span class="keyword">desc</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入数据</span></span><br><span class="line"><span class="keyword">insert into</span> class <span class="keyword">values</span>(<span class="number">001</span>, <span class="string">&#x27;java&#x27;</span>), (<span class="number">002</span>, <span class="string">&#x27;iso&#x27;</span>),(<span class="number">003</span>, <span class="string">&#x27;php&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class;</span><br><span class="line"><span class="keyword">insert into</span> student(sname, gender, class_id) <span class="keyword">values</span></span><br><span class="line">	(<span class="string">&#x27;敌法师&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">2</span>),</span><br><span class="line">	(<span class="string">&#x27;主宰&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">1</span>),</span><br><span class="line">	(<span class="string">&#x27;痛苦女王&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">3</span>),</span><br><span class="line">	(<span class="string">&#x27;露娜&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student;</span><br></pre></td></tr></table></figure>
<ul>
<li>1:n表关系图：</li>
</ul>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251006717.jpg" alt="1:n表关系图"></p>
<h4 id="9-1-3-多对多-n-n"><a href="#9-1-3-多对多-n-n" class="headerlink" title="9.1.3. 多对多(n:n)"></a>9.1.3. 多对多(n:n)</h4><ul>
<li>常见实例：学生和课程、用户和角色。</li>
<li>多对多关系建表原则<ul>
<li>需要创建第三张表，中间表中至少两个字段，这两个字段分别作为外键指向各自一方的主键。</li>
</ul>
</li>
<li>多对多设计的关系表的关键：<ul>
<li>单独设置一张关系表(设置为联合主键)</li>
</ul>
</li>
<li>语法例子</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constraint</span> <span class="keyword">primary key</span>(s_id, c_id)</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> goods(</span><br><span class="line">	gid <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">	gname <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not null</span> <span class="keyword">unique</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入商品</span></span><br><span class="line"><span class="keyword">insert into</span> goods(gname) <span class="keyword">values</span> (<span class="string">&#x27;椅子&#x27;</span>),(<span class="string">&#x27;床&#x27;</span>),(<span class="string">&#x27;桌子&#x27;</span>),	(<span class="string">&#x27;苹果&#x27;</span>),(<span class="string">&#x27;香蕉&#x27;</span>),(<span class="string">&#x27;汽水&#x27;</span>),(<span class="string">&#x27;饼干&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看商品表</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> goods;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建购买人表 主表</span></span><br><span class="line"><span class="keyword">create table</span> person(</span><br><span class="line">	pid <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">	pname <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not null</span>,</span><br><span class="line">	age <span class="type">int</span> <span class="keyword">not null</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入购买人信息</span></span><br><span class="line"><span class="keyword">insert into</span> person(pname, age) <span class="keyword">values</span> (<span class="string">&#x27;剑圣&#x27;</span>,<span class="number">28</span>),(<span class="string">&#x27;敌法师&#x27;</span>,<span class="number">26</span>),(<span class="string">&#x27;痛苦女王&#x27;</span>,<span class="number">23</span>),(<span class="string">&#x27;西门吹水&#x27;</span>,<span class="number">34</span>),(<span class="string">&#x27;潘银莲&#x27;</span>,<span class="number">21</span>),(<span class="string">&#x27;东施&#x27;</span>,<span class="number">23</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看购买人表</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> person;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建关系表 从表</span></span><br><span class="line"><span class="keyword">create table</span> person_goods(</span><br><span class="line">	p_id <span class="type">int</span>,</span><br><span class="line">	g_id <span class="type">int</span>,</span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">primary key</span> (p_id,g_id),</span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">foreign key</span>(p_id) <span class="keyword">references</span> person(pid),</span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">foreign key</span>(g_id) <span class="keyword">references</span> goods(gid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> person_goods <span class="keyword">values</span> (<span class="number">1</span>,<span class="number">2</span>),(<span class="number">1</span>,<span class="number">6</span>),(<span class="number">2</span>,<span class="number">4</span>),(<span class="number">3</span>,<span class="number">4</span>),(<span class="number">3</span>,<span class="number">5</span>),(<span class="number">4</span>,<span class="number">6</span>),(<span class="number">5</span>,<span class="number">7</span>),(<span class="number">6</span>,<span class="number">6</span>),(<span class="number">5</span>,<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看关系表</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> person_goods;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改关系表数据</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> person_goods <span class="keyword">where</span> p_id<span class="operator">=</span><span class="number">2</span> <span class="keyword">and</span> g_id<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line"><span class="keyword">update</span> person_goods <span class="keyword">set</span> p_id<span class="operator">=</span><span class="number">2</span> <span class="keyword">where</span> p_id<span class="operator">=</span><span class="number">5</span> <span class="keyword">and</span> g_id<span class="operator">=</span><span class="number">6</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>n:n表关系图：</li>
</ul>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004182.jpg" alt="n:n表关系图"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  关卡2训练案例2</span></span><br><span class="line"><span class="comment">   1:完成学员 student 和 老师 teacher 表和课程表的设计</span></span><br><span class="line"><span class="comment">   2:多对多设计原则,引入中间表.</span></span><br><span class="line"><span class="comment">   操作步骤</span></span><br><span class="line"><span class="comment">	1: 完成学员和老师,课程以及中间表设计</span></span><br><span class="line"><span class="comment">	2: 使用 sql 脚本完成中间表设计以及联合主键,外键的引入.</span></span><br><span class="line"><span class="comment">	3: 录入相关数据.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">-- 创建学生表 stu</span></span><br><span class="line"><span class="keyword">create table</span> stu(</span><br><span class="line">	sid <span class="type">int</span>(<span class="number">4</span>) zerofill <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">	sname <span class="type">varchar</span>(<span class="number">6</span>) <span class="keyword">not null</span>,</span><br><span class="line">	age <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 创建老师表</span></span><br><span class="line"><span class="keyword">create table</span> teacher(</span><br><span class="line">	tid <span class="type">int</span>(<span class="number">4</span>) zerofill <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">	tname <span class="type">varchar</span>(<span class="number">6</span>) <span class="keyword">not null</span>,</span><br><span class="line">	age <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 创建课程表course</span></span><br><span class="line"><span class="keyword">create table</span> course(</span><br><span class="line">	cid <span class="type">int</span>(<span class="number">2</span>) zerofill <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">	cname <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not null</span> <span class="keyword">unique</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建关系表</span></span><br><span class="line"><span class="keyword">create table</span> stu_tea_cou(</span><br><span class="line">	sid <span class="type">int</span>(<span class="number">4</span>) zerofill,</span><br><span class="line">	tid <span class="type">int</span>(<span class="number">4</span>) zerofill,</span><br><span class="line">	cid <span class="type">int</span>(<span class="number">2</span>) zerofill,</span><br><span class="line">	<span class="comment">-- 定义联合主键</span></span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">primary key</span>(sid,tid,cid),</span><br><span class="line">	<span class="comment">-- 定义主键对应各个表的主键</span></span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">foreign key</span>(sid) <span class="keyword">references</span> stu(sid),</span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">foreign key</span>(tid) <span class="keyword">references</span> teacher(tid),</span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">foreign key</span>(cid) <span class="keyword">references</span> course(cid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用内连接查询全部学生内容</span></span><br><span class="line"><span class="comment">-- SELECT * FROM ((表1 INNER JOIN 表2 ON 表1.字段号=表2.字段号)</span></span><br><span class="line"><span class="comment">-- 	INNER JOIN 表3 ON 表1.字段号=表3.字段号) INNER JOIN 表4 ON Member.字段号=表4.字段号;</span></span><br><span class="line"><span class="keyword">select</span> stu.<span class="operator">*</span>,course.cname <span class="keyword">as</span> <span class="string">&#x27;学科名&#x27;</span>,stu_tea_cou.score <span class="keyword">as</span> <span class="string">&#x27;得分&#x27;</span>,teacher.tname <span class="keyword">as</span> <span class="string">&#x27;老师&#x27;</span> <span class="keyword">from</span> ((stu <span class="keyword">inner</span> <span class="keyword">join</span> stu_tea_cou <span class="keyword">on</span> stu.sid<span class="operator">=</span>stu_tea_cou.sid)</span><br><span class="line">	<span class="keyword">inner</span> <span class="keyword">join</span> course <span class="keyword">on</span> course.cid<span class="operator">=</span>stu_tea_cou.cid)</span><br><span class="line">	<span class="keyword">inner</span> <span class="keyword">join</span> teacher <span class="keyword">on</span> teacher.tid<span class="operator">=</span>stu_tea_cou.tid;</span><br></pre></td></tr></table></figure>
<ul>
<li>n:n表关系图（三个）</li>
</ul>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004183.jpg" alt="n:n表关系图（三个）"></p>
<h3 id="9-2-多表连接查询"><a href="#9-2-多表连接查询" class="headerlink" title="9.2. 多表连接查询"></a>9.2. 多表连接查询</h3><h4 id="9-2-1-多表连接查询概述"><a href="#9-2-1-多表连接查询概述" class="headerlink" title="9.2.1. 多表连接查询概述"></a>9.2.1. 多表连接查询概述</h4><p>单表查询是从一张表中查询数据，而<strong>多表查询</strong>就是从多张有关联的表中查询数据。</p>
<blockquote>
<p>Notes: N 张表的连接查询，至少要有 N-1 个连接条件</p>
</blockquote>
<h4 id="9-2-2-多表连接类型"><a href="#9-2-2-多表连接类型" class="headerlink" title="9.2.2. 多表连接类型"></a>9.2.2. 多表连接类型</h4><ul>
<li>交叉连接查询[产生笛卡尔积，了解]</li>
<li>内连接查询</li>
<li>左右(外)连接查询</li>
<li>子查询</li>
<li>表自关联</li>
<li>全表连接查询（MySql 不支持，Oracle 支持）</li>
</ul>
<p>下图展示了 LEFT JOIN、RIGHT JOIN、INNER JOIN、OUTER JOIN 相关的 7 种用法</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251006820.jpg" alt=""></p>
<h4 id="9-2-3-多表连接查询的步骤"><a href="#9-2-3-多表连接查询的步骤" class="headerlink" title="9.2.3. 多表连接查询的步骤"></a>9.2.3. 多表连接查询的步骤</h4><ol>
<li>首先确定要查询的数据有哪些</li>
<li>再确定要查询的数据来自哪些表</li>
<li>最后确定表之间的连接条件</li>
</ol>
<blockquote>
<p>Tips: <strong>多表连接查询必须使用<code>表名(或表别名).列名</code>才进行查询，因为需要区分该列是属于哪个表的，一旦设置了别名后，就必须用<code>别名.列名</code>，用原来<code>表名.列名</code>会报错。</strong></p>
</blockquote>
<h3 id="9-3-交叉连接查询（笛卡尔积）"><a href="#9-3-交叉连接查询（笛卡尔积）" class="headerlink" title="9.3. 交叉连接查询（笛卡尔积）"></a>9.3. 交叉连接查询（笛卡尔积）</h3><h4 id="9-3-1-交叉查询概述"><a href="#9-3-1-交叉查询概述" class="headerlink" title="9.3.1. 交叉查询概述"></a>9.3.1. 交叉查询概述</h4><ul>
<li>当查询记录数等于多个表的记录数乘积时，该查询则称为交叉查询。</li>
<li>交叉查询的结果称为笛卡尔积，即多张表记录的乘积</li>
<li>在实际开发中，笛卡尔积的结果一般没有任何意义，一般都会在笛卡尔积基础上加上过滤条件，得出的结果才会有意义。</li>
</ul>
<h4 id="9-3-2-交叉查询格式"><a href="#9-3-2-交叉查询格式" class="headerlink" title="9.3.2. 交叉查询格式"></a>9.3.2. 交叉查询格式</h4><p>这种查询会产生笛卡尔积，就是两个表的所有记录的乘积。语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 表名<span class="number">1.</span><span class="operator">*</span>,表名<span class="number">2.</span><span class="operator">*</span>,…… <span class="keyword">from</span> 表名<span class="number">1</span>,表名<span class="number">2</span>,…… <span class="keyword">where</span> 控制条件;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.<span class="operator">*</span>, d.<span class="operator">*</span> <span class="keyword">FROM</span> employee e, dept d;</span><br></pre></td></tr></table></figure>
<p>图例：有 2 张表，1 张 R、1 张 S</p>
<ul>
<li>R 表有 ABC 三列，表中有三条记录。</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">a1</td>
<td style="text-align:center">b1</td>
<td style="text-align:center">c1</td>
</tr>
<tr>
<td style="text-align:center">a2</td>
<td style="text-align:center">b2</td>
<td style="text-align:center">c2</td>
</tr>
<tr>
<td style="text-align:center">a3</td>
<td style="text-align:center">b3</td>
<td style="text-align:center">c3</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>S 表有 CD 两列，表中有三条记录。</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">c1</td>
<td style="text-align:center">d1</td>
</tr>
<tr>
<td style="text-align:center">c2</td>
<td style="text-align:center">d2</td>
</tr>
<tr>
<td style="text-align:center">c4</td>
<td style="text-align:center">d3</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><strong>交叉连接(笛卡尔积):<code>select r.*,s.* from r,s;</code></strong></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">a1</td>
<td style="text-align:center">b1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">d1</td>
</tr>
<tr>
<td style="text-align:center">a2</td>
<td style="text-align:center">b2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">d1</td>
</tr>
<tr>
<td style="text-align:center">a3</td>
<td style="text-align:center">b3</td>
<td style="text-align:center">c3</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">d1</td>
</tr>
<tr>
<td style="text-align:center">a1</td>
<td style="text-align:center">b1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">d2</td>
</tr>
<tr>
<td style="text-align:center">a2</td>
<td style="text-align:center">b2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">d2</td>
</tr>
<tr>
<td style="text-align:center">a3</td>
<td style="text-align:center">b3</td>
<td style="text-align:center">c3</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">d2</td>
</tr>
<tr>
<td style="text-align:center">a1</td>
<td style="text-align:center">b1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">c4</td>
<td style="text-align:center">d3</td>
</tr>
<tr>
<td style="text-align:center">a2</td>
<td style="text-align:center">b2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">c4</td>
<td style="text-align:center">d3</td>
</tr>
<tr>
<td style="text-align:center">a3</td>
<td style="text-align:center">b3</td>
<td style="text-align:center">c3</td>
<td style="text-align:center">c4</td>
<td style="text-align:center">d3</td>
</tr>
</tbody>
</table>
</div>
<h3 id="9-4-内连接查询-inner-join-……-on"><a href="#9-4-内连接查询-inner-join-……-on" class="headerlink" title="9.4. 内连接查询( inner join …… on )"></a>9.4. 内连接查询( inner join …… on )</h3><h4 id="9-4-1-内连接概述"><a href="#9-4-1-内连接概述" class="headerlink" title="9.4.1. 内连接概述"></a>9.4.1. 内连接概述</h4><p>只有满足连接条件的记录才会被查询出来，实际开发使用频率最高。连接条件：主表的主键与从表的外键值进行相等匹配查询</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004195.jpg" alt=""></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">&lt;</span> select_list <span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	Table_A A</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Table_B B <span class="keyword">ON</span> A. KEY <span class="operator">=</span> B. KEY</span><br></pre></td></tr></table></figure>
<h4 id="9-4-2-内连接语法格式"><a href="#9-4-2-内连接语法格式" class="headerlink" title="9.4.2. 内连接语法格式"></a>9.4.2. 内连接语法格式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表<span class="number">1</span> [<span class="keyword">INNER</span> <span class="operator">|</span> <span class="keyword">CROSS</span>] <span class="keyword">JOIN</span> 表<span class="number">2</span> [<span class="keyword">ON</span> 连接条件] [<span class="keyword">WHERE</span> 普通过滤条件];</span><br></pre></td></tr></table></figure>
<h4 id="9-4-3-内连接查询的分类"><a href="#9-4-3-内连接查询的分类" class="headerlink" title="9.4.3. 内连接查询的分类"></a>9.4.3. 内连接查询的分类</h4><ul>
<li>隐式内连接：使用where语句(在笛卡尔积的基础上使用)</li>
<li>显式内连接：使用语法格式 <code>inner join …… on</code>（inner 可以省略）</li>
</ul>
<p>在 MySQL 中，下边这几种内连接的写法都是等价的：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t1 <span class="keyword">JOIN</span> t2;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t2;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t1 <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> t2;</span><br><span class="line"><span class="comment">-- 上边的这些写法和直接把需要连接的表名放到 FROM 语句之后，用逗号,分隔开的写法是等价的</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t1, t2;</span><br></pre></td></tr></table></figure>
<blockquote>
<font color=red>**注：在内连接查询中，`on`子语句与`where`子语句的作用是一样的。**</font>

</blockquote>
<h4 id="9-4-4-内连接的驱动表与被驱动表"><a href="#9-4-4-内连接的驱动表与被驱动表" class="headerlink" title="9.4.4. 内连接的驱动表与被驱动表"></a>9.4.4. 内连接的驱动表与被驱动表</h4><p>对于内连接来说，由于凡是不符合<code>ON</code>子句或<code>WHERE</code>子句中的条件的记录都会被过滤掉，其实也就相当于从两表连接的笛卡尔积中过滤了不符合条件的记录，所以对于内连接来说，驱动表和被驱动表是可以互换的，并不会影响最后的查询结果。</p>
<p>但是对于外连接来说，由于驱动表中的记录即使在被驱动表中找不到符合<code>ON</code>子句条件的记录时也要将其加入到结果集，所以此时驱动表和被驱动表的关系就很重要了，也就是说左外连接和右外连接的驱动表和被驱动表不能轻易互换。</p>
<h4 id="9-4-5-显式内连接：使用-inner-join-…-on"><a href="#9-4-5-显式内连接：使用-inner-join-…-on" class="headerlink" title="9.4.5. 显式内连接：使用 inner join … on"></a>9.4.5. 显式内连接：使用 inner join … on</h4><ul>
<li>显式内连接格式：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 表名<span class="number">1.</span><span class="operator">*</span>,表名<span class="number">2.</span><span class="operator">*</span> <span class="keyword">from</span> 表名<span class="number">1</span> <span class="keyword">inner</span> <span class="keyword">join</span> 表名<span class="number">2</span> <span class="keyword">on</span> 表名<span class="number">1.</span>列名<span class="operator">=</span>表名<span class="number">2.</span>列名;</span><br></pre></td></tr></table></figure>
<ul>
<li>显式内连接，上面的列名分别是主从表的主键与从键，表名后面可以跟表别名，通常用表的首字母，后面使用<strong>表别名.列名</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sname,c.sub <span class="keyword">from</span> student s <span class="keyword">inner</span> <span class="keyword">join</span> class c <span class="keyword">on</span> s.class_id<span class="operator">=</span>c.cid;</span><br></pre></td></tr></table></figure>
<p>图例：<strong>内连接：<code>select r.*,s.* from r inner join s on r.c=s.c;</code></strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">a1</td>
<td style="text-align:center">b1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">d1</td>
</tr>
<tr>
<td style="text-align:center">a2</td>
<td style="text-align:center">b2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">d2</td>
</tr>
</tbody>
</table>
</div>
<h4 id="9-4-6-隐式内连接：使用-where-子句（笛卡尔积再过滤）"><a href="#9-4-6-隐式内连接：使用-where-子句（笛卡尔积再过滤）" class="headerlink" title="9.4.6. 隐式内连接：使用 where 子句（笛卡尔积再过滤）"></a>9.4.6. 隐式内连接：使用 where 子句（笛卡尔积再过滤）</h4><p>隐式内连接格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 表名<span class="number">1.</span><span class="operator">*</span>,表名<span class="number">2.</span><span class="operator">*</span> <span class="keyword">from</span> 表名<span class="number">1</span>,表名<span class="number">2</span> <span class="keyword">where</span> 表名<span class="number">1.</span>列名<span class="operator">=</span>表名<span class="number">2.</span>列名;</span><br></pre></td></tr></table></figure>
<p>隐式内连接，上面的列名分别是主从表的主键与从键，表名后面可以跟表别名，通常用表的首字母，后面使用 <code>表别名.列名</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sname,c.sub <span class="keyword">from</span> student s,class c <span class="keyword">where</span> s.class_id<span class="operator">=</span>c.cid;</span><br></pre></td></tr></table></figure>
<h4 id="9-4-7-扩展：内连接3个以上数据表"><a href="#9-4-7-扩展：内连接3个以上数据表" class="headerlink" title="9.4.7. 扩展：内连接3个以上数据表"></a>9.4.7. 扩展：内连接3个以上数据表</h4><ul>
<li><strong>INNER JOIN 连接三个数据表的用法：</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式1：</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	表<span class="number">1</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">2</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">3</span> <span class="keyword">ON</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">2.</span>字段号</span><br><span class="line"><span class="keyword">AND</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">3.</span>字段号;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2：</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	(表<span class="number">1</span> <span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">2</span> <span class="keyword">ON</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">2.</span>字段号)</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">3</span> <span class="keyword">ON</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">3.</span>字段号;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 以上两种写法一样的效果。</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>INNER JOIN 连接四个数据表的用法：</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	表<span class="number">1</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">2</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">3</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">4</span> <span class="keyword">ON</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">2.</span>字段号</span><br><span class="line"><span class="keyword">AND</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">3.</span>字段号</span><br><span class="line"><span class="keyword">AND</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">4.</span>字段号;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>INNER JOIN 连接五个数据表的用法：</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	表<span class="number">1</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">2</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">3</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">4</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">5</span> <span class="keyword">ON</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">2.</span>字段号</span><br><span class="line"><span class="keyword">AND</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">3.</span>字段号</span><br><span class="line"><span class="keyword">AND</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">4.</span>字段号</span><br><span class="line"><span class="keyword">AND</span> 表<span class="number">1.</span>字段号 <span class="operator">=</span> 表<span class="number">5.</span>字段号;</span><br></pre></td></tr></table></figure>
<p><em>上面的表号根据实际情况确定，连接六个数据表的用法，根据上面类推</em></p>
<p><strong>注意事项：</strong></p>
<ul>
<li><strong>如果连接n张表，其连接条件就是n-1个。</strong></li>
<li><strong>使用内连接前，搞清楚需要输出那些字段，字段在那些表中，各自表的主外键的关系。</strong></li>
<li>在建立数据表时，如果一个表与多个表联接，那么这一个表中的字段必须是“数字”数据类型，而多个表中的相同字段必须是主键，而且是“自动编号”数据类型。否则，很难联接成功。</li>
</ul>
<h3 id="9-5-左-外-连接-left-join-……-on"><a href="#9-5-左-外-连接-left-join-……-on" class="headerlink" title="9.5. 左(外)连接( left join …… on )"></a>9.5. 左(外)连接( left join …… on )</h3><h4 id="9-5-1-左外连接概述"><a href="#9-5-1-左外连接概述" class="headerlink" title="9.5.1. 左外连接概述"></a>9.5.1. 左外连接概述</h4><ul>
<li><strong>左外连接定义</strong>：用左表的记录去匹配右表的记录，如果条件满足，则右边显示右表的记录；否则右表显示 <code>null</code>。<strong>（左表和右表取决于定义在实际语句的位置）</strong></li>
<li><strong>左外连接特点</strong>：左边的表的记录一定会全部显示完整</li>
<li><strong>左外连接的驱动表</strong>：选取语句左侧的表</li>
</ul>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004140.jpg" alt=""></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">&lt;</span> select_list <span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	Table_A A</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Table_B B <span class="keyword">ON</span> A. KEY <span class="operator">=</span> B. KEY</span><br></pre></td></tr></table></figure>
<h4 id="9-5-2-左外连接语法格式"><a href="#9-5-2-左外连接语法格式" class="headerlink" title="9.5.2. 左外连接语法格式"></a>9.5.2. 左外连接语法格式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表<span class="number">1</span> <span class="keyword">LEFT</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> 表<span class="number">2</span> <span class="keyword">ON</span> 连接条件 [<span class="keyword">WHERE</span> 普通过滤条件];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips: 其中中括号里的<code>OUTER</code>关键字是可以省略的。</p>
</blockquote>
<ul>
<li>示例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sname,c.sub <span class="keyword">from</span> student s <span class="keyword">left</span> <span class="keyword">join</span> class c <span class="keyword">on</span> s.class_id<span class="operator">=</span>c.cid;</span><br></pre></td></tr></table></figure>
<p>图例：<strong>左连接：<code>select r.*,s.* from r left join s on r.c=s.c;</code></strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">a1</td>
<td style="text-align:center">b1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">d1</td>
</tr>
<tr>
<td style="text-align:center">a2</td>
<td style="text-align:center">b2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">d2</td>
</tr>
<tr>
<td style="text-align:center">a3</td>
<td style="text-align:center">b3</td>
<td style="text-align:center">c3</td>
<td style="text-align:center"></td>
<td style="text-align:center">null</td>
</tr>
</tbody>
</table>
</div>
<h3 id="9-6-右-外-连接-right-join-……-on"><a href="#9-6-右-外-连接-right-join-……-on" class="headerlink" title="9.6. 右(外)连接( right join …… on )"></a>9.6. 右(外)连接( right join …… on )</h3><h4 id="9-6-1-右外连接概述"><a href="#9-6-1-右外连接概述" class="headerlink" title="9.6.1. 右外连接概述"></a>9.6.1. 右外连接概述</h4><ul>
<li><strong>右外连接定义</strong>：用右表的记录去匹配左表的记录，如果条件满足，则左边显示左表的记录；否则左边显示 null。<strong>（左表和右表取决于定义在实际语句的位置）</strong></li>
<li><strong>右外连接特点</strong>：如果右外连接，右边的表的记录一定会全部显示完整</li>
<li><strong>右外连接驱动表</strong>：选取语句右侧的表</li>
</ul>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004213.jpg" alt=""></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">&lt;</span> select_list <span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	Table_A A</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> Table_B B <span class="keyword">ON</span> A. KEY <span class="operator">=</span> B. KEY</span><br></pre></td></tr></table></figure>
<h4 id="9-6-2-右外连接语法格式"><a href="#9-6-2-右外连接语法格式" class="headerlink" title="9.6.2. 右外连接语法格式"></a>9.6.2. 右外连接语法格式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表<span class="number">1</span> <span class="keyword">RIGHT</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> 表<span class="number">2</span> <span class="keyword">ON</span> 连接条件 [<span class="keyword">WHERE</span> 普通过滤条件];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其中中括号里的<code>OUTER</code>关键字是可以省略的。</p>
</blockquote>
<ul>
<li>示例：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sname,c.sub <span class="keyword">from</span> student s <span class="keyword">right</span> <span class="keyword">join</span> class c <span class="keyword">on</span> s.class_id<span class="operator">=</span>c.cid;</span><br></pre></td></tr></table></figure>
<p>图例：<strong>右外连接：<code>select r.*,s.* from r right join s on r.c=s.c;</code></strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">a1</td>
<td style="text-align:center">b1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">d1</td>
</tr>
<tr>
<td style="text-align:center">a2</td>
<td style="text-align:center">b2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">d2</td>
</tr>
<tr>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
<td style="text-align:center"></td>
<td style="text-align:center">c4</td>
<td style="text-align:center">d3</td>
</tr>
</tbody>
</table>
</div>
<h3 id="9-7-连接查询的过滤条件-on-与-where-的区别总结"><a href="#9-7-连接查询的过滤条件-on-与-where-的区别总结" class="headerlink" title="9.7. 连接查询的过滤条件 on 与 where 的区别总结"></a>9.7. 连接查询的过滤条件 on 与 where 的区别总结</h3><p>在连接查询中，过滤条件分为两种<code>on</code>与<code>where</code>，根据过滤条件使用的不同的关键字有不同的语义</p>
<ul>
<li><strong>WHERE 子句中的过滤条件</strong>：不论是内连接还是外连接，凡是不符合 <code>WHERE</code> 子句中的过滤条件的记录都不会被加入最后的结果集。</li>
<li><strong>ON 子句中的过滤条件</strong>：<ul>
<li>对于外连接的驱动表的记录来说，如果无法在被驱动表中找到匹配<code>ON</code>子句中的过滤条件的记录，那么该记录仍然会被加入到结果集中，对应的被驱动表记录的各个字段使用<code>NULL</code>值填充。</li>
<li>对于内连接来说，MySQL 会把它和<code>WHERE</code>子句一样对待，也就是说：内连接中的<code>WHERE</code>子句和<code>ON</code>子句是等价的。</li>
</ul>
</li>
</ul>
<font color=red>*一般情况下，都把只涉及单表的过滤条件放到`WHERE`子句中，把涉及两表的过滤条件都放到`ON`子句中，也一般把放到`ON`子句中的过滤条件也称之为连接条件。*</font>

<h3 id="9-8-自连接查询"><a href="#9-8-自连接查询" class="headerlink" title="9.8. 自连接查询"></a>9.8. 自连接查询</h3><h4 id="9-8-1-自关联表概述"><a href="#9-8-1-自关联表概述" class="headerlink" title="9.8.1. 自关联表概述"></a>9.8.1. 自关联表概述</h4><p>一张表，自关联一对多，数据表的外键列引用自身的主键列，自关联一般针对多级关系的使用</p>
<blockquote>
<p>省 —&gt; 市 —&gt; 区(县) —&gt; 镇(街道)</p>
<p>老板 —&gt; 总经理 —&gt; 部门经理 —&gt; 主管 —&gt; 组长 —&gt; 员工</p>
</blockquote>
<h4 id="9-8-2-自关联表格式（创建外键）"><a href="#9-8-2-自关联表格式（创建外键）" class="headerlink" title="9.8.2. 自关联表格式（创建外键）"></a>9.8.2. 自关联表格式（创建外键）</h4><p><strong>创建表同时自关联主外键：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> 表名(</span><br><span class="line">	主键名 <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">	其他列,</span><br><span class="line">	外键名(parent_主键名，一般这么写) <span class="type">int</span>,</span><br><span class="line">	<span class="keyword">constraint</span> <span class="keyword">foreign key</span>(parent_主键名) <span class="keyword">references</span> 表名(主键名);</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><strong>创建表后再关联主外键的格式：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">add constraint</span> <span class="keyword">foreign key</span>(主键名) <span class="keyword">references</span> 表名(parent_主键名);</span><br></pre></td></tr></table></figure>
<p><strong>注：最顶层的 parent_id 是 null</strong></p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004260.jpg" alt=""></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Code Dome:一张表，自关联一对多</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> AREA(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">PRIMARY KEY</span> auto_increment,</span><br><span class="line">	NAME <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	description <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">	parent_id <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 自关联一对多</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> AREA <span class="keyword">ADD CONSTRAINT</span> <span class="keyword">FOREIGN KEY</span> (parent_id) <span class="keyword">REFERENCES</span> AREA(id);</span><br></pre></td></tr></table></figure>
<h4 id="9-8-3-自连接查询的概念"><a href="#9-8-3-自连接查询的概念" class="headerlink" title="9.8.3. 自连接查询的概念"></a>9.8.3. 自连接查询的概念</h4><p>自连接查询：在数据查询时需要进行对表自身进行关联查询，即一张表自己和自己关联，一张表当成多张表来用。</p>
<blockquote>
<p>注意：</p>
<ul>
<li>自连接查询，本质还是使用到内连接或左连接或右连接。</li>
<li><font color=red>**自连接查询其实不需要依赖自关联表的外键约束的创建，无自关联外键约束也是可以进行自连接查询**</font></li>
<li><font color=red>**注意自关联查询表时，必须给表起别名。**</font>

</li>
</ul>
</blockquote>
<h4 id="9-8-4-自连接查询的格式"><a href="#9-8-4-自连接查询的格式" class="headerlink" title="9.8.4. 自连接查询的格式"></a>9.8.4. 自连接查询的格式</h4><ol>
<li>先创建自关联表</li>
<li>使用内连接(左连接、右连接)</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 自连接</span></span><br><span class="line"><span class="comment">-- 创建新员工表emp(员工工号,员工姓名,上级编号)</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> emp (</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">	NAME <span class="type">VARCHAR</span> (<span class="number">20</span>),</span><br><span class="line">	parent_id <span class="type">INT</span>, <span class="comment">-- 上级id</span></span><br><span class="line">	<span class="keyword">CONSTRAINT</span> <span class="keyword">FOREIGN KEY</span> (parent_id) <span class="keyword">REFERENCES</span> emp (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用显式内连接</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	e.NAME 员工姓名,</span><br><span class="line">	b.NAME 上司姓名</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	emp e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> emp b <span class="keyword">ON</span> e.parent_id <span class="operator">=</span> b.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 连接条件</span></span><br><span class="line"><span class="comment">-- 查询员工姓名和对应的上司姓名，没有上司的员工姓名也要显示出来。</span></span><br><span class="line"><span class="comment">-- 左外连接</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	e. NAME 员工姓名,</span><br><span class="line">	b. NAME 上司姓名</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	emp e</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp b <span class="keyword">ON</span> e.parent_id <span class="operator">=</span> b.id;  <span class="comment">-- 连接条件</span></span><br></pre></td></tr></table></figure>
<h3 id="9-9-联合查询-UNION-ALL"><a href="#9-9-联合查询-UNION-ALL" class="headerlink" title="9.9. 联合查询 UNION [ALL]"></a>9.9. 联合查询 UNION [ALL]</h3><h4 id="9-9-1-概述"><a href="#9-9-1-概述" class="headerlink" title="9.9.1. 概述"></a>9.9.1. 概述</h4><p>对于 union 查询，就是把多次查询的结果合并起来，形成一个新的查询结果集。语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表A ...</span><br><span class="line"><span class="keyword">UNION</span> [ <span class="keyword">ALL</span> ]</span><br><span class="line"><span class="keyword">SELECT</span> 字段列表 <span class="keyword">FROM</span> 表B ....;</span><br></pre></td></tr></table></figure>
<h4 id="9-9-2-基础使用示例"><a href="#9-9-2-基础使用示例" class="headerlink" title="9.9.2. 基础使用示例"></a>9.9.2. 基础使用示例</h4><p>示例需求：将薪资低于 5000 的员工，和年龄大于 50 岁的员工全部查询出来</p>
<p>对于此需求，可以直接使用多条件查询，使用逻辑运算符 or 连接即可。也可以通过 <code>union</code>/<code>union all</code> 来联合查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> salary <span class="operator">&lt;</span> <span class="number">5000</span></span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">50</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004724.png" alt=""></p>
<p>由结果可知，<code>union all</code> 查询出来的结果仅仅进行简单的合并，并未去重。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> salary <span class="operator">&lt;</span> <span class="number">5000</span></span><br><span class="line"><span class="keyword">UNION</span> </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">50</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004963.png" alt=""></p>
<p>而 <code>union</code> 联合查询，会对查询出来的结果进行去重处理。</p>
<h4 id="9-9-3-联合查询注意事项"><a href="#9-9-3-联合查询注意事项" class="headerlink" title="9.9.3. 联合查询注意事项"></a>9.9.3. 联合查询注意事项</h4><p>对于联合查询的多张表的列数必须保持一致，字段类型也需要保持一致。否则在进行<code>union</code>/<code>union all</code>联合查询时，将会报错。如：</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251005429.png" alt=""></p>
<h4 id="9-9-4-union-与-union-all-区别"><a href="#9-9-4-union-与-union-all-区别" class="headerlink" title="9.9.4. union 与 union all 区别"></a>9.9.4. union 与 union all 区别</h4><ul>
<li><code>union all</code>：直接合并多个结果集，不会去除重复记录。</li>
<li><code>union</code>：合并多个结果集，去除重复，所以执行效率会较差。</li>
</ul>
<h3 id="9-10-全外连接查询（MySql-暂不支持，Oracle-支持、了解）"><a href="#9-10-全外连接查询（MySql-暂不支持，Oracle-支持、了解）" class="headerlink" title="9.10. 全外连接查询（MySql 暂不支持，Oracle 支持、了解）"></a>9.10. 全外连接查询（MySql 暂不支持，Oracle 支持、了解）</h3><h4 id="9-10-1-full-join-语法定义"><a href="#9-10-1-full-join-语法定义" class="headerlink" title="9.10.1. full join 语法定义"></a>9.10.1. full join 语法定义</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> r.<span class="operator">*</span>,s.<span class="operator">*</span> <span class="keyword">from</span> r <span class="keyword">full</span> <span class="keyword">join</span> s <span class="keyword">on</span> r.c<span class="operator">=</span>s.c</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">a1</td>
<td style="text-align:center">b1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">c1</td>
<td style="text-align:center">d1</td>
</tr>
<tr>
<td style="text-align:center">a2</td>
<td style="text-align:center">b2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">c2</td>
<td style="text-align:center">d2</td>
</tr>
<tr>
<td style="text-align:center">a3</td>
<td style="text-align:center">b3</td>
<td style="text-align:center">c3</td>
<td style="text-align:center"></td>
<td style="text-align:center">null</td>
</tr>
<tr>
<td style="text-align:center">null</td>
<td style="text-align:center">null</td>
<td style="text-align:center"></td>
<td style="text-align:center">c4</td>
<td style="text-align:center">d3</td>
</tr>
</tbody>
</table>
</div>
<h4 id="9-10-2-使用-union-关键字实现全表连接查询"><a href="#9-10-2-使用-union-关键字实现全表连接查询" class="headerlink" title="9.10.2. 使用 union 关键字实现全表连接查询"></a>9.10.2. 使用 union 关键字实现全表连接查询</h4><p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表<span class="number">1</span> <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span> 表<span class="number">1.</span>字段名 <span class="operator">=</span> 表<span class="number">2.</span>字段名</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表<span class="number">2</span> <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> 表<span class="number">1</span> <span class="keyword">on</span> 表<span class="number">2.</span>字段名 <span class="operator">=</span> 表<span class="number">1.</span>字段名;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：<code>union</code> 关键字会去掉两个结果集的重复记录</p>
</blockquote>
<h3 id="9-11-SQL-的其他-join-用法-网上资料"><a href="#9-11-SQL-的其他-join-用法-网上资料" class="headerlink" title="9.11. SQL 的其他 join 用法(网上资料)"></a>9.11. SQL 的其他 join 用法(网上资料)</h3><h4 id="9-11-1-OUTER-JOIN（外连接）"><a href="#9-11-1-OUTER-JOIN（外连接）" class="headerlink" title="9.11.1. OUTER JOIN（外连接）"></a>9.11.1. OUTER JOIN（外连接）</h4><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004067.jpg" alt="表连接查询图5"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">&lt;</span> select_list <span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	Table_A A</span><br><span class="line"><span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Table_B B <span class="keyword">ON</span> A. KEY <span class="operator">=</span> B. KEY</span><br></pre></td></tr></table></figure>
<h4 id="9-11-2-LEFT-JOIN-EXCLUDING-INNER-JOIN（左连接-内连接）"><a href="#9-11-2-LEFT-JOIN-EXCLUDING-INNER-JOIN（左连接-内连接）" class="headerlink" title="9.11.2. LEFT JOIN EXCLUDING INNER JOIN（左连接-内连接）"></a>9.11.2. LEFT JOIN EXCLUDING INNER JOIN（左连接-内连接）</h4><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251005862.jpg" alt="表连接查询图6"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">&lt;</span> select_list <span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	Table_A A</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Table_B B <span class="keyword">ON</span> A. KEY <span class="operator">=</span> B. KEY</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	B. KEY <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>
<h4 id="9-11-3-RIGHT-JOIN-EXCLUDING-INNER-JOIN（右连接-内连接）"><a href="#9-11-3-RIGHT-JOIN-EXCLUDING-INNER-JOIN（右连接-内连接）" class="headerlink" title="9.11.3. RIGHT JOIN EXCLUDING INNER JOIN（右连接-内连接）"></a>9.11.3. RIGHT JOIN EXCLUDING INNER JOIN（右连接-内连接）</h4><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004426.jpg" alt="表连接查询图7"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">&lt;</span> select_list <span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	Table_A A</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> Table_B B <span class="keyword">ON</span> A. KEY <span class="operator">=</span> B. KEY</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	A. KEY <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>
<h4 id="9-11-4-OUTER-JOIN-EXCLUDING-INNER-JOIN（外连接-内连接）"><a href="#9-11-4-OUTER-JOIN-EXCLUDING-INNER-JOIN（外连接-内连接）" class="headerlink" title="9.11.4. OUTER JOIN EXCLUDING INNER JOIN（外连接-内连接）"></a>9.11.4. OUTER JOIN EXCLUDING INNER JOIN（外连接-内连接）</h4><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004567.jpg" alt="表连接查询图8"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">&lt;</span> select_list <span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	Table_A A</span><br><span class="line"><span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Table_B B <span class="keyword">ON</span> A. KEY <span class="operator">=</span> B. KEY</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	A. KEY <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">OR</span> B. KEY <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>
<h3 id="9-12-straight-join-指定驱动表查询"><a href="#9-12-straight-join-指定驱动表查询" class="headerlink" title="9.12. straight_join 指定驱动表查询"></a>9.12. straight_join 指定驱动表查询</h3><h4 id="9-12-1-概述"><a href="#9-12-1-概述" class="headerlink" title="9.12.1. 概述"></a>9.12.1. 概述</h4><p><code>straight_join</code> 关键字功能与 <code>join</code> 关键字类似，区别在于，<code>straight_join</code> 可以指定左边的表来驱动右边的表，改变 MySQL 优化器对于联表查询的执行顺序。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t2 straight_join t1 <span class="keyword">on</span> t2.a <span class="operator">=</span> t1.a;</span><br></pre></td></tr></table></figure>
<p>以上语句代表指定 t2 表作为驱动表。</p>
<h4 id="9-12-2-注意事项"><a href="#9-12-2-注意事项" class="headerlink" title="9.12.2. 注意事项"></a>9.12.2. 注意事项</h4><p><code>straight_join</code> 只适用于 <code>inner join</code> 的情况，并不适用于 <code>left join</code>，<code>right join</code>。（因为<code>left join</code>，<code>right join</code>已经指定了表的执行顺序，哪个表做为驱动表）</p>
<blockquote>
<p>Tips: 建议少使用此关键字，尽可能使用优化器去选择的执行顺序，因为大部分情况下人为指定的执行顺序并不一定会比优化引擎选择的要更优。</p>
</blockquote>
<h1 id="10-子查询"><a href="#10-子查询" class="headerlink" title="10. 子查询"></a>10. 子查询</h1><h3 id="10-1-子查询概述"><a href="#10-1-子查询概述" class="headerlink" title="10.1. 子查询概述"></a>10.1. 子查询概述</h3><p>一条 SQL 语句(子查询)的查询结果做为另一条SQL语句(父语句)的条件或查询结果，这种操作则称为<strong>子查询</strong>。多条 SQL 语句嵌套使用，内部的 SQL 查询语句称为子查询。简单理解就是<em>包含select嵌套的查询</em>。</p>
<p>例如：在一个查询语句 A 里的某个位置也可以有另一个查询语句 B，这个出现在 A 语句的某个位置中的查询 B 就被称为<strong>子查询</strong>，A 也被称之为<strong>外层查询</strong>。</p>
<p>子查询外部的语句可以是<code>INSERT</code>/<code>UPDATE</code>/<code>DELETE</code>/<code>SELECT</code>的任何一个。</p>
<h3 id="10-2-子查询语法使用位置"><a href="#10-2-子查询语法使用位置" class="headerlink" title="10.2. 子查询语法使用位置"></a>10.2. 子查询语法使用位置</h3><p>子查询可以在一个外层查询的各种位置出现。</p>
<h4 id="10-2-1-SELECT-子句"><a href="#10-2-1-SELECT-子句" class="headerlink" title="10.2.1. SELECT 子句"></a>10.2.1. SELECT 子句</h4><p>出现在<code>select</code>语句中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> (<span class="keyword">SELECT</span> col <span class="keyword">FROM</span> <span class="keyword">table</span> LIMIT <span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<h4 id="10-2-2-FROM-子句"><a href="#10-2-2-FROM-子句" class="headerlink" title="10.2.2. FROM 子句"></a>10.2.2. FROM 子句</h4><p>出现在<code>from</code>子句中，可以把子查询的查询结果当作是一个表，但这种表与正常的创建的表不一样，MySQL 把这种由子查询结果集组成的表称之为<strong>派生表</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> m, n <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> m2 <span class="operator">+</span> <span class="number">1</span> <span class="keyword">AS</span> m, n2 <span class="keyword">AS</span> n <span class="keyword">FROM</span> table2 <span class="keyword">WHERE</span> m2 <span class="operator">&gt;</span> <span class="number">2</span>) <span class="keyword">AS</span> t;</span><br></pre></td></tr></table></figure>
<h4 id="10-2-3-WHERE-或-ON-子句"><a href="#10-2-3-WHERE-或-ON-子句" class="headerlink" title="10.2.3. WHERE 或 ON 子句"></a>10.2.3. WHERE 或 ON 子句</h4><p>子查询可放在外层查询的<code>WHERE</code>子句或者<code>ON</code>子句中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table1 <span class="keyword">WHERE</span> m1 <span class="keyword">IN</span> (<span class="keyword">SELECT</span> m2 <span class="keyword">FROM</span> table2);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>示例查询表明想要将<code>(SELECT m2 FROM table2)</code>这个子查询的结果作为外层查询的<code>IN</code>语句参数，整个查询语句逻辑是找table1表中的某些记录，这些记录的 m1 列的值能在 table2 表的 m2 列找到匹配的值。</p>
</blockquote>
<h4 id="10-2-4-ORDER-BY-子句、GROUP-BY-子句"><a href="#10-2-4-ORDER-BY-子句、GROUP-BY-子句" class="headerlink" title="10.2.4. ORDER BY 子句、GROUP BY 子句"></a>10.2.4. ORDER BY 子句、GROUP BY 子句</h4><p>子查询也可以出现ORDER BY 子句、GROUP BY 子句中。虽然语法支持，但没有意义。</p>
<h3 id="10-3-按返回的结果集区分子查询类型"><a href="#10-3-按返回的结果集区分子查询类型" class="headerlink" title="10.3. 按返回的结果集区分子查询类型"></a>10.3. 按返回的结果集区分子查询类型</h3><p>子查询本身也算是一个查询，所以可以按照它们返回的不同结果集类型，可以把这些子查询分为不同的类型：</p>
<ul>
<li>单行单列（标量子查询）：返回的是一个具体列的内容，可以理解为一个单值数据；</li>
<li>单行多列（行子查询）：返回一行数据中多个列的内容；</li>
<li>多行单列（列子查询）：返回多行记录之中同一列的内容，相当于给出了一个操作范围；</li>
<li>多行多列（表子查询）：查询返回的结果是一张临时表</li>
</ul>
<h4 id="10-3-1-标量子查询"><a href="#10-3-1-标量子查询" class="headerlink" title="10.3.1. 标量子查询"></a>10.3.1. 标量子查询</h4><p>只返回一个单一值的子查询称之为标量子查询。这些标量子查询可以作为一个单一值或者表达式的一部分出现在查询语句的各个地方。父查询可以使用 <code>=</code>、 <code>&lt;</code>、 <code>&gt;</code> 等比较运算符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> (<span class="keyword">SELECT</span> m1 <span class="keyword">FROM</span> e1 LIMIT <span class="number">1</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> m1 <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(m2) <span class="keyword">FROM</span> e2);</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 先查询平均工资的值（单行子查询）</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="built_in">AVG</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employee;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 再使用父查询判断小于平均值的员工</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	NAME 姓名, salary 工资</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employee</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	salary <span class="operator">&lt;</span> (</span><br><span class="line">		<span class="keyword">SELECT</span></span><br><span class="line">			<span class="built_in">AVG</span>(salary)</span><br><span class="line">		<span class="keyword">FROM</span></span><br><span class="line">			employee</span><br><span class="line">	);</span><br></pre></td></tr></table></figure>
<h4 id="10-3-2-单行（多列）子查询"><a href="#10-3-2-单行（多列）子查询" class="headerlink" title="10.3.2. 单行（多列）子查询"></a>10.3.2. 单行（多列）子查询</h4><p>返回一条记录的子查询，不过这条记录需要包含多个列（只包含一个列就成了标量子查询了）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> (m1, n1) <span class="operator">=</span> (<span class="keyword">SELECT</span> m2, n2 <span class="keyword">FROM</span> e2 LIMIT <span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>sql语句的含义就是要从 e1 表中找一些记录，这些记录的 m1 和 n1 列分别等于子查询结果中的m2 和 n2 列。</p>
</blockquote>
<h4 id="10-3-3-单列（多行）子查询"><a href="#10-3-3-单列（多行）子查询" class="headerlink" title="10.3.3. 单列（多行）子查询"></a>10.3.3. 单列（多行）子查询</h4><p>多行子查询查询结果是多行单列的值，类似于一个数组（只包含一条记录就成了标量子查询了）。父查询使用 <code>in</code> 关键字的使用结果</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 3) 查询大于 5000 的员工，来至于哪些部门，输出部门的名字</span></span><br><span class="line"><span class="comment">-- 先查询大于5000的员工名单（多行子查询）</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	NAME 姓名</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employee</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	salary <span class="operator">&gt;</span> <span class="number">5000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询大于5000的员工的部门名字</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	d. NAME 部门名称</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	dept d</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	d.id <span class="keyword">IN</span> (</span><br><span class="line">		<span class="keyword">SELECT</span></span><br><span class="line">			e.dept_id</span><br><span class="line">		<span class="keyword">FROM</span></span><br><span class="line">			employee e</span><br><span class="line">		<span class="keyword">WHERE</span></span><br><span class="line">			salary <span class="operator">&gt;</span> <span class="number">5000</span></span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第2种方法使用内连接</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	e. NAME 员工姓名, e.salary 工资, d. NAME 部门名称</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employee e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">AND</span> e.salary <span class="operator">&gt;</span> <span class="number">5000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4) 查询开发部与财务部所有的员工信息，分别使用子查询和表连接实现</span></span><br><span class="line"><span class="comment">-- 使用多行子查询。查询开发部与财务部的部门ID</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	d.id</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	dept d</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	d. NAME <span class="keyword">IN</span> (<span class="string">&#x27;开发部&#x27;</span>, <span class="string">&#x27;财务部&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用多行子查询</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employee e</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	e.dept_id <span class="keyword">IN</span> (</span><br><span class="line">		<span class="keyword">SELECT</span></span><br><span class="line">			d.id</span><br><span class="line">		<span class="keyword">FROM</span></span><br><span class="line">			dept d</span><br><span class="line">		<span class="keyword">WHERE</span></span><br><span class="line">			d. NAME <span class="keyword">IN</span> (<span class="string">&#x27;开发部&#x27;</span>, <span class="string">&#x27;财务部&#x27;</span>)</span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用表连接查询</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	e.<span class="operator">*</span>, d. NAME</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employee e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	d. NAME <span class="keyword">IN</span> (<span class="string">&#x27;开发部&#x27;</span>, <span class="string">&#x27;财务部&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p><strong>注：需要注意，如果在子查询定义过的别名，出了括号后，父查询就无法使用该别名，需要自己重新定义一个别名，如下例：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 先找到上过关羽课的学生id，当子查询结果，再查找不在结果内的学生</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	s.sid 学号, s.sname 姓名</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	stu s</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	s.sid <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">		<span class="keyword">SELECT</span></span><br><span class="line">			s.sid</span><br><span class="line">		<span class="keyword">FROM</span></span><br><span class="line">			stu s</span><br><span class="line">		<span class="keyword">INNER</span> <span class="keyword">JOIN</span> stu_cou sc</span><br><span class="line">		<span class="keyword">INNER</span> <span class="keyword">JOIN</span> course c</span><br><span class="line">		<span class="keyword">INNER</span> <span class="keyword">JOIN</span> teacher t <span class="keyword">ON</span> s.sid <span class="operator">=</span> sc.sid</span><br><span class="line">		<span class="keyword">AND</span> sc.cid <span class="operator">=</span> c.cid</span><br><span class="line">		<span class="keyword">AND</span> c.cid <span class="operator">=</span> t.cid</span><br><span class="line">		<span class="keyword">WHERE</span></span><br><span class="line">			t.tname <span class="operator">=</span> <span class="string">&#x27;关羽&#x27;</span></span><br><span class="line">	);</span><br></pre></td></tr></table></figure>
<h4 id="10-3-4-表（多行多列）子查询"><a href="#10-3-4-表（多行多列）子查询" class="headerlink" title="10.3.4. 表（多行多列）子查询"></a>10.3.4. 表（多行多列）子查询</h4><p>表子查询返回结果是一个多行多列的值，类似于一张虚拟表。不能用于 where 条件，用于 select 子句中做为子表。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> (m1, n1) <span class="keyword">IN</span> (<span class="keyword">SELECT</span> m2, n2 <span class="keyword">FROM</span> e2);</span><br></pre></td></tr></table></figure>
<p><strong>注意事项：如果子查询和表连接可以同时实现结果时，子查询的效率低于表连接查询，优先考虑使用表连接。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 5) 查询 2011 年以后入职的员工信息和部门信息，分别使用子查询和表连接实现</span></span><br><span class="line"><span class="comment">-- 使用多列子查询。查询2011年后入职人员的全部信息</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employee e</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	e.join_date <span class="operator">&gt;</span> <span class="string">&#x27;2011-01-01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用多列子查询</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	e.<span class="operator">*</span>, d. NAME</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	dept d,</span><br><span class="line">	(</span><br><span class="line">		<span class="keyword">SELECT</span></span><br><span class="line">			<span class="operator">*</span></span><br><span class="line">		<span class="keyword">FROM</span></span><br><span class="line">			employee e</span><br><span class="line">		<span class="keyword">WHERE</span></span><br><span class="line">			e.join_date <span class="operator">&gt;</span> <span class="string">&#x27;2011-01-01&#x27;</span></span><br><span class="line">	) e</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	d.id <span class="operator">=</span> e.dept_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用内连接查询</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	e.<span class="operator">*</span>, d. NAME</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employee e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> e.dept_id <span class="operator">=</span> d.id</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	e.join_date <span class="operator">&gt;</span> <span class="string">&#x27;2011-01-01&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="10-4-按与外层查询关系来区分子查询类型"><a href="#10-4-按与外层查询关系来区分子查询类型" class="headerlink" title="10.4. 按与外层查询关系来区分子查询类型"></a>10.4. 按与外层查询关系来区分子查询类型</h3><h4 id="10-4-1-不相关子查询"><a href="#10-4-1-不相关子查询" class="headerlink" title="10.4.1. 不相关子查询"></a>10.4.1. 不相关子查询</h4><p>如果子查询可以单独运行出结果，而不依赖于外层查询的值，就可以把这个子查询称之为不相关子查询。<em>上面示例基本上都是不相关子查询</em></p>
<h4 id="10-4-2-相关子查询"><a href="#10-4-2-相关子查询" class="headerlink" title="10.4.2. 相关子查询"></a>10.4.2. 相关子查询</h4><p>如果子查询的执行需要依赖于外层查询的值，就可以把这个子查询称之为相关子查询。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> m1 <span class="keyword">IN</span> (<span class="keyword">SELECT</span> m2 <span class="keyword">FROM</span> e2 <span class="keyword">WHERE</span> n1 <span class="operator">=</span> n2);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其中子查询<code>(SELECT m2 FROM e2 WHERE n1 = n2)</code>的查询条件n1是外层查询的列。也就是说子查询的执行需要依赖于外层查询的值，所以这个子查询就是一个相关子查询。</p>
</blockquote>
<h3 id="10-5-NOT-IN-ANY-SOME-ALL-EXISTS-子查询"><a href="#10-5-NOT-IN-ANY-SOME-ALL-EXISTS-子查询" class="headerlink" title="10.5. [NOT] IN/ANY/SOME/ALL/EXISTS 子查询"></a>10.5. [NOT] IN/ANY/SOME/ALL/EXISTS 子查询</h3><p>对于列子查询和表子查询来说，它们的结果集中包含很多条记录，这些记录相当于是一个集合，所以就不能单纯的和另外一个操作数使用操作符来组成布尔表达式了，MySQL 通过下面的语法来支持某个操作数和一个集合组成一个布尔表达式：</p>
<ul>
<li><code>ALL</code> 关键字</li>
<li><code>ANY</code> 关键字</li>
<li><code>SOME</code> 关键字</li>
<li><code>IN</code>/<code>NOT IN</code> 关键字</li>
<li><code>EXISTS</code> 关键字</li>
</ul>
<h4 id="10-5-1-IN-或者-NOT-IN"><a href="#10-5-1-IN-或者-NOT-IN" class="headerlink" title="10.5.1. IN 或者 NOT IN"></a>10.5.1. IN 或者 NOT IN</h4><p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表 <span class="keyword">where</span> 字段名 [<span class="keyword">NOT</span>] <span class="keyword">IN</span> (子查询);</span><br></pre></td></tr></table></figure>
<p>用来判断某个操作数在不在由子查询结果集组成的集合中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> (m1, n1) <span class="keyword">IN</span> (<span class="keyword">SELECT</span> m2, n2 <span class="keyword">FROM</span> e2);</span><br></pre></td></tr></table></figure>
<h4 id="10-5-2-ANY-SOME（ANY-和-SOME-是同义词）"><a href="#10-5-2-ANY-SOME（ANY-和-SOME-是同义词）" class="headerlink" title="10.5.2. ANY/SOME（ANY 和 SOME 是同义词）"></a>10.5.2. ANY/SOME（ANY 和 SOME 是同义词）</h4><p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表 <span class="keyword">where</span> 字段名 比较操作符 <span class="keyword">ANY</span><span class="operator">/</span><span class="keyword">SOME</span>(子查询);</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ANY</code>/<code>SOME</code> 关键字的作用是，只要子查询结果集中存在某个值和给定的操作数做比较操作，比较结果为<code>TRUE</code>，那么整个表达式的结果就为<code>TRUE</code>，否则整个表达式的结果就为<code>FALSE</code></li>
<li><code>ANY</code>/<code>SOME</code> 可以与<code>=</code>、<code>&gt;</code>、<code>&gt;=</code>、<code>&lt;</code>、<code>&lt;=</code>、<code>&lt;&gt;</code>结合是来使用，分别表示等于、大于、大于等于、小于、小于等于、不等于其中的其中的任何一个数据。</li>
<li>表示制定列中的值要大于子查询中的任意一个值，即必须要大于子查询集中的最小值。同理可以推出其它的比较运算符的情况。</li>
<li><code>SOME</code>和<code>ANY</code>的作用一样，<code>SOME</code>可以理解为<code>ANY</code>的别名</li>
</ul>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> m1 <span class="operator">&gt;</span> <span class="keyword">ANY</span>(<span class="keyword">SELECT</span> m2 <span class="keyword">FROM</span> e2);</span><br></pre></td></tr></table></figure>
<p>查询示例的意思就是，对于 e1 表的某条记录的 m1 列的值来说，如果子查询(SELECT m2 FROM e2)的结果集中存在一个小于 m1 列的值，那么整个布尔表达式的值就是 TRUE，否则为 FALSE，也就是说只要 m1 列的值大于子查询结果集中最小的值，整个表达式的结果就是TRUE，所以上边的查询本质上等价于这个查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> m1 <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(m2) <span class="keyword">FROM</span> e2);</span><br></pre></td></tr></table></figure>
<p>另外，<code>=ANY</code>相当于判断子查询结果集中是否存在某个值和给定的操作数相等，它的含义和<code>IN</code>是相同的。</p>
<h4 id="10-5-3-ALL"><a href="#10-5-3-ALL" class="headerlink" title="10.5.3. ALL"></a>10.5.3. ALL</h4><p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表 <span class="keyword">where</span> 字段名 比较操作符 <span class="keyword">ALL</span>(子查询);</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ALL</code>关键字作用是，子查询结果集中所有的值和给定的操作数做比较操作比较结果为TRUE，那么整个表达式的结果就为TRUE，否则整个表达式的结果就为FALSE。</li>
<li><code>ALL</code> 可以与<code>=</code>、<code>&gt;</code>、<code>&gt;=</code>、<code>&lt;</code>、<code>&lt;=</code>、<code>&lt;&gt;</code>结合是来使用，分别表示等于、大于、大于等于、小于、小于等于、不等于其中的其中的所有数据。</li>
<li><code>ALL</code> 表示指定列中的值必须要大于子查询集的每一个值，即必须要大于子查询集的最大值；如果是小于号即小于子查询集的最小值。同理可以推出其它的比较运算符的情况。</li>
</ul>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> m1 <span class="operator">&gt;</span> <span class="keyword">ALL</span>(<span class="keyword">SELECT</span> m2 <span class="keyword">FROM</span> e2);</span><br></pre></td></tr></table></figure>
<p>查询示例的意思就是，对于 e1 表的某条记录的 m1 列的值来说，如果子查询<code>(SELECT m2 FROM e2)</code>的结果集中的所有值都小于 m1 列的值，那么整个布尔表达式的值就是 TRUE，否则为 FALSE，也就是说只要 m1 列的值大于子查询结果集中最大的值，整个表达式的结果就是 TRUE，所以上边的查询本质上等价于这个查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> m1 <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(m2) <span class="keyword">FROM</span> e2);</span><br></pre></td></tr></table></figure>
<h4 id="10-5-4-EXISTS-子查询"><a href="#10-5-4-EXISTS-子查询" class="headerlink" title="10.5.4. EXISTS 子查询"></a>10.5.4. EXISTS 子查询</h4><h5 id="10-5-4-1-基础使用"><a href="#10-5-4-1-基础使用" class="headerlink" title="10.5.4.1. 基础使用"></a>10.5.4.1. 基础使用</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表A <span class="keyword">where</span> <span class="keyword">exists</span>(子查询语句);</span><br></pre></td></tr></table></figure>
<p><code>EXISTS</code> 的作用是，将主查询表A的每一行数据，放到子查询中作为筛选条件，然后根据子查询中的结果（true 或 false）来决定判断主查询的数据是否保留。如果仅仅需要判断子查询的结果集中是否有记录，而不在乎它的记录具体值，可以使用把 <code>EXISTS</code> 或者 <code>NOT EXISTS</code> 放在子查询语句前边。</p>
<ul>
<li><code>EXISTS(subquery)</code> 只返回 TRUE 或 FALSE，因此子查询中的 <code>SELECT *</code> 也可以用 <code>SELECT 1</code> 替换，官方说法是实际执行时会忽略 <code>SELECT</code> 的清单，因此两者没有区别</li>
<li>该子查询如果“有数据结果”(至少返回一行数据)，则该<code>EXISTS()</code>的结果为“<code>true</code>”，外层查询执行</li>
<li>该子查询如果“没有数据结果”（没有任何数据返回），则该<code>EXISTS()</code>的结果为“<code>false</code>”，外层查询不执行</li>
<li><code>EXISTS</code> 后面的子查询不返回任何实际数据，只返回真或假，当返回真时 <code>where</code> 条件成立</li>
<li><code>EXISTS</code> 子查询的实际执行过程可能经过了优化，而不是逐条对比</li>
<li><code>EXISTS</code> 子查询也可以用 <code>JOIN</code> 来代替，但需要具体问题具体分析才能决定哪种方式最优</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> e1 <span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> e2);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询公司是否有大于60岁的员工，有则输出</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp3 a <span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp3 b <span class="keyword">where</span> a.age <span class="operator">&gt;</span> <span class="number">60</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询有所属部门的员工信息</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp3 a <span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept3 b <span class="keyword">where</span> a.dept_id <span class="operator">=</span> b.deptno);</span><br></pre></td></tr></table></figure>
<p>对于子查询<code>(SELECT 1 FROM e2)</code>来说，如果并不关心这个子查询最后到底查询出的结果是什么，所以查询列表里填<code>*</code>、某个列名，或者其他内容都无所谓，真正关心的是子查询的结果集中是否存在记录。也就是说只要<code>(SELECT 1 FROM e2)</code>这个查询中有记录，那么整个<code>EXISTS</code>表达式的结果就为TRUE。</p>
<h5 id="10-5-4-2-in-和-exists-子查询的区别"><a href="#10-5-4-2-in-和-exists-子查询的区别" class="headerlink" title="10.5.4.2. in 和 exists 子查询的区别"></a>10.5.4.2. in 和 exists 子查询的区别</h5><p>mysql 中的 in 语句是把外表和内表作 hash 连接，而 exists 语句是对外表作 loop循环，每次loop循环再对内表进行查询。exists 语句在某些条件下的执行效率比 in 语句高：</p>
<ol>
<li>如果查询的两个表大小相当，那么用 in 和 exists 差别不大。</li>
<li>如果两个表中一个较小，一个是大表，则子查询表大的用 exists，子查询表小的用 in。</li>
<li>not in 和 not exists 比较：如果查询语句使用了 not in，那么内外表都进行全表扫描，没有用到索引；而 not extsts 的子查询依然能用到表上的索引。所以无论那个表大，用 not exists 都比 not in 要快。</li>
</ol>
<blockquote>
<p>Tips: 在实际开发中，特别是大数据量时，推荐使用 <code>EXISTS</code> 关键字</p>
</blockquote>
<h3 id="10-6-子查询的注意事项"><a href="#10-6-子查询的注意事项" class="headerlink" title="10.6. 子查询的注意事项"></a>10.6. 子查询的注意事项</h3><ul>
<li>子查询语句一定要使用括号括起来，否则无法确定子查询语句什么时候结束。</li>
<li>在<code>SELECT</code>子句中的子查询必须是标量子查询，如果子查询结果集中有多个列或者多个行，都不允许放在<code>SELECT</code>子句中，在想要得到标量子查询或者行子查询，但又不能保证子查询的结果集只有一条记录时，应该使用<code>LIMIT 1</code>语句来限制记录数量。</li>
<li>对于<code>[NOT] IN/ANY/SOME/ALL</code>子查询来说，子查询中不允许有<code>LIMIT</code>语句，而且这类子查询中<code>ORDER BY</code>子句、<code>DISTINCT</code>语句、没有聚集函数以及<code>HAVING</code>子句的<code>GROUP BY</code>子句没有什么意义。因为子查询的结果其实就相当于一个集合，集合里的值排不排序等一点儿都不重要。</li>
<li>不允许在一条语句中增删改某个表的记录时同时还对该表进行子查询。</li>
</ul>
<h1 id="11-DCL语句使用-了解"><a href="#11-DCL语句使用-了解" class="headerlink" title="11. DCL语句使用(了解)"></a>11. DCL语句使用(了解)</h1><h3 id="11-1-DCL概述"><a href="#11-1-DCL概述" class="headerlink" title="11.1. DCL概述"></a>11.1. DCL概述</h3><p>DCL 英文全称是 Data Control Language(数据控制语言)，用来管理数据库用户的创建和删除、控制用户的数据库访问权限。</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004703.png" alt=""></p>
<h3 id="11-2-管理用户"><a href="#11-2-管理用户" class="headerlink" title="11.2. 管理用户"></a>11.2. 管理用户</h3><h4 id="11-2-1-查询用户"><a href="#11-2-1-查询用户" class="headerlink" title="11.2.1. 查询用户"></a>11.2.1. 查询用户</h4><p>mysql的用户信息保存在 <code>mysql.user</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from mysql.user;</span><br></pre></td></tr></table></figure>
<p>查询的结果如下:</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251005222.png" alt=""></p>
<p>其中 Host 代表当前用户访问的主机，如果为 localhost，仅代表只能够在当前本机访问，是不可以远程访问的。User 代表的是访问该数据库的用户名。在 MySQL 中需要通过 Host 和 User 来唯一标识一个用户。</p>
<h4 id="11-2-2-创建用户"><a href="#11-2-2-创建用户" class="headerlink" title="11.2.2. 创建用户"></a>11.2.2. 创建用户</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;密码&#x27;</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Notes: </p>
<ul>
<li>在 MySQL 中需要通过<code>用户名@主机名</code>的方式，来唯一标识一个用户。</li>
<li>“主机名”表示创建的用户使用的IP地址，可以设置为localhost(代表仅允许本机)或者<code>&#39;%&#39;</code>（代表允许所有IP地址登录）</li>
</ul>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建用户 moon, 只能够在当前主机localhost访问, 密码123456;</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;moon&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建用户 zero, 可以在任意主机访问该数据库, 密码123456;</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;zero&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="11-2-3-修改用户密码"><a href="#11-2-3-修改用户密码" class="headerlink" title="11.2.3. 修改用户密码"></a>11.2.3. 修改用户密码</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;新密码&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> <span class="string">&#x27;moon&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">with</span> mysql_native_password <span class="keyword">by</span> <span class="string">&#x27;1234&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="11-2-4-删除用户"><a href="#11-2-4-删除用户" class="headerlink" title="11.2.4. 删除用户"></a>11.2.4. 删除用户</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> <span class="string">&#x27;moon&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="11-3-用户权限控制"><a href="#11-3-用户权限控制" class="headerlink" title="11.3. 用户权限控制"></a>11.3. 用户权限控制</h3><h4 id="11-3-1-常用权限"><a href="#11-3-1-常用权限" class="headerlink" title="11.3.1. 常用权限"></a>11.3.1. 常用权限</h4><p>MySQL 中定义了很多种权限，但是常用的就以下几种：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>权限</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ALL, ALL PRIVILEGES</td>
<td>所有权限</td>
</tr>
<tr>
<td>SELECT</td>
<td>查询数据</td>
</tr>
<tr>
<td>INSERT</td>
<td>新增数据</td>
</tr>
<tr>
<td>UPDATE</td>
<td>修改数据</td>
</tr>
<tr>
<td>DELETE</td>
<td>删除数据</td>
</tr>
<tr>
<td>ALTER</td>
<td>修改表</td>
</tr>
<tr>
<td>DROP</td>
<td>删除数据库/表/视图</td>
</tr>
<tr>
<td>CREATE</td>
<td>创建数据库/表</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>上述只是简单罗列了常见的几种权限描述，其他权限描述及含义，可以直接参考<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html">MySQL 8.0 版本官方文档</a></p>
</blockquote>
<h4 id="11-3-2-查询用户权限"><a href="#11-3-2-查询用户权限" class="headerlink" title="11.3.2. 查询用户权限"></a>11.3.2. 查询用户权限</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询 &#x27;zero&#x27;@&#x27;%&#x27; 用户的权限</span></span><br><span class="line"><span class="keyword">show</span> grants <span class="keyword">for</span> <span class="string">&#x27;zero&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="11-3-3-用户授权"><a href="#11-3-3-用户授权" class="headerlink" title="11.3.3. 用户授权"></a>11.3.3. 用户授权</h4><p>创建用户之后，可以使用新用户进行登录，查看数据库只有系统自带的数据库，想要操作自己创建的数据库还需要root用户对新用户进行授权。语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> 权限列表 <span class="keyword">ON</span> 数据库名.表名 <span class="keyword">TO</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 授予zero用户temp_db数据库所有表的多个权限</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">delete</span>,<span class="keyword">insert</span>,<span class="keyword">update</span> <span class="keyword">on</span> temp_db.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;zero&#x27;</span>@<span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 授予zero用户temp_db数据库所有表的某个权限</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">delete</span> <span class="keyword">on</span> temp_db.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;zero&#x27;</span>@<span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 授予zero用户temp_db数据库所有表的所有权限</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> temp_db.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;zero&#x27;</span>@<span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 授予moon用户所有数据库所有表的所有权限</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;moon&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Notes: </p>
<ul>
<li>多个权限之间，使用英文逗号<code>,</code>分隔</li>
<li>授权时，数据库名和表名均可使用<code>*</code>进行通配，代表所有</li>
</ul>
</blockquote>
<h4 id="11-3-4-撤销权限"><a href="#11-3-4-撤销权限" class="headerlink" title="11.3.4. 撤销权限"></a>11.3.4. 撤销权限</h4><p>当需要限制新用户操作数据库的权限时，root 用户可以撤销已授予用户的某些权限。语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> 权限列表 <span class="keyword">ON</span> 数据库名.表名 <span class="keyword">FROM</span> <span class="string">&#x27;用户名&#x27;</span>@<span class="string">&#x27;主机名&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 撤销zero用户temp_db数据库所有表的多个权限</span></span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">delete</span>,<span class="keyword">insert</span>,<span class="keyword">update</span> <span class="keyword">on</span> temp_db.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;zero&#x27;</span>@<span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 撤销zero用户temp_db数据库所有表的某个权限</span></span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">delete</span> <span class="keyword">on</span> temp_db.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;zero&#x27;</span>@<span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 撤销zero用户temp_db数据库所有表的所有权限</span></span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">all</span> <span class="keyword">on</span> temp_db.<span class="operator">*</span> <span class="keyword">from</span> <span class="string">&#x27;zero&#x27;</span>@<span class="string">&#x27;*&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h1 id="12-数据的约束"><a href="#12-数据的约束" class="headerlink" title="12. 数据的约束"></a>12. 数据的约束</h1><h3 id="12-1-数据约束概述"><a href="#12-1-数据约束概述" class="headerlink" title="12.1. 数据约束概述"></a>12.1. 数据约束概述</h3><p>约束（constraint），是作用于表中字段上的规则，实质就是对表中存储的数据进行限制，表在设计和创建的时候加入约束的目的就是为了保证表中的记录完整性、有效性和准确性。</p>
<p>数据完整性分为以下几类：</p>
<ul>
<li>实体完整性：规定表的每一行在表中是惟一的实体。</li>
<li>域完整性：是指表中的列必须满足某种特定的数据类型约束，其中约束又包括取值范围、精度等规定。</li>
<li>参照完整性：是指两个表的主关键字和外关键字的数据应一致，保证了表之间的数据的一致性，防止了数据丢失或无意义的数据在数据库中扩散。</li>
<li>用户定义的完整性：不同的关系数据库系统根据其应用环境的不同，往往还需要一些特殊的约束条件。用户定义的完整性即是针对某个特定关系数据库的约束条件，它反映某一具体应用必须满足的语义要求。与表有关的约束：包括列约束(NOT NULL（非空约束）)和表约束(PRIMARY KEY、foreign key、check、UNIQUE) 。</li>
</ul>
<h4 id="12-1-1-约束种类"><a href="#12-1-1-约束种类" class="headerlink" title="12.1.1. 约束种类"></a>12.1.1. 约束种类</h4><div class="table-container">
<table>
<thead>
<tr>
<th>约束</th>
<th>描述</th>
<th>关键字</th>
</tr>
</thead>
<tbody>
<tr>
<td>默认约束</td>
<td>保存数据时，如果未指定该字段的值，则采用默认值</td>
<td><code>DEFAULT</code></td>
</tr>
<tr>
<td>主键约束</td>
<td>主键是一行数据的唯一标识，要求非空且唯一</td>
<td><code>PRIMARY KEY</code></td>
</tr>
<tr>
<td>唯一约束</td>
<td>保证该字段的所有数据都是唯一、不重复的</td>
<td><code>UNIQUE</code></td>
</tr>
<tr>
<td>非空约束</td>
<td>限制该字段的数据不能为null</td>
<td><code>NOT NULL</code></td>
</tr>
<tr>
<td>检查约束</td>
<td>8.0.16 版本之后新增，保证字段值满足某一个条件</td>
<td><code>CHECK</code></td>
</tr>
<tr>
<td>外键约束</td>
<td>用来让两张表的数据之间建立连接，保证数据的一致性和完整性</td>
<td><code>FOREIGN KEY</code></td>
</tr>
<tr>
<td>自增长约束</td>
<td></td>
<td><code>auto_increment</code></td>
</tr>
<tr>
<td>零填充约束</td>
<td></td>
<td><code>zerofill</code></td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>扩展：还有一种叫“检查约束”，但 MySQL 不支持，Oracle 支持</p>
</blockquote>
<h4 id="12-1-2-约束添加时机"><a href="#12-1-2-约束添加时机" class="headerlink" title="12.1.2. 约束添加时机"></a>12.1.2. 约束添加时机</h4><ul>
<li>创建表结构的同时添加约束（推荐）</li>
<li>创建完表结构之后添加（不推荐）。如果创建完之后再添加约束，可能会添加失败。因为已有的数据可能不符合即将要添加的约束。</li>
</ul>
<h3 id="12-2-默认值约束-default"><a href="#12-2-默认值约束-default" class="headerlink" title="12.2. 默认值约束 (default)"></a>12.2. 默认值约束 (default)</h3><p>默认约束，如果这个字段没有输入任何的值，则数据库使用默认的值</p>
<h4 id="12-2-1-定义与语法"><a href="#12-2-1-定义与语法" class="headerlink" title="12.2.1. 定义与语法"></a>12.2.1. 定义与语法</h4><ul>
<li>在创建表时，指定默认约束，关键字：<code>default</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> 表名 (</span><br><span class="line">  列名 数据类型(长度) <span class="keyword">default</span> 默认值,</span><br><span class="line">  ....</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>创建表后，修改字段的默认约束</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 modify 字段名 数据类型(长度) <span class="keyword">default</span> 默认值;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个学生表 s1，字段：(编号，姓名，地址（默认值是：广州)），插入 2 条记录，地址使用默认值。</span></span><br><span class="line"><span class="keyword">create table</span> st1 (</span><br><span class="line">	id <span class="type">int</span>,</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">	<span class="comment">-- 默认值</span></span><br><span class="line">	address <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">default</span> <span class="string">&#x27;广州&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">-- 写法一：只插入前面 2 列，第 3 列不写</span></span><br><span class="line"><span class="keyword">insert into</span> st1 (id,name) <span class="keyword">values</span> (<span class="number">10</span>, <span class="string">&#x27;猪八戒&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> st1;</span><br><span class="line"><span class="comment">-- 写法二：VALUES 前面的列名不写</span></span><br><span class="line"><span class="keyword">insert into</span> st1 <span class="keyword">values</span> (<span class="number">20</span>, <span class="string">&#x27;猪九戒&#x27;</span>,<span class="keyword">default</span>);</span><br><span class="line"><span class="comment">-- 使用自己的值</span></span><br><span class="line"><span class="keyword">insert into</span> st1 <span class="keyword">values</span> (<span class="number">10</span>, <span class="string">&#x27;小猪&#x27;</span>, <span class="string">&#x27;珠海&#x27;</span>);</span><br><span class="line"><span class="comment">-- 如果第 3 列使用 NULL 的常量，会不会插入默认值呢？</span></span><br><span class="line"><span class="keyword">insert into</span> st1 <span class="keyword">values</span> (<span class="number">10</span>, <span class="string">&#x27;小猪&#x27;</span>, <span class="keyword">null</span>);</span><br></pre></td></tr></table></figure>
<h4 id="12-2-2-删除默认约束"><a href="#12-2-2-删除默认约束" class="headerlink" title="12.2.2. 删除默认约束"></a>12.2.2. 删除默认约束</h4><p>删除默认约束只需要将默认值修改为<code>null</code>即可</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 modify <span class="keyword">column</span> 字段名 数据类型(长度) <span class="keyword">default</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<h3 id="12-3-非空约束-not-null"><a href="#12-3-非空约束-not-null" class="headerlink" title="12.3. 非空约束 (not null)"></a>12.3. 非空约束 (not null)</h3><h4 id="12-3-1-定义非空约束"><a href="#12-3-1-定义非空约束" class="headerlink" title="12.3.1. 定义非空约束"></a>12.3.1. 定义非空约束</h4><p>非空约束：约束某一列的值不能为空(<code>null</code>)，<strong>必须有值，但可以插入空字符</strong>。对于使用了非空约束的字段，如果用户在添加数据时没有指定值，数据库系统就会报错。</p>
<ul>
<li>在创建表时，指定非空约束，关键字：<code>not null</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> 表名 (</span><br><span class="line">  列名 数据类型(长度) <span class="keyword">not null</span>,</span><br><span class="line">  ....</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>创建表后，修改字段为非空约束</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 modify 字段 数据类型(长度) <span class="keyword">not null</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 示例：创建表学生表 s2，字段(id，name, gender)，其中姓名不能为 null</span></span><br><span class="line"><span class="keyword">create table</span> s2 (</span><br><span class="line">	id <span class="type">int</span>,</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not null</span>, <span class="comment">-- 非空</span></span><br><span class="line">	gender <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">-- 不赋值：第 2 列不写 Column &#x27;name&#x27; cannot be null</span></span><br><span class="line"><span class="keyword">insert into</span> s2 (id,name,gender) <span class="keyword">values</span> (<span class="number">1</span>,<span class="keyword">null</span>,<span class="string">&#x27;女&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> s2 (id,gender) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;女&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> s2;</span><br></pre></td></tr></table></figure>
<h4 id="12-3-2-删除非空约束"><a href="#12-3-2-删除非空约束" class="headerlink" title="12.3.2. 删除非空约束"></a>12.3.2. 删除非空约束</h4><p>删除非空约束，其实就是使用<code>alter</code>关键字修改字段的约束，去掉<code>not null</code>即可</p>
<h4 id="12-3-3-Mysql-允许-null-与-default-值"><a href="#12-3-3-Mysql-允许-null-与-default-值" class="headerlink" title="12.3.3. Mysql 允许 null 与 default 值"></a>12.3.3. Mysql 允许 null 与 default 值</h4><p>分为下面4种情况：</p>
<ol>
<li>允许<code>null</code>，指定<code>default</code>值。</li>
<li>允许<code>null</code>，不指定<code>default</code>，这个时候可认为<code>default</code>值就是<code>null</code></li>
<li>不允许<code>null</code>，指定<code>default</code>值，不能指定<code>default</code>值为<code>null</code>，否则报错 <code>Invalid default value for xxx</code></li>
<li>不允许<code>null</code>，不指定<code>default</code>值。这种情况，新增的时候，必须指定值。否则报错 <code>Field xxx doesn&#39;t have a default value</code></li>
</ol>
<h4 id="12-3-4-字段为什么建议定义为-not-null"><a href="#12-3-4-字段为什么建议定义为-not-null" class="headerlink" title="12.3.4. 字段为什么建议定义为 not null"></a>12.3.4. 字段为什么建议定义为 not null</h4><blockquote>
<p>MySQL 官网说明:</p>
<p>NULL columns require additional space in the rowto record whether their values are NULL. For MyISAM tables, each NULL columntakes one bit extra, rounded up to the nearest byte.</p>
</blockquote>
<p>null 值会占用更多的字节，且会在程序中造成很多与预期不符的情况。</p>
<h3 id="12-4-唯一约束-unique"><a href="#12-4-唯一约束-unique" class="headerlink" title="12.4. 唯一约束 (unique)"></a>12.4. 唯一约束 (unique)</h3><h4 id="12-4-1-定义与语法"><a href="#12-4-1-定义与语法" class="headerlink" title="12.4.1. 定义与语法"></a>12.4.1. 定义与语法</h4><p>唯一约束，是指所有记录中某一列的数据不允许出现重复值</p>
<ul>
<li>在创建表时，指定唯一约束，关键字：<code>unique</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> 表名 (</span><br><span class="line">  列名 数据类型(长度) <span class="keyword">unique</span>,</span><br><span class="line">  ....</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>创建表后，修改字段为唯一约束</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">add constraint</span> 约束名 <span class="keyword">unique</span>(列名);</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建学生表 s3，列(id,name)，学生姓名这一列设置成唯一约束，即不能出现同名的学生。</span></span><br><span class="line"><span class="keyword">create table</span> s3 (</span><br><span class="line">	id <span class="type">int</span>,</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">unique</span> <span class="comment">-- 唯一约束</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> s3 <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;Jack&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> s3;</span><br><span class="line"><span class="comment">-- 插入相同的名字： Duplicate entry &#x27;Jack&#x27; for key &#x27;name&#x27;</span></span><br><span class="line"><span class="keyword">insert into</span> s3 <span class="keyword">values</span> (<span class="number">2</span>,<span class="string">&#x27;Jack&#x27;</span>);</span><br><span class="line"><span class="comment">-- 问：出现多个 null 的时候会怎样？因为 null 是没有值，所以不存在重复的问题。</span></span><br><span class="line"><span class="keyword">insert into</span> s3 <span class="keyword">values</span>(<span class="number">3</span>,<span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">insert into</span> s3 <span class="keyword">values</span>(<span class="number">4</span>,<span class="keyword">null</span>);</span><br></pre></td></tr></table></figure>
<h4 id="12-4-2-删除唯一约束"><a href="#12-4-2-删除唯一约束" class="headerlink" title="12.4.2. 删除唯一约束"></a>12.4.2. 删除唯一约束</h4><p>删除唯一约束的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">drop</span> index 唯一约束名;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：如果创建唯一约束时没有指定名称，则字段名就是唯一约束名称。</p>
</blockquote>
<h4 id="12-4-3-注意事项"><a href="#12-4-3-注意事项" class="headerlink" title="12.4.3. 注意事项"></a>12.4.3. 注意事项</h4><ul>
<li>可以出现多个<code>null</code>，因为<code>null</code>是表示没有任何内容，就没有重复的说法</li>
<li>不可以出现多个空字符，因为空字符也是有内容，所以不能同时出现多个空字符</li>
</ul>
<h3 id="12-5-主键约束-primary-key"><a href="#12-5-主键约束-primary-key" class="headerlink" title="12.5. 主键约束 (primary key)"></a>12.5. 主键约束 (primary key)</h3><h4 id="12-5-1-概念"><a href="#12-5-1-概念" class="headerlink" title="12.5.1. 概念"></a>12.5.1. 概念</h4><p>MySQL 主键约束是一个列或者多个列的组合，用于唯一标识表中的一条数据，方便在RDBMS中尽快的找到某一行。每一张表都最多只能允许有一个主键。</p>
<p>主键约束相当于“唯一约束 + 非空约束”的组合，主键约束列不允许重复，也不允许出现空值。当创建主键的约束时，系统默认会在所在的列和列组合上建立对应的唯一索引。</p>
<p><strong>主键约束的关键字</strong>：</p>
<ul>
<li><code>primary key</code>：<strong>保证列的数据非空，唯一</strong></li>
<li><code>primary key auto_increment</code>：<strong>让主键列数据，实现自动增长</strong></li>
</ul>
<p><strong>主键设计原则</strong>：</p>
<ul>
<li>主键列一般是选择对用户没有任何意义的数据。只是用于开发时标识当前记录。</li>
<li>主键列的值一般是由数据库或计算机生成。</li>
<li>主键值生成后，一般不建议修改</li>
</ul>
<h4 id="12-5-2-创建单列主键"><a href="#12-5-2-创建单列主键" class="headerlink" title="12.5.2. 创建单列主键"></a>12.5.2. 创建单列主键</h4><p>创建单列主键有两种方式，一种是在定义字段的同时指定主键，一种是定义完字段之后指定主键</p>
<ul>
<li>在创建表时创建主键，在字段后面加上 <code>primary key</code>，语法格式：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> tablename(</span><br><span class="line">	列名 数据类型(长度) <span class="keyword">primary key</span>,</span><br><span class="line">	.......</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li>在创建表时创建主键，在表创建的最后来指定主键，语法格式：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> tablename(</span><br><span class="line">	.......,</span><br><span class="line">	<span class="keyword">constraint</span> 主键名称 <span class="keyword">primary key</span>(列名)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：上面语法中 <code>constraint 主键名称</code> 是可以省略</p>
</blockquote>
<h4 id="12-5-3-添加多列主键-联合主键）"><a href="#12-5-3-添加多列主键-联合主键）" class="headerlink" title="12.5.3. 添加多列主键(联合主键）"></a>12.5.3. 添加多列主键(联合主键）</h4><p>联合主键，是由一张表中多个字段组成的。注意事项：</p>
<ul>
<li>当主键是由多个字段组成时，不能直接在字段名后面声明主键约束。</li>
<li>一张表只能有一个主键，联合主键只算是一个主键。即有联合主键后，不能再创建单列主键</li>
<li>创建联合主键后，相关每个列的值都不能空</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> 表名(</span><br><span class="line">   ...,</span><br><span class="line">   <span class="keyword">constraint</span> 主键名称 <span class="keyword">primary key</span> (字段<span class="number">1</span>, 字段<span class="number">2</span>, …, 字段n)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：上面语法中 <code>constraint 主键名称</code> 是可以省略</p>
</blockquote>
<h4 id="12-5-4-通过修改表结构添加主键"><a href="#12-5-4-通过修改表结构添加主键" class="headerlink" title="12.5.4. 通过修改表结构添加主键"></a>12.5.4. 通过修改表结构添加主键</h4><p>主键约束不仅可以在创建表的同时创建，也可以在修改表结构时添加。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">add</span> <span class="keyword">primary key</span>(字段<span class="number">1</span>, 字段<span class="number">2</span>, ....);</span><br></pre></td></tr></table></figure>
<h4 id="12-5-5-删除主键"><a href="#12-5-5-删除主键" class="headerlink" title="12.5.5. 删除主键"></a>12.5.5. 删除主键</h4><p>一个表中不需要主键约束时，可以从表中将其删除。删除指定表格的主键语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">drop</span> <span class="keyword">primary key</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除 sort 表的主键</span></span><br><span class="line"><span class="keyword">alter table</span> sort <span class="keyword">drop</span> <span class="keyword">primary key</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips: 因为表只有一个主键，所以删除时不需要指定主键名</p>
</blockquote>
<h4 id="12-5-6-设置主键自动增长"><a href="#12-5-6-设置主键自动增长" class="headerlink" title="12.5.6. 设置主键自动增长"></a>12.5.6. 设置主键自动增长</h4><p>在 MySQL 中，当主键定义为自增长后，由数据库系统根据定义自动赋值。每增加一条记录，主键会自动以相同的步长进行增长。</p>
<ul>
<li>一般主键是自增长的字段，不需要指定。</li>
<li>实现添加自增长语句，主键字段后加 <code>auto_increment</code> 关键字(只适用MySQL)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建分类表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> sort (</span><br><span class="line">	sid <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> auto_increment,  <span class="comment">-- 分类ID</span></span><br><span class="line">	sname <span class="type">VARCHAR</span>(<span class="number">100</span>)     <span class="comment">-- 分类名称</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="12-6-自增长字段-auto-increment"><a href="#12-6-自增长字段-auto-increment" class="headerlink" title="12.6. 自增长字段 ( auto_increment )"></a>12.6. 自增长字段 ( auto_increment )</h3><h4 id="12-6-1-自增长约束"><a href="#12-6-1-自增长约束" class="headerlink" title="12.6.1. 自增长约束"></a>12.6.1. 自增长约束</h4><ul>
<li>创建表时，指定自增长约束的语法：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> 表名(</span><br><span class="line">  列名 数值类型(长度) <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">  ....</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>创建表时，指定自增长字段初始值的语法：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> 表名 (</span><br><span class="line">  字段名 <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">  ....</span><br><span class="line">) auto_increment <span class="operator">=</span> 初始值;</span><br></pre></td></tr></table></figure>
<ul>
<li>创建表后，修改自增长起始值：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 AUTO_INCREMENT <span class="operator">=</span> 新的起始值;</span><br></pre></td></tr></table></figure>
<h4 id="12-6-2-自增长约束特点"><a href="#12-6-2-自增长约束特点" class="headerlink" title="12.6.2. 自增长约束特点"></a>12.6.2. 自增长约束特点</h4><ul>
<li>默认情况下，<code>auto_increment</code> 的初始值是 1，每新增一条记录，字段值自动加 1。</li>
<li>一个表中只能有一个字段使用 <code>auto_increment</code> 约束，且该字段必须有唯一索引，以避免序号重复（即为主键或主键的一部分）。</li>
<li><code>auto_increment</code> 约束的字段必须具备 <code>NOT NULL</code> 属性。</li>
<li><code>auto_increment</code> 约束的字段只能是整数类型（<code>TINYINT</code>、<code>SMALLINT</code>、<code>INT</code>、<code>BIGINT</code> 等。</li>
<li><code>auto_increment</code> 约束字段的最大值受该字段的数据类型约束，如果达到上限，<code>auto_increment</code> 就会失效。</li>
</ul>
<h4 id="12-6-3-delete-和-truncate-删除后自增列的变化"><a href="#12-6-3-delete-和-truncate-删除后自增列的变化" class="headerlink" title="12.6.3. delete 和 truncate 删除后自增列的变化"></a>12.6.3. delete 和 truncate 删除后自增列的变化</h4><ul>
<li><code>delete</code> 数据之后自动增长从断点开始</li>
<li><code>truncate</code> 数据之后自动增长从默认起始值开始</li>
</ul>
<h3 id="12-7-零填充"><a href="#12-7-零填充" class="headerlink" title="12.7. 零填充"></a>12.7. 零填充</h3><p>如果某一数值列的值不满指定的位数，可以设置在列的值前面使用零填充。在数据类型的后面使用 <code>zerofill</code> 关键字：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> 表名 (</span><br><span class="line">  列名 数值类型(长度) zerofill,</span><br><span class="line">  ....</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>作用如果数据的位数是4位，则使用0进行填充整个4位。</p>
<blockquote>
<p>注：当使用 <code>zerofill</code> 时，默认会自动加<code>unsigned</code>（无符号）属性，使用<code>unsigned</code>属性后，数值范围是原值的2倍，例如，有符号为-128~+127，无符号为0~256。</p>
</blockquote>
<h3 id="12-8-外键约束"><a href="#12-8-外键约束" class="headerlink" title="12.8. 外键约束"></a>12.8. 外键约束</h3><h4 id="12-8-1-定义"><a href="#12-8-1-定义" class="headerlink" title="12.8.1. 定义"></a>12.8.1. 定义</h4><p>MySQL 外键约束（FOREIGN KEY）是表的一个特殊字段，经常与主键约束一起使用。对于两个具有关联关系的表而言，相关联字段中主键所在的表就是主表（父表），外键所在的表就是从表（子表）。</p>
<p>外键的主要目的是，用来建立主表与从表的关联关系，为两个表的数据建立连接，<strong>约束两个表中数据的一致性和完整性</strong>。</p>
<p>例如：左侧的 emp 表是员工表，里面存储员工的基本信息，包含员工的ID、姓名、年龄、职位、薪资、入职日期、上级主管ID、部门ID，在员工的信息中存储的是部门的ID dept_id，而这个部门的 ID 是关联的部门表 dept 的主键 id，那 emp 表的 dept_id 就是外键，关联的是另一张表的主键。</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004833.png" alt=""></p>
<blockquote>
<p>Notes: 目前上述两张表，只是在逻辑上存在这样一层关系；在数据库层面，并未建立外键关联，所以是无法通过数据库本身来保证数据的一致性和完整性的。</p>
</blockquote>
<p><strong>外键的优缺点</strong>：</p>
<ul>
<li><strong>优点</strong>：由数据库自身保证数据一致性，完整性，更可靠，因为程序很难 100% 保证数据的完整性，而用外键即使在数据库服务器当机或者出现其他问题的时候，也能够最大限度的保证数据的一致性和完整性。有主外键的数据库设计可以增加 ER 图的可读性，这点在数据库设计时非常重要。外键在一定程度上说明的业务逻辑，会使设计周到具体全面。</li>
<li><strong>缺点</strong>：可以用触发器或应用程序保证数据的完整性；过分强调或者说使用外键会增加开发难度，导致表过多，更改业务困难，扩展困难等问题；不用外键时数据管理简单，操作方便，性能高（导入导出等操作，在 insert, update, delete 数据的时候更快）。</li>
</ul>
<h4 id="12-8-2-外键需遵守的规则"><a href="#12-8-2-外键需遵守的规则" class="headerlink" title="12.8.2. 外键需遵守的规则"></a>12.8.2. 外键需遵守的规则</h4><p>定义一个外键时，需要遵守下列规则：</p>
<ul>
<li>为了避免大量重复的数据出现，数据冗余。就需要使用到外键约束。</li>
<li>从表的某一列值(外键列)和主表的主键值相关关联，外键列的值必须来源于主表的主键值</li>
<li>主表：约束别人，表结构不变；副表/从表：被别人约束</li>
<li>主表必须已经存在于数据库中，或者是当前正在创建的表。</li>
<li>主表必须定义主键。</li>
<li>主键不能包含空值，但允许在外键中出现空值。也就是说，只要外键的每个非空值出现在指定的主键中，这个外键的内容就是正确的。</li>
<li>在主表的表名后面指定列名或列名的组合。这个列或列的组合必须是主表的主键或候选键。</li>
<li>外键中列的数目必须和主表的主键中列的数目相同。</li>
<li>外键中列的数据类型必须和主表主键中对应列的数据类型相同。</li>
</ul>
<p><strong>注：定义外键的时候，外键的约束比较和主键完全一致才能成功关联</strong></p>
<h4 id="12-8-3-外键约束语法格式1-创建表时定义"><a href="#12-8-3-外键约束语法格式1-创建表时定义" class="headerlink" title="12.8.3. 外键约束语法格式1(创建表时定义)"></a>12.8.3. 外键约束语法格式1(创建表时定义)</h4><p>在 <code>create table</code> 语句中，通过 <code>foreign key</code> 关键字来指定外键，具体的语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constraint</span> [外键名] <span class="keyword">foreign key</span>(外键列名<span class="number">1</span>, 外键列名<span class="number">2</span>, ....) <span class="keyword">references</span> 主表(主键列名<span class="number">1</span>, 主键名列<span class="number">2</span>, ...);</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> employee(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">	emp_name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">	dept_id <span class="type">int</span>, <span class="comment">-- 部门 id</span></span><br><span class="line">	<span class="comment">-- 定义一个外键</span></span><br><span class="line">	<span class="keyword">constraint</span> employee_dept_fk <span class="keyword">foreign key</span>(dept_id) <span class="keyword">references</span> dept(id)</span><br><span class="line">	<span class="comment">-- 声明 外键名称 外键(员工表中的列) 引用 部门表(部门表 id 主键)</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">-- ******** 或者： *********</span></span><br><span class="line"><span class="keyword">create table</span> employee (</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">	emp_name <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">	dept_id <span class="type">int</span>, <span class="comment">-- 这里有逗号，没有 constraint 和名字</span></span><br><span class="line">	<span class="keyword">foreign key</span> (dept_id) <span class="keyword">references</span> dept(id)</span><br><span class="line">	<span class="comment">-- 外键，关联部门表(部门表的主键)</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="12-8-4-外键约束语法格式2-创建表后再定义"><a href="#12-8-4-外键约束语法格式2-创建表后再定义" class="headerlink" title="12.8.4. 外键约束语法格式2(创建表后再定义)"></a>12.8.4. 外键约束语法格式2(创建表后再定义)</h4><p>外键约束也可以在修改表时添加，但是添加外键约束的前提是：从表中外键列中的数据必须与主表中主键列中的数据一致或者是没有数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">add constraint</span> <span class="keyword">foreign key</span>(外键名) <span class="keyword">references</span> 主表(主键名);</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建部门表</span></span><br><span class="line"><span class="keyword">create table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> dept2(</span><br><span class="line">  deptno <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">primary key</span> ,  <span class="comment">-- 部门号</span></span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">20</span>) <span class="comment">-- 部门名字</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 创建员工表</span></span><br><span class="line"><span class="keyword">create table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> emp2(</span><br><span class="line">  eid <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">primary key</span> , <span class="comment">-- 员工编号</span></span><br><span class="line">  ename <span class="type">varchar</span>(<span class="number">20</span>), <span class="comment">-- 员工名字</span></span><br><span class="line">  age <span class="type">int</span>,  <span class="comment">-- 员工年龄</span></span><br><span class="line">  dept_id <span class="type">varchar</span>(<span class="number">20</span>)  <span class="comment">-- 员工所属部门</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 创建外键约束</span></span><br><span class="line"><span class="keyword">alter table</span> emp2 <span class="keyword">add constraint</span> dept_id_fk <span class="keyword">foreign key</span>(dept_id) <span class="keyword">references</span> dept2 (deptno);</span><br></pre></td></tr></table></figure>
<h4 id="12-8-5-在外键约束下的数据操作"><a href="#12-8-5-在外键约束下的数据操作" class="headerlink" title="12.8.5. 在外键约束下的数据操作"></a>12.8.5. 在外键约束下的数据操作</h4><ul>
<li><strong>外键约束设计插入数据的顺序</strong>：先插入主表、再插入副表</li>
<li><strong>外键约束设计更新数据的顺序</strong>：先修改从表的外键数据，再修改主表的主键数据。</li>
<li><strong>外键约束设计删除数据的顺序</strong>：先修改从表的外键数据，再修改主表的主键数据。</li>
</ul>
<h4 id="12-8-6-删除外键约束"><a href="#12-8-6-删除外键约束" class="headerlink" title="12.8.6. 删除外键约束"></a>12.8.6. 删除外键约束</h4><p>当一个表中不需要外键约束时，就需要从表中将其删除。外键一旦删除，就会解除主表和从表间的关联关系。语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">drop</span> <span class="keyword">foreign key</span> 外键约束名;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> emp2 <span class="keyword">drop</span> <span class="keyword">foreign key</span> dept_id_fk;</span><br></pre></td></tr></table></figure>
<h4 id="12-8-7-级联操作"><a href="#12-8-7-级联操作" class="headerlink" title="12.8.7. 级联操作"></a>12.8.7. 级联操作</h4><p>在修改和删除主表的主键值时，同时更新或删除从表的外键值，称为级联操作。具体的删除/更新行为有以下几种:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>行为</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>NO ACTION</code></td>
<td>当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新。(与<code>RESTRICT</code>一致)默认行为</td>
</tr>
<tr>
<td><code>RESTRICT</code></td>
<td>当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新。(与<code>NO ACTION</code>一致)默认行为</td>
</tr>
<tr>
<td><code>CASCADE</code></td>
<td>当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有，则也删除/更新外键在子表中的记录。</td>
</tr>
<tr>
<td><code>SET NULL</code></td>
<td>当在父表中删除对应记录时，首先检查该记录是否有对应外键，如果有则设置子表中该外键值为null（这就要求该外键允许取null）。</td>
</tr>
<tr>
<td><code>SET DEFAULT</code></td>
<td>父表有变更时，子表将外键列设置成一个默认的值 (Innodb不支持)</td>
</tr>
</tbody>
</table>
</div>
<h5 id="12-8-7-1-CASCADE"><a href="#12-8-7-1-CASCADE" class="headerlink" title="12.8.7.1. CASCADE"></a>12.8.7.1. CASCADE</h5><p><code>CASCADE</code> 外键级联操作(更新和删除)的语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constraint</span> <span class="keyword">foreign key</span>(外键名) <span class="keyword">references</span> 主表(主键名) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>级联更新</strong>：更新主表的主键值时自动更新从表的相关的外键值，关键字：<code>on update cascade</code></li>
<li><strong>级联删除</strong>：删除主表的主键的记录时自动删除从表中的相关的数据，关键字：<code>on delete cascade</code>。<strong>实际开发中，级联删除不常用，需要谨慎使用</strong></li>
</ul>
<p>测试将修改父表id为1的记录修改为6，</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004181.png" alt=""></p>
<p>原来在子表中 dept_id 值为1的记录都修改为6了，这就是cascade级联更新</p>
<blockquote>
<p>Tips: <strong>在一般的业务系统中，不会修改一张表的主键值。</strong></p>
</blockquote>
<p>测试删除父表id为6的记录</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004101.png" alt=""></p>
<p>父表的数据删除成功了，相应子表中关联的记录也被级联删除了。</p>
<h5 id="12-8-7-2-SET-NULL"><a href="#12-8-7-2-SET-NULL" class="headerlink" title="12.8.7.2. SET NULL"></a>12.8.7.2. SET NULL</h5><p><code>SET NULL</code> 外键级联操作(更新和删除)的语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constraint</span> <span class="keyword">foreign key</span>(外键名) <span class="keyword">references</span> 主表(主键名) <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">set</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>级联更新</strong>：更新主表的主键值时自动更新从表的相关的外键值，关键字：<code>on update set null</code></li>
<li><strong>级联删除</strong>：删除主表的主键的记录时自动删除从表中的相关的数据，关键字：<code>on delete set null</code>。</li>
</ul>
<p>测试删除主表id为1的数据</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004797.png" alt=""></p>
<p>主表的记录是可以正常的删除，而子表 emp 的 dept_id 字段，原来 dept_id 为 1 的数据，现在都被置为NULL了。</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251004169.png" alt=""></p>
<p>以上就是 <code>SET NULL</code> 这种删除/更新行为的级联效果。</p>
<h1 id="13-MySQL-扩展内容"><a href="#13-MySQL-扩展内容" class="headerlink" title="13. MySQL 扩展内容"></a>13. MySQL 扩展内容</h1><h3 id="13-1-系统变量"><a href="#13-1-系统变量" class="headerlink" title="13.1. 系统变量"></a>13.1. 系统变量</h3><h4 id="13-1-1-简介"><a href="#13-1-1-简介" class="headerlink" title="13.1.1. 简介"></a>13.1.1. 简介</h4><p>系统变量又分为<strong>全局变量</strong>与<strong>会话变量</strong></p>
<ul>
<li>全局变量在MYSQL启动的时候由服务器自动将它们初始化为默认值，这些默认值可以通过更改<code>my.ini</code>这个文件来更改。</li>
<li>会话变量在每次建立一个新的连接的时候，由MYSQL来初始化。MYSQL会将当前所有全局变量的值复制一份。来做为会话变量。也就是说，如果在建立会话以后，没有手动更改过会话变量与全局变量的值，那所有这些变量的值都是一样的。</li>
</ul>
<p>全局变量与会话变量的区别就在于，对全局变量的修改会影响到整个服务器，但是对会话变量的修改，只会影响到当前的会话（也就是当前的数据库连接）。</p>
<p>有些系统变量的值是可以利用语句来动态进行更改的，但是有些系统变量的值却是只读的，对于那些可以更改的系统变量，可以利用<code>set</code>语句进行更改。</p>
<h4 id="13-1-2-系统变量-全局变量"><a href="#13-1-2-系统变量-全局变量" class="headerlink" title="13.1.2. 系统变量-全局变量"></a>13.1.2. 系统变量-全局变量</h4><p>由系统提供，在整个数据库有效。</p>
<p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="variable">@global</span>.全局变量名称</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看全局变量</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables;</span><br><span class="line"><span class="comment">-- 查看某全局变量</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@global</span>.auto_increment_increment;</span><br><span class="line"><span class="comment">-- 修改全局变量的值</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> sort_buffer_size <span class="operator">=</span> <span class="number">40000</span>;</span><br><span class="line"><span class="keyword">set</span> @<span class="variable">@global</span>.sort_buffer_size <span class="operator">=</span> <span class="number">40000</span>;</span><br></pre></td></tr></table></figure>
<h4 id="13-1-3-系统变量-会话变量"><a href="#13-1-3-系统变量-会话变量" class="headerlink" title="13.1.3. 系统变量-会话变量"></a>13.1.3. 系统变量-会话变量</h4><p>由系统提供，当前会话（连接）有效</p>
<p>语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="variable">@session</span>.会话变量名称</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看会话变量</span></span><br><span class="line"><span class="keyword">show</span> session variables;</span><br><span class="line"><span class="comment">-- 查看某会话变量</span></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@session</span>.auto_increment_increment;</span><br><span class="line"><span class="comment">-- 修改会话变量的值</span></span><br><span class="line"><span class="keyword">set</span> session sort_buffer_size <span class="operator">=</span> <span class="number">50000</span>;</span><br><span class="line"><span class="keyword">set</span> @<span class="variable">@session</span>.sort_buffer_size <span class="operator">=</span> <span class="number">50000</span>;</span><br></pre></td></tr></table></figure>
<h3 id="13-2-MySQL-的-pymysql-操作"><a href="#13-2-MySQL-的-pymysql-操作" class="headerlink" title="13.2. MySQL 的 pymysql 操作"></a>13.2. MySQL 的 pymysql 操作</h3><p>PyMySQL 是一个纯 Python 实现的 MySQL 客户端库，支持兼容 Python 3，用于代替 MySQLdb。</p>
<h4 id="13-2-1-查询示例"><a href="#13-2-1-查询示例" class="headerlink" title="13.2.1. 查询示例"></a>13.2.1. 查询示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取MySQL连接</span></span><br><span class="line">conn = pymysql.connect(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">3306</span>, user=<span class="string">&#x27;root&#x27;</span>,password=<span class="string">&#x27;123456&#x27;</span>,database=<span class="string">&#x27;mydb17_pymysql&#x27;</span>, charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取游标</span></span><br><span class="line">cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行SQL语句，返回值就是SQL语句在执行过程中影响的行数</span></span><br><span class="line">sql = <span class="string">&quot;select * from student;&quot;</span></span><br><span class="line"></span><br><span class="line">row_count = cursor.execute(sql)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;SQL 语句执行影响的行数%d&quot;</span> % row_count)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出结果集中一行,返回的结果是一行</span></span><br><span class="line"><span class="comment"># print(cursor.fetchone())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出结果集中的所有数据,返回一行数据</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> cursor.fetchall():</span><br><span class="line">    <span class="built_in">print</span>(line)</span><br><span class="line"><span class="comment"># 关闭游标</span></span><br><span class="line">cursor.close()</span><br><span class="line"><span class="comment"># 关闭连接</span></span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<h4 id="13-2-2-增删改示例"><a href="#13-2-2-增删改示例" class="headerlink" title="13.2.2. 增删改示例"></a>13.2.2. 增删改示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取MySQL连接</span></span><br><span class="line">conn = pymysql.connect(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">3306</span>, user=<span class="string">&#x27;root&#x27;</span>,password=<span class="string">&#x27;123456&#x27;</span>,database=<span class="string">&#x27;mydb17_pymysql&#x27;</span>, charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取游标</span></span><br><span class="line">cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment">#插入数据</span></span><br><span class="line"><span class="comment"># sql = &quot;insert into student values(%s,%s,%s)&quot;</span></span><br><span class="line"><span class="comment"># data = (4, &#x27;晁盖&#x27;, 34)</span></span><br><span class="line"><span class="comment"># cursor.execute(sql, data)  #sql和data之间以&quot;,&quot;隔开</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改数据</span></span><br><span class="line"><span class="comment"># sql = &quot;update student set sname=%s where sid=%s&quot;</span></span><br><span class="line"><span class="comment"># data = (&#x27;李逵&#x27;, 4)</span></span><br><span class="line"><span class="comment"># cursor.execute(sql, data)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除数据</span></span><br><span class="line">sql = <span class="string">&quot;delete from student where sid=%s&quot;</span></span><br><span class="line">data = (<span class="number">4</span>)</span><br><span class="line">cursor.execute(sql, data)</span><br><span class="line"></span><br><span class="line">conn.commit()   <span class="comment"># 提交，不然无法保存插入或者修改的数据(这个一定不要忘记加上)</span></span><br><span class="line"><span class="comment"># 关闭游标</span></span><br><span class="line">cursor.close()</span><br><span class="line"><span class="comment"># 关闭连接</span></span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<h3 id="13-3-MySQL-数据库的伪表-DUAL"><a href="#13-3-MySQL-数据库的伪表-DUAL" class="headerlink" title="13.3. MySQL 数据库的伪表 DUAL"></a>13.3. MySQL 数据库的伪表 DUAL</h3><p>与 Oracle 数据库的伪表 DUAL 一样的用法</p>
<h3 id="13-4-在-Unix-和-MySQL-时间戳之间进行转换"><a href="#13-4-在-Unix-和-MySQL-时间戳之间进行转换" class="headerlink" title="13.4. 在 Unix 和 MySQL 时间戳之间进行转换"></a>13.4. 在 Unix 和 MySQL 时间戳之间进行转换</h3><ul>
<li><code>UNIX_TIMESTAMP</code> 是从 MySQL 时间戳转换为 Unix 时间戳的命令</li>
<li><code>FROM_UNIXTIME</code> 是从 Unix 时间戳转换为 MySQL 时间戳的命令</li>
</ul>
<h3 id="13-5-MySQL-fetch-array-和-MySQL-fetch-object-的区别"><a href="#13-5-MySQL-fetch-array-和-MySQL-fetch-object-的区别" class="headerlink" title="13.5. MySQL_fetch_array 和 MySQL_fetch_object 的区别"></a>13.5. MySQL_fetch_array 和 MySQL_fetch_object 的区别</h3><ul>
<li><code>MySQL_fetch_array</code> – 将结果行作为关联数组或来自数据库的常规数组返回。</li>
<li><code>MySQL_fetch_object</code> – 从数据库返回结果行作为对象。</li>
</ul>
<h3 id="13-6-如何存储-IP-地址（待整理）"><a href="#13-6-如何存储-IP-地址（待整理）" class="headerlink" title="13.6. 如何存储 IP 地址（待整理）"></a>13.6. 如何存储 IP 地址（待整理）</h3><ol>
<li>使用字符串。此方式无法使用范围查询。</li>
<li>使用无符号整型。只占用 4 个字节的空间，并且此方式可以支持范围查询，传统的 IP 地址使用 <code>INET_ATON()</code> 和 <code>INET_NTOA()</code>；ipv6 使用 <code>INET6_ATON()</code> 和 <code>INET6_NTOA()</code>。</li>
</ol>
<h3 id="13-7-SQL-注入"><a href="#13-7-SQL-注入" class="headerlink" title="13.7. SQL 注入"></a>13.7. SQL 注入</h3><p>SQL 注入产生的原因：程序开发过程中不注意规范书写 sql 语句和对特殊字符进行过滤，导致客户端可以通过全局变量 POST 和 GET 提交一些 sql 语句正常执行。</p>
<p>防止 SQL 注入的方案：</p>
<ul>
<li>开启 MySQL 配置文件中的 magic_quotes_gpc 和 magic_quotes_runtime 设置。</li>
<li>Sql 语句书写尽量不要省略双引号和单引号。</li>
<li>在程序中过滤掉 sql 语句中的一些关键词。如：<code>update</code>、<code>insert</code>、<code>delete</code>、<code>select</code>、<code>*</code> 等。</li>
<li>执行 sql 语句时使用 <code>addslashes()</code> 进行 sql 语句转换。</li>
<li>提高数据库表和字段的命名技巧，对一些重要的字段根据程序的特点命名，不易被攻击者猜中。</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://ktzxy.github.io">蓝桉</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://ktzxy.github.io/posts/bce68613.html">https://ktzxy.github.io/posts/bce68613.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://ktzxy.github.io" target="_blank">蓝桉`Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post-share"><div class="social-share" data-image="/bg/Image00026.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><link rel="stylesheet" href="/css/coin/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">不给糖果就捣蛋</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.webp" target="_blank"><img class="post-qr-code-img" src="/img/wechat.webp" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.webp" target="_blank"><img class="post-qr-code-img" src="/img/alipay.webp" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></button></div><audio id="coinAudio" src="https://cdn.cbd.int/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin/coin.js"></script><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/663d5908.html" title="Ubuntu在线安装mysql"><img class="cover" src="/bg/Image00013.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Ubuntu在线安装mysql</div></div><div class="info-2"><div class="info-item-1">添加 APT 仓库 访问 https://dev.mysql.com/downloads/repo/apt/。  选择下载适合自己平台的 deb 包。  执行下面的命令，安装下载的软件包。   1sudo dpkg -i /PATH/version-specific-package-name.deb 用下载的包的名称替换掉 version-specific-package-name.deb。  在安装期间，需要选择 mysql server 和组件的版本。不能确定版本，就不要改变默认版本。如果不想安装某一个组件，就选择 none。选择完毕后，选择 ok 就可以完成安装。  安装完成以后也可以通过选择发行版本，修改 mysql 版本。  可以用下边的命令更新包。  1apt-get update 除了利用发行的 deb 包，还可以人工自己添加 APT 仓库。详见 https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-repo-manual-setup 注意：MYSQL APT 仓...</div></div></div></a><a class="pagination-related" href="/posts/582aa787.html" title="MySQL准备知识"><img class="cover" src="/bg/Image00003.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">MySQL准备知识</div></div><div class="info-2"><div class="info-item-1">番外篇1. MySQL目录结构windows版本 bin：存放可执行文件，比如MySQL.exe data：存储的是MySQL默认的数据库 include：存放的C语言的头文件 lib：存放的C++的动态链接库 my.ini：数据库的配置文件  2. 启动 MySQL 服务器程序的相关可执行文件启动 MySOL 服务器程序的可执行文件有很多，大多在 MySQL 安装目录的 bin 目录下。 mysqld（不常用） mysqld 这个可执行文件就代表着 MySOL 服务器程序，运行这个可执行文件就可以直接启动一个服务器进程。  mysqld_safe mysqld_safe是一个启动脚本，它会间接的调用mysqld，而且还顺便启动了另外一个监控进程，这个监控进程在服务器进程挂了的时候，可以帮助重启它。 除外，使用mysqld_safe启动服务器程序时，它会将服务器程序的出错信息和其他诊断信息重定向到某个文件中，产生出错日志，方便找出发生错误的原因。  mysql.servermysql.server也是一个启动脚本，它会间接的调用mysqld_safe。需要注意的是，这个mysql...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/a318ca1f.html" title="MySQL数据库150道高频面试题"><img class="cover" src="/bg/Image00018.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">MySQL数据库150道高频面试题</div></div><div class="info-2"><div class="info-item-1">[toc] 1. Mysql 索引1.1. Mysql如何实现的索引机制？MySQL中索引分三类：B+树索引、Hash索引、全文索引 1.1.1. InnoDB索引与MyISAM索引实现的区别是什么？ MyISAM的索引方式都是非聚簇的，与InnoDB包含1个聚簇索引是不同的。 在InnoDB存储引擎中，我们只需要根据主键值对聚簇索引进行一次查找就能找到对应的记录，而在MyISAM中却需要进行一次回表操作，意味着MyISAM中建立的索引相当于全部都是二级索引。 InnoDB的数据文件本身就是索引文件，而MyISAM索引文件和数据文件是分离的 ，索引文件仅保存数据记录的地址。 MyISAM的表在磁盘上存储在以下文件中：  *.sdi（描述表结构）、*.MYD（数据），*.MYI（索引） InnoDB的表在磁盘上存储在以下文件中： .ibd（表结构、索引和数据都存在一起）   InnoDB的非聚簇索引data域存储相应记录主键的值 ，而MyISAM索引记录的是地址 。换句话说，InnoDB的所有非聚簇索引都引用主键作为data域。 MyISAM的回表操作是十分快速的，因为是拿着地址偏...</div></div></div></a><a class="pagination-related" href="/posts/8f9b37aa.html" title="技术同学必会的MySQL设计规约"><img class="cover" src="/bg/Image00014.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">技术同学必会的MySQL设计规约</div></div><div class="info-2"><div class="info-item-1">在我们对数据库技术方案设计的时候，我们是否有自己的设计理念或者原则，还是更多的依据自己的直觉去设计，是否曾经懊悔线上发生过的一次低级故障，可能稍微注意点就可以避免，是否想过怎么才能很好的避免，下面规范的价值正是我们工作的检查清单，需要我们不断从错误中积累有效经验来指导未来的工作。以下规范在大型互联网公司经过了充分的验证，尤其适用于并发量大、数据量大的业务场景。先介绍的是安全规范，因为安全无小事，很多公司都曾经因为自己的数据泄露导致用户的惨痛损失，所以将安全规范放到了第一位。﻿ 一、安全规范1.【强制】禁止在数据库中存储明文密码，需把密码加密后存储 说明：对于加密操作建议由公司的中间件团队基于如mybatis的扩展，提供统一的加密算法及密钥管理，避免每个业务线单独开发一套，同时也与具体的业务进行了解耦 2.【强制】禁止在数据库中明文存储用户敏感信息，如手机号等 说明：对于手机号建议公司搭建统一的手机号查询服务，避免在每个业务线单独存储 3.【强制】禁止开发直接给业务同学导出或者查询涉及到用户敏感信息的数据，如需要需上级领导审批 4.【强制】涉及到导出数据功能的操作，如包含敏感字段都...</div></div></div></a><a class="pagination-related" href="/posts/dfdfdf4.html" title="数据库概述"><img class="cover" src="/bg/Image00002.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">数据库概述</div></div><div class="info-2"><div class="info-item-1">1. 数据库技术1.1. 概述数据库（DB）是一个以某种组织方式存储在磁盘上的数据的集合。简单理解就是用来存储数据的仓库。  数据库 DataBase（DB）：存储数据的仓库，数据是有组织的进行存储。 数据库管理系统 DataBase Management System (DBMS)：操纵和管理数据库的大型软件。  1.2. 数据库的分类  1.3. 不同的数据存储方式数据存储在集合（内存）中  优点：读写速度快 缺点：不能永久存储  数据存储在文件中  优点：可以永久存储 缺点：频繁的IO操作效率低，查询数据很不方便。  数据存储在数据库中  优点：可以永久存储。查询速度快，查询数据很方便 缺点：要使用 SQL 语言执行增删改查操作  2. 关系型数据库 关系型数据库 - 百度百科  2.1. 概念关系型数据库，是指采用了关系模型来组织数据的数据库，其以行和列的形式存储数据，以便于用户理解，关系型数据库这一系列的行和列被称为表，一组表组成了数据库。用户通过查询来检索数据库中的数据，而查询是一个用于限定数据库中某些区域的执行代码。关系模型可以简单理解为二维表格模型，而一个关系型数...</div></div></div></a><a class="pagination-related" href="/posts/75522c08.html" title="第4节-布隆过滤器"><img class="cover" src="/bg/Image00003.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">第4节-布隆过滤器</div></div><div class="info-2"><div class="info-item-1">第4节-布隆过滤器BloomFilter面试题： 现有50亿个电话号码，选定其中10w个电话号码，如何要快速准确的判断这些号码是否已经存在？ 思路：  1、通过数据库查询———-实现快速有点难。  2、数据预放到内存集合中：50亿*8字节大约40G，内存太大了。 1、布隆过滤器是什么？它实际上==是一个很长的二进制数组+一系列随机hash算法映射函数，主要用于判断一个元素是否在集合中==。 通常我们会遇到很多要判断一个元素是否在某个集合中的业务场景，一般想到的是将集合中所有元素保存起来，然后通过比较确定。 链表、树、散列表（又叫哈希表，Hash table）等等数据结构都是这种思路。 但是随着集合中元素的增加，我们需要的存储空间也会呈现线性增长，最终达到瓶颈。 同时检索速度也越来越慢，上述三种结构的检索时间复杂度分别为O(n),O(logn),O(1)。这个时候，布隆过滤器（Bloom Filter）就应运而生  一句话概述：由一个初值为零的bit数组和多个哈希函数构成，用来快速判断某个数据是否存在。 本质就是判断具体元素存不存在一个大的集合中。 布隆过滤器是一种类似set的数据...</div></div></div></a><a class="pagination-related" href="/posts/e4cd3c5b.html" title="第5节-缓存预热+缓存雪崩+缓存击穿+缓存穿透"><img class="cover" src="/bg/Image00008.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">第5节-缓存预热+缓存雪崩+缓存击穿+缓存穿透</div></div><div class="info-2"><div class="info-item-1">第5节-缓存预热+缓存雪崩+缓存击穿+缓存穿透1、缓存雪崩发生情况： ​    redis主机挂了，redis全盘崩溃，比如缓存中有大量数据同时过期。 解决方案：  redis缓存集群实现高可用，主从+哨兵|| redis cluster ehcache本地缓存 + hystrix 或者 阿里sentinel限流&amp;降级 开启Redis持久化机制/aof+rdb，尽快恢复缓存集群 2、缓存穿透 什么是缓存穿透  请求去查询一条记录，先redis后mysql发现，都查不到该条记录，但是每次请求都会打到数据库上面去，导致后台数据库压力暴增，这种现象我们称为缓存穿透，redis成为了一个摆设。 简单说就是，本来无一物，即不再redis中，也不在mysql中。  危害  数据库可能会被打崩。导致服务不可用。 第一次来查询后，一般我们会有回写redis机制， 第二次来查询的时候redis就有了，偶尔出现穿透现象一般情况无关紧要。  解决方案   1、返回空对象缓存或者缺省值 一般OK  但是存在黑客和恶意攻击情况 黑客会对你的系统进行攻击，拿到一个不存在的id，去查询数据，会产生大量...</div></div></div></a><a class="pagination-related" href="/posts/41ae0132.html" title="MongoDB-基础"><img class="cover" src="/bg/Image00026.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">MongoDB-基础</div></div><div class="info-2"><div class="info-item-1">1. MongoDb 概述MongoDB 是一个跨平台的，面向文档的数据库，是当前 NoSQL 数据库产品中最热门的一种。它介于关系数据库和非关系数据库之间，是非关系数据库当中功能最丰富，最像关系数据库的产品。它支持的数据结构非常松散，是类似 JSON 的 BSON 格式，因此可以存储比较复杂的数据类型。 1.1. MongoDB 特点MongoDB 最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。它是一个面向集合的，模式自由的文档型数据库，具体特点总结如下：  面向集合存储，易于存储对象类型的数据 模式自由 支持动态查询 支持完全索引，包含内部对象 支持复制和故障恢复 使用高效的二进制数据存储，包括大型对象（如视频等） 自动处理碎片，以支持云计算层次的扩展性 支持 Python，PHP，Ruby，Java，C，C#，Javascript，Perl 及 C++语言的驱动程序，社区中也提供了对 Erlang 及.NET 等平台的驱动程序 文件存储格式为 BSON（一种 JSON 的...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">蓝桉</div><div class="author-info-description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">生活、学习、技术</b>相关的问题和看法，还有<b style="color:#fff">文章教程</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">264</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">37</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ktzxy"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon faa-parent animated-hover" href="https://github.com/ktzxy" target="_blank" title="Github"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=2251511764@qq.com" target="_blank" title="Email"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-youxiang"></use></svg></a><a class="social-icon faa-parent animated-hover" href="/atom.xml" target="_blank" title="RSS"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-RSS"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/496148176" target="_blank" title="BiliBili"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QX-BILIBILI"></use></svg></a><a class="social-icon faa-parent animated-hover" href="tencent://Message/?Uin=2251511764&amp;amp;websiteName=local.edu.com:8888=&amp;amp;Menu=yes" target="_blank" title="QQ"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QQ"></use></svg></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E7%89%88%E6%9C%AC%E5%88%86%E7%B1%BB"><span class="toc-number">1.</span> <span class="toc-text">1.1. 版本分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E7%89%88%E6%9C%AC%E5%8F%B7"><span class="toc-number">2.</span> <span class="toc-text">1.2. 版本号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E6%9F%A5%E8%AF%A2%E5%BD%93%E5%89%8D-MySQL-%E7%9A%84%E7%89%88%E6%9C%AC"><span class="toc-number">3.</span> <span class="toc-text">1.3. 查询当前 MySQL 的版本</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%8A%E5%85%B6%E6%A6%82%E5%BF%B5"><span class="toc-number"></span> <span class="toc-text">2.常见数据库及其概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number"></span> <span class="toc-text">3.数据完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%AE%9E%E4%BD%93%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">0.1.</span> <span class="toc-text">3.1 实体完整性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%9F%9F%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">0.2.</span> <span class="toc-text">3.2 域完整性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%BC%95%E7%94%A8%E5%AE%8C%E6%95%B4%E6%80%A7%EF%BC%88%E5%8F%82%E7%85%A7%E5%AE%8C%E6%95%B4%E6%80%A7%EF%BC%89"><span class="toc-number">0.3.</span> <span class="toc-text">3.3 引用完整性（参照完整性）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-SQL%E8%AF%AD%E5%8F%A5%E5%88%86%E7%B1%BB%EF%BC%9A"><span class="toc-number"></span> <span class="toc-text">4.SQL语句分类：</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number"></span> <span class="toc-text">5.数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B"><span class="toc-number">0.1.</span> <span class="toc-text">1. 数值类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E6%95%B4%E5%9E%8B%E7%B1%BB%E5%9E%8B%E7%9A%84%E9%95%BF%E5%BA%A6%E8%AE%BE%E7%BD%AE"><span class="toc-number">0.1.1.</span> <span class="toc-text">1.1. 整型类型的长度设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-Decimal-%E7%B1%BB%E5%9E%8B%E5%92%8C-Float%E3%80%81Double-%E7%AD%89%E5%8C%BA%E5%88%AB"><span class="toc-number">0.1.2.</span> <span class="toc-text">1.2. Decimal 类型和 Float、Double 等区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-number">0.2.</span> <span class="toc-text">2.字符串类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-char-%E5%92%8C-vachar-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">0.2.1.</span> <span class="toc-text">2.1. char 和 vachar 的区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2%E5%AD%97%E7%AC%A6%E4%B8%AD%E7%9A%84%E5%88%86%E9%9A%94%E5%AD%97%E7%AC%A6%E5%A4%84%E7%90%86"><span class="toc-number">0.2.2.</span> <span class="toc-text">2.2字符中的分隔字符处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-BLOB-%E5%92%8C-TEXT-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">0.2.3.</span> <span class="toc-text">2.3. BLOB 和 TEXT 的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-number">0.3.</span> <span class="toc-text">3.日期时间类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B%E4%BC%98%E5%85%88%E7%BA%A7%E9%80%89%E6%8B%A9"><span class="toc-number">0.4.</span> <span class="toc-text">4.字段类型优先级选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%85%B3%E4%BA%8E-Null-%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%89%B9%E5%88%AB%E8%AF%B4%E6%98%8E"><span class="toc-number">0.5.</span> <span class="toc-text">5. 关于 Null 类型的特别说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%9E%9A%E4%B8%BE%E5%92%8C%E9%9B%86%E5%90%88"><span class="toc-number">0.6.</span> <span class="toc-text">6.枚举和集合</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-SQL%E8%AF%AD%E5%8F%A5"><span class="toc-number"></span> <span class="toc-text">6.SQL语句</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B9%B6%E6%96%AD%E5%BC%80%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.</span> <span class="toc-text">6.1 连接到服务器并断开与服务器的连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-DDL-%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80"><span class="toc-number">2.</span> <span class="toc-text">6.2 DDL:数据定义语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%93%E6%93%8D%E4%BD%9C%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">库操作：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.</span> <span class="toc-text">表操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-DML-%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C%E8%AF%AD%E8%A8%80"><span class="toc-number">3.</span> <span class="toc-text">6.3 DML:数据操作语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-DCL-%E6%95%B0%E6%8D%AE%E6%8E%A7%E5%88%B6%E8%AF%AD%E8%A8%80"><span class="toc-number">4.</span> <span class="toc-text">6.4 DCL:数据控制语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-DQL-%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-number">5.</span> <span class="toc-text">6.5 DQL:数据查询语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F"><span class="toc-number">5.1.</span> <span class="toc-text">查询语法格式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SELECT-%E8%AF%AD%E6%B3%95"><span class="toc-number">5.1.1.</span> <span class="toc-text">SELECT 语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SELECT-INTO-%E8%AF%AD%E6%B3%95"><span class="toc-number">5.1.2.</span> <span class="toc-text">SELECT INTO 语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE-select"><span class="toc-number">5.2.</span> <span class="toc-text">查询数据 select</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E5%88%97"><span class="toc-number">5.2.1.</span> <span class="toc-text">查询所有列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%8C%87%E5%AE%9A%E5%88%97"><span class="toc-number">5.2.2.</span> <span class="toc-text">查询指定列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%97%B6%E6%8C%87%E5%AE%9A%E5%88%97%E7%9A%84%E5%88%AB%E5%90%8D"><span class="toc-number">5.2.3.</span> <span class="toc-text">查询时指定列的别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E5%88%97%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.2.4.</span> <span class="toc-text">合并列查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%97%B6%E6%B7%BB%E5%8A%A0%E5%B8%B8%E9%87%8F%E5%88%97"><span class="toc-number">5.2.5.</span> <span class="toc-text">查询时添加常量列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%BB%E9%99%A4%E9%87%8D%E5%A4%8D%E6%95%B0%E6%8D%AE"><span class="toc-number">5.2.6.</span> <span class="toc-text">去除重复数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2-where"><span class="toc-number">5.3.</span> <span class="toc-text">条件查询 where</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-number">5.3.1.</span> <span class="toc-text">基础语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MySQL%E6%94%AF%E6%8C%814%E7%A7%8D%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">5.3.2.</span> <span class="toc-text">MySQL支持4种运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">5.3.3.</span> <span class="toc-text">算术运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">5.3.4.</span> <span class="toc-text">比较运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#null-%E5%92%8C%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97"><span class="toc-number">5.3.4.1.</span> <span class="toc-text">null 和空字符串的比较运算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%EF%BC%9Alike"><span class="toc-number">5.3.4.2.</span> <span class="toc-text">模糊查询：like</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%EF%BC%9Ain"><span class="toc-number">5.3.4.3.</span> <span class="toc-text">模糊查询：in</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%A9%E5%B1%95-%E8%A1%8C%E8%A1%8C%E6%AF%94%E8%BE%83%EF%BC%88SQL-92%EF%BC%89"><span class="toc-number">5.3.4.4.</span> <span class="toc-text">扩展 - 行行比较（SQL-92）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">5.3.5.</span> <span class="toc-text">逻辑运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6-%E4%BA%86%E8%A7%A3"><span class="toc-number">5.3.6.</span> <span class="toc-text">位运算符(了解)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2-order-by"><span class="toc-number">5.4.</span> <span class="toc-text">排序查询 order by</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A5%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%88%97%E5%90%8D%E6%8E%92%E5%BA%8F"><span class="toc-number">5.4.1.</span> <span class="toc-text">以表中的列名排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A5-select-%E8%AF%AD%E5%8F%A5%E5%90%8E%E6%8C%87%E5%AE%9A%E7%9A%84%E5%88%97%E5%90%8D%E6%8E%92%E5%BA%8F"><span class="toc-number">5.4.2.</span> <span class="toc-text">以 select 语句后指定的列名排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#order-by-%E6%8E%92%E5%BA%8F%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86"><span class="toc-number">5.4.3.</span> <span class="toc-text">order by 排序内部原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.5.</span> <span class="toc-text">聚合查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%8E%E8%AF%AD%E6%B3%95"><span class="toc-number">5.5.1.</span> <span class="toc-text">定义与语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">5.5.2.</span> <span class="toc-text">常用的聚合函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.5.3.</span> <span class="toc-text">聚合查询示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2%E5%AF%B9-NULL-%E5%80%BC%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">5.5.4.</span> <span class="toc-text">聚合查询对 NULL 值的处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2-limit"><span class="toc-number">5.6.</span> <span class="toc-text">分页查询 limit</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">5.6.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.6.2.</span> <span class="toc-text">分页查询示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E8%AE%A1%E7%AE%97%E8%A7%84%E5%BE%8B%E6%80%BB%E7%BB%93"><span class="toc-number">5.6.3.</span> <span class="toc-text">分页计算规律总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2-group-by"><span class="toc-number">5.7.</span> <span class="toc-text">分组查询 group by</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99"><span class="toc-number">5.7.1.</span> <span class="toc-text">语法规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89-having"><span class="toc-number">5.7.2.</span> <span class="toc-text">分组条件筛选 (having)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#where-%E5%92%8C-having-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">5.7.3.</span> <span class="toc-text">where 和 having 的区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#with-rollup-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">5.7.4.</span> <span class="toc-text">with rollup 关键字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GROUP-BY-%E4%BD%BF%E7%94%A8%E8%A7%84%E5%AE%9A"><span class="toc-number">5.7.5.</span> <span class="toc-text">GROUP BY 使用规定</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">5.8.</span> <span class="toc-text">正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99-1"><span class="toc-number">5.8.1.</span> <span class="toc-text">语法规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.8.2.</span> <span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%EF%BC%88select%EF%BC%89%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E5%88%86%E6%9E%90"><span class="toc-number">5.9.</span> <span class="toc-text">查询（select）语句执行顺序分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E8%AF%B4%E6%98%8E"><span class="toc-number">5.9.1.</span> <span class="toc-text">执行顺序说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E8%BF%87%E7%A8%8B"><span class="toc-number">5.9.2.</span> <span class="toc-text">验证过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D"><span class="toc-number">6.</span> <span class="toc-text">6.6 备份与恢复</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%AD%97%E7%AC%A6%E9%9B%86%E7%BC%96%E7%A0%81"><span class="toc-number"></span> <span class="toc-text">7.字符集编码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E5%AD%97%E7%AC%A6%E9%9B%86%E6%A6%82%E8%BF%B0"><span class="toc-number">0.1.</span> <span class="toc-text">7.1. 字符集概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-1-%E6%9F%A5%E7%9C%8B%E6%94%AF%E6%8C%81%E7%9A%84%E5%AD%97%E7%AC%A6%E9%9B%86"><span class="toc-number">0.1.1.</span> <span class="toc-text">7.1.1. 查看支持的字符集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-2-Unicode%E3%80%81UTF8-%E5%92%8C-UTF8MB4"><span class="toc-number">0.1.2.</span> <span class="toc-text">7.1.2. Unicode、UTF8 和 UTF8MB4</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%A0%A1%E5%AF%B9%E8%A7%84%E5%88%99-%E6%AF%94%E8%BE%83%E5%92%8C%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99-%EF%BC%88COLLATE%EF%BC%89"><span class="toc-number">0.2.</span> <span class="toc-text">7.2. 校对规则(比较和排序规则)（COLLATE）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2-1-%E6%A6%82%E5%BF%B5"><span class="toc-number">0.2.1.</span> <span class="toc-text">7.2.1. 概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2-2-%E6%9F%A5%E7%9C%8B%E6%94%AF%E6%8C%81%E7%9A%84%E6%A0%A1%E5%AF%B9%E8%A7%84%E5%88%99"><span class="toc-number">0.2.2.</span> <span class="toc-text">7.2.2. 查看支持的校对规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2-3-UTF8MB4-%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99"><span class="toc-number">0.2.3.</span> <span class="toc-text">7.2.3. UTF8MB4 常用的排序规则</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E6%8C%87%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E9%BB%98%E8%AE%A4%E5%AD%97%E7%AC%A6%E9%9B%86%E4%B8%8E%E6%A0%A1%E5%AF%B9%E8%A7%84%E5%88%99"><span class="toc-number">0.3.</span> <span class="toc-text">7.3. 指定数据库的默认字符集与校对规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E6%9F%A5%E7%9C%8B%E4%B8%8E%E4%BF%AE%E6%94%B9%E5%BD%93%E5%89%8D%E5%AD%97%E7%AC%A6%E9%9B%86"><span class="toc-number">0.4.</span> <span class="toc-text">7.4. 查看与修改当前字符集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-1-%E6%9F%A5%E7%9C%8B%E5%AD%97%E7%AC%A6%E9%9B%86"><span class="toc-number">0.4.1.</span> <span class="toc-text">7.4.1. 查看字符集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-2-%E4%BF%AE%E6%94%B9%E5%AD%97%E7%AC%A6%E9%9B%86"><span class="toc-number">0.4.2.</span> <span class="toc-text">7.4.2. 修改字符集</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-%E5%AD%97%E7%AC%A6%E9%9B%86%E7%9A%84%E9%80%89%E6%8B%A9%E5%8E%9F%E5%88%99"><span class="toc-number">0.5.</span> <span class="toc-text">7.5. 字符集的选择原则</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA"><span class="toc-number"></span> <span class="toc-text">8.导入导出</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-MySQL-%E7%9A%84%E5%A4%9A%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-number"></span> <span class="toc-text">9. MySQL 的多表操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E5%A4%9A%E8%A1%A8%E5%85%B3%E7%B3%BB"><span class="toc-number">0.1.</span> <span class="toc-text">9.1. 多表关系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-1-%E4%B8%80%E5%AF%B9%E4%B8%80-1-1"><span class="toc-number">0.1.1.</span> <span class="toc-text">9.1.1. 一对一(1:1)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-2-%E4%B8%80%E5%AF%B9%E5%A4%9A-1-n-%E9%87%8D%E7%82%B9"><span class="toc-number">0.1.2.</span> <span class="toc-text">9.1.2. 一对多(1:n)(重点)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-3-%E5%A4%9A%E5%AF%B9%E5%A4%9A-n-n"><span class="toc-number">0.1.3.</span> <span class="toc-text">9.1.3. 多对多(n:n)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.2.</span> <span class="toc-text">9.2. 多表连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-1-%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E6%A6%82%E8%BF%B0"><span class="toc-number">0.2.1.</span> <span class="toc-text">9.2.1. 多表连接查询概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-2-%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5%E7%B1%BB%E5%9E%8B"><span class="toc-number">0.2.2.</span> <span class="toc-text">9.2.2. 多表连接类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-3-%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="toc-number">0.2.3.</span> <span class="toc-text">9.2.3. 多表连接查询的步骤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%EF%BC%88%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF%EF%BC%89"><span class="toc-number">0.3.</span> <span class="toc-text">9.3. 交叉连接查询（笛卡尔积）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-3-1-%E4%BA%A4%E5%8F%89%E6%9F%A5%E8%AF%A2%E6%A6%82%E8%BF%B0"><span class="toc-number">0.3.1.</span> <span class="toc-text">9.3.1. 交叉查询概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-3-2-%E4%BA%A4%E5%8F%89%E6%9F%A5%E8%AF%A2%E6%A0%BC%E5%BC%8F"><span class="toc-number">0.3.2.</span> <span class="toc-text">9.3.2. 交叉查询格式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2-inner-join-%E2%80%A6%E2%80%A6-on"><span class="toc-number">0.4.</span> <span class="toc-text">9.4. 内连接查询( inner join …… on )</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-1-%E5%86%85%E8%BF%9E%E6%8E%A5%E6%A6%82%E8%BF%B0"><span class="toc-number">0.4.1.</span> <span class="toc-text">9.4.1. 内连接概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-2-%E5%86%85%E8%BF%9E%E6%8E%A5%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F"><span class="toc-number">0.4.2.</span> <span class="toc-text">9.4.2. 内连接语法格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-3-%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">0.4.3.</span> <span class="toc-text">9.4.3. 内连接查询的分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-4-%E5%86%85%E8%BF%9E%E6%8E%A5%E7%9A%84%E9%A9%B1%E5%8A%A8%E8%A1%A8%E4%B8%8E%E8%A2%AB%E9%A9%B1%E5%8A%A8%E8%A1%A8"><span class="toc-number">0.4.4.</span> <span class="toc-text">9.4.4. 内连接的驱动表与被驱动表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-5-%E6%98%BE%E5%BC%8F%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%9A%E4%BD%BF%E7%94%A8-inner-join-%E2%80%A6-on"><span class="toc-number">0.4.5.</span> <span class="toc-text">9.4.5. 显式内连接：使用 inner join … on</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-6-%E9%9A%90%E5%BC%8F%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%9A%E4%BD%BF%E7%94%A8-where-%E5%AD%90%E5%8F%A5%EF%BC%88%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF%E5%86%8D%E8%BF%87%E6%BB%A4%EF%BC%89"><span class="toc-number">0.4.6.</span> <span class="toc-text">9.4.6. 隐式内连接：使用 where 子句（笛卡尔积再过滤）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-7-%E6%89%A9%E5%B1%95%EF%BC%9A%E5%86%85%E8%BF%9E%E6%8E%A53%E4%B8%AA%E4%BB%A5%E4%B8%8A%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">0.4.7.</span> <span class="toc-text">9.4.7. 扩展：内连接3个以上数据表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-%E5%B7%A6-%E5%A4%96-%E8%BF%9E%E6%8E%A5-left-join-%E2%80%A6%E2%80%A6-on"><span class="toc-number">0.5.</span> <span class="toc-text">9.5. 左(外)连接( left join …… on )</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-5-1-%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%A6%82%E8%BF%B0"><span class="toc-number">0.5.1.</span> <span class="toc-text">9.5.1. 左外连接概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-5-2-%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F"><span class="toc-number">0.5.2.</span> <span class="toc-text">9.5.2. 左外连接语法格式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-6-%E5%8F%B3-%E5%A4%96-%E8%BF%9E%E6%8E%A5-right-join-%E2%80%A6%E2%80%A6-on"><span class="toc-number">0.6.</span> <span class="toc-text">9.6. 右(外)连接( right join …… on )</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-6-1-%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%A6%82%E8%BF%B0"><span class="toc-number">0.6.1.</span> <span class="toc-text">9.6.1. 右外连接概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-6-2-%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F"><span class="toc-number">0.6.2.</span> <span class="toc-text">9.6.2. 右外连接语法格式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-7-%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%BF%87%E6%BB%A4%E6%9D%A1%E4%BB%B6-on-%E4%B8%8E-where-%E7%9A%84%E5%8C%BA%E5%88%AB%E6%80%BB%E7%BB%93"><span class="toc-number">0.7.</span> <span class="toc-text">9.7. 连接查询的过滤条件 on 与 where 的区别总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-8-%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.8.</span> <span class="toc-text">9.8. 自连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-8-1-%E8%87%AA%E5%85%B3%E8%81%94%E8%A1%A8%E6%A6%82%E8%BF%B0"><span class="toc-number">0.8.1.</span> <span class="toc-text">9.8.1. 自关联表概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-8-2-%E8%87%AA%E5%85%B3%E8%81%94%E8%A1%A8%E6%A0%BC%E5%BC%8F%EF%BC%88%E5%88%9B%E5%BB%BA%E5%A4%96%E9%94%AE%EF%BC%89"><span class="toc-number">0.8.2.</span> <span class="toc-text">9.8.2. 自关联表格式（创建外键）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-8-3-%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">0.8.3.</span> <span class="toc-text">9.8.3. 自连接查询的概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-8-4-%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-number">0.8.4.</span> <span class="toc-text">9.8.4. 自连接查询的格式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-9-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2-UNION-ALL"><span class="toc-number">0.9.</span> <span class="toc-text">9.9. 联合查询 UNION [ALL]</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-9-1-%E6%A6%82%E8%BF%B0"><span class="toc-number">0.9.1.</span> <span class="toc-text">9.9.1. 概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-9-2-%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">0.9.2.</span> <span class="toc-text">9.9.2. 基础使用示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-9-3-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">0.9.3.</span> <span class="toc-text">9.9.3. 联合查询注意事项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-9-4-union-%E4%B8%8E-union-all-%E5%8C%BA%E5%88%AB"><span class="toc-number">0.9.4.</span> <span class="toc-text">9.9.4. union 与 union all 区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-10-%E5%85%A8%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%EF%BC%88MySql-%E6%9A%82%E4%B8%8D%E6%94%AF%E6%8C%81%EF%BC%8COracle-%E6%94%AF%E6%8C%81%E3%80%81%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">0.10.</span> <span class="toc-text">9.10. 全外连接查询（MySql 暂不支持，Oracle 支持、了解）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-10-1-full-join-%E8%AF%AD%E6%B3%95%E5%AE%9A%E4%B9%89"><span class="toc-number">0.10.1.</span> <span class="toc-text">9.10.1. full join 语法定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-10-2-%E4%BD%BF%E7%94%A8-union-%E5%85%B3%E9%94%AE%E5%AD%97%E5%AE%9E%E7%8E%B0%E5%85%A8%E8%A1%A8%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.10.2.</span> <span class="toc-text">9.10.2. 使用 union 关键字实现全表连接查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-11-SQL-%E7%9A%84%E5%85%B6%E4%BB%96-join-%E7%94%A8%E6%B3%95-%E7%BD%91%E4%B8%8A%E8%B5%84%E6%96%99"><span class="toc-number">0.11.</span> <span class="toc-text">9.11. SQL 的其他 join 用法(网上资料)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-11-1-OUTER-JOIN%EF%BC%88%E5%A4%96%E8%BF%9E%E6%8E%A5%EF%BC%89"><span class="toc-number">0.11.1.</span> <span class="toc-text">9.11.1. OUTER JOIN（外连接）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-11-2-LEFT-JOIN-EXCLUDING-INNER-JOIN%EF%BC%88%E5%B7%A6%E8%BF%9E%E6%8E%A5-%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%89"><span class="toc-number">0.11.2.</span> <span class="toc-text">9.11.2. LEFT JOIN EXCLUDING INNER JOIN（左连接-内连接）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-11-3-RIGHT-JOIN-EXCLUDING-INNER-JOIN%EF%BC%88%E5%8F%B3%E8%BF%9E%E6%8E%A5-%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%89"><span class="toc-number">0.11.3.</span> <span class="toc-text">9.11.3. RIGHT JOIN EXCLUDING INNER JOIN（右连接-内连接）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-11-4-OUTER-JOIN-EXCLUDING-INNER-JOIN%EF%BC%88%E5%A4%96%E8%BF%9E%E6%8E%A5-%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%89"><span class="toc-number">0.11.4.</span> <span class="toc-text">9.11.4. OUTER JOIN EXCLUDING INNER JOIN（外连接-内连接）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-12-straight-join-%E6%8C%87%E5%AE%9A%E9%A9%B1%E5%8A%A8%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.12.</span> <span class="toc-text">9.12. straight_join 指定驱动表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-12-1-%E6%A6%82%E8%BF%B0"><span class="toc-number">0.12.1.</span> <span class="toc-text">9.12.1. 概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-12-2-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">0.12.2.</span> <span class="toc-text">9.12.2. 注意事项</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number"></span> <span class="toc-text">10. 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E5%AD%90%E6%9F%A5%E8%AF%A2%E6%A6%82%E8%BF%B0"><span class="toc-number">0.1.</span> <span class="toc-text">10.1. 子查询概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E5%AD%90%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E4%BD%BF%E7%94%A8%E4%BD%8D%E7%BD%AE"><span class="toc-number">0.2.</span> <span class="toc-text">10.2. 子查询语法使用位置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-1-SELECT-%E5%AD%90%E5%8F%A5"><span class="toc-number">0.2.1.</span> <span class="toc-text">10.2.1. SELECT 子句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-2-FROM-%E5%AD%90%E5%8F%A5"><span class="toc-number">0.2.2.</span> <span class="toc-text">10.2.2. FROM 子句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-3-WHERE-%E6%88%96-ON-%E5%AD%90%E5%8F%A5"><span class="toc-number">0.2.3.</span> <span class="toc-text">10.2.3. WHERE 或 ON 子句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-4-ORDER-BY-%E5%AD%90%E5%8F%A5%E3%80%81GROUP-BY-%E5%AD%90%E5%8F%A5"><span class="toc-number">0.2.4.</span> <span class="toc-text">10.2.4. ORDER BY 子句、GROUP BY 子句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-%E6%8C%89%E8%BF%94%E5%9B%9E%E7%9A%84%E7%BB%93%E6%9E%9C%E9%9B%86%E5%8C%BA%E5%88%86%E5%AD%90%E6%9F%A5%E8%AF%A2%E7%B1%BB%E5%9E%8B"><span class="toc-number">0.3.</span> <span class="toc-text">10.3. 按返回的结果集区分子查询类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3-1-%E6%A0%87%E9%87%8F%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.3.1.</span> <span class="toc-text">10.3.1. 标量子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3-2-%E5%8D%95%E8%A1%8C%EF%BC%88%E5%A4%9A%E5%88%97%EF%BC%89%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.3.2.</span> <span class="toc-text">10.3.2. 单行（多列）子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3-3-%E5%8D%95%E5%88%97%EF%BC%88%E5%A4%9A%E8%A1%8C%EF%BC%89%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.3.3.</span> <span class="toc-text">10.3.3. 单列（多行）子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3-4-%E8%A1%A8%EF%BC%88%E5%A4%9A%E8%A1%8C%E5%A4%9A%E5%88%97%EF%BC%89%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.3.4.</span> <span class="toc-text">10.3.4. 表（多行多列）子查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-%E6%8C%89%E4%B8%8E%E5%A4%96%E5%B1%82%E6%9F%A5%E8%AF%A2%E5%85%B3%E7%B3%BB%E6%9D%A5%E5%8C%BA%E5%88%86%E5%AD%90%E6%9F%A5%E8%AF%A2%E7%B1%BB%E5%9E%8B"><span class="toc-number">0.4.</span> <span class="toc-text">10.4. 按与外层查询关系来区分子查询类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-4-1-%E4%B8%8D%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.4.1.</span> <span class="toc-text">10.4.1. 不相关子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-4-2-%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.4.2.</span> <span class="toc-text">10.4.2. 相关子查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-5-NOT-IN-ANY-SOME-ALL-EXISTS-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.5.</span> <span class="toc-text">10.5. [NOT] IN&#x2F;ANY&#x2F;SOME&#x2F;ALL&#x2F;EXISTS 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-5-1-IN-%E6%88%96%E8%80%85-NOT-IN"><span class="toc-number">0.5.1.</span> <span class="toc-text">10.5.1. IN 或者 NOT IN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-5-2-ANY-SOME%EF%BC%88ANY-%E5%92%8C-SOME-%E6%98%AF%E5%90%8C%E4%B9%89%E8%AF%8D%EF%BC%89"><span class="toc-number">0.5.2.</span> <span class="toc-text">10.5.2. ANY&#x2F;SOME（ANY 和 SOME 是同义词）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-5-3-ALL"><span class="toc-number">0.5.3.</span> <span class="toc-text">10.5.3. ALL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-5-4-EXISTS-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">0.5.4.</span> <span class="toc-text">10.5.4. EXISTS 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#10-5-4-1-%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8"><span class="toc-number">0.5.4.1.</span> <span class="toc-text">10.5.4.1. 基础使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#10-5-4-2-in-%E5%92%8C-exists-%E5%AD%90%E6%9F%A5%E8%AF%A2%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">0.5.4.2.</span> <span class="toc-text">10.5.4.2. in 和 exists 子查询的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-6-%E5%AD%90%E6%9F%A5%E8%AF%A2%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">0.6.</span> <span class="toc-text">10.6. 子查询的注意事项</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-DCL%E8%AF%AD%E5%8F%A5%E4%BD%BF%E7%94%A8-%E4%BA%86%E8%A7%A3"><span class="toc-number"></span> <span class="toc-text">11. DCL语句使用(了解)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-DCL%E6%A6%82%E8%BF%B0"><span class="toc-number">0.1.</span> <span class="toc-text">11.1. DCL概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E7%AE%A1%E7%90%86%E7%94%A8%E6%88%B7"><span class="toc-number">0.2.</span> <span class="toc-text">11.2. 管理用户</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2-1-%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7"><span class="toc-number">0.2.1.</span> <span class="toc-text">11.2.1. 查询用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2-2-%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">0.2.2.</span> <span class="toc-text">11.2.2. 创建用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2-3-%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="toc-number">0.2.3.</span> <span class="toc-text">11.2.3. 修改用户密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2-4-%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7"><span class="toc-number">0.2.4.</span> <span class="toc-text">11.2.4. 删除用户</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-number">0.3.</span> <span class="toc-text">11.3. 用户权限控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-3-1-%E5%B8%B8%E7%94%A8%E6%9D%83%E9%99%90"><span class="toc-number">0.3.1.</span> <span class="toc-text">11.3.1. 常用权限</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-3-2-%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90"><span class="toc-number">0.3.2.</span> <span class="toc-text">11.3.2. 查询用户权限</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-3-3-%E7%94%A8%E6%88%B7%E6%8E%88%E6%9D%83"><span class="toc-number">0.3.3.</span> <span class="toc-text">11.3.3. 用户授权</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-3-4-%E6%92%A4%E9%94%80%E6%9D%83%E9%99%90"><span class="toc-number">0.3.4.</span> <span class="toc-text">11.3.4. 撤销权限</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-%E6%95%B0%E6%8D%AE%E7%9A%84%E7%BA%A6%E6%9D%9F"><span class="toc-number"></span> <span class="toc-text">12. 数据的约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-%E6%95%B0%E6%8D%AE%E7%BA%A6%E6%9D%9F%E6%A6%82%E8%BF%B0"><span class="toc-number">0.1.</span> <span class="toc-text">12.1. 数据约束概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-1-1-%E7%BA%A6%E6%9D%9F%E7%A7%8D%E7%B1%BB"><span class="toc-number">0.1.1.</span> <span class="toc-text">12.1.1. 约束种类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-1-2-%E7%BA%A6%E6%9D%9F%E6%B7%BB%E5%8A%A0%E6%97%B6%E6%9C%BA"><span class="toc-number">0.1.2.</span> <span class="toc-text">12.1.2. 约束添加时机</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E9%BB%98%E8%AE%A4%E5%80%BC%E7%BA%A6%E6%9D%9F-default"><span class="toc-number">0.2.</span> <span class="toc-text">12.2. 默认值约束 (default)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-2-1-%E5%AE%9A%E4%B9%89%E4%B8%8E%E8%AF%AD%E6%B3%95"><span class="toc-number">0.2.1.</span> <span class="toc-text">12.2.1. 定义与语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-2-2-%E5%88%A0%E9%99%A4%E9%BB%98%E8%AE%A4%E7%BA%A6%E6%9D%9F"><span class="toc-number">0.2.2.</span> <span class="toc-text">12.2.2. 删除默认约束</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F-not-null"><span class="toc-number">0.3.</span> <span class="toc-text">12.3. 非空约束 (not null)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-3-1-%E5%AE%9A%E4%B9%89%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-number">0.3.1.</span> <span class="toc-text">12.3.1. 定义非空约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-3-2-%E5%88%A0%E9%99%A4%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-number">0.3.2.</span> <span class="toc-text">12.3.2. 删除非空约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-3-3-Mysql-%E5%85%81%E8%AE%B8-null-%E4%B8%8E-default-%E5%80%BC"><span class="toc-number">0.3.3.</span> <span class="toc-text">12.3.3. Mysql 允许 null 与 default 值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-3-4-%E5%AD%97%E6%AE%B5%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BB%BA%E8%AE%AE%E5%AE%9A%E4%B9%89%E4%B8%BA-not-null"><span class="toc-number">0.3.4.</span> <span class="toc-text">12.3.4. 字段为什么建议定义为 not null</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-4-%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F-unique"><span class="toc-number">0.4.</span> <span class="toc-text">12.4. 唯一约束 (unique)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-4-1-%E5%AE%9A%E4%B9%89%E4%B8%8E%E8%AF%AD%E6%B3%95"><span class="toc-number">0.4.1.</span> <span class="toc-text">12.4.1. 定义与语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-4-2-%E5%88%A0%E9%99%A4%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F"><span class="toc-number">0.4.2.</span> <span class="toc-text">12.4.2. 删除唯一约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-4-3-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">0.4.3.</span> <span class="toc-text">12.4.3. 注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-5-%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F-primary-key"><span class="toc-number">0.5.</span> <span class="toc-text">12.5. 主键约束 (primary key)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-5-1-%E6%A6%82%E5%BF%B5"><span class="toc-number">0.5.1.</span> <span class="toc-text">12.5.1. 概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-5-2-%E5%88%9B%E5%BB%BA%E5%8D%95%E5%88%97%E4%B8%BB%E9%94%AE"><span class="toc-number">0.5.2.</span> <span class="toc-text">12.5.2. 创建单列主键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-5-3-%E6%B7%BB%E5%8A%A0%E5%A4%9A%E5%88%97%E4%B8%BB%E9%94%AE-%E8%81%94%E5%90%88%E4%B8%BB%E9%94%AE%EF%BC%89"><span class="toc-number">0.5.3.</span> <span class="toc-text">12.5.3. 添加多列主键(联合主键）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-5-4-%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%BB%93%E6%9E%84%E6%B7%BB%E5%8A%A0%E4%B8%BB%E9%94%AE"><span class="toc-number">0.5.4.</span> <span class="toc-text">12.5.4. 通过修改表结构添加主键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-5-5-%E5%88%A0%E9%99%A4%E4%B8%BB%E9%94%AE"><span class="toc-number">0.5.5.</span> <span class="toc-text">12.5.5. 删除主键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-5-6-%E8%AE%BE%E7%BD%AE%E4%B8%BB%E9%94%AE%E8%87%AA%E5%8A%A8%E5%A2%9E%E9%95%BF"><span class="toc-number">0.5.6.</span> <span class="toc-text">12.5.6. 设置主键自动增长</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-6-%E8%87%AA%E5%A2%9E%E9%95%BF%E5%AD%97%E6%AE%B5-auto-increment"><span class="toc-number">0.6.</span> <span class="toc-text">12.6. 自增长字段 ( auto_increment )</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-6-1-%E8%87%AA%E5%A2%9E%E9%95%BF%E7%BA%A6%E6%9D%9F"><span class="toc-number">0.6.1.</span> <span class="toc-text">12.6.1. 自增长约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-6-2-%E8%87%AA%E5%A2%9E%E9%95%BF%E7%BA%A6%E6%9D%9F%E7%89%B9%E7%82%B9"><span class="toc-number">0.6.2.</span> <span class="toc-text">12.6.2. 自增长约束特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-6-3-delete-%E5%92%8C-truncate-%E5%88%A0%E9%99%A4%E5%90%8E%E8%87%AA%E5%A2%9E%E5%88%97%E7%9A%84%E5%8F%98%E5%8C%96"><span class="toc-number">0.6.3.</span> <span class="toc-text">12.6.3. delete 和 truncate 删除后自增列的变化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-7-%E9%9B%B6%E5%A1%AB%E5%85%85"><span class="toc-number">0.7.</span> <span class="toc-text">12.7. 零填充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-8-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">0.8.</span> <span class="toc-text">12.8. 外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#12-8-1-%E5%AE%9A%E4%B9%89"><span class="toc-number">0.8.1.</span> <span class="toc-text">12.8.1. 定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-8-2-%E5%A4%96%E9%94%AE%E9%9C%80%E9%81%B5%E5%AE%88%E7%9A%84%E8%A7%84%E5%88%99"><span class="toc-number">0.8.2.</span> <span class="toc-text">12.8.2. 外键需遵守的规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-8-3-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F1-%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%97%B6%E5%AE%9A%E4%B9%89"><span class="toc-number">0.8.3.</span> <span class="toc-text">12.8.3. 外键约束语法格式1(创建表时定义)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-8-4-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F2-%E5%88%9B%E5%BB%BA%E8%A1%A8%E5%90%8E%E5%86%8D%E5%AE%9A%E4%B9%89"><span class="toc-number">0.8.4.</span> <span class="toc-text">12.8.4. 外键约束语法格式2(创建表后再定义)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-8-5-%E5%9C%A8%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">0.8.5.</span> <span class="toc-text">12.8.5. 在外键约束下的数据操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-8-6-%E5%88%A0%E9%99%A4%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">0.8.6.</span> <span class="toc-text">12.8.6. 删除外键约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-8-7-%E7%BA%A7%E8%81%94%E6%93%8D%E4%BD%9C"><span class="toc-number">0.8.7.</span> <span class="toc-text">12.8.7. 级联操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#12-8-7-1-CASCADE"><span class="toc-number">0.8.7.1.</span> <span class="toc-text">12.8.7.1. CASCADE</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-8-7-2-SET-NULL"><span class="toc-number">0.8.7.2.</span> <span class="toc-text">12.8.7.2. SET NULL</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#13-MySQL-%E6%89%A9%E5%B1%95%E5%86%85%E5%AE%B9"><span class="toc-number"></span> <span class="toc-text">13. MySQL 扩展内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">0.1.</span> <span class="toc-text">13.1. 系统变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#13-1-1-%E7%AE%80%E4%BB%8B"><span class="toc-number">0.1.1.</span> <span class="toc-text">13.1.1. 简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-1-2-%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F-%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-number">0.1.2.</span> <span class="toc-text">13.1.2. 系统变量-全局变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-1-3-%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F-%E4%BC%9A%E8%AF%9D%E5%8F%98%E9%87%8F"><span class="toc-number">0.1.3.</span> <span class="toc-text">13.1.3. 系统变量-会话变量</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-MySQL-%E7%9A%84-pymysql-%E6%93%8D%E4%BD%9C"><span class="toc-number">0.2.</span> <span class="toc-text">13.2. MySQL 的 pymysql 操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#13-2-1-%E6%9F%A5%E8%AF%A2%E7%A4%BA%E4%BE%8B"><span class="toc-number">0.2.1.</span> <span class="toc-text">13.2.1. 查询示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-2-2-%E5%A2%9E%E5%88%A0%E6%94%B9%E7%A4%BA%E4%BE%8B"><span class="toc-number">0.2.2.</span> <span class="toc-text">13.2.2. 增删改示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-MySQL-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%BC%AA%E8%A1%A8-DUAL"><span class="toc-number">0.3.</span> <span class="toc-text">13.3. MySQL 数据库的伪表 DUAL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-4-%E5%9C%A8-Unix-%E5%92%8C-MySQL-%E6%97%B6%E9%97%B4%E6%88%B3%E4%B9%8B%E9%97%B4%E8%BF%9B%E8%A1%8C%E8%BD%AC%E6%8D%A2"><span class="toc-number">0.4.</span> <span class="toc-text">13.4. 在 Unix 和 MySQL 时间戳之间进行转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-5-MySQL-fetch-array-%E5%92%8C-MySQL-fetch-object-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">0.5.</span> <span class="toc-text">13.5. MySQL_fetch_array 和 MySQL_fetch_object 的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-6-%E5%A6%82%E4%BD%95%E5%AD%98%E5%82%A8-IP-%E5%9C%B0%E5%9D%80%EF%BC%88%E5%BE%85%E6%95%B4%E7%90%86%EF%BC%89"><span class="toc-number">0.6.</span> <span class="toc-text">13.6. 如何存储 IP 地址（待整理）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-7-SQL-%E6%B3%A8%E5%85%A5"><span class="toc-number">0.7.</span> <span class="toc-text">13.7. SQL 注入</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/a318ca1f.html" title="MySQL数据库150道高频面试题"><img src="/bg/Image00018.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL数据库150道高频面试题"/></a><div class="content"><a class="title" href="/posts/a318ca1f.html" title="MySQL数据库150道高频面试题">MySQL数据库150道高频面试题</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8f9b37aa.html" title="技术同学必会的MySQL设计规约"><img src="/bg/Image00014.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="技术同学必会的MySQL设计规约"/></a><div class="content"><a class="title" href="/posts/8f9b37aa.html" title="技术同学必会的MySQL设计规约">技术同学必会的MySQL设计规约</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dfdfdf4.html" title="数据库概述"><img src="/bg/Image00002.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库概述"/></a><div class="content"><a class="title" href="/posts/dfdfdf4.html" title="数据库概述">数据库概述</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/490575ab.html" title="24工厂模式俗话解释"><img src="/bg/Image00024.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="24工厂模式俗话解释"/></a><div class="content"><a class="title" href="/posts/490575ab.html" title="24工厂模式俗话解释">24工厂模式俗话解释</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/364ea8cc.html" title="设计模式"><img src="/bg/Image00014.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="设计模式"/></a><div class="content"><a class="title" href="/posts/364ea8cc.html" title="设计模式">设计模式</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2020 - 2025 By 蓝桉</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="8152976493" data-server="netease" data-type="playlist"   data-order="list" data-fixed="true" data-preload="auto" data-autoplay="false" data-mutex="true" ></div><script async src="//at.alicdn.com/t/c/font_4379924_273fk05h86zi.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat/cat.js"></script><script async data-pjax src="/js/meting/music_lanan.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script defer src="/js/day/lunar.js"></script><script defer src="/js/day/day.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = '10a7db1c41b6489db9c830c668a18304';
  var gaud_map_key = '82a64bc994fb6494830f157f319f9f69';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title=""><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.2.2" title=""><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://www.jsdelivr.com/" style="margin-inline:5px" data-title="本站使用JsDelivr为静态资源提供CDN加速" title=""><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime/runtime.min.js"></script><script async src="/js/font/ali_font_all.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('article-sort-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__slideInRight');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>