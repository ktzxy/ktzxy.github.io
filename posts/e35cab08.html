<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Java基础-数据库编程 | 蓝桉`Blog</title><meta name="author" content="蓝桉,kt_zxh@163.com"><meta name="copyright" content="蓝桉"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. JDBC（Java数据库连接）概述JDBC（Java DataBase Connectivity, java数据库连接）是一种用于执行 SQL 语句的 Java API。JDBC 是 Java访问数据库的标准规范，作用是可以为不同的关系型数据库提供统一访问方式，它由一组用Java语言编写的接口和类组成。具体的实现类由各大数据库厂商来编写。 JDBC 需要连接驱动，驱动是两个设备要进行通信，满">
<meta property="og:type" content="article">
<meta property="og:title" content="Java基础-数据库编程">
<meta property="og:url" content="https://ktzxy.github.io/posts/e35cab08.html">
<meta property="og:site_name" content="蓝桉&#96;Blog">
<meta property="og:description" content="1. JDBC（Java数据库连接）概述JDBC（Java DataBase Connectivity, java数据库连接）是一种用于执行 SQL 语句的 Java API。JDBC 是 Java访问数据库的标准规范，作用是可以为不同的关系型数据库提供统一访问方式，它由一组用Java语言编写的接口和类组成。具体的实现类由各大数据库厂商来编写。 JDBC 需要连接驱动，驱动是两个设备要进行通信，满">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ktzxy.github.io/bg/Image00029.webp">
<meta property="article:published_time" content="2025-07-09T17:28:45.000Z">
<meta property="article:modified_time" content="2025-07-13T15:45:18.462Z">
<meta property="article:author" content="蓝桉">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ktzxy.github.io/bg/Image00029.webp"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Java基础-数据库编程",
  "url": "https://ktzxy.github.io/posts/e35cab08.html",
  "image": "https://ktzxy.github.io/bg/Image00029.webp",
  "datePublished": "2025-07-09T17:28:45.000Z",
  "dateModified": "2025-07-13T15:45:18.462Z",
  "author": [
    {
      "@type": "Person",
      "name": "蓝桉",
      "url": "https://ktzxy.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ktzxy.github.io/posts/e35cab08.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Java基础-数据库编程',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4379924_273fk05h86zi.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/progress_bar/progress_bar.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/windmill/windmill.css"><link rel="stylesheet" href="/css/cat.css"><link rel="stylesheet" href="/css/meting/music_lanan.css"><div id="myscoll"></div><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="/css/runtime/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="蓝桉`Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/bg.webp);"></div><div id="an_music_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">264</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">37</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-zhuye-"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zhuye-"></use></svg><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shijianzhou"></use></svg><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/essay/"><i class="fa-fw icon-xiaoxi"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xiaoxi"></use></svg><span> 闲言碎语</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/music/"><i class="fa-fw icon-music"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/fcircle/"><i class="fa-fw icon-pengyouquan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pengyouquan"></use></svg><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-xinfeng"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinfeng"></use></svg><span> 留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> 友人帐</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:randomPost();"><i class="fa-fw icon-wodezhuifan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wodezhuifan"></use></svg><span> 随机访问</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon-guanyuwomen2"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guanyuwomen2"></use></svg><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/bg/Image00029.webp);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">蓝桉`Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Java基础-数据库编程</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-zhuye-"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zhuye-"></use></svg><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shijianzhou"></use></svg><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/essay/"><i class="fa-fw icon-xiaoxi"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xiaoxi"></use></svg><span> 闲言碎语</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/music/"><i class="fa-fw icon-music"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/fcircle/"><i class="fa-fw icon-pengyouquan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pengyouquan"></use></svg><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-xinfeng"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinfeng"></use></svg><span> 留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> 友人帐</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:randomPost();"><i class="fa-fw icon-wodezhuifan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wodezhuifan"></use></svg><span> 随机访问</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon-guanyuwomen2"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guanyuwomen2"></use></svg><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Java基础-数据库编程</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-09T17:28:45.000Z" title="发表于 2025-07-09 17:28:45">2025-07-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-13T15:45:18.462Z" title="更新于 2025-07-13 15:45:18">2025-07-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/">Java</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="1-JDBC（Java数据库连接）概述"><a href="#1-JDBC（Java数据库连接）概述" class="headerlink" title="1. JDBC（Java数据库连接）概述"></a>1. JDBC（Java数据库连接）概述</h2><p>JDBC（Java DataBase Connectivity, java数据库连接）是一种用于执行 SQL 语句的 Java API。JDBC 是 Java访问数据库的标准规范，作用是可以为不同的关系型数据库提供统一访问方式，它由一组用Java语言编写的接口和类组成。具体的实现类由各大数据库厂商来编写。</p>
<p>JDBC 需要连接驱动，驱动是两个设备要进行通信，满足一定通信数据格式，数据格式由设备提供商规定，设备提供商为设备提供驱动软件，通过软件可以与该设备进行通信。</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251038796.png" alt=""></p>
<h3 id="1-1-MySQL-数据库-JDBC-相关资源"><a href="#1-1-MySQL-数据库-JDBC-相关资源" class="headerlink" title="1.1. MySQL 数据库 JDBC 相关资源"></a>1.1. MySQL 数据库 JDBC 相关资源</h3><p>MySQL 驱动官网下载地址：<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/connector/j/">https://dev.mysql.com/downloads/connector/j/</a></p>
<p>相关文件夹说明：</p>
<ul>
<li>src 文件夹是源代码</li>
<li>docs 文件夹是 API</li>
</ul>
<h2 id="2-JDBC-开发"><a href="#2-JDBC-开发" class="headerlink" title="2. JDBC 开发"></a>2. JDBC 开发</h2><h3 id="2-1-JDBC-执行流程"><a href="#2-1-JDBC-执行流程" class="headerlink" title="2.1. JDBC 执行流程"></a>2.1. JDBC 执行流程</h3><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410251038797.png" alt=""></p>
<p>使用 JDBC 连接数据库的四个参数：</p>
<ul>
<li>用户名</li>
<li>密码</li>
<li>连接字符串：jdbc:mysql://localhost:3306/数据库?参数名=参数值</li>
<li>数据库驱动类，如 MySQL数据库驱动是 <code>com.mysql.jdbc.Driver</code>，8.0版本后驱动类是 <code>com.mysql.cj.jdbc.Driver</code></li>
</ul>
<h3 id="2-2-JDBC-开发步骤（以-MySQL-为例）"><a href="#2-2-JDBC-开发步骤（以-MySQL-为例）" class="headerlink" title="2.2. JDBC 开发步骤（以 MySQL 为例）"></a>2.2. JDBC 开发步骤（以 MySQL 为例）</h3><ol>
<li>加载并注册数据库驱动，即告知JVM使用的是哪一个数据库的驱动，通常使用反射技术 <code>Class.forName()</code> 方法将驱动类加入到内存中。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>)</span><br></pre></td></tr></table></figure>
<ol>
<li>通过 <code>DriverManager</code> 连接数据库并获得连接对象 <code>Connection</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用JDBC中的类，完成对MySQL数据库的连接</p>
</blockquote>
<ol>
<li>获得语句执行平台，通过 <code>Connection</code> 对象的 <code>createStatement()</code> 方法获得 <code>Statement</code> 对象。<code>Statement</code> 对象就是对SQL语句的执行者对象。</li>
<li>调用 <code>Statement</code> 对象的 <code>excuteXxx(String sql)</code> 方法发送要执行的SQL语句，并获得执行后数据库返回结果。</li>
<li>处理结果，通过 <code>ResultSet</code> 的 <code>next()</code> 和 <code>getXxx(索引/字段名)</code> 方法获得数据库返回的结果集。</li>
<li>必须关闭释放数据库资源，使用 <code>close()</code> 方法。<font color=red><strong>关闭原则：后开的先关(<code>ResultSet</code> -&gt; <code>Statement</code> -&gt; <code>Connection</code>)</strong></font></li>
</ol>
<blockquote>
<font color=purple>**注：一般开发会使用 `PreparedStatement` 来代替父类 `Statement`，使用效率和安全性都更高。**</font>

<font color=red>JDBC 访问数据库的基础包，在 JavaSE 中的包。导包注意要选择java.sql包</font>

</blockquote>
<h3 id="2-3-项目（程序）引入驱动-jar-包（MySQL-的驱动）"><a href="#2-3-项目（程序）引入驱动-jar-包（MySQL-的驱动）" class="headerlink" title="2.3. 项目（程序）引入驱动 jar 包（MySQL 的驱动）"></a>2.3. 项目（程序）引入驱动 jar 包（MySQL 的驱动）</h3><ul>
<li>MySQL 相关jar包：mysql-connector-java-x.x.xx-bin.jar<ul>
<li>MySQL驱动相关文件夹mysql-connector-java-x.x.xx</li>
<li>src文件夹是源代码，docs文件夹是API</li>
</ul>
</li>
<li>MySQL 官方驱动下载地址：<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/connector/j/">https://dev.mysql.com/downloads/connector/j/</a></li>
<li>MySQL maven 依赖  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>x.x.xx<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="3-JDBC-的核心-API-使用"><a href="#3-JDBC-的核心-API-使用" class="headerlink" title="3. JDBC 的核心 API 使用"></a>3. JDBC 的核心 API 使用</h2><h3 id="3-1-核心-API-概述"><a href="#3-1-核心-API-概述" class="headerlink" title="3.1. 核心 API 概述"></a>3.1. 核心 API 概述</h3><ul>
<li><code>Driver</code> 接口：数据库驱动的接口，由数据库的厂商实现。</li>
<li><code>DriverManager</code> 类：用来管理和注册数据库驱动的类</li>
<li><code>Connection</code> 接口：数据库连接对象。</li>
<li><code>Statement</code>/<code>PrepareStatement</code> 接口：操作数据库 SQL 语句的对象</li>
<li><code>ResultSet</code> 接口：用来封装数据库返回符合查询条件的结果集</li>
</ul>
<h3 id="3-2-Driver-接口"><a href="#3-2-Driver-接口" class="headerlink" title="3.2. Driver 接口"></a>3.2. Driver 接口</h3><p>每个驱动程序都应该提供一个实现 Driver 接口的类。<code>DriverManager</code> 会试着加载尽可能多的它可以找到的驱动程序，这意味着用户可以通过调用以下程序加载和注册一个驱动程序类对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(<span class="string">&quot;foo.bah.Driver&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="3-3-DriverManager-类"><a href="#3-3-DriverManager-类" class="headerlink" title="3.3. DriverManager 类"></a>3.3. DriverManager 类</h3><h4 id="3-3-1-类作用"><a href="#3-3-1-类作用" class="headerlink" title="3.3.1. 类作用"></a>3.3.1. 类作用</h4><p><code>java.sql.DriverManager</code> 类用于管理和注册一组 JDBC 驱动程序的基本服务。</p>
<p><code>DriverManager</code> 是一个工厂类，通过它来创建数据库连接。当 JDBC 的 <code>Driver</code> 类被加载进来时，它会自己注册到 <code>DriverManager</code> 类里面，然后会把数据库配置信息传成 <code>DriverManager.getConnection()</code> 方法，<code>DriverManager</code> 会使用注册到它里面的驱动来获取数据库连接，并返回给调用的程序。</p>
<h4 id="3-3-2-注册驱动程序方法"><a href="#3-3-2-注册驱动程序方法" class="headerlink" title="3.3.2. 注册驱动程序方法"></a>3.3.2. 注册驱动程序方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">registerDriver</span><span class="params">(new Driver()</span>);</span><br></pre></td></tr></table></figure>
<p>注册数据库驱动的静态方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DriverManager.registerDriver(<span class="keyword">new</span> <span class="title class_">com</span>.mysql.jdbc.Driver());</span><br></pre></td></tr></table></figure>
<p>使用该方法注册驱动会触发驱动注册两次，一般不推荐使用</p>
<font color=red>**正确的注册驱动使用下面的方式：一般使用 `Class` 类的 `forName("类全名")` 注册驱动，可以解决注册两次的问题**</font>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<font color=red>**注：从JDK1.6开始，JDBC的版本是4.0版本后，可以不用写注册驱动的代码了，但是为了兼容之前的版本，注册驱动的代码一般都会保留。**</font>

</blockquote>
<h4 id="3-3-3-类常用方法"><a href="#3-3-3-类常用方法" class="headerlink" title="3.3.3. 类常用方法"></a>3.3.3. 类常用方法</h4><p>获取连接对象方式1：通过指定 url（需要连接的数据库地址），用户名和密码得到一个 <code>Connection</code> 接口的实现类。用于连接数据库并获得连接对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">(String url, String user, String password)</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>url</code>: 连接数据库字符串 url</li>
<li><code>user</code>: 用户名，比如：root</li>
<li><code>password</code>: 密码，注册时候的密码。比如：123456</li>
</ul>
<p>获取连接对象方式2：通过一个属性集和 URL，得到一个数据库的连接。实际开发中比较常用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">(String url, Properties info)</span> <span class="keyword">throws</span> SQLException</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>url</code>: 连接数据库字符串url</li>
<li><code>info</code>: 属性集合，用来存储用户名和密码</li>
</ul>
<blockquote>
<p>一般 properties 属性文件存放在 src 文件夹中，先获取当前类的 <code>Class</code> 对象，再使用 <code>Class</code> 类的 <code>getResourceAsStream(&quot;/文件名&quot;)</code> 得到输入流对象，再使用 <code>load()</code> 读取文件</p>
</blockquote>
<p>Code Demo: 使用 <code>Properties</code> 属性文件获取 <code>Connection</code> 对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建Properties集合</span></span><br><span class="line"><span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"><span class="comment">// 加载文件数据到info中</span></span><br><span class="line">info.load(ConnectionDemo.class.getResourceAsStream(<span class="string">&quot;/jdbc.properties&quot;</span>));</span><br><span class="line"><span class="comment">// 连接数据库获得连接对象</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://10.211.55.3:3306/tempDb&quot;</span>, info);</span><br></pre></td></tr></table></figure>
<h4 id="3-3-4-连接数据库的-URL-地址格式"><a href="#3-3-4-连接数据库的-URL-地址格式" class="headerlink" title="3.3.4. 连接数据库的 URL 地址格式"></a>3.3.4. 连接数据库的 URL 地址格式</h4><p>URL用于标识数据库的位置，程序员通过URL地址告诉JDBC程序连接哪个数据库，URL的写法为：</p>
<h5 id="3-3-4-1-url地址格式"><a href="#3-3-4-1-url地址格式" class="headerlink" title="3.3.4.1. url地址格式"></a>3.3.4.1. url地址格式</h5><p>格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc协议名:子协议://数据库服务器地址或 IP 地址:端口号/数据库名</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql: [] <span class="comment">//localhost:3306/test? 参数名:参数值</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MySQL写法：</span></span><br><span class="line">jdbc:mysql:<span class="comment">//localhost:3306/temp</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 简写格式（前提：数据库服务器地址是本机，端口号默认是3306）</span></span><br><span class="line">jdbc:mysql:<span class="comment">///temp</span></span><br></pre></td></tr></table></figure>
<h5 id="3-3-4-2-各类数据库连接字符串"><a href="#3-3-4-2-各类数据库连接字符串" class="headerlink" title="3.3.4.2. 各类数据库连接字符串"></a>3.3.4.2. 各类数据库连接字符串</h5><p>JDBC的URL = 协议名 + 子协议名 + 数据源名</p>
<ul>
<li>协议名总是<code>jdbc</code>。</li>
<li>子协议名由JDBC驱动程序的编写者决定。</li>
<li>数据源名也可能包含用户与口令等信息；这些信息也可单独提供。</li>
</ul>
<h5 id="3-3-4-3-几种常见的数据库连接"><a href="#3-3-4-3-几种常见的数据库连接" class="headerlink" title="3.3.4.3. 几种常见的数据库连接"></a>3.3.4.3. 几种常见的数据库连接</h5><p><strong>Oracle</strong></p>
<ul>
<li>驱动：<code>oracle.jdbc.driver.OracleDriver</code></li>
<li>URL：<code>jdbc:oracle:thin:@machine_name:port:dbname</code><ul>
<li><code>machine_name</code>：数据库所在的机器的名称；</li>
<li><code>port</code>：端口号，默认是1521</li>
</ul>
</li>
</ul>
<p><strong>MySQL</strong></p>
<ul>
<li>驱动：<code>com.mysql.jdbc.Driver</code></li>
<li>URL：<code>jdbc:mysql://machine_name:port/dbname</code><ul>
<li><code>machine_name</code>：数据库所在的机器的名称；</li>
<li><code>port</code>：端口号，默认3306</li>
</ul>
</li>
</ul>
<p><strong>SQL Server</strong></p>
<ul>
<li>驱动：<code>com.microsoft.jdbc.sqlserver.SQLServerDriver</code></li>
<li>URL：<code>jdbc:microsoft:sqlserver://&lt;machine_name&gt;&lt;:port&gt;;DatabaseName=&lt;dbname&gt;</code><ul>
<li><code>machine_name</code>：数据库所在的机器的名称；</li>
<li><code>port</code>：端口号，默认是1433</li>
</ul>
</li>
</ul>
<p><strong>DB2</strong></p>
<ul>
<li>驱动：<code>com.ibm.db2.jdbc.app.DB2Driver</code></li>
<li>URL：<code>jdbc:db2://&lt;machine_name&gt;&lt;:port&gt;/dbname</code><ul>
<li><code>machine_name</code>：数据库所在的机器的名称；</li>
<li><code>port</code>：端口号，默认是5000</li>
</ul>
</li>
</ul>
<h4 id="3-3-5-解决JDBC无法连接MySQL数据库的问题"><a href="#3-3-5-解决JDBC无法连接MySQL数据库的问题" class="headerlink" title="3.3.5. 解决JDBC无法连接MySQL数据库的问题"></a>3.3.5. 解决JDBC无法连接MySQL数据库的问题</h4><p>MySQL数据连接时只能使用localhost连接，但不能用IP连接问题的解决方案</p>
<ol>
<li>打开cmd窗口，进入MySQL安装的bin目录</li>
<li>执行命令登录数据库,之后会出现一行要你输入密码的 <code>mysql -u root -p</code></li>
<li>执行以下命令分配新用户： <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># (%) 表示所有ip</span></span><br><span class="line">grant all privileges on *.* to <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;root&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li>执行完上述命令后用下面的命令刷新权限 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flush privileges;</span><br></pre></td></tr></table></figure></li>
<li>之后关闭mysql服务，然后启动mysql服务，大功告成</li>
</ol>
<h4 id="3-3-6-mysql-8-0-以上版本驱动连接失败"><a href="#3-3-6-mysql-8-0-以上版本驱动连接失败" class="headerlink" title="3.3.6. mysql 8.0+以上版本驱动连接失败"></a>3.3.6. mysql 8.0+以上版本驱动连接失败</h4><p>使用 mysql 8.0+ 版本后，一些项目连接数据会报以下的错误：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.sql.SQLNonTransientConnectionException:Public key Retrieval is not allowed…</span><br></pre></td></tr></table></figure>
<p>此时需要修改数据库的连接，增加如下配置：</p>
<ol>
<li><code>useSSL=false</code> MySQL 8.0 以上版本不需要建立 SSL 连接的，需要显示关闭</li>
<li><code>allowPublicKeyRetrieval=true</code> 允许客户端从服务器获取公钥。</li>
<li><code>serverTimezone=UTC</code> 设置时区，mysql驱动8.0+也要指定时区，不然也会报一些错</li>
</ol>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/test_db?characterEncoding=utf-8&amp;useSSL=false&amp;useUnicode=true&amp;allowPublicKeyRetrieval=true&amp;serverTimezone=UTC</span></span><br><span class="line">    <span class="attr">driverClassName:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span> <span class="comment"># 设置使用的数据源类型</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Notes: 如果使用的 mysql 是 8.0+，建议最好把以上三个参数设置下，避免发生一些莫名错误。</p>
</blockquote>
<h3 id="3-4-Connection-接口"><a href="#3-4-Connection-接口" class="headerlink" title="3.4. Connection 接口"></a>3.4. Connection 接口</h3><h4 id="3-4-1-接口作用"><a href="#3-4-1-接口作用" class="headerlink" title="3.4.1. 接口作用"></a>3.4.1. 接口作用</h4><p>用来和数据库建立连接，和获取 <code>Statement</code> 对象</p>
<h4 id="3-4-2-常用方法"><a href="#3-4-2-常用方法" class="headerlink" title="3.4.2. 常用方法"></a>3.4.2. 常用方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Statement <span class="title function_">createStatement</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li>创建一个 <code>Statement</code> 接口现实类对象来将 SQL 语句发送到数据库。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PreparedStatement <span class="title function_">prepareStatement</span><span class="params">(String sql)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>创建一个 <code>PreparedStatement</code> 对象来将参数化的 SQL 语句发送到数据库。<ul>
<li><code>sql</code>：需要执行的SQL语句，获取 <code>PreparedStatement</code> 对象后直接使用方法 <code>executeUpdate()</code> 或 <code>executeQuery()</code> 进行操作。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> <span class="keyword">throws</span> SQLException</span><br></pre></td></tr></table></figure>
<ul>
<li>立即释放此 <code>Connection</code> 对象的数据库和 JDBC 资源，建议最好在调用 <code>close</code> 方法之前，应用程序显式提交或回滚一个活动事务。</li>
</ul>
<h3 id="3-5-Statement-接口（操作数据库）"><a href="#3-5-Statement-接口（操作数据库）" class="headerlink" title="3.5. Statement 接口（操作数据库）"></a>3.5. Statement 接口（操作数据库）</h3><h4 id="3-5-1-接口概述"><a href="#3-5-1-接口概述" class="headerlink" title="3.5.1. 接口概述"></a>3.5.1. 接口概述</h4><p>用来发送SQL语句给数据库执行，对数据库进行增删改查操作。通过 <code>Connection</code> 对象的 <code>createStatement()</code> 方法获取 <code>Statement</code> 对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Statement</span> <span class="keyword">extends</span> <span class="title class_">Wrapper</span>, AutoCloseable</span><br></pre></td></tr></table></figure>
<p>CRUD(增删改查操作):</p>
<ul>
<li>C: <code>Create</code></li>
<li>R: <code>Read</code></li>
<li>U: <code>Update</code></li>
<li>D: <code>Delete</code></li>
</ul>
<h4 id="3-5-2-常用方法"><a href="#3-5-2-常用方法" class="headerlink" title="3.5.2. 常用方法"></a>3.5.2. 常用方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">execute</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">execute</span><span class="params">(String sql, <span class="type">int</span> autoGeneratedKeys)</span> <span class="keyword">throws</span> SQLException;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">execute</span><span class="params">(String sql, <span class="type">int</span> columnIndexes[])</span> <span class="keyword">throws</span> SQLException;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">execute</span><span class="params">(String sql, String columnNames[])</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li>可以执行任意的 SQL 语句。如果查询的结果是一个 <code>ResultSet</code> 对象，此方法返回 true；如果结果不是 <code>ResultSet</code>（比如 insert 或者 update 等语句），此方法则会返回 false。可以通过接口的 <code>getResultSet()</code> 方法来获取 ResultSet 结结果对象，或者通过 <code>getUpdateCount()</code> 方法来获取更新的记录条数。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">executeUpdate</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li>只能执行数据库的SQL语句中的 <code>insert</code>、<code>delete</code>、<code>update</code>、<code>drop</code>、<code>create</code> 用于数据库的增删改的操作等 DML、DDL 语句。方法参数与返回值解析如下：<ul>
<li><code>sql</code>：表示语句，返回执行成功的数据表行数。</li>
<li>可以执行数据定义语言『DDL(Data Definition Language)』。用于创建，修改，删除数据库、表、列等。如：<code>create</code>，<code>alter</code>，<code>drop</code>等。<strong>使用DDL语句不影响行数，即返回值为0</strong>。</li>
<li>可以数据操作语言『DML(Data Manipulation Language)』。用来修改、删除、添加数据。如：<code>insert</code>、<code>delete</code>、<code>update</code>。<strong>使用DML语句会影响行数，会返回影响行数</strong><blockquote>
<p>建议：一般使用操作数据库的语句，先在图形化客户端运行判断是否有错，再写到 IDE</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ResultSet <span class="title function_">executeQuery</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li>用于数据库SQL语句中的 <code>select</code> 查询操作，返回一个符合条件的结果集，是 <code>ResultSet</code> 接口的现实类。即使查询不到记录返回的 <code>ResultSet</code> 也不会为 null。如果方法传入参数是 insert 或者 update 语句的话，它会抛出错误信息为 “executeQuery method can not be used for update” 的 <code>java.util.SQLException</code>。 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li>立即释放此 <code>Statement</code> 对象的数据库和 JDBC 资源，而不是等待该对象自动关闭时发生此操作。一般来说，使用完后立即释放资源是一个好习惯，这样可以避免对数据库资源的占用。</li>
</ul>
<blockquote>
<p>注：关闭 <code>Statement</code> 对象时，还将同时关闭其当前的 <code>ResultSet</code> 对象（如果有）。</p>
</blockquote>
<h3 id="3-6-ResultSet-接口（查询-处理结果）"><a href="#3-6-ResultSet-接口（查询-处理结果）" class="headerlink" title="3.6. ResultSet 接口（查询/处理结果）"></a>3.6. ResultSet 接口（查询/处理结果）</h3><h4 id="3-6-1-接口概述"><a href="#3-6-1-接口概述" class="headerlink" title="3.6.1. 接口概述"></a>3.6.1. 接口概述</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ResultSet</span> <span class="keyword">extends</span> <span class="title class_">Wrapper</span>, AutoCloseable</span><br></pre></td></tr></table></figure>
<p>通过 <code>Statement</code> 的 <code>executeQuery()</code> 方法查询数据库后会返回一个 <code>ResultSet</code> 对象。<code>java.sql.ResultSet</code> 是一个接口，其作用是用来封装符合查询条件的记录，提供用于从当前行获取列值的方法，可以指定列的索引编号或列的名称。</p>
<p><code>ResultSet</code> 对象维护了一个游标，指向当前的数据行。可以将 <code>ResultSet</code> 理解成一根指针，开始的时候这个游标默认指向位置在执行查询记录的第一行之前，如果调用了 <code>ResultSet</code> 的 <code>next()</code> 方法游标会下移一行；如果没有更多的数据时，<code>next()</code> 方法会返回 false。因此可以在 for 循环中用它来遍历数据集。</p>
<p>默认的 <code>ResultSet</code> 是不能更新的，游标也只能往下移，即只能从第一行到最后一行遍历一遍。不过<strong>也可以创建可以回滚或者可更新的 <code>ResultSet</code></strong>。</p>
<p>值得注意的是，当生成 <code>ResultSet</code> 的 <code>Statement</code> 对象要关闭或者重新执行或是获取下一个 <code>ResultSet</code> 的时候，之前的 <code>ResultSet</code> 对象也会自动关闭。</p>
<h4 id="3-6-2-常用方法"><a href="#3-6-2-常用方法" class="headerlink" title="3.6.2. 常用方法"></a>3.6.2. 常用方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">next</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ResultSet</code> 光标最初位于第一行之前。第一次调用 <code>next</code> 方法使第一行成为当前行；第二次调用使第二行成为当前行，依此类推。如果新的当前行有效，则返回 <code>true</code>；如果不存在下一行，则返回 <code>false</code>。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Xxx <span class="title function_">getXxx</span><span class="params">(列索引号或列字段名称)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>可以指定列的索引编号或列的名称，XXX 表示数据类型。<strong>列号默认从1开始</strong>。如：<code>getString(1);</code>、<code>getInt(&quot;name&quot;);</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li>即释放此 <code>ResultSet</code> 对象的数据库和 JDBC 资源</li>
</ul>
<h4 id="3-6-3-getXxx-方法注意事项"><a href="#3-6-3-getXxx-方法注意事项" class="headerlink" title="3.6.3. getXxx 方法注意事项"></a>3.6.3. getXxx 方法注意事项</h4><ol>
<li>如果指针在指向结果集第一行前面时调用 <code>resultSet.getXX()</code> 获取列值，会抛出异常：<code>Before start of result set</code></li>
<li>如果指针在指向结果集最后一行后面时，调用 <code>resultSet.getXX()</code> 获取列值，会抛出异常：<code>After end of result set</code></li>
<li>如果查询结果集为空，还调用 <code>resultSet.getXX()</code> 获取列值，会抛出异常：<code>Illegal operation on empty result set</code></li>
<li>使用完毕以后要关闭结果集 <code>ResultSet</code>，再关闭 <code>Statement</code>，再关闭 <code>Connection</code></li>
</ol>
<h4 id="3-6-4-常用数据类型转换表"><a href="#3-6-4-常用数据类型转换表" class="headerlink" title="3.6.4. 常用数据类型转换表"></a>3.6.4. 常用数据类型转换表</h4><div class="table-container">
<table>
<thead>
<tr>
<th>SQL 类型</th>
<th>JDBC  对应方法</th>
<th>返回类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>BIT(1) bit(n)</td>
<td>getBoolean getBytes()</td>
<td>Boolean byte[]</td>
</tr>
<tr>
<td>TINYINT</td>
<td>getByte()</td>
<td>Byte</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>getShort()</td>
<td>Short</td>
</tr>
<tr>
<td>Int</td>
<td>getInt()</td>
<td>Int</td>
</tr>
<tr>
<td>BIGINT</td>
<td>getLong()</td>
<td>Long</td>
</tr>
<tr>
<td>CHAR,VARCHAR,LONGVARCHAR</td>
<td>getString()</td>
<td>String</td>
</tr>
<tr>
<td>Text(clob) Blob</td>
<td>getClob getBlob()</td>
<td>Clob Blob</td>
</tr>
<tr>
<td>DATE</td>
<td>getDate()</td>
<td>java.sql.Date</td>
</tr>
<tr>
<td>TIME</td>
<td>getTime()</td>
<td>java.sql.Time</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>getTimestamp()</td>
<td>java.sql.Timestamp</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p><strong>查询乱码的问题</strong>：如果汉字查询出现乱码，要将数据库的字符集设置成 UTF-8，因为多数 IDE 默认使用 utf-8 的编码</p>
</blockquote>
<h3 id="3-7-PreparedStatement-接口"><a href="#3-7-PreparedStatement-接口" class="headerlink" title="3.7. PreparedStatement 接口"></a>3.7. PreparedStatement 接口</h3><h4 id="3-7-1-SQL-注入的概念"><a href="#3-7-1-SQL-注入的概念" class="headerlink" title="3.7.1. SQL 注入的概念"></a>3.7.1. SQL 注入的概念</h4><p>SQL 注入是指，用户输入的内容作为了 SQL 语法的一部分，改变了原有 SQL 语句的含义。</p>
<h4 id="3-7-2-接口概述"><a href="#3-7-2-接口概述" class="headerlink" title="3.7.2. 接口概述"></a>3.7.2. 接口概述</h4><p>用于 SQL 语句的发送，是继承 <code>Statement</code> 的子接口，拥有父类所有的功能。可以防止 SQL 注入的问题，比父类更安全。然后可以使用此对象多次高效地执行该语句。</p>
<p>在使用 <code>Connection</code> 的方法得到 <code>PreparedStatement</code> 对象时，已经定义数据库操作的语句。</p>
<blockquote>
<p>实际开发时使用 <code>PreparedStatement</code> 比较多</p>
</blockquote>
<h4 id="3-7-3-常用方法"><a href="#3-7-3-常用方法" class="headerlink" title="3.7.3. 常用方法"></a>3.7.3. 常用方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">executeUpdate</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<p>用于增删改的操作，返回影响的行数<br>在此 PreparedStatement 对象中执行 SQL 语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ResultSet <span class="title function_">executeQuery</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<p>用于查询，返回结果集。在此 <code>PreparedStatement</code> 对象中执行 SQL 查询，并返回该查询结果集封装成的 <code>ResultSet</code> 对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">setXxx</span><span class="params">(<span class="type">int</span> index, Xxx xxx)</span>;</span><br></pre></td></tr></table></figure>
<p>将指定参数值 <code>xxx</code> 赋值给第 <code>index</code> 个占位符 <code>?</code> 。再将此值发送到数据库时，驱动程序将它转换成一个 SQL Xxx类型值。</p>
<h4 id="3-7-4-预编译"><a href="#3-7-4-预编译" class="headerlink" title="3.7.4. 预编译"></a>3.7.4. 预编译</h4><p>数据库在接收到 SQL 语句后，需要对词法和语义解析，优化 SQL 语句，制定执行计划等一系列处理，这需要花费一些时间。如果一条 SQL 语句需要反复执行，每次都进行语法检查和优化，显然会造成性能与时间的浪费。</p>
<p>SQL 预编译，指的是数据库驱动在发送 SQL 语句和参数给 DBMS 之前对 SQL 语句进行编译，这样 DBMS 执行 SQL 时，就不需要重新编译，一次编译、多次运行，省去解析优化等过程。</p>
<p>JDBC 中使用对象 <code>PreparedStatement</code> 来抽象预编译语句，使用预编译。具体做法是将 SQl 语句中的<strong>值用占位符替代</strong>，即<strong>SQL 语句模板化</strong>。预编译阶段可以优化 SQL 的执行，预编译之后的 SQL 多数情况下可以直接执行，DBMS 不需要再次编译，越复杂的 SQL，编译的复杂度将越大，预编译阶段可以合并多次操作为一个操作；同时预编译语句对象可以重复利用，把一个 SQL 预编译后产生的 <code>PreparedStatement</code> 对象缓存下来，下次对于同一个SQL，可以直接使用这个缓存的对象。</p>
<p><strong>预编译的作用小结</strong>：</p>
<ul>
<li>预编译阶段可以优化 sql 的执行。预编译之后的 sql 多数情况下可以直接执行，数据库服务器不需要再次编译，可以提升性能。</li>
<li>预编译语句对象可以重复利用。将一个 sql 预编译后产生的 <code>PreparedStatement</code> 对象缓存下来，下次对于同一个 sql，可以直接使用这个缓存的对象。</li>
<li>防止 SQL 注入。使用预编译，对注入的参数将<strong>不会再进行 SQL 编译</strong>。即后面注入进来的参数系统将不会认为它会是一条 SQL 语句，而默认其是一个参数。</li>
</ul>
<h4 id="3-7-5-Statement-和-PreparedStatement-的区别"><a href="#3-7-5-Statement-和-PreparedStatement-的区别" class="headerlink" title="3.7.5. Statement 和 PreparedStatement 的区别"></a>3.7.5. Statement 和 PreparedStatement 的区别</h4><ol>
<li>安全性<ul>
<li><code>PreparedStatement</code> 可以防止 SQL 注入问题，安全</li>
<li><code>Statement</code> 有 SQL注入 的隐患问题，不安全</li>
</ul>
</li>
<li>预编译功能<ul>
<li><code>PreparedStatement</code> 有预编译的功能，在创建对象的时候就提供了 SQL 语句并存储在 <code>PreparedStatement</code> 对象中。在真正执行前，才把参数传递给 SQL 语句，并且可以反复执行。</li>
<li><code>Statement</code> 没有预编译的功能，创建的时候没有 SQL 语句，执行的时候才提供 SQL 语句</li>
</ul>
</li>
<li>缓存<ul>
<li><code>PreparedStatement</code> 有缓存功能，使用缓存可以提升运行速度。</li>
<li><code>Statement</code> 没有缓存功能</li>
</ul>
</li>
<li>效率<ul>
<li><code>PreparedStatement</code> 效率高，因为数据库系统对相同的 SQL 语句不会再次编译</li>
<li><code>Statement</code> 效率低</li>
</ul>
</li>
</ol>
<h4 id="3-7-6-PreparedStatement-使用步骤"><a href="#3-7-6-PreparedStatement-使用步骤" class="headerlink" title="3.7.6. PreparedStatement 使用步骤"></a>3.7.6. PreparedStatement 使用步骤</h4><ol>
<li>准备要执行的SQL语句，使用 <code>?</code> 临时代替真实的参数</li>
<li>调用 <code>Connection</code> 对象的 <code>preparedStatement()</code> 方法创建 <code>PreparedStatement</code> 对象，并传递SQL语句</li>
<li>调用 <code>PreparedStatement</code> 对象的 <code>setXxx(int index, Xxx value)</code> 给占位符 <code>?</code> 使用真实的参数赋值，<font color=red><strong><code>?</code> 参数序号，从 1 开始</strong></font></li>
<li>调用 <code>PreparedStatement</code> 对象的 <code>executeUpdate()</code>/<code>executeQuery()</code> 方法，执行SQL语句，不需要再次传递SQL语句。</li>
</ol>
<font color=red>**注：要先使用 `setXxx()` 方法给占位符 `?` 赋值后再调用 `executeXxx()` 方法**</font>

<h3 id="3-8-释放资源"><a href="#3-8-释放资源" class="headerlink" title="3.8. 释放资源"></a>3.8. 释放资源</h3><ol>
<li>需要释放的对象和顺序：<code>ResultSet</code> -&gt; <code>Statement</code> -&gt; <code>Connection</code></li>
<li><code>Connection</code> 对象释放原则：尽可能晚的打开，尽可能早的释放。因为 <code>Connection</code> 资源比较占用内存的，而且使用频率高，是公共的，稀缺的资源。</li>
<li>释放资源的操作放在 <code>finally</code> 语句块中</li>
</ol>
<h3 id="3-9-API-示例"><a href="#3-9-API-示例" class="headerlink" title="3.9. API 示例"></a>3.9. API 示例</h3><h4 id="3-9-1-使用-executeUpdate-执行-DML-操作数据库练习代码"><a href="#3-9-1-使用-executeUpdate-执行-DML-操作数据库练习代码" class="headerlink" title="3.9.1. 使用 executeUpdate 执行 DML 操作数据库练习代码"></a>3.9.1. 使用 executeUpdate 执行 DML 操作数据库练习代码</h4><p>Code Demo: 给数据库insert、update、delete create、drop等操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 3.1 使用 JDBC 的开发步骤：</span></span><br><span class="line"><span class="comment">	 	* 1. 注册并加载数据库驱动 Class.forName()</span></span><br><span class="line"><span class="comment">	 	* 2. 连接数据库，获取连接对象 Connection con = DriverManager.getConnection();</span></span><br><span class="line"><span class="comment">	 	* 3. 创建 Statement对象  Statement stmt = conn.createStatement();</span></span><br><span class="line"><span class="comment">	 	* 4. 使用 Statement对象发送 SQL</span></span><br><span class="line"><span class="comment">	 	* 5. 处理结果</span></span><br><span class="line"><span class="comment">	 	* 6. 关闭连接，后开的先关。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MoonZero</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// 注册数据库驱动</span></span><br><span class="line">		Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 准备连接数据库字符串</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/tempDb&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">uName</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 连接数据库，获取Connection对象</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> DriverManager.getConnection(url, uName, pwd);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取Statement对象</span></span><br><span class="line">		<span class="type">Statement</span> <span class="variable">sta</span> <span class="operator">=</span> con.createStatement();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用Statement对象进行DDL和DML操作,定义一个sql操作语句字符串</span></span><br><span class="line">		String sql;</span><br><span class="line">		<span class="comment">// 创建表</span></span><br><span class="line">		<span class="comment">// sql = &quot;create table testss(id int primary key,tname varchar(20) not null);&quot;;</span></span><br><span class="line">		<span class="comment">// 执行后line=0</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 删除数据表</span></span><br><span class="line">		<span class="comment">// sql = &quot;drop table testss;&quot;;</span></span><br><span class="line">		<span class="comment">// 执行后line=0</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 进行insert操作</span></span><br><span class="line">		<span class="comment">// sql = &quot;insert into testss values(1,&#x27;试试&#x27;);&quot;;</span></span><br><span class="line">		<span class="comment">// 执行后line=1</span></span><br><span class="line">		<span class="comment">// sql = &quot;insert into testss values(2,&#x27;再试试&#x27;), (3,&#x27;最后一插&#x27;);&quot;;</span></span><br><span class="line">		<span class="comment">// 执行后line=2</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 进行delete操作</span></span><br><span class="line">		<span class="comment">// sql = &quot;delete from testss where id = 1;&quot;;</span></span><br><span class="line">		<span class="comment">// 执行后line=1</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 进行update操作</span></span><br><span class="line">		sql = <span class="string">&quot;update testss set tname=&#x27;用eclipse改一下&#x27; where id = 3;&quot;</span>;</span><br><span class="line">		<span class="comment">// 执行后line=1</span></span><br><span class="line"></span><br><span class="line">		operateTable(sta, sql);</span><br><span class="line">		<span class="comment">// 关闭资源，先开后关</span></span><br><span class="line">		sta.close();</span><br><span class="line">		con.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 测试创建数据表方法</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">operateTable</span><span class="params">(Statement sta, String sql)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 执行后line=0</span></span><br><span class="line">		<span class="type">int</span> <span class="variable">line</span> <span class="operator">=</span> sta.executeUpdate(sql);</span><br><span class="line">		System.out.println(line);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-9-2-解析-executeQuery-返回的数据库结果集练习代码"><a href="#3-9-2-解析-executeQuery-返回的数据库结果集练习代码" class="headerlink" title="3.9.2. 解析 executeQuery 返回的数据库结果集练习代码"></a>3.9.2. 解析 executeQuery 返回的数据库结果集练习代码</h4><p>Code Demo: 解析 executeQuery 返回的数据库结果集(执行 DQL 操作)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MoonZero</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// 数据库注册</span></span><br><span class="line">		Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取数据库Connetion对象</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/tempDb&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, pwd);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获得语句执行平台，通过数据库连接对象，获取到SQL语句执行者对象</span></span><br><span class="line">		<span class="type">Statement</span> <span class="variable">stat</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 准备sql语句</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from dept&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取查询返回的select查询结果集</span></span><br><span class="line">		<span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stat.executeQuery(sql);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用循环解析返回的所有内容</span></span><br><span class="line">		<span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">			System.out.print(rs.getInt(<span class="string">&quot;id&quot;</span>) + <span class="string">&quot; &quot;</span>);</span><br><span class="line">			System.out.println(rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 关闭资源</span></span><br><span class="line">		rs.close();</span><br><span class="line">		stat.close();</span><br><span class="line">		conn.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-9-3-自定义数据库工具类练习"><a href="#3-9-3-自定义数据库工具类练习" class="headerlink" title="3.9.3. 自定义数据库工具类练习"></a>3.9.3. 自定义数据库工具类练习</h4><p>Code Demo: 自定义原生JDBC数据库工具类，用来创建连接和关闭资源，用户名和密码使用读取 properties 属性文件的方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取数据连接、关闭等操作的工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MooNJDBCUtils</span> &#123;</span><br><span class="line">	<span class="comment">// 数据库驱动字符串</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DRIVER_CLASS</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 使用静态代码块，用来加载类时就运行注册的动作</span></span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(DRIVER_CLASS);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获取数据库连接对象</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> url  需要连接的数据库地址url字符串</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> 连接数据库对象</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">(String url)</span> &#123;</span><br><span class="line">		<span class="comment">// 读取jdbc.properties配置文件，获取用户名和密码</span></span><br><span class="line">		<span class="type">Properties</span> <span class="variable">pro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			pro.load(MooNJDBCUtils.class.getResourceAsStream(<span class="string">&quot;/jdbc.properties&quot;</span>));</span><br><span class="line">			<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, pro);</span><br><span class="line">			<span class="keyword">return</span> conn;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(ResultSet rs, Statement stmt, Connection conn)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (rs != <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				rs.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		close(stmt, conn);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 关闭数据库资源方法</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> stmt  数据库操作对象(子类PreparedStatement也可以关闭)</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> conn  数据库的连接对象</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Statement stmt, Connection conn)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (stmt != <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				stmt.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		close(conn);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 关闭数据库连接对象方法</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> conn  数据库的连接对象</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				conn.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>保存用户名和密码的 properties 属性文件 jdbc.properties:</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">user</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">123456</span></span><br></pre></td></tr></table></figure>
<h2 id="4-JDBC-事务操作"><a href="#4-JDBC-事务操作" class="headerlink" title="4. JDBC 事务操作"></a>4. JDBC 事务操作</h2><h3 id="4-1-JDBC-事务处理的分类"><a href="#4-1-JDBC-事务处理的分类" class="headerlink" title="4.1. JDBC 事务处理的分类"></a>4.1. JDBC 事务处理的分类</h3><p>事务处理方式主要分为两种：<strong>自动处理</strong>和<strong>手动处理</strong>。</p>
<p><strong>自动处理</strong>：每条SQL语句执行后自动提交事务，无法通过回滚撤消操作。</p>
<p><strong>手动处理</strong>：</p>
<ol>
<li>先调用 <code>setAutoCommit(false)</code> 开启事务，取消自动提交</li>
<li>在 SQL 执行完后调用 <code>commit()</code> 提交事务；如果出现异常则调用 <code>rollback()</code> 回滚事务。</li>
</ol>
<h3 id="4-2-Connection-接口与事务处理相关的方法"><a href="#4-2-Connection-接口与事务处理相关的方法" class="headerlink" title="4.2. Connection 接口与事务处理相关的方法"></a>4.2. Connection 接口与事务处理相关的方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">setAutoCommit</span><span class="params">(<span class="type">boolean</span> autoCommit)</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li>将此连接的自动提交模式设置为给定状态。如果连接处于自动提交模式下，则它的所有 SQL 语句将被执行并作为单个事务提交。否则，它的 SQL 语句将聚集到事务中，直到调用 commit 方法或 rollback 方法为止。默认情况下，新连接处于自动提交模式。参数 <code>boolean autoCommit</code> 的取值说明如下：<ul>
<li>autoCommit 设置为 false，则代表开启事务，后面的 SQL 语句将算成一个事务，直到调用 commit 方法或 rollback 方法为止。</li>
<li>默认情况下，autoCommit 值为 true，是自动提交模式，代表后面每一个 SQL 语句算成一个事务，自动提交事务。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">commit</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li>提交事务</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">rollback</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>
<ul>
<li>回滚事务</li>
</ul>
<h3 id="4-3-JDBC-事务操作基础示例"><a href="#4-3-JDBC-事务操作基础示例" class="headerlink" title="4.3. JDBC 事务操作基础示例"></a>4.3. JDBC 事务操作基础示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.DbUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jdbc.C3P0Utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MoonZero</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="comment">// 声明连接对象</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="comment">// 声明操作数据库对象</span></span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// 定义操作sql语句</span></span><br><span class="line">			<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update users set gender=&#x27;改&#x27; where id=2;&quot;</span>;</span><br><span class="line">			<span class="comment">// 使用工具类读取配置文件获取连接</span></span><br><span class="line">			conn = C3P0Utils.getConnection();</span><br><span class="line">			<span class="comment">// 关闭事务自动提交</span></span><br><span class="line">			conn.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 获取操作对象,对数据库进行更新</span></span><br><span class="line">			ps = conn.prepareStatement(sql);</span><br><span class="line">			ps.executeUpdate();</span><br><span class="line"></span><br><span class="line">			DbUtils.closeQuietly(ps);</span><br><span class="line">			<span class="comment">// 手动制造异常</span></span><br><span class="line">			<span class="comment">// System.out.println(5 / 0);</span></span><br><span class="line"></span><br><span class="line">			ps = conn.prepareStatement(<span class="string">&quot;update users set gender=&#x27;改&#x27; where id=4;&quot;</span>);</span><br><span class="line">			ps.executeUpdate();</span><br><span class="line">			System.out.println(<span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">			<span class="comment">// 提交事务</span></span><br><span class="line">			DbUtils.commitAndCloseQuietly(conn);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// 事务回滚</span></span><br><span class="line">			DbUtils.rollbackAndCloseQuietly(conn);</span><br><span class="line">			System.out.println(<span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="comment">// 使用DbUtils工具类关闭资源</span></span><br><span class="line">			DbUtils.closeQuietly(ps);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-JDBC-连接池"><a href="#5-JDBC-连接池" class="headerlink" title="5. JDBC 连接池"></a>5. JDBC 连接池</h2><h3 id="5-1-连接池概述"><a href="#5-1-连接池概述" class="headerlink" title="5.1. 连接池概述"></a>5.1. 连接池概述</h3><p><strong>连接池</strong>是一个用来创建和管理数据连接对象的容器。</p>
<font color=red>**连接池的核心思想：连接复用**</font>，为数据库连接建立一个“缓冲池”。预先在缓冲池中放入一定数量的连接，当需要建立数据库连接时，只需从“缓冲池”中取出一个连接，使用完毕之后再放回池中。可以通过设定连接池最大连接数来防止系统无限制地与数据库连接，更为重要的是可以通过连接池的管理机制监视数据库的连接的数量、使用情况，为系统开发，测试及性能调整提供依据。

#### 5.1.1. JDBC 中连接数据的问题

获取连接对象需要消耗比较多的资源，而每次操作都要重新获取新的连接对象，执行一次操作就把连接关闭，这样连接对象的使用率低。而数据库创建连接通常需要消耗相对较多的资源，创建时间也较长。

使用连接池技术可以避免频繁创建数据库连接对象和销毁连接对象带来的开销。

#### 5.1.2. 连接池的使用步骤

- 创建：程序启动时创建连接池(容器)并初始化连接对象。放在一块内存中，这块内存称为连接池。
- 获取(使用)：直接从连接池中获得一个已经创建好的连接对象来操作数据库
- 关闭：关闭的时候不是真正关闭连接，而是将连接对象再次放回到连接池中，等待复用。

### 5.2. DataSource 数据库连接池 API

#### 5.2.1. 数据源(连接池)接口

`javax.sql.DataSource` 接口表示数据源。只要是实现类实现了该接口的类，就是一个连接池类。

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DataSource</span>  <span class="keyword">extends</span> <span class="title class_">CommonDataSource</span>, Wrapper</span><br></pre></td></tr></table></figure>

#### 5.2.2. 连接池接口常用方法

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br></pre></td></tr></table></figure>

从数据源（连接池）中获取一个连接对象

#### 5.2.3. 连接池相关参数

1. 初始连接数：一开始连接池中创建多少个连接对象。
2. 最大连接数：连接池中最多可以有多少个连接对象。
3. 最长等待时间：当一个会话要从连接池中得到连接对象的时候，最长等待多久。
4. 最长空闲时间：当一个连接对象在指定时间内没有被使用时，则回收该连接对象。

### 5.3. 常用数据库连接池（第三方工具）

- C3P0 连接池
- DBCP 连接池

### 5.4. C3P0 连接池技术

#### 5.4.1. C3P0 连接池概述

C3P0 是一个开源的第三方 JDBC 连接池工具，它实现了数据源和 JNDI 绑定，支持 JDBC3 规范和 JDBC2 的标准扩展。目前使用它的开源项目有 Hibernate，Spring 等。

> 官网下载地址：https://sourceforge.net/projects/c3p0/

#### 5.4.2. C3P0 连接池的特点

1. 免费开源的连接池技术
2. 很多主流的第三方框架都是使用该连接池技术。比如：Spring 和 Hibernate 框架，默认推荐使用 C3P0 作为连接池实现

#### 5.4.3. c3p0 与 DBCP 区别

- dbcp 没有自动回收空闲连接的功能
- c3p0 有自动回收空闲连接功能

#### 5.4.4. C3P0 的使用步骤

1. 导入 jar 库 c3p0-0.9.5.2.jar 和 mchange-commons-java-0.2.11.jar。（*注：数据库驱动mysql-connector-java-5.1.37-bin.jar也不能少*）
2. 创建连接池对象 ComboPooledDataSource 对象
    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ComboPooledDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>();</span><br></pre></td></tr></table></figure>
3. 设置数据库连接参数（jdbcUrl，user，password，driverClass）
    - 数据库连接url字符串：`ds.setJdbcUrl("jdbc:mysql://localhost:3306/tempDb");`
    - 用户名：`ds.setUser("root");`
    - 密码：`ds.setPassword("123456");`
    - 驱动类全名：`ds.setDriverClass("com.mysql.jdbc.Driver");`
4. 设置连接池参数
    - 初始连接数：一开始获得多少个数据连接对象(默认值：3)，如果设置值少于3，也是默认是3。
    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setInitialPoolSize(<span class="type">int</span> num)</span><br></pre></td></tr></table></figure>
    - 最大连接数：连接池中最多有多少个连接对象可以使用(默认值：15)
    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setMaxPoolSize(<span class="type">int</span> num)</span><br></pre></td></tr></table></figure>
    - 最大等待时间：当某个纯种要获得连接对象时，如果没有可用的连接对象时需要等待的时间，如果超过时间还没有获得，则抛出异常。(默认值：0，就是无限等待)
    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setCheckoutTimeout(毫秒值)</span><br></pre></td></tr></table></figure>
    - 最大空闲回收时间：连接对象空间时长，如果在指定的时长内没有被再次使用，会被真正关闭。(默认值：0，就是无限等待)
    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setMaxIdleTime(秒值)</span><br></pre></td></tr></table></figure>
5. 调用 `getConnection()` 方法，获取连接对象。
    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br></pre></td></tr></table></figure>
6. 关闭连接对象。不是真正关闭，而是将连接对象放回连接池中。

Code Demo: C3P0创建连接池步骤练习

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MoonZero</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="comment">// 创建连接池对象</span></span><br><span class="line">		<span class="type">ComboPooledDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// 设置连接参数</span></span><br><span class="line">			ds.setDriverClass(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">			ds.setJdbcUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/tempDb&quot;</span>);</span><br><span class="line">			ds.setUser(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">			ds.setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 设置连接池参数</span></span><br><span class="line">			<span class="comment">// 初始化连接数</span></span><br><span class="line">			ds.setInitialPoolSize(<span class="number">5</span>);</span><br><span class="line">			<span class="comment">// 最大连接数</span></span><br><span class="line">			ds.setMaxPoolSize(<span class="number">10</span>);</span><br><span class="line">			<span class="comment">// 最大等待时间</span></span><br><span class="line">			ds.setCheckoutTimeout(<span class="number">3000</span>);</span><br><span class="line">			<span class="comment">// 最大空余等待时间</span></span><br><span class="line">			ds.setMaxIdleTime(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 获取连接</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">11</span>; i++) &#123;</span><br><span class="line">				<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br><span class="line">				System.out.println(conn);</span><br><span class="line">				<span class="keyword">if</span> (i == <span class="number">5</span>) &#123;</span><br><span class="line">					<span class="comment">// 不是真正关闭，将连接对象放回连接池</span></span><br><span class="line">					conn.close();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

#### 5.4.5. C3P0 连接池(使用 xml 配置文件加载)

##### 5.4.5.1. 使用配置文件的好处

1. 配置信息和操作数据库代码分离，降低了程序的耦合性。
2. 配置信息不是硬编码到 Java 源码中，后期维护更加方便。
3. 可以使用不同的连接池参数。如：`maxPoolSize=10`,`maxPoolSize=8`
4. 可以连接不同的数据库。如：db1,db2
5. 可以连接不同厂商的数据库。如：Oracle 或 MySQL

##### 5.4.5.2. 配置文件的要求

1. 文件名命名要求：`c3p0-config.xml`
2. 位置要求：放在类路径下，源代码即 src 目录下。

##### 5.4.5.3. C3P0 配置文件的使用方式

方式1： 使用默认配置（default-config）

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ComboPooledDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>();</span><br></pre></td></tr></table></figure>

方式2： 使用命名配置（`named-config：name="配置名"`）

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ComboPooledDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>(<span class="string">&quot;配置名&quot;</span>);</span><br></pre></td></tr></table></figure>

<font color=red>**配置文件的各个属性名，都是以设置方法去掉`set`后的名字。**</font>

<p>Code Demo : C3P0 配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 默认配置 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">default-config</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 数据库连接信息 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/tempDb<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- 连接池的配置 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接池初始化连接数 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接池最大连接数 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接池最大等待时间 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;checkoutTimeout&quot;</span>&gt;</span>3000<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接池最大空闲时间 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxIdleTime&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">default-config</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 其它的命名配置 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">named-config</span> <span class="attr">name</span>=<span class="string">&quot;MoonZero-config&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 数据库连接信息 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://127.0.0.1:3306/tempDb<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- 连接池的配置 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接池初始化连接数 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接池最大连接数 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>9<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接池最大等待时间 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;checkoutTimeout&quot;</span>&gt;</span>3000<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 连接池最大空闲时间 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxIdleTime&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">named-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c3p0-config</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Code Demo : C3P0 使用配置文件创建连接池</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 关卡1训练案例2</span></span><br><span class="line"><span class="comment"> * 1.C3P0 连接池的使用</span></span><br><span class="line"><span class="comment"> 	* 要求：连接池参数和初始化连接数通过配置文件配置。</span></span><br><span class="line"><span class="comment"> * 使用 C3P0连接池获得 10个连接对象。</span></span><br><span class="line"><span class="comment"> 	* 要求：分别使用默认配置和命名配置创建连接池对象。再通过连接池对象获得连接对象。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MoonZero</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="comment">// 使用配置文件创建连接池对象(方式1：使用默认配置(default-config))</span></span><br><span class="line">		<span class="comment">// ComboPooledDataSource ds = new ComboPooledDataSource();</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用配置文件创建连接池对象(方式2：使用命名配置(named-config:MoonZero-config))</span></span><br><span class="line">		<span class="type">ComboPooledDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>(<span class="string">&quot;MoonZero-config&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用循环获取连接对象</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">11</span>; i++) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br><span class="line">				System.out.println(i + <span class="string">&quot; = &quot;</span> + conn);</span><br><span class="line">				<span class="comment">// 测试最大连接数，不是真正的关闭，只是放回去连接池</span></span><br><span class="line">				<span class="keyword">if</span> (i == <span class="number">5</span> || i == <span class="number">9</span>) &#123;</span><br><span class="line">					conn.close();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-4-6-自定义-C3P0-连接池工具类"><a href="#5-4-6-自定义-C3P0-连接池工具类" class="headerlink" title="5.4.6. 自定义 C3P0 连接池工具类"></a>5.4.6. 自定义 C3P0 连接池工具类</h4><p>Code Demo: 自定义C3P0工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">C3P0Utils</span> &#123;</span><br><span class="line">	<span class="comment">// 创建私有静态数据源(连接池对象)成员变量</span></span><br><span class="line">	<span class="comment">// src文件夹下有xml配置文件，所以不需要进行数据库设置与连接池设置</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="type">DataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 创建公有的得到数据源(连接池对象)的方法</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> DataSource <span class="title function_">getDataSource</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> ds;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 创建共有的得到连接对象的方法</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> ds.getConnection();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-5-DBCP-连接池技术"><a href="#5-5-DBCP-连接池技术" class="headerlink" title="5.5. DBCP 连接池技术"></a>5.5. DBCP 连接池技术</h3><h4 id="5-5-1-DBCP-连接池概述"><a href="#5-5-1-DBCP-连接池概述" class="headerlink" title="5.5.1. DBCP 连接池概述"></a>5.5.1. DBCP 连接池概述</h4><p>DBCP: DataBase Connection Pool 数据库连接池。</p>
<p>DBCP 是 Apache 旗下组织开发的一款产品，免费开源的，也是 Tomcat 服务器的默认使用连接池</p>
<h4 id="5-5-2-DBCP-使用步骤"><a href="#5-5-2-DBCP-使用步骤" class="headerlink" title="5.5.2. DBCP 使用步骤"></a>5.5.2. DBCP 使用步骤</h4><ol>
<li>导入 dbcp 相关的 jar 包<pre><code> 目前使用版本
     commons-dbcp-1.4.jar    核心包
     commons-pool-1.6.jar    支持包
 注：DBCP 2 compiles and runs under Java 7 only (JDBC 4.1)
     DBCP 1.4 compiles and runs under Java 6 only (JDBC 4)
</code></pre></li>
<li>创建连接池对象 <code>BasicDataSource</code> 对象 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BasicDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BasicDataSource</span>();</span><br></pre></td></tr></table></figure></li>
<li>设置连接参数（url，username，password，driverClassName）<ul>
<li>数据库连接url字符串：<code>ds.setUrl(&quot;jdbc:mysql://localhost:3306/tempDb&quot;);</code></li>
<li>用户名：<code>ds.setUsername(&quot;root&quot;);</code></li>
<li>密码：<code>ds.setPassword(&quot;xxx&quot;);</code></li>
<li>驱动类全名：<code>ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;);</code><blockquote>
<p><strong>注：与C3P0设置连接参数的方法名有不同</strong></p>
</blockquote>
</li>
</ul>
</li>
<li>设置连接池参数（初始连接数，最大连接数，最大等待时间，最大空闲数）<ul>
<li>初始化连接数：<code>setInitialSize(int num)</code></li>
<li>最大连接数：<code>setMaxActive(int num)</code></li>
<li>超过最大连接数时，最大等待时间：<code>setMaxWait(毫秒值)</code></li>
<li>最大空闲数：<code>setMaxIdle(int num)</code> 连接池中最多只有指定个数的连接对象空闲。<blockquote>
<p><strong>注：与C3P0设置连接池参数的方法名有不同</strong></p>
</blockquote>
</li>
</ul>
</li>
<li>调用 <code>getConnection()</code> 方法，获取连接对象 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br></pre></td></tr></table></figure></li>
<li>关闭连接对象。不是真正关闭，而是将连接对象放回连接池中</li>
</ol>
<p>Code Demo: DBCP连接池技术</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbcp.BasicDataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MoonZero</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// 创建连接池对象</span></span><br><span class="line">			<span class="type">BasicDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BasicDataSource</span>();</span><br><span class="line">			<span class="comment">// 设置连接参数</span></span><br><span class="line">			ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">			ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/tempDb&quot;</span>);</span><br><span class="line">			ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">			ds.setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 设置连接池参数</span></span><br><span class="line">			<span class="comment">// 初始化连接数</span></span><br><span class="line">			ds.setInitialSize(<span class="number">5</span>);</span><br><span class="line">			<span class="comment">// 最大连接数</span></span><br><span class="line">			ds.setMaxActive(<span class="number">10</span>);</span><br><span class="line">			<span class="comment">// 超过最大连接数时，最大等待时间</span></span><br><span class="line">			ds.setMaxWait(<span class="number">3000</span>);</span><br><span class="line">			<span class="comment">// 最大空闲连接数</span></span><br><span class="line">			ds.setMaxIdle(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 获取连接</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">				<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br><span class="line">				<span class="comment">// 因为 DBCP 返回的 Connection 对象已经重写了 toString()方法，</span></span><br><span class="line">				<span class="comment">// 为了看到不同的对象，输出 hashCode()方法。</span></span><br><span class="line">				System.out.println(i + <span class="string">&quot; : &quot;</span> + conn.hashCode());</span><br><span class="line">				<span class="keyword">if</span> (i == <span class="number">5</span>) &#123;</span><br><span class="line">					<span class="comment">// 释放连接(不是真正的关闭连接对象，而是把连接对象放回连接池)</span></span><br><span class="line">					conn.close();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">输出结果：</span><br><span class="line">1 : 1327763628</span><br><span class="line">2 : 1915503092</span><br><span class="line">3 : 1535128843</span><br><span class="line">4 : 2027961269</span><br><span class="line">5 : 458209687</span><br><span class="line">6 : 458209687</span><br><span class="line">7 : 254413710</span><br><span class="line">8 : 1789447862</span><br><span class="line">9 : 1688376486</span><br><span class="line">10 : 445884362</span><br></pre></td></tr></table></figure>
<h4 id="5-5-3-使用-Properties-配置文件加载-DBCP-连接池"><a href="#5-5-3-使用-Properties-配置文件加载-DBCP-连接池" class="headerlink" title="5.5.3. 使用 Properties 配置文件加载 DBCP 连接池"></a>5.5.3. 使用 Properties 配置文件加载 DBCP 连接池</h4><h5 id="5-5-3-1-DBCP配置文件要求"><a href="#5-5-3-1-DBCP配置文件要求" class="headerlink" title="5.5.3.1. DBCP配置文件要求"></a>5.5.3.1. DBCP配置文件要求</h5><ol>
<li>文件名命名要求：xxx.properties，一般使用 dbcp.properties</li>
<li>位置要求：放在类路径下，源代码即 src 目录下。</li>
<li>键名：配置文件的键与方法名去掉 set 相同，首字母小写。</li>
</ol>
<blockquote>
<p>注：写键值对时，在”=”左右尽量不要有空格</p>
</blockquote>
<p>dbcp.properties : DBCP配置文件示例</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据库的连接信息</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/tempDb</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">123456</span></span><br><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="comment">#连接池的配置信息</span></span><br><span class="line"><span class="attr">initailSize</span>=<span class="string">5</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">10</span></span><br><span class="line"><span class="attr">maxWait</span>=<span class="string">3000</span></span><br><span class="line"><span class="attr">maxIdle</span>=<span class="string">7</span></span><br></pre></td></tr></table></figure>
<h5 id="5-5-3-2-DBCP-使用配置文件加载连接池步骤"><a href="#5-5-3-2-DBCP-使用配置文件加载连接池步骤" class="headerlink" title="5.5.3.2. DBCP 使用配置文件加载连接池步骤"></a>5.5.3.2. DBCP 使用配置文件加载连接池步骤</h5><ol>
<li>创建 <code>Properties</code> 属性文件，配置相关参数</li>
<li>通过类对象的 <code>getResourceAsStream(&quot;/dbcp.properties&quot;)</code> 方法，从类路径下加载文件，以字节流的方式加载。</li>
<li>通过 <code>properties.load(InputStream in)</code> 加载属性文件</li>
<li>通过 <code>BasicDataSourceFactory.createDataSource(Properties prop)</code>，得到 <code>DataSource</code> 连接池对象</li>
<li>通过 <code>DataSource</code> 类对象调用 <code>getConnection()</code> 方法得到连接对象</li>
<li>关闭连接对象</li>
</ol>
<p>Code Demo: DBCP使用配置文件加载连接池</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbcp.BasicDataSource;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbcp.BasicDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MoonZero</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// 创建Properties类对象读取属性文件</span></span><br><span class="line">			<span class="type">Properties</span> <span class="variable">pro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">			pro.load(MoonZero.class.getResourceAsStream(<span class="string">&quot;/dbcp.properties&quot;</span>));</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 创建连接池对象</span></span><br><span class="line">			<span class="type">DataSource</span> <span class="variable">ds</span> <span class="operator">=</span> BasicDataSourceFactory.createDataSource(pro);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 获取连接</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">11</span>; i++) &#123;</span><br><span class="line">				<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br><span class="line">				<span class="comment">// 因为 DBCP 返回的 Connection 对象已经重写了 toString()方法，</span></span><br><span class="line">				<span class="comment">// 为了看到不同的对象，输出 hashCode()方法。</span></span><br><span class="line">				System.out.println(i + <span class="string">&quot; : &quot;</span> + conn.hashCode());</span><br><span class="line">				<span class="keyword">if</span> (i == <span class="number">5</span>) &#123;</span><br><span class="line">					<span class="comment">// 释放连接(不是真正的关闭连接对象，而是把连接对象放回连接池)</span></span><br><span class="line">					conn.close();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-DBUtils-工具"><a href="#6-DBUtils-工具" class="headerlink" title="6. DBUtils 工具"></a>6. DBUtils 工具</h2><h3 id="6-1-DbUtils-工具概述"><a href="#6-1-DbUtils-工具概述" class="headerlink" title="6.1. DbUtils 工具概述"></a>6.1. DbUtils 工具概述</h3><p><code>DbUtils</code> 是 Apache 组织开发的一个开源 JDBC 工具类库。是一款方便操作数据库的工具。</p>
<p>使用 DBUtils 能简化 JDBC 操作数据库复杂的代码，同时也不会影响程序的性能。使用需要导入 jar 包：</p>
<ul>
<li>commons-dbutils-x.x.jar  核心包</li>
<li>commons-logging-x.x.x.jar  日志记录包</li>
</ul>
<p>目前使用的是：commons-dbutils-1.7.jar</p>
<h3 id="6-2-DbUtils-工具的核心类"><a href="#6-2-DbUtils-工具的核心类" class="headerlink" title="6.2. DbUtils 工具的核心类"></a>6.2. DbUtils 工具的核心类</h3><h4 id="6-2-1-DbUtils-类"><a href="#6-2-1-DbUtils-类" class="headerlink" title="6.2.1. DbUtils 类"></a>6.2.1. DbUtils 类</h4><p>提供了装载 JDBC 驱动程序、关闭资源和处理事务的相关静态方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(…)</span> <span class="keyword">throws</span> java.sql.SQLException;</span><br></pre></td></tr></table></figure>
<p>DbUtils 类提供了三个重载的关闭方法。这些方法检查所提供的参数是不是 <code>NULL</code>，如果不是的话，它们就关闭 <code>Connection</code>、<code>Statement</code> 和 <code>ResultSet</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeQuietly</span><span class="params">(…)</span>;</span><br></pre></td></tr></table></figure>
<p>这一类方法不仅能在 <code>Connection</code>、<code>Statement</code> 和 <code>ResultSet</code> 为 <code>NULL</code> 情况下避免关闭，还能隐藏一些在程序中抛出的 <code>SQLException</code>。</p>
<h4 id="6-2-2-QueryRunner-类"><a href="#6-2-2-QueryRunner-类" class="headerlink" title="6.2.2. QueryRunner 类"></a>6.2.2. QueryRunner 类</h4><p>用来对数据库执行CRUD(增删改查)操作</p>
<h5 id="6-2-2-1-QueryRunner-增删改操作方式1：传入数据源对象"><a href="#6-2-2-1-QueryRunner-增删改操作方式1：传入数据源对象" class="headerlink" title="6.2.2.1. QueryRunner 增删改操作方式1：传入数据源对象"></a>6.2.2.1. QueryRunner 增删改操作方式1：传入数据源对象</h5><p><strong>构造方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QueryRunner(DataSource ds);</span><br></pre></td></tr></table></figure>
<p>根据数据源创建查询器对象，方法参数：</p>
<ul>
<li><code>ds</code>: 连接池对象，数据源</li>
</ul>
<p><strong>增删改的方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">update</span><span class="params">(String sql)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">update</span><span class="params">(String sql, Object param)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">update</span><span class="params">(String sql, Object...params)</span>;</span><br></pre></td></tr></table></figure>
<p>执行增删改操作，返回影响的行数。</p>
<p>方法参数：</p>
<ul>
<li><code>sql</code>：需要执行的sql语句</li>
<li><code>params</code>：实际参数(真实参数)，给sql语句中的占位符赋值</li>
</ul>
<blockquote>
<p>注：以上方法在内部都有释放资源的代码，所以<font color=red><strong>无需关闭连接</strong></font>等操作</p>
</blockquote>
<h5 id="6-2-2-2-QueryRunner-增删改操作方式2：没有传入任何对象"><a href="#6-2-2-2-QueryRunner-增删改操作方式2：没有传入任何对象" class="headerlink" title="6.2.2.2. QueryRunner 增删改操作方式2：没有传入任何对象"></a>6.2.2.2. QueryRunner 增删改操作方式2：没有传入任何对象</h5><p><strong>构造方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QueryRunner();</span><br></pre></td></tr></table></figure>
<p>创建查询器对象</p>
<p><strong>增删改的方法，在方法中指定 <code>Connection</code> 对象</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">update</span><span class="params">(Connection conn, String sql)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">update</span><span class="params">(Connection conn, String sql, Object...params)</span>;</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>conn</code>: 数据库连接对象</li>
<li><code>sql</code>: 需要执行的sql语句</li>
<li><code>params</code>: 实际参数(真实参数)，给sql语句中的占位符赋值</li>
</ul>
<blockquote>
<p>注：以上方法没有释放资源的代码，<font color=red><strong>需要操作者手动关闭连接</strong></font></p>
</blockquote>
<h5 id="6-2-2-3-QueryRunner-查询操作方式1：没有连接对象"><a href="#6-2-2-3-QueryRunner-查询操作方式1：没有连接对象" class="headerlink" title="6.2.2.3. QueryRunner 查询操作方式1：没有连接对象"></a>6.2.2.3. QueryRunner 查询操作方式1：没有连接对象</h5><p>构造方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QueryRunner(DataSource ds);</span><br></pre></td></tr></table></figure>
<p>根据数据源创建查询器对象。</p>
<p>参数说明：</p>
<ul>
<li><code>ds</code>: 连接池对象，数据源</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Object <span class="title function_">query</span><span class="params">(String sql, ResultSetHandler rsh)</span></span><br><span class="line">Object <span class="title function_">query</span><span class="params">(String sql, ResultSetHandler rsh, Object... params)</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：以上方法在内部都有释放资源的代码，所以<font color=red><strong>无需关闭连接</strong></font>等操作</p>
</blockquote>
<h5 id="6-2-2-4-QueryRunner-查询操作方式2：有连接对象，需要手动关闭资源"><a href="#6-2-2-4-QueryRunner-查询操作方式2：有连接对象，需要手动关闭资源" class="headerlink" title="6.2.2.4. QueryRunner 查询操作方式2：有连接对象，需要手动关闭资源"></a>6.2.2.4. QueryRunner 查询操作方式2：有连接对象，需要手动关闭资源</h5><p>构造方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QueryRunner();</span><br></pre></td></tr></table></figure>
<p>创建查询器对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Object <span class="title function_">query</span><span class="params">(Connection conn, String sql, ResultSetHandler rsh)</span></span><br><span class="line">Object <span class="title function_">query</span><span class="params">(Connection conn, String sql, ResultSetHandler rsh, Object... params)</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注：以上方法没有释放资源的代码，<font color=red><strong>需要操作者手动关闭连接</strong></font></p>
</blockquote>
<h5 id="6-2-2-5-QureyRunner-的操作多个数据方法"><a href="#6-2-2-5-QureyRunner-的操作多个数据方法" class="headerlink" title="6.2.2.5. QureyRunner 的操作多个数据方法"></a>6.2.2.5. QureyRunner 的操作多个数据方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] batch(String sql, Object[][] params)</span><br></pre></td></tr></table></figure>
<p>用于同一个sql语句进行执行多次的方法。</p>
<p>参数说明：</p>
<ul>
<li><code>params</code>：二维数组<ul>
<li>一维：sql语句要执行多次</li>
<li>二维：就是每条sql语句中<code>?</code>存储的占位符的参数，二维长度是<code>?</code>参数的个数</li>
</ul>
</li>
</ul>
<blockquote>
<font color=red>**注：批量处理，是访问数据库一次，一次性执行重复多个sql语句处理，这样可以减少数据库访问次数的压力(如果使用逐条删除的方式，每次删除都访问数据库一次)。**</font>

</blockquote>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量删除商品</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pids 商品id数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delProductBatch</span><span class="params">(String[] pids)</span> &#123;</span><br><span class="line">	<span class="comment">// 删除数据的sql语句，只需要将删除单个数据的语句执行多次，每次根据不同的id删除即可</span></span><br><span class="line">	<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from product where pid=?;&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// DBUtils.runner.batch(sql, params),用于同一个sql语句进行执行多次的方法</span></span><br><span class="line">	<span class="comment">// params 二维数组</span></span><br><span class="line">	<span class="comment">// 一维：sql语句要执行多少次</span></span><br><span class="line">	<span class="comment">// 二维：就是每个sql语句中？存储的占位符的值</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 创建二维数组,长度是传入数组的长度，每个元素数组长度是1</span></span><br><span class="line">	Object[][] params = <span class="keyword">new</span> <span class="title class_">Object</span>[pids.length][<span class="number">1</span>];</span><br><span class="line">	<span class="comment">// 使用循环给二维数组赋值</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">		params[i][<span class="number">0</span>] = pids[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 使用查询器方法操作多次操作</span></span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		qr.batch(sql, params);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-2-3-ResultSetHandler-接口"><a href="#6-2-3-ResultSetHandler-接口" class="headerlink" title="6.2.3. ResultSetHandler 接口"></a>6.2.3. ResultSetHandler 接口</h4><p>用来定义如何封装查询结果集</p>
<h5 id="6-2-3-1-接口的方法"><a href="#6-2-3-1-接口的方法" class="headerlink" title="6.2.3.1. 接口的方法"></a>6.2.3.1. 接口的方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object <span class="title function_">handle</span><span class="params">(ResultSet rs)</span>;</span><br></pre></td></tr></table></figure>
<p>方法调用时机：调用<code>query(String sql, ResultSetHandler rsh);</code>方法查询到结果之后会触发结果集处理器对象的该方法，按需要重写方法返回自定义的结果。</p>
<p>方法内如何处理由操作者定义。当<code>DbUtils</code>提供的常用实现类不能满足要求的时，再定义匿名内部类重写该方法</p>
<p>Code Demo: 实现 <code>ResultSetHandler</code> 接口，重写 <code>handle</code> 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.ResultSetHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jdbc.C3P0Utils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 关卡1训练案例10</span></span><br><span class="line"><span class="comment"> 	* 查询用户表的所有用户数据，要求如下：</span></span><br><span class="line"><span class="comment"> 	* 1.只查询用户名和性别两个字段信息。</span></span><br><span class="line"><span class="comment"> 	* 2.查询结果是一个集合，集合中存放所有的用户对象。</span></span><br><span class="line"><span class="comment">	 	* 操作步骤</span></span><br><span class="line"><span class="comment">	 	* 1. 通过 C3P0Utils 工具类获得数据源对象</span></span><br><span class="line"><span class="comment">	 	* 2. 根据数据源对象创建 QueryRunner 对象</span></span><br><span class="line"><span class="comment">	 	* 3. 编写查询的 SQL 语句。</span></span><br><span class="line"><span class="comment">	 	* 4. 调用 QueryRunner 的对象的 query 方法进行查询</span></span><br><span class="line"><span class="comment">	 	* 5. 获得查询结果。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QueryRunnerTest</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="comment">// 使用c3p0工具类获取数据源对象</span></span><br><span class="line">		<span class="type">DataSource</span> <span class="variable">ds</span> <span class="operator">=</span> C3P0Utils.getDataSource();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取QueryRunner对象</span></span><br><span class="line">		<span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(ds);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 准备sql语句</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select name,gender from users;&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 调用query文件进行查询，重写handle方法，返回一个对象集合</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			List&lt;User&gt; list = qr.query(sql, <span class="keyword">new</span> <span class="title class_">ResultSetHandler</span>&lt;List&lt;User&gt;&gt;() &#123;</span><br><span class="line"></span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="keyword">public</span> List&lt;User&gt; <span class="title function_">handle</span><span class="params">(ResultSet rs)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">					<span class="comment">// 创建集合用来存放对象</span></span><br><span class="line">					List&lt;User&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">					<span class="comment">// 使用循环记取数据库返回的结果集</span></span><br><span class="line">					<span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">						<span class="comment">// 创建用户对象</span></span><br><span class="line">						<span class="type">User</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">						u.setName(rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">						u.setGender(rs.getString(<span class="string">&quot;gender&quot;</span>));</span><br><span class="line">						list.add(u);</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">return</span> list;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 遍历集合</span></span><br><span class="line">			<span class="keyword">for</span> (User u : list) &#123;</span><br><span class="line">				System.out.println(u);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-2-4-常用的-ResultSetHandler-接口的实现类"><a href="#6-2-4-常用的-ResultSetHandler-接口的实现类" class="headerlink" title="6.2.4. 常用的 ResultSetHandler 接口的实现类"></a>6.2.4. 常用的 ResultSetHandler 接口的实现类</h4><h5 id="6-2-4-1-封装成-JavaBean-BeanHandler-BeanListHandler"><a href="#6-2-4-1-封装成-JavaBean-BeanHandler-BeanListHandler" class="headerlink" title="6.2.4.1. 封装成 JavaBean (BeanHandler / BeanListHandler)"></a>6.2.4.1. 封装成 JavaBean (BeanHandler / BeanListHandler)</h5><font color=red>**前提：表的列名与 JavaBean 属性名要相同**</font>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T BeanHandler&lt;T&gt;(Class clazz);</span><br></pre></td></tr></table></figure>
<p>把结果集的一行数据封装成 JavaBean。常用于查询一条记录的情况。如果SQL语句是查询多个记录，则返回查询到的第一行记录。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;T&gt; BeanListHandler&lt;T&gt;(Class clazz);</span><br></pre></td></tr></table></figure>
<p>把结果集的每一行数据封装成 JavaBean，把这个 JavaBean 放入 <code>List</code> 中返回</p>
<p>Code Demo:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> day25.level01.User;</span><br><span class="line"><span class="keyword">import</span> jdbc.DBCPUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 关卡2训练案例3</span></span><br><span class="line"><span class="comment"> 	* 查询用户表中的第一条用户记录并将该记录封装成一个 JavaBean 对象。</span></span><br><span class="line"><span class="comment"> 	* 注意事项：JavaBean 属性名和用户表的列名要相同。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test02_03</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 使用工具类得到数据源对象,并创建QueryRunner对象</span></span><br><span class="line">		<span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DBCPUtils.getDataSource());</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 准备sql语句</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 准备好bean对象，属性名与用户表列相同，调用query方法封装JavaBean对象</span></span><br><span class="line">		<span class="type">User</span> <span class="variable">u</span> <span class="operator">=</span> qr.query(sql, <span class="keyword">new</span> <span class="title class_">BeanHandler</span>&lt;&gt;(User.class));</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 输入bean对象</span></span><br><span class="line">		System.out.println(u);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.DbUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanListHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> day25.level01.User;</span><br><span class="line"><span class="keyword">import</span> jdbc.DBCPUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 关卡2训练案例4</span></span><br><span class="line"><span class="comment"> 	* 1.查询用户表的所有用户记录并将每一条记录封装成 JavaBean 对象存放到集合中。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test02_04</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 创建无参QueryRunner对象</span></span><br><span class="line">		<span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 准备sql语句 查询用户表全部记录</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users;&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用工具类获取连接对象，创建BeanListHandler对象，执行sql语句</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DBCPUtils.getConnection();</span><br><span class="line">		List&lt;User&gt; list = qr.query(conn, sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;&gt;(User.class));</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 遍历集合将Bean对象输出</span></span><br><span class="line">		<span class="keyword">for</span> (User u : list) &#123;</span><br><span class="line">			System.out.println(u);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用DbUtils工具类关闭资源</span></span><br><span class="line">		DbUtils.closeQuietly(conn);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="6-2-4-2-封装成-Map-MapHandler-MapListHandler"><a href="#6-2-4-2-封装成-Map-MapHandler-MapListHandler" class="headerlink" title="6.2.4.2. 封装成 Map (MapHandler / MapListHandler)"></a>6.2.4.2. 封装成 Map (MapHandler / MapListHandler)</h5><font color=red>**可用于表连接查询的时候**</font>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; <span class="title function_">MapHandler</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<p>将结果集中的第一行数据封装到一个 <code>Map</code> 里，<code>key</code> 是列名，<code>value</code> 就是对应的值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Map&lt;String, Object&gt;&gt; <span class="title function_">MapListHandler</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<p>将结果集中的每一行数据都封装到一个 <code>Map</code> 里，然后再存放到 <code>List</code></p>
<p>Code Demo:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.DbUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.MapHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.MapListHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jdbc.DBCPUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 关卡2训练案例6</span></span><br><span class="line"><span class="comment"> 	* 1.定义一个方法：查询用户表获取第一条用户记录并封装成 Map 集合(key 是字段名称，value是字段值)。</span></span><br><span class="line"><span class="comment"> 	* 2.定义一个方法：查询用户表获取所有用户记录并返回一个集合，集合中存放的都是 Map 对象，</span></span><br><span class="line"><span class="comment"> 		* 一个 Map 对象封装对应一个用户记录。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test02_06</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 创建无参的QueryRunner对象</span></span><br><span class="line">		<span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 定义执行的sql操作语句</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 查询用户表第一个用户记录并封装成map集合</span></span><br><span class="line">		testMapHandler(qr, sql);</span><br><span class="line">		System.out.println(<span class="string">&quot;**********************&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 查询用户表获取所有用户记录并返回一个集合，集合中存放的都是 Map对象</span></span><br><span class="line">		testMapListHandler(qr, sql);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testMapListHandler</span><span class="params">(QueryRunner qr, String sql)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 使用工具类获取Connection对象</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DBCPUtils.getConnection();</span><br><span class="line">		<span class="comment">// 创建MapHandler对象，执行sql语句</span></span><br><span class="line">		List&lt;Map&lt;String, Object&gt;&gt; list = qr.query(conn, sql, <span class="keyword">new</span> <span class="title class_">MapListHandler</span>());</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 遍历List集合</span></span><br><span class="line">		<span class="keyword">for</span> (Map&lt;String, Object&gt; map : list) &#123;</span><br><span class="line">			Set&lt;String&gt; key = map.keySet();</span><br><span class="line">			<span class="keyword">for</span> (String k : key) &#123;</span><br><span class="line">				System.out.println(k + <span class="string">&quot; = &quot;</span> + map.get(k));</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(<span class="string">&quot;==========&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 使用DbUtils工具类关闭资源</span></span><br><span class="line">		DbUtils.closeQuietly(conn);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testMapHandler</span><span class="params">(QueryRunner qr, String sql)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 使用工具类获取Connection对象</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DBCPUtils.getConnection();</span><br><span class="line">		<span class="comment">// 创建MapHandler对象，执行sql语句</span></span><br><span class="line">		Map&lt;String, Object&gt; map = qr.query(conn, sql, <span class="keyword">new</span> <span class="title class_">MapHandler</span>());</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 遍历Map集合</span></span><br><span class="line">		Set&lt;String&gt; keySet = map.keySet();</span><br><span class="line">		<span class="keyword">for</span> (String key : keySet) &#123;</span><br><span class="line">			System.out.println(key + <span class="string">&quot; = &quot;</span> + map.get(key));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 使用DbUtils工具类关闭资源</span></span><br><span class="line">		DbUtils.closeQuietly(conn);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="6-2-4-3-封装成数组-ArrayHandler-ArrayListHandler"><a href="#6-2-4-3-封装成数组-ArrayHandler-ArrayListHandler" class="headerlink" title="6.2.4.3. 封装成数组(ArrayHandler / ArrayListHandler)"></a>6.2.4.3. 封装成数组(ArrayHandler / ArrayListHandler)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object[] ArrayHandler();</span><br></pre></td></tr></table></figure>
<p>把结果集的第一行数据封装成对象数组。(常用于只有一条记录的情况)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Object[]&gt; ArrayListHandler();</span><br></pre></td></tr></table></figure>
<p>把结果集的每一行数据封装对象数组，把这个对象数组放入 <code>List</code> 中</p>
<p>Code Demo:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.DbUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.ArrayHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.ArrayListHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jdbc.DBCPUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 关卡2训练案例1</span></span><br><span class="line"><span class="comment"> 	* 查询用户表中的第一条数据。并将数据封装成对象数组</span></span><br><span class="line"><span class="comment"> 		* 操作步骤</span></span><br><span class="line"><span class="comment">	 	* 1.通过 C3P0Utils 工具类获得数据源对象</span></span><br><span class="line"><span class="comment">	 	* 2.创建 QueryRunner 对象</span></span><br><span class="line"><span class="comment">	 	* 3.编写 SQL 语句</span></span><br><span class="line"><span class="comment">	 	* 4.调用 QueryRunner 对象的 query 方法传入 SQL 语句和 ArrayHandler 对象</span></span><br><span class="line"><span class="comment">	 	* 5.接收方法返回值即对象数组。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test02_01</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 准备sql语句</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用DBCP工具类获取数据源，并创建QueryRunner对象</span></span><br><span class="line">		<span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>(DBCPUtils.getDataSource());</span><br><span class="line">		<span class="comment">// 使用ArrayHandler获取第一行数据并封装成对象数组</span></span><br><span class="line">		Object[] arr = qr.query(sql, <span class="keyword">new</span> <span class="title class_">ArrayHandler</span>());</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 直接输出数组</span></span><br><span class="line">		System.out.println(Arrays.toString(arr));</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">&quot;================&quot;</span>);</span><br><span class="line">		<span class="comment">// 使用无参构造方法创建QueryRunner对象</span></span><br><span class="line">		<span class="type">QueryRunner</span> <span class="variable">qr2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line">		<span class="comment">// 使用工具类获取Connection对象，传入query方法执行sql语句,</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DBCPUtils.getConnection();</span><br><span class="line">		<span class="comment">// 使用ArrayListHandler返回一个对象数组集合</span></span><br><span class="line">		List&lt;Object[]&gt; arr2 = qr2.query(conn, sql, <span class="keyword">new</span> <span class="title class_">ArrayListHandler</span>());</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用DbUtils方法关闭资源</span></span><br><span class="line">		DbUtils.closeQuietly(conn);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 遍历对象数组集合</span></span><br><span class="line">		<span class="keyword">for</span> (Object[] objs : arr2) &#123;</span><br><span class="line">			System.out.println(Arrays.toString(objs));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="6-2-4-4-封装单行单列数据-ScalarHandler"><a href="#6-2-4-4-封装单行单列数据-ScalarHandler" class="headerlink" title="6.2.4.4. 封装单行单列数据 (ScalarHandler)"></a>6.2.4.4. 封装单行单列数据 (ScalarHandler)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T ScalarHandler&lt;T&gt;();</span><br></pre></td></tr></table></figure>
<p>把结果集的第一行第一列取出。通常用于只有单行单列的聚合函数查询查询结果集。</p>
<blockquote>
<font color=red>*注：用来统计数量是时返回的数据类型是`long`*</font>

</blockquote>
<p>Code Demo:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.DbUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.ScalarHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jdbc.DBCPUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 关卡2训练案例4</span></span><br><span class="line"><span class="comment"> 	* 查询用户表中用户记录的数量。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test02_04</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 创建无参QueryRunner对象</span></span><br><span class="line">		<span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 准备sql语句 查询用户表全部记录</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select COUNT(*) from users;&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用工具类获取连接对象，创建ScalarHandler对象统计用户数量，执行sql语句</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DBCPUtils.getConnection();</span><br><span class="line">		<span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> qr.query(conn, sql, <span class="keyword">new</span> <span class="title class_">ScalarHandler</span>&lt;Long&gt;());</span><br><span class="line">		System.out.println(<span class="string">&quot;用户数量是：&quot;</span> + count);</span><br><span class="line">		<span class="comment">// 使用DbUtils工具类关闭资源</span></span><br><span class="line">		DbUtils.closeQuietly(conn);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="6-2-4-5-封装多行单列数据-ColumnListHandler"><a href="#6-2-4-5-封装多行单列数据-ColumnListHandler" class="headerlink" title="6.2.4.5. 封装多行单列数据 (ColumnListHandler)"></a>6.2.4.5. 封装多行单列数据 (ColumnListHandler)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;T&gt; ColumnListHandler&lt;T&gt;();</span><br></pre></td></tr></table></figure>
<p>只封装一列的时候，将这一列的数据封装成 <code>List</code> 集合，集合中的元素类型与列的类型相同。其中 <code>new ColumnListHandler&lt;String&gt;(&quot;列名&quot;)</code>。通常用于多行单列的查询结果集。</p>
<p>如果查询多列的话，只默认返回第一列</p>
<p>Code Demo:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.DbUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.ColumnListHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jdbc.C3P0Utils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 关卡2训练案例5</span></span><br><span class="line"><span class="comment"> 	* 1.定义一个方法，查询用户表，获得所有用户的名字存放到集合中。(ColumnListHandler)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test02_05</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 创建QueryRunner无参对象</span></span><br><span class="line">		<span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 准备sql语句</span></span><br><span class="line">		<span class="comment">// 查询用户表中所有用户名</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select name from users;&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用工具类获取连接对象，创建ColumnListHandler，获取所有用户名集合</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> C3P0Utils.getConnection();</span><br><span class="line">		List&lt;String&gt; list = qr.query(conn, sql, <span class="keyword">new</span> <span class="title class_">ColumnListHandler</span>&lt;String&gt;());</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 遍历集合</span></span><br><span class="line">		<span class="keyword">for</span> (String s : list) &#123;</span><br><span class="line">			System.out.println(s);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用DbUtils工具类关闭资源</span></span><br><span class="line">		DbUtils.closeQuietly(conn);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="6-2-4-6-KeyedHandler"><a href="#6-2-4-6-KeyedHandler" class="headerlink" title="6.2.4.6. KeyedHandler"></a>6.2.4.6. KeyedHandler</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Map&lt;String, Object&gt;&gt; KeyedHandler&lt;K&gt;(String s);</span><br></pre></td></tr></table></figure>
<p>将多条记录封装成一个 <code>Map</code>，取其中的一列做为键，记录本身做为值，这个值是 <code>Map</code> 集合，封装这一条记录。即：<code>Map&lt;某列类型,Map&lt;字段名,字段值&gt;&gt;</code>，其中 <code>KeyedHandler</code> 指定为<code>&lt;某列的类型&gt;(列名)</code>。</p>
<p>不指定，默认以第1列的值做为键。一般指定唯一的值的列做为列</p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.DbUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.KeyedHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jdbc.C3P0Utils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 关卡2训练案例5</span></span><br><span class="line"><span class="comment"> 	* 2.定义一个方法，查询用户表，获得所有用户的所有信息，返回一个 Map 集合(Map 集合的</span></span><br><span class="line"><span class="comment"> 		* key 是用户 id，value 是每一个用户的信息，也是一个 Map 集合。)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test02_05</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">		<span class="comment">// 创建QueryRunner无参对象</span></span><br><span class="line">		<span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 准备sql语句</span></span><br><span class="line">		<span class="comment">// 查询用户表中所有用户,封装成一个Map集合</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users;&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用工具类获取连接对象，创建KeyedHandler，获取所有用户Map集合</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> C3P0Utils.getConnection();</span><br><span class="line">		Map&lt;Integer, Map&lt;String, Object&gt;&gt; map = qr.query(conn, sql, <span class="keyword">new</span> <span class="title class_">KeyedHandler</span>&lt;Integer&gt;(<span class="string">&quot;id&quot;</span>));</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 遍历Map集合</span></span><br><span class="line">		Set&lt;Integer&gt; set = map.keySet();</span><br><span class="line">		<span class="keyword">for</span> (Integer key : set) &#123;</span><br><span class="line">			System.out.println(key + <span class="string">&quot; = &quot;</span> + map.get(key));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用DbUtils工具类关闭资源</span></span><br><span class="line">		DbUtils.closeQuietly(conn);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-3-DbUtils-事务操作"><a href="#6-3-DbUtils-事务操作" class="headerlink" title="6.3. DbUtils 事务操作"></a>6.3. DbUtils 事务操作</h3><h4 id="6-3-1-DbUtils-事务处理方式"><a href="#6-3-1-DbUtils-事务处理方式" class="headerlink" title="6.3.1. DbUtils 事务处理方式"></a>6.3.1. DbUtils 事务处理方式</h4><p><strong>自动提交</strong>：每条SQL语句执行后自动提交事务。无法通过回滚撤消操作。</p>
<p><strong>手动提交</strong>：</p>
<ol>
<li>创建 <code>Connection</code> 对象和 <code>QueryRunner</code> 对象，<code>QueryRunner</code> 对象不能使用数据源。</li>
<li>先调用 <code>conn.setAutoCommit(false);</code> 开启事务，取消自动提交。</li>
<li>在 SQL 执行完后调用 <code>commitAndCloseQuietly(conn);</code> 提交事务，如果出现异常则调用 <code>rollbackAndCloseQuietly(conn);</code> 回滚事务。</li>
</ol>
<h4 id="6-3-2-与事务处理相关的方法（待修改完善）"><a href="#6-3-2-与事务处理相关的方法（待修改完善）" class="headerlink" title="6.3.2. 与事务处理相关的方法（待修改完善）"></a>6.3.2. 与事务处理相关的方法（待修改完善）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conn.setAutoCommit(<span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>禁止自动提交事务，开启事务</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br></pre></td></tr></table></figure>
<ul>
<li>创建核心类，不传数据源(手动管理连接)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">query(conn , sql , handler, params);</span><br><span class="line">update(conn, sql , params);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>手动传递连接执行查询或更新的操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DbUtils.commitAndClose(conn);</span><br><span class="line">DbUtils.commitAndCloseQuietly(conn);</span><br></pre></td></tr></table></figure>
<ul>
<li>提交并关闭连接</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DbUtils.rollbackAndClose(conn);</span><br><span class="line">DbUtils.rollbackAndCloseQuietly(conn);</span><br></pre></td></tr></table></figure>
<ul>
<li>回滚并关闭连接</li>
</ul>
<h2 id="7-JPA（Java-Persistence-API）"><a href="#7-JPA（Java-Persistence-API）" class="headerlink" title="7. JPA（Java Persistence API）"></a>7. JPA（Java Persistence API）</h2><h3 id="7-1-概述"><a href="#7-1-概述" class="headerlink" title="7.1. 概述"></a>7.1. 概述</h3><p>JPA 是 Java Persistence API 的简称，中文名 Java 持久层 API，是 JDK 5.0 注解或 XML 描述对象－关系表的映射关系，并将运行期的实体对象持久化到数据库中。</p>
<h3 id="7-2-Persistence-类"><a href="#7-2-Persistence-类" class="headerlink" title="7.2. Persistence 类"></a>7.2. Persistence 类</h3><p><code>Persistence</code> 类主要是用于读取配置文件，获得实体管理工厂。常用方法如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> EntityManagerFactory <span class="title function_">createEntityManagerFactory</span><span class="params">(String persistenceUnitName)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>获得实体管理工厂。参数 <code>String persistenceUnitName</code>：配置文件中的 <code>persistenceUnitName</code></li>
</ul>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">EntityManagerFactory</span> <span class="variable">emf</span> <span class="operator">=</span> Persistence.createEntityManagerFactory(<span class="string">&quot;crm&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="7-3-EntityManagerFactory-接口"><a href="#7-3-EntityManagerFactory-接口" class="headerlink" title="7.3. EntityManagerFactory 接口"></a>7.3. EntityManagerFactory 接口</h3><p>用于管理数据库的连接，获得操作对象实体管理类 <code>EntityManager</code>。<code>EntityManagerFactory</code> 是一个线程安全的对象，并且其创建极其浪费资源，所以编程的时候要保持它是单例的。常用方法如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> EntityManager <span class="title function_">createEntityManager</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>获取操作对象实体管理类</li>
</ul>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">EntityManagerFactory</span> <span class="variable">emf</span> <span class="operator">=</span> Persistence.createEntityManagerFactory(<span class="string">&quot;crm&quot;</span>);</span><br><span class="line"><span class="type">EntityManager</span> <span class="variable">entityManager</span> <span class="operator">=</span> emf.createEntityManager();</span><br></pre></td></tr></table></figure>
<h3 id="7-4-EntityManager-接口"><a href="#7-4-EntityManager-接口" class="headerlink" title="7.4. EntityManager 接口"></a>7.4. EntityManager 接口</h3><p>在 JPA 规范中，EntityManager 实体管理类是操作数据库的重要 API，它是线程不安全的，需要保持线程独有。常用方法如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> EntityTransaction <span class="title function_">getTransaction</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>获取事务对象，<font color=red><strong>但没有开启事务</strong></font></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">persist</span><span class="params">(Object entity)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>插入数据</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(Object entity)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>根据对象的主键id删除数据。<font color=red><strong>注意：使用JPA删除数据也必须使用持久化对象，即要先查询数据，再删除</strong></font></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; T <span class="title function_">merge</span><span class="params">(T entity)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果数据库没有记录就保存，如果有记录就更新，重要的判断是 OID 是否相同，OID（Object ID）就是在配置文件配置为 <code>&lt;id&gt;</code> 属性。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; T <span class="title function_">find</span><span class="params">(Class&lt;T&gt; entityClass, Object primaryKey)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>用于通过OID，获得一条记录，有延迟。相当于<code>get()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; T <span class="title function_">getReference</span><span class="params">(Class&lt;T&gt; entityClass, Object primaryKey)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>用于通过OID，获得一条记录，无延迟。相当于<code>load()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Query <span class="title function_">createQuery</span><span class="params">(String qlString)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>获取 JPQL 操作对象，参数是操作 HQL 语句，用于删除和更新</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; TypedQuery&lt;T&gt; <span class="title function_">createQuery</span><span class="params">(String qlString, Class&lt;T&gt; resultClass)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>获取 JPQL 操作对象，用于查询操作</li>
</ul>
<h3 id="7-5-EntityTransaction-接口"><a href="#7-5-EntityTransaction-接口" class="headerlink" title="7.5. EntityTransaction 接口"></a>7.5. EntityTransaction 接口</h3><p>EntityTransaction 接口用于管理事务（开始，提交，回滚）。获取事务（没有开启事务）：</p>
<h4 id="7-5-1-获取实例"><a href="#7-5-1-获取实例" class="headerlink" title="7.5.1. 获取实例"></a>7.5.1. 获取实例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">EntityManagerFactory</span> <span class="variable">emf</span> <span class="operator">=</span> Persistence.createEntityManagerFactory(<span class="string">&quot;crm&quot;</span>);</span><br><span class="line"><span class="type">EntityManager</span> <span class="variable">em</span> <span class="operator">=</span> emf.createEntityManager();</span><br><span class="line"><span class="type">EntityTransaction</span> <span class="variable">transaction</span> <span class="operator">=</span> em.getTransaction();</span><br></pre></td></tr></table></figure>
<h4 id="7-5-2-常用方法"><a href="#7-5-2-常用方法" class="headerlink" title="7.5.2. 常用方法"></a>7.5.2. 常用方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">begin</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>开启事务</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">commit</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>提交事务</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rollback</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>回滚事务</li>
</ul>
<h3 id="7-6-TypedQuery-接口"><a href="#7-6-TypedQuery-接口" class="headerlink" title="7.6. TypedQuery 接口"></a>7.6. TypedQuery 接口</h3><p><code>TypedQuery</code> 接口继承 <code>Query</code> 接口。用于操作 JPQL 的查询的。JPQL 和 HQL 一样。为什么 JPA 的标准，查询需要指定类型，目的就是为了让返回的数据没有没有警告。</p>
<h4 id="7-6-1-获取实例"><a href="#7-6-1-获取实例" class="headerlink" title="7.6.1. 获取实例"></a>7.6.1. 获取实例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">EntityManager</span> <span class="variable">em</span> <span class="operator">=</span> xxx;</span><br><span class="line">TypedQuery&lt;Xxx&gt; query = em.createQuery(<span class="string">&quot;xxx&quot;</span>, Xxx.class);</span><br></pre></td></tr></table></figure>
<h4 id="7-6-2-常用方法"><a href="#7-6-2-常用方法" class="headerlink" title="7.6.2. 常用方法"></a>7.6.2. 常用方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">executeUpdate</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>执行查询操作（好像不用）。此方法继承于 <code>Query</code> 接口</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypedQuery&lt;X&gt; <span class="title function_">setParameter</span><span class="params">(<span class="type">int</span> position, Object value)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置 <code>?</code> 参数的值。<ul>
<li><code>int position</code>：是 <code>?</code> 占位符后面指定的下标</li>
<li><code>Object value</code>：占位符的值</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypedQuery&lt;X&gt; <span class="title function_">setParameter</span><span class="params">(String name, Object value)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置命名参数的值。<ul>
<li><code>String name</code>：命名参数的名字，不带 <code>:</code> 号</li>
<li><code>Object value</code>：命名参数的值</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypedQuery&lt;X&gt; <span class="title function_">setFirstResult</span><span class="params">(<span class="type">int</span> startPosition)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置分页查询的起始数<ul>
<li><code>int startPosition</code>：查询语句 <code>limit</code> 的起始数</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypedQuery&lt;X&gt; <span class="title function_">setMaxResults</span><span class="params">(<span class="type">int</span> maxResult)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置分页查询的数量<ul>
<li><code>int maxResult</code>：分页查询每页大小</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;X&gt; <span class="title function_">getResultList</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>返回查询的结果List集合（查询所有的数据）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X <span class="title function_">getSingleResult</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>返回查询的结果是一条数据，常用聚合函数 <code>count()</code>，相当于 <code>uniqueResult()</code></li>
</ul>
<h3 id="7-7-Query-接口"><a href="#7-7-Query-接口" class="headerlink" title="7.7. Query 接口"></a>7.7. Query 接口</h3><p>用于操作SQL的查询接口，执行没有返回数据的JPQL（增删改），<font color=red><strong>用于删除和更新</strong></font></p>
<h4 id="7-7-1-获取实例"><a href="#7-7-1-获取实例" class="headerlink" title="7.7.1. 获取实例"></a>7.7.1. 获取实例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">EntityManager</span> <span class="variable">em</span> <span class="operator">=</span> xxx;</span><br><span class="line"><span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> em.createQuery(<span class="string">&quot;xxx&quot;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="7-7-2-常用方法"><a href="#7-7-2-常用方法" class="headerlink" title="7.7.2. 常用方法"></a>7.7.2. 常用方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">executeUpdate</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>执行删除和修改的操作</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Query <span class="title function_">setParameter</span><span class="params">(<span class="type">int</span> position, Object value)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置 <code>?</code> 参数的值。<ul>
<li><code>int position</code>：是 <code>?</code> 占位符后面指定的下标</li>
<li><code>Object value</code>：占位符的值</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Query <span class="title function_">setParameter</span><span class="params">(String name, Object value)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置命名参数的值。<ul>
<li><code>String name</code>：命名参数的名字，不带 <code>:</code> 号</li>
<li><code>Object value</code>：命名参数的值</li>
</ul>
</li>
</ul>
<h3 id="7-8-CriteriaBuilder-接口"><a href="#7-8-CriteriaBuilder-接口" class="headerlink" title="7.8. CriteriaBuilder 接口"></a>7.8. CriteriaBuilder 接口</h3><p>用户使用标准查询接口 Criteria 查询接口</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://ktzxy.github.io">蓝桉</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://ktzxy.github.io/posts/e35cab08.html">https://ktzxy.github.io/posts/e35cab08.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://ktzxy.github.io" target="_blank">蓝桉`Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post-share"><div class="social-share" data-image="/bg/Image00029.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><link rel="stylesheet" href="/css/coin/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">不给糖果就捣蛋</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.webp" target="_blank"><img class="post-qr-code-img" src="/img/wechat.webp" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.webp" target="_blank"><img class="post-qr-code-img" src="/img/alipay.webp" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></button></div><audio id="coinAudio" src="https://cdn.cbd.int/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin/coin.js"></script><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/1d49bf7f.html" title="Java基础-枚举"><img class="cover" src="/bg/Image00005.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Java基础-枚举</div></div><div class="info-2"><div class="info-item-1">Java基础 - 枚举(Enum)1. 枚举的概述枚举类型是在JDK1.5后的新特性。本质就是一个类，所有自定义的枚举类都默认是Enum的子类  关于枚举，阿里巴巴开发手册有这样两条建议：  枚举类名带上 Enum 后缀，枚举成员名称需要全大写，单词间用下划线隔开。 如果变量值仅在一个固定范围内变化用 enum 类型来定义。   1.1. JDK1.5之前实现类似枚举的功能（了解）JDK1.5之前的解决输入非法成员变量值的方法：重新定义一个成员变量的类，在定义成员变量的时候，使用这个相应的成员变量类。将成员变量的类的构造方法私有，不能让使用者new对象。 **JKD1.5之后的解决方法：定义一个枚举类，解决调用构造方法创建对象时输入非法成员变量的情况。**  1.2. Enum 类1public abstract class Enum&lt;E extends Enum&lt;E&gt;&gt; implements Comparable&lt;E&gt;, Serializable 这是所有 Java 语言枚举类型的公共基本类 1.3. 枚举的作用 提高代码的可读性 控制某一数...</div></div></div></a><a class="pagination-related" href="/posts/5dd001c7.html" title="Java基础-异常"><img class="cover" src="/bg/Image00013.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Java基础-异常</div></div><div class="info-2"><div class="info-item-1">1. 异常概述1.1. 什么是异常Java程序在编译或运行过程中出现的问题就称为异常。 Java 异常是 Java 提供的一种识别及响应错误的一致性机制。Java 异常机制可以使程序中异常处理代码和正常业务代码分离，保证程序代码更加优雅，并提高程序健壮性。 1.2. 异常的继承体系  异常体系思维导图详见《01-Java SE 知识体系.xmind》   1.2.1. ThrowableThrowable 是 Java 异常体系的最顶层、所有错误与异常的超类。它包含了两个主要子类：Error（错误）和 Exception（异常） 无论是错误还是异常，它们都有具体的子类体现每一个问题，它们的子类都有一个共性，就是都以父类名才作为子类的后缀名 1.2.2. Error（错误）Error 类：是 Throwable 一个子类，用来指示运行时环境发生的错误。Java 程序通常不捕获错误，错误一般发生在严重故障时，它们在Java程序处理的范畴之外。一出现就是致命的，例如，服务器宕机，数据库崩溃，JVM 内存溢出等。一般地，程序不会从错误中恢复。 特点：此类错误一般表示代码运行时 JVM 出...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/4e9c3100.html" title="Java基础-网络编程"><img class="cover" src="/bg/Image00026.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">Java基础-网络编程</div></div><div class="info-2"><div class="info-item-1">1. 网络编程概述在计算机领域中，网络是信息传输、接收、共享的虚拟平台，将各个点、面、体的信息联系到一起，从而实现这些资源的共享。网络编程的作用：解决计算机与计算机数据传输的问题。 网络体系大致分为三种：OSI七层模型、TCP/IP四层模型和五层模型。  Tips: 一般面试的时候考察比较多的是五层模型。  1.1. 网络通讯三要素1.1.1. IP地址IP 是每台电脑在互联网上的唯一标识符。一个 IPV4 的地址是由四段 0—255 的数字组成：192.168.0.100，每一段的取值范围由8位二进制数据组成。 IPv6 使用 16 个字节表示 IP 地址，它所拥有的地址容量约是 IPv4 的 8×1028倍，达到 2128个。  Notes:   127.0.0.1 为本地主机地址(本地回环地址)，与 localhost 类似，均代表本机地址 xxx.xxx.xxx.255 广播地址，即该网段下所有用户均可以被通知到   例如在 windows 系统中，可以通过以下命令来获取 ip 与网络相关内容： 1ipconfig  用于DOS获取计算机IP设置  1ping ip地址 ...</div></div></div></a><a class="pagination-related" href="/posts/2af7de89.html" title="Day-0-IDEA简单学习"><img class="cover" src="/bg/Image00021.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">Day-0-IDEA简单学习</div></div><div class="info-2"><div class="info-item-1">﻿# Day-0-IDEA简单学习 1.设置主题 2.编辑区的字体变大或者变小：（ctrl+鼠标滚轮） 3.鼠标悬浮在代码上有提示： 4.自动导包和优化多余的包：手动导包：快捷键：alt+enter自动导包和优化多余的包：  5.显示行号 ，  方法和方法间的分隔符： 6.忽略大小写，进行提示： 7.修改代码中注释的字体颜色： 8.修改类头的文档注释信息：注意：对新建的类才有效/**  @Auther: XXX @Date: ${DATE} - ${MONTH} - ${DAY} - ${TIME}  @Description: ${PACKAGE_NAME} @version: 1.0*/   8.自动编译： 9.常用快捷键【1】创建内容：alt+insert 【2】main方法：psvm 【3】输出语句：sout 【4】复制行：ctrl+d 【5】删除行：ctrl+y 【6】代码向上/下移动：Ctrl + Shift + Up / Down 【7】搜索类：  ctrl+n 【8】生成代码  ：alt + Insert（如构造函数等，getter,setter,hashCode...</div></div></div></a><a class="pagination-related" href="/posts/72ba03f7.html" title="Day-02-java基础语法"><img class="cover" src="/bg/Image00027.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">Day-02-java基础语法</div></div><div class="info-2"><div class="info-item-1">﻿ Day-02-java基础语法快捷键操作 psvm —&gt;快速生成public static void main(String[] args) {} sout —&gt;快速生成System.out.println();  可能会遇到的问题  每个单词的大小不能出现问题，==Java是大小写敏感的==； 尽量使用英文； 文件名和类名必须保证一致，并且首字母大写； 符号使用的了中文。   Java运行机制  编译型 解释型    注释：Java中的注释有三种： 12345678910注释：    单行注释：    //我是单行注释    多行注释      /*我是多行注释*/    文档注释    /**    *@description  HelloWrold    *@Author 作者    */ 标识符：关键字 Java所有的组成部分都需要名字。类名、变量名以及方法名都被称为标识符。 标识符注意点 所有的标识符都应该以字母(A-Z或者a-z),美元符（$)、数字或者下划线(_)开始首字符之后可以是字母（A-Z或者a-z),美元符（$)、下划线(_)或数字的任何字符...</div></div></div></a><a class="pagination-related" href="/posts/369b2118.html" title="Day-03-java流程控制"><img class="cover" src="/bg/Image00020.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">Day-03-java流程控制</div></div><div class="info-2"><div class="info-item-1">﻿ Day-03-java流程控制Scanner对象java.util.Scanner是Java5的新特性，我们可以通过Scanner类来获取用户的输入。 基本语法 1Scanner s = new Scanner(System.in); 通过Scanner类的next()与nextLine()方法获取输入的字符串，在读取前我们一般需要使用hasNext() 与hasNextLine()判断是否还有输入的数据。 12345678910111213public static void main(String[] args) &#123;    //创建一个扫描对象，用于接受键盘数据    Scanner scanner = new Scanner(System.in);    System.out.println(&quot;使用next方式接受：&quot;);    //判断用户有没有输入字符串    if (scanner.hasNext())&#123;        //使用next方式接受        String str = scanner.next();     ...</div></div></div></a><a class="pagination-related" href="/posts/bbaa91bf.html" title="Day-04-java方法详解"><img class="cover" src="/bg/Image00021.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">Day-04-java方法详解</div></div><div class="info-2"><div class="info-item-1">﻿ Day-04-java方法详解何谓方法？​    System.out.println(),那么它是什么呢? ​    调用系统类里的标准输出对象out中的方法println ​    Java方法是语句的集合，它们在一起执行一个功能。 ​    方法是解决一类问题的步骤的有序组合 ​    方法包含于类或对象中，方法和方法是并列的关系，所以我们定义的方法不能写到main方法中 ​    方法在程序中被创建，在其他地方被引用 ​    设计方法的原则:方法的本意是功能块，就是实现某个功能的语句块的集合。我们设计方法的时候，最好保持方法的原子性，就是一个方法只完成1个功能，这样利于我们后期的扩展。 方法的定义Java的方法类似争其它语言的函数,是一段用来完成特定功能的代码片段，一股情况卜，定义一个方法包含以下语法: 方法包含一个方法头和一个方法体。 下面是一个方法的所有部分: 修饰符:修饰符，这是可选的，告诉编译器如何调用该方法。定义了该方法的访问类型。 返回值类型∶方法可能会返回值。returnValueType 是方法返回值的数据类型。有些方法执行所需的操作，但没有返回值。...</div></div></div></a><a class="pagination-related" href="/posts/cccc6599.html" title="Day-06-java面向对象"><img class="cover" src="/bg/Image00022.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">Day-06-java面向对象</div></div><div class="info-2"><div class="info-item-1">﻿ Day-06-java面向对象什么是面向对象面向对象编程(Object-Oriented Programming, OOP) 面向对象编程的本质就是:==以类的方式组织代码，以对象的组织(封装)数据。== 抽象 三大特性: ​        封装 ​        继承 ​        多态从认识论角度考虑是先有对象后有类。对象，是具体的事物。类，是抽象的，是对对象的抽象 从代码运行角度考虑是先有类后有对象。类是对象的模板。 回顾方法及加深方法的定义 修饰符 返回类型 ==break: 跳出switch，结束循环和return的区别方法名== 参数列表 异常抛出 方法的调用        静态方法 ​        非静态方法 ​        形参和实参 ​        值传递和引用传递 ​        this关键字 12345678910111213141516171819202122232425//demo1  类public class demo1 &#123;    //main方法    public static void main(String[] a...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">蓝桉</div><div class="author-info-description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">生活、学习、技术</b>相关的问题和看法，还有<b style="color:#fff">文章教程</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">264</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">37</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ktzxy"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon faa-parent animated-hover" href="https://github.com/ktzxy" target="_blank" title="Github"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=2251511764@qq.com" target="_blank" title="Email"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-youxiang"></use></svg></a><a class="social-icon faa-parent animated-hover" href="/atom.xml" target="_blank" title="RSS"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-RSS"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/496148176" target="_blank" title="BiliBili"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QX-BILIBILI"></use></svg></a><a class="social-icon faa-parent animated-hover" href="tencent://Message/?Uin=2251511764&amp;amp;websiteName=local.edu.com:8888=&amp;amp;Menu=yes" target="_blank" title="QQ"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QQ"></use></svg></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-JDBC%EF%BC%88Java%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%EF%BC%89%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">1. JDBC（Java数据库连接）概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-MySQL-%E6%95%B0%E6%8D%AE%E5%BA%93-JDBC-%E7%9B%B8%E5%85%B3%E8%B5%84%E6%BA%90"><span class="toc-number">1.1.</span> <span class="toc-text">1.1. MySQL 数据库 JDBC 相关资源</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-JDBC-%E5%BC%80%E5%8F%91"><span class="toc-number">2.</span> <span class="toc-text">2. JDBC 开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-JDBC-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">2.1.</span> <span class="toc-text">2.1. JDBC 执行流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-JDBC-%E5%BC%80%E5%8F%91%E6%AD%A5%E9%AA%A4%EF%BC%88%E4%BB%A5-MySQL-%E4%B8%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">2.2. JDBC 开发步骤（以 MySQL 为例）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E9%A1%B9%E7%9B%AE%EF%BC%88%E7%A8%8B%E5%BA%8F%EF%BC%89%E5%BC%95%E5%85%A5%E9%A9%B1%E5%8A%A8-jar-%E5%8C%85%EF%BC%88MySQL-%E7%9A%84%E9%A9%B1%E5%8A%A8%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">2.3. 项目（程序）引入驱动 jar 包（MySQL 的驱动）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-JDBC-%E7%9A%84%E6%A0%B8%E5%BF%83-API-%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">3. JDBC 的核心 API 使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%A0%B8%E5%BF%83-API-%E6%A6%82%E8%BF%B0"><span class="toc-number">3.1.</span> <span class="toc-text">3.1. 核心 API 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Driver-%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.2.</span> <span class="toc-text">3.2. Driver 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-DriverManager-%E7%B1%BB"><span class="toc-number">3.3.</span> <span class="toc-text">3.3. DriverManager 类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-%E7%B1%BB%E4%BD%9C%E7%94%A8"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.3.1. 类作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-%E6%B3%A8%E5%86%8C%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E6%96%B9%E6%B3%95"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.3.2. 注册驱动程序方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3-%E7%B1%BB%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.3.3. 类常用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-4-%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84-URL-%E5%9C%B0%E5%9D%80%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.3.4.</span> <span class="toc-text">3.3.4. 连接数据库的 URL 地址格式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-4-1-url%E5%9C%B0%E5%9D%80%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.3.4.1.</span> <span class="toc-text">3.3.4.1. url地址格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-4-2-%E5%90%84%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">3.3.4.2.</span> <span class="toc-text">3.3.4.2. 各类数据库连接字符串</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-4-3-%E5%87%A0%E7%A7%8D%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.3.4.3.</span> <span class="toc-text">3.3.4.3. 几种常见的数据库连接</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-5-%E8%A7%A3%E5%86%B3JDBC%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">3.3.5.</span> <span class="toc-text">3.3.5. 解决JDBC无法连接MySQL数据库的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-6-mysql-8-0-%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%E9%A9%B1%E5%8A%A8%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5"><span class="toc-number">3.3.6.</span> <span class="toc-text">3.3.6. mysql 8.0+以上版本驱动连接失败</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-Connection-%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.4.</span> <span class="toc-text">3.4. Connection 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-%E6%8E%A5%E5%8F%A3%E4%BD%9C%E7%94%A8"><span class="toc-number">3.4.1.</span> <span class="toc-text">3.4.1. 接口作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.4.2.</span> <span class="toc-text">3.4.2. 常用方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-Statement-%E6%8E%A5%E5%8F%A3%EF%BC%88%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%89"><span class="toc-number">3.5.</span> <span class="toc-text">3.5. Statement 接口（操作数据库）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-1-%E6%8E%A5%E5%8F%A3%E6%A6%82%E8%BF%B0"><span class="toc-number">3.5.1.</span> <span class="toc-text">3.5.1. 接口概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.5.2.</span> <span class="toc-text">3.5.2. 常用方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-ResultSet-%E6%8E%A5%E5%8F%A3%EF%BC%88%E6%9F%A5%E8%AF%A2-%E5%A4%84%E7%90%86%E7%BB%93%E6%9E%9C%EF%BC%89"><span class="toc-number">3.6.</span> <span class="toc-text">3.6. ResultSet 接口（查询&#x2F;处理结果）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-1-%E6%8E%A5%E5%8F%A3%E6%A6%82%E8%BF%B0"><span class="toc-number">3.6.1.</span> <span class="toc-text">3.6.1. 接口概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.6.2.</span> <span class="toc-text">3.6.2. 常用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-3-getXxx-%E6%96%B9%E6%B3%95%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">3.6.3.</span> <span class="toc-text">3.6.3. getXxx 方法注意事项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-4-%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E8%A1%A8"><span class="toc-number">3.6.4.</span> <span class="toc-text">3.6.4. 常用数据类型转换表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-PreparedStatement-%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.7.</span> <span class="toc-text">3.7. PreparedStatement 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-1-SQL-%E6%B3%A8%E5%85%A5%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">3.7.1.</span> <span class="toc-text">3.7.1. SQL 注入的概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-2-%E6%8E%A5%E5%8F%A3%E6%A6%82%E8%BF%B0"><span class="toc-number">3.7.2.</span> <span class="toc-text">3.7.2. 接口概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-3-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.7.3.</span> <span class="toc-text">3.7.3. 常用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-4-%E9%A2%84%E7%BC%96%E8%AF%91"><span class="toc-number">3.7.4.</span> <span class="toc-text">3.7.4. 预编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-5-Statement-%E5%92%8C-PreparedStatement-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">3.7.5.</span> <span class="toc-text">3.7.5. Statement 和 PreparedStatement 的区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-6-PreparedStatement-%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.7.6.</span> <span class="toc-text">3.7.6. PreparedStatement 使用步骤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8-%E9%87%8A%E6%94%BE%E8%B5%84%E6%BA%90"><span class="toc-number">3.8.</span> <span class="toc-text">3.8. 释放资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9-API-%E7%A4%BA%E4%BE%8B"><span class="toc-number">3.9.</span> <span class="toc-text">3.9. API 示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-1-%E4%BD%BF%E7%94%A8-executeUpdate-%E6%89%A7%E8%A1%8C-DML-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%83%E4%B9%A0%E4%BB%A3%E7%A0%81"><span class="toc-number">3.9.1.</span> <span class="toc-text">3.9.1. 使用 executeUpdate 执行 DML 操作数据库练习代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-2-%E8%A7%A3%E6%9E%90-executeQuery-%E8%BF%94%E5%9B%9E%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%93%E6%9E%9C%E9%9B%86%E7%BB%83%E4%B9%A0%E4%BB%A3%E7%A0%81"><span class="toc-number">3.9.2.</span> <span class="toc-text">3.9.2. 解析 executeQuery 返回的数据库结果集练习代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B7%A5%E5%85%B7%E7%B1%BB%E7%BB%83%E4%B9%A0"><span class="toc-number">3.9.3.</span> <span class="toc-text">3.9.3. 自定义数据库工具类练习</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-JDBC-%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C"><span class="toc-number">4.</span> <span class="toc-text">4. JDBC 事务操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-JDBC-%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">4.1.</span> <span class="toc-text">4.1. JDBC 事务处理的分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Connection-%E6%8E%A5%E5%8F%A3%E4%B8%8E%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E7%9B%B8%E5%85%B3%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">4.2.</span> <span class="toc-text">4.2. Connection 接口与事务处理相关的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-JDBC-%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C%E5%9F%BA%E7%A1%80%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.3.</span> <span class="toc-text">4.3. JDBC 事务操作基础示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-JDBC-%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">5.</span> <span class="toc-text">5. JDBC 连接池</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%A6%82%E8%BF%B0"><span class="toc-number">5.1.</span> <span class="toc-text">5.1. 连接池概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-6-%E8%87%AA%E5%AE%9A%E4%B9%89-C3P0-%E8%BF%9E%E6%8E%A5%E6%B1%A0%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-number">5.1.1.</span> <span class="toc-text">5.4.6. 自定义 C3P0 连接池工具类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-DBCP-%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%8A%80%E6%9C%AF"><span class="toc-number">5.2.</span> <span class="toc-text">5.5. DBCP 连接池技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-1-DBCP-%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%A6%82%E8%BF%B0"><span class="toc-number">5.2.1.</span> <span class="toc-text">5.5.1. DBCP 连接池概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-2-DBCP-%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="toc-number">5.2.2.</span> <span class="toc-text">5.5.2. DBCP 使用步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-3-%E4%BD%BF%E7%94%A8-Properties-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD-DBCP-%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">5.2.3.</span> <span class="toc-text">5.5.3. 使用 Properties 配置文件加载 DBCP 连接池</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-5-3-1-DBCP%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A6%81%E6%B1%82"><span class="toc-number">5.2.3.1.</span> <span class="toc-text">5.5.3.1. DBCP配置文件要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-5-3-2-DBCP-%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%AD%A5%E9%AA%A4"><span class="toc-number">5.2.3.2.</span> <span class="toc-text">5.5.3.2. DBCP 使用配置文件加载连接池步骤</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-DBUtils-%E5%B7%A5%E5%85%B7"><span class="toc-number">6.</span> <span class="toc-text">6. DBUtils 工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-DbUtils-%E5%B7%A5%E5%85%B7%E6%A6%82%E8%BF%B0"><span class="toc-number">6.1.</span> <span class="toc-text">6.1. DbUtils 工具概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-DbUtils-%E5%B7%A5%E5%85%B7%E7%9A%84%E6%A0%B8%E5%BF%83%E7%B1%BB"><span class="toc-number">6.2.</span> <span class="toc-text">6.2. DbUtils 工具的核心类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-1-DbUtils-%E7%B1%BB"><span class="toc-number">6.2.1.</span> <span class="toc-text">6.2.1. DbUtils 类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-2-QueryRunner-%E7%B1%BB"><span class="toc-number">6.2.2.</span> <span class="toc-text">6.2.2. QueryRunner 类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-2-1-QueryRunner-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F1%EF%BC%9A%E4%BC%A0%E5%85%A5%E6%95%B0%E6%8D%AE%E6%BA%90%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.2.2.1.</span> <span class="toc-text">6.2.2.1. QueryRunner 增删改操作方式1：传入数据源对象</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-2-2-QueryRunner-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F2%EF%BC%9A%E6%B2%A1%E6%9C%89%E4%BC%A0%E5%85%A5%E4%BB%BB%E4%BD%95%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.2.2.2.</span> <span class="toc-text">6.2.2.2. QueryRunner 增删改操作方式2：没有传入任何对象</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-2-3-QueryRunner-%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F1%EF%BC%9A%E6%B2%A1%E6%9C%89%E8%BF%9E%E6%8E%A5%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.2.2.3.</span> <span class="toc-text">6.2.2.3. QueryRunner 查询操作方式1：没有连接对象</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-2-4-QueryRunner-%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F2%EF%BC%9A%E6%9C%89%E8%BF%9E%E6%8E%A5%E5%AF%B9%E8%B1%A1%EF%BC%8C%E9%9C%80%E8%A6%81%E6%89%8B%E5%8A%A8%E5%85%B3%E9%97%AD%E8%B5%84%E6%BA%90"><span class="toc-number">6.2.2.4.</span> <span class="toc-text">6.2.2.4. QueryRunner 查询操作方式2：有连接对象，需要手动关闭资源</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-2-5-QureyRunner-%E7%9A%84%E6%93%8D%E4%BD%9C%E5%A4%9A%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%96%B9%E6%B3%95"><span class="toc-number">6.2.2.5.</span> <span class="toc-text">6.2.2.5. QureyRunner 的操作多个数据方法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-3-ResultSetHandler-%E6%8E%A5%E5%8F%A3"><span class="toc-number">6.2.3.</span> <span class="toc-text">6.2.3. ResultSetHandler 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-3-1-%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">6.2.3.1.</span> <span class="toc-text">6.2.3.1. 接口的方法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-4-%E5%B8%B8%E7%94%A8%E7%9A%84-ResultSetHandler-%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">6.2.4.</span> <span class="toc-text">6.2.4. 常用的 ResultSetHandler 接口的实现类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-4-1-%E5%B0%81%E8%A3%85%E6%88%90-JavaBean-BeanHandler-BeanListHandler"><span class="toc-number">6.2.4.1.</span> <span class="toc-text">6.2.4.1. 封装成 JavaBean (BeanHandler &#x2F; BeanListHandler)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-4-2-%E5%B0%81%E8%A3%85%E6%88%90-Map-MapHandler-MapListHandler"><span class="toc-number">6.2.4.2.</span> <span class="toc-text">6.2.4.2. 封装成 Map (MapHandler &#x2F; MapListHandler)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-4-3-%E5%B0%81%E8%A3%85%E6%88%90%E6%95%B0%E7%BB%84-ArrayHandler-ArrayListHandler"><span class="toc-number">6.2.4.3.</span> <span class="toc-text">6.2.4.3. 封装成数组(ArrayHandler &#x2F; ArrayListHandler)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-4-4-%E5%B0%81%E8%A3%85%E5%8D%95%E8%A1%8C%E5%8D%95%E5%88%97%E6%95%B0%E6%8D%AE-ScalarHandler"><span class="toc-number">6.2.4.4.</span> <span class="toc-text">6.2.4.4. 封装单行单列数据 (ScalarHandler)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-4-5-%E5%B0%81%E8%A3%85%E5%A4%9A%E8%A1%8C%E5%8D%95%E5%88%97%E6%95%B0%E6%8D%AE-ColumnListHandler"><span class="toc-number">6.2.4.5.</span> <span class="toc-text">6.2.4.5. 封装多行单列数据 (ColumnListHandler)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-4-6-KeyedHandler"><span class="toc-number">6.2.4.6.</span> <span class="toc-text">6.2.4.6. KeyedHandler</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-DbUtils-%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C"><span class="toc-number">6.3.</span> <span class="toc-text">6.3. DbUtils 事务操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-1-DbUtils-%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F"><span class="toc-number">6.3.1.</span> <span class="toc-text">6.3.1. DbUtils 事务处理方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-2-%E4%B8%8E%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E7%9B%B8%E5%85%B3%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%88%E5%BE%85%E4%BF%AE%E6%94%B9%E5%AE%8C%E5%96%84%EF%BC%89"><span class="toc-number">6.3.2.</span> <span class="toc-text">6.3.2. 与事务处理相关的方法（待修改完善）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-JPA%EF%BC%88Java-Persistence-API%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">7. JPA（Java Persistence API）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%A6%82%E8%BF%B0"><span class="toc-number">7.1.</span> <span class="toc-text">7.1. 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-Persistence-%E7%B1%BB"><span class="toc-number">7.2.</span> <span class="toc-text">7.2. Persistence 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-EntityManagerFactory-%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.3.</span> <span class="toc-text">7.3. EntityManagerFactory 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-EntityManager-%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.4.</span> <span class="toc-text">7.4. EntityManager 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-EntityTransaction-%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.5.</span> <span class="toc-text">7.5. EntityTransaction 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-5-1-%E8%8E%B7%E5%8F%96%E5%AE%9E%E4%BE%8B"><span class="toc-number">7.5.1.</span> <span class="toc-text">7.5.1. 获取实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-5-2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">7.5.2.</span> <span class="toc-text">7.5.2. 常用方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-TypedQuery-%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.6.</span> <span class="toc-text">7.6. TypedQuery 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-6-1-%E8%8E%B7%E5%8F%96%E5%AE%9E%E4%BE%8B"><span class="toc-number">7.6.1.</span> <span class="toc-text">7.6.1. 获取实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-6-2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">7.6.2.</span> <span class="toc-text">7.6.2. 常用方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-7-Query-%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.7.</span> <span class="toc-text">7.7. Query 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-7-1-%E8%8E%B7%E5%8F%96%E5%AE%9E%E4%BE%8B"><span class="toc-number">7.7.1.</span> <span class="toc-text">7.7.1. 获取实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-7-2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">7.7.2.</span> <span class="toc-text">7.7.2. 常用方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-8-CriteriaBuilder-%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.8.</span> <span class="toc-text">7.8. CriteriaBuilder 接口</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/a318ca1f.html" title="MySQL数据库150道高频面试题"><img src="/bg/Image00018.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL数据库150道高频面试题"/></a><div class="content"><a class="title" href="/posts/a318ca1f.html" title="MySQL数据库150道高频面试题">MySQL数据库150道高频面试题</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8f9b37aa.html" title="技术同学必会的MySQL设计规约"><img src="/bg/Image00014.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="技术同学必会的MySQL设计规约"/></a><div class="content"><a class="title" href="/posts/8f9b37aa.html" title="技术同学必会的MySQL设计规约">技术同学必会的MySQL设计规约</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dfdfdf4.html" title="数据库概述"><img src="/bg/Image00002.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库概述"/></a><div class="content"><a class="title" href="/posts/dfdfdf4.html" title="数据库概述">数据库概述</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/490575ab.html" title="24工厂模式俗话解释"><img src="/bg/Image00024.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="24工厂模式俗话解释"/></a><div class="content"><a class="title" href="/posts/490575ab.html" title="24工厂模式俗话解释">24工厂模式俗话解释</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/364ea8cc.html" title="设计模式"><img src="/bg/Image00014.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="设计模式"/></a><div class="content"><a class="title" href="/posts/364ea8cc.html" title="设计模式">设计模式</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2020 - 2025 By 蓝桉</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="8152976493" data-server="netease" data-type="playlist"   data-order="list" data-fixed="true" data-preload="auto" data-autoplay="false" data-mutex="true" ></div><script async src="//at.alicdn.com/t/c/font_4379924_273fk05h86zi.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat/cat.js"></script><script async data-pjax src="/js/meting/music_lanan.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script defer src="/js/day/lunar.js"></script><script defer src="/js/day/day.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = '10a7db1c41b6489db9c830c668a18304';
  var gaud_map_key = '82a64bc994fb6494830f157f319f9f69';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title=""><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.2.2" title=""><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://www.jsdelivr.com/" style="margin-inline:5px" data-title="本站使用JsDelivr为静态资源提供CDN加速" title=""><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime/runtime.min.js"></script><script async src="/js/font/ali_font_all.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('article-sort-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__slideInRight');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>