<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Oracle-基础 | 蓝桉`Blog</title><meta name="author" content="蓝桉,kt_zxh@163.com"><meta name="copyright" content="蓝桉"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. Oracle 的基本概念ORACLE 数据库系统是美国 ORACLE 公司（甲骨文）提供的以分布式数据库为核心的一组软件产品，是目前最流行的客户&#x2F;服务器(CLIENT&#x2F;SERVER)或 B&#x2F;S 体系结构的数据库之一。 Oracle默认的端口号是：1521 1.1. 在虚拟机中安装Oracle在安装完成前将scott和hr的两个账号解锁，可以设置新口令，如果使用默认的口令是:tiger 在虚拟">
<meta property="og:type" content="article">
<meta property="og:title" content="Oracle-基础">
<meta property="og:url" content="https://ktzxy.github.io/posts/eb5d336c.html">
<meta property="og:site_name" content="蓝桉&#96;Blog">
<meta property="og:description" content="1. Oracle 的基本概念ORACLE 数据库系统是美国 ORACLE 公司（甲骨文）提供的以分布式数据库为核心的一组软件产品，是目前最流行的客户&#x2F;服务器(CLIENT&#x2F;SERVER)或 B&#x2F;S 体系结构的数据库之一。 Oracle默认的端口号是：1521 1.1. 在虚拟机中安装Oracle在安装完成前将scott和hr的两个账号解锁，可以设置新口令，如果使用默认的口令是:tiger 在虚拟">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ktzxy.github.io/bg/Image00002.webp">
<meta property="article:published_time" content="2025-07-09T17:28:46.000Z">
<meta property="article:modified_time" content="2025-07-13T15:45:18.454Z">
<meta property="article:author" content="蓝桉">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ktzxy.github.io/bg/Image00002.webp"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Oracle-基础",
  "url": "https://ktzxy.github.io/posts/eb5d336c.html",
  "image": "https://ktzxy.github.io/bg/Image00002.webp",
  "datePublished": "2025-07-09T17:28:46.000Z",
  "dateModified": "2025-07-13T15:45:18.454Z",
  "author": [
    {
      "@type": "Person",
      "name": "蓝桉",
      "url": "https://ktzxy.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ktzxy.github.io/posts/eb5d336c.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Oracle-基础',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4379924_273fk05h86zi.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/progress_bar/progress_bar.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/windmill/windmill.css"><link rel="stylesheet" href="/css/cat.css"><link rel="stylesheet" href="/css/meting/music_lanan.css"><div id="myscoll"></div><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="/css/runtime/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="蓝桉`Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/bg.webp);"></div><div id="an_music_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">264</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">37</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-zhuye-"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zhuye-"></use></svg><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shijianzhou"></use></svg><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/essay/"><i class="fa-fw icon-xiaoxi"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xiaoxi"></use></svg><span> 闲言碎语</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/music/"><i class="fa-fw icon-music"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/fcircle/"><i class="fa-fw icon-pengyouquan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pengyouquan"></use></svg><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-xinfeng"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinfeng"></use></svg><span> 留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> 友人帐</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:randomPost();"><i class="fa-fw icon-wodezhuifan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wodezhuifan"></use></svg><span> 随机访问</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon-guanyuwomen2"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guanyuwomen2"></use></svg><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/bg/Image00002.webp);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">蓝桉`Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Oracle-基础</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><i class="fa-fw icon-zhuye-"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zhuye-"></use></svg><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/archives/"><i class="fa-fw icon-shijianzhou"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shijianzhou"></use></svg><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/essay/"><i class="fa-fw icon-xiaoxi"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xiaoxi"></use></svg><span> 闲言碎语</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/music/"><i class="fa-fw icon-music"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> 分类</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/fcircle/"><i class="fa-fw icon-pengyouquan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pengyouquan"></use></svg><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><i class="fa-fw icon-xinfeng"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinfeng"></use></svg><span> 留言板</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> 友人帐</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:randomPost();"><i class="fa-fw icon-wodezhuifan"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wodezhuifan"></use></svg><span> 随机访问</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><i class="fa-fw icon-guanyuwomen2"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guanyuwomen2"></use></svg><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Oracle-基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-13T15:45:18.454Z" title="更新于 2025-07-13 15:45:18">2025-07-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="1-Oracle-的基本概念"><a href="#1-Oracle-的基本概念" class="headerlink" title="1. Oracle 的基本概念"></a>1. Oracle 的基本概念</h2><p>ORACLE 数据库系统是美国 ORACLE 公司（甲骨文）提供的以分布式数据库为核心的一组软件产品，是目前最流行的客户/服务器(CLIENT/SERVER)或 B/S 体系结构的数据库之一。</p>
<p><strong>Oracle默认的端口号是：1521</strong></p>
<h3 id="1-1-在虚拟机中安装Oracle"><a href="#1-1-在虚拟机中安装Oracle" class="headerlink" title="1.1. 在虚拟机中安装Oracle"></a>1.1. 在虚拟机中安装Oracle</h3><p>在安装完成前将scott和hr的两个账号解锁，可以设置新口令，如果使用默认的口令是:tiger</p>
<p>在虚拟机中验证Oracle是否安装成功</p>
<ol>
<li>打开“运行”，输入cmd，进行命令行。输入sqlplus system/口令密码</li>
<li>登陆成功后可以查询Oracle里面的表格测试一下</li>
</ol>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415726.jpg" alt="安装oracle"></p>
<h3 id="1-2-虚拟网卡设置"><a href="#1-2-虚拟网卡设置" class="headerlink" title="1.2. 虚拟网卡设置"></a>1.2. 虚拟网卡设置</h3><p>本机和虚拟机之间能相互访问，它们的 IP 段必须相同，配置方式如下</p>
<ol>
<li>为虚拟机添加虚拟网卡</li>
</ol>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415728.jpg" alt="配置网络1"></p>
<ol>
<li>开启修改权限，点击下图的“更改设置”</li>
</ol>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415729.jpg" alt="配置网络2"></p>
<ol>
<li>点击添加网络</li>
</ol>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415730.jpg" alt="配置网络3"></p>
<ol>
<li>添加后会自动分配子网IP，不用修改。点击应用、确定</li>
</ol>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415731.jpg" alt="配置网络4"></p>
<ol>
<li>添加完成后本机的网络上会多出一个网络适配器，根据虚拟机中的子网IP设置此IP地址</li>
</ol>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415732.jpg" alt="配置网络5"></p>
<ol>
<li>自定义虚拟机的网络适配器，自定义为刚才手动添加的那个网络适配器</li>
</ol>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415733.jpg" alt="配置网络6"></p>
<ol>
<li>回到XP虚拟机中设置IP，记得要与上述中的虚拟网络设置成同一网段的即可，比如我们设置为192.168.133.10</li>
</ol>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415734.jpg" alt="配置网络7"></p>
<ol>
<li><p>修改Oracle的两个核心文件，进入虚拟机找到Oracle的安装目录</p>
<p> <img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415735.jpg" alt="配置网络8">  </p>
<ul>
<li>打开listener.ora把红色框的内容改为我们刚才设置的虚拟机的ip地址: 192.168.133.10<br><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415736.jpg" alt="配置网络9"></li>
<li>打开tnsname.ora把红色框的内容改为虚拟机的IP: 192.168.133.10<br><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415737.jpg" alt="配置网络10"></li>
</ul>
</li>
<li><p>重启Oracle的两个服务</p>
</li>
</ol>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415738.jpg" alt="配置网络11"></p>
<p>配置好测试一下是否ping通</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415739.jpg" alt="测试"></p>
<h3 id="1-3-PLSQL-Developer-客户端工具的安装"><a href="#1-3-PLSQL-Developer-客户端工具的安装" class="headerlink" title="1.3. PLSQL Developer 客户端工具的安装"></a>1.3. PLSQL Developer 客户端工具的安装</h3><p>参考文档：G:\Java编程工具资料\数据库\Oracle数据库安装视频教程\02、测试sqlplus客户端连接服务器.doc</p>
<p>命令行输入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlplus system/moon@192.168.17.10:1521/orcl</span><br></pre></td></tr></table></figure>
<ul>
<li>格式：<code>sqlplus system/密码@远程IP:1521/orcl</code></li>
<li>注：moon是自己设置的口令密码，<strong>orcl是安装oracle时填写的全局数据库名！！！！！</strong></li>
</ul>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415741.jpg" alt="全局数据库名"></p>
<h3 id="1-4-安装-PLSQL-Developer-客户端"><a href="#1-4-安装-PLSQL-Developer-客户端" class="headerlink" title="1.4. 安装 PLSQL Developer 客户端"></a>1.4. 安装 PLSQL Developer 客户端</h3><p>参考文档：G:\Java编程工具资料\数据库\Oracle数据库安装视频教程\03、安装PLSQL并测试连接.doc</p>
<h3 id="1-5-中文乱码的处理"><a href="#1-5-中文乱码的处理" class="headerlink" title="1.5. 中文乱码的处理"></a>1.5. 中文乱码的处理</h3><ol>
<li>查看服务器端编码</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> userenv(<span class="string">&#x27;language&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 实际查到的结果为：AMERICAN_AMERICA.ZHS16GBK</span></span><br></pre></td></tr></table></figure>
<ol>
<li>执行语句 <code>select * from V$NLS_PARAMETERS</code><ul>
<li>查看第一行中PARAMETER项中为NLS_LANGUAGE对应的VALUE项中是否和第一步得到的值一样。如果不是，需要设置环境变量。</li>
<li>否则PLSQL客户端使用的编码和服务器端编码不一致，插入中文时就会出现乱码。</li>
</ul>
</li>
<li>设置环境变量<ul>
<li>计算机 —&gt; 属性 —&gt; 高级系统设置 —&gt; 环境变量 —&gt; 新建</li>
<li>设置变量名：<code>NLS_LANG</code></li>
<li>变量值：第1步查到的值: <code>AMERICAN_AMERICA.ZHS16GBK</code></li>
</ul>
</li>
<li>重新启动PLSQL，插入数据正常</li>
</ol>
<h3 id="1-6-本次安装oracle相关信息"><a href="#1-6-本次安装oracle相关信息" class="headerlink" title="1.6. 本次安装oracle相关信息"></a>1.6. 本次安装oracle相关信息</h3><ul>
<li>system口令：moon</li>
<li>SCOTT的口令:123456</li>
<li>HR的口令:123456</li>
<li>oracle连接的虚拟网络<ul>
<li>子网IP:192.168.187.0    ；子网掩码:255.255.255.0</li>
<li>win10设置VMware Network Adapter VMnet5：<ul>
<li>子网IP:192.168.187.1；子网掩码:255.255.255.0</li>
</ul>
</li>
<li>虚拟机XP系统设置<ul>
<li>子网IP:192.168.187.10；子网掩码:255.255.255.0</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="2-Oracle-数据库的体系结构"><a href="#2-Oracle-数据库的体系结构" class="headerlink" title="2. Oracle 数据库的体系结构"></a>2. Oracle 数据库的体系结构</h2><ul>
<li>数据库：一个操作系统只有一个oracle数据库</li>
<li>实例：数据库的后台的一系列进程，一个计算机只有一个实例</li>
<li>数据文件（dbf）：数据库软件操作的</li>
<li>表空间：一个表空间可以有多个数据文件，但是一个数据文件只属于一个表空间</li>
<li>用户：用户操作表空间</li>
</ul>
<h3 id="2-1-数据库：database"><a href="#2-1-数据库：database" class="headerlink" title="2.1. 数据库：database"></a>2.1. 数据库：database</h3><p>Oracle 数据库是数据的物理存储。这就包括（数据文件 ORA 或者 DBF、控制文件、联机日志、参数文件）。其实 Oracle 数据库的概念和其它数据库不一样，<strong>一个操作系统只有一个oracle数据库</strong>。可以看作是 Oracle 就只有一个大数据库</p>
<h3 id="2-2-实例：Oracle-Instance"><a href="#2-2-实例：Oracle-Instance" class="headerlink" title="2.2. 实例：Oracle Instance"></a>2.2. 实例：Oracle Instance</h3><p><strong>一个计算机只有一个Oracle实例</strong></p>
<p>一个 Oracle 实例（Oracle Instance）有一系列的后台进程（Backguound Processes)和内存结构（Memory Structures)组成。一个数据库可以有 n 个实例。</p>
<h3 id="2-3-数据文件（dbf）"><a href="#2-3-数据文件（dbf）" class="headerlink" title="2.3. 数据文件（dbf）"></a>2.3. 数据文件（dbf）</h3><p>数据文件(.dbf)，由数据库软件操作的</p>
<p>数据文件是数据库的物理存储单位。数据库的数据是存储在表空间中的，真正是在某一个或者多个数据文件中。而一个表空间可以由一个或多个数据文件组成，一个数据文件只能属于一个表空间。一旦数据文件被加入到某个表空间后，就不能删除这个文件，<strong>如果要删除某个数据文件，只能删除其所属于的表空间才行</strong>。</p>
<h3 id="2-4-表空间"><a href="#2-4-表空间" class="headerlink" title="2.4. 表空间"></a>2.4. 表空间</h3><p>表空间是 Oracle 对物理数据库上相关数据文件（ORA 或者 DBF 文件）的逻辑映射。一个数据库在逻辑上被划分成一到若干个表空间，每个表空间包含了在逻辑上相关联的一组结构。每个数据库至少有一个表空间(称之为 system 表空间)。     每个表空间由同一磁盘上的一个或多个文件组成，这些文件叫数据文件(datafile)。<strong>一个数据文件只能属于一个表空间</strong></p>
<h3 id="2-5-用户"><a href="#2-5-用户" class="headerlink" title="2.5. 用户"></a>2.5. 用户</h3><p>用户是在实例下建立的。不同实例中可以建相同名字的用户</p>
<p>注：表的数据，是有用户放入某一个表空间的，而这个表空间会随机把这些表数据放到一个或者多个数据文件中</p>
<p>由于 oracle 的数据库不是普通的概念，oracle 是有用户和表空间对数据进行管理和存放的。但是表不是有表空间去查询的，而是由用户去查的。因为不同用户可以在同一个表空间建立同一个名字的表！这里区分就是用户了！</p>
<h3 id="2-6-SCOTT-用户和-HR-用户"><a href="#2-6-SCOTT-用户和-HR-用户" class="headerlink" title="2.6. SCOTT 用户和 HR 用户"></a>2.6. SCOTT 用户和 HR 用户</h3><p>SCOTT 与 HR 就是初始的普通用户，这些用户下面都默认存在了表结构。scott用户与hr用户的表结构：</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415742.jpg" alt="scott用户与hr用户的表结构"></p>
<h2 id="3-Oracle-的-SQL-语法"><a href="#3-Oracle-的-SQL-语法" class="headerlink" title="3. Oracle 的 SQL 语法"></a>3. Oracle 的 SQL 语法</h2><h3 id="3-1-SQL简介"><a href="#3-1-SQL简介" class="headerlink" title="3.1. SQL简介"></a>3.1. SQL简介</h3><p>结构化查询语言(Structured Query Language)简称 SQL。结构化查询语言是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统；同时也是数据库脚本文件的扩展名</p>
<ul>
<li>DML(数据库操作语言): 其语句包括动词 <code>INSERT</code>，<code>UPDATE</code> 和 <code>DELETE</code>。它们分别用于添加，修改和删除表中的行。也称为动作查询语言。</li>
<li>DDL(数据库定义语言): 其语句包括动词 <code>CREATE</code> 和 <code>DROP</code>。在数据库中创建新表或删除表（<code>CREAT TABLE</code> 或 <code>DROP TABLE</code>）；为表加入索引等。DDL 包括许多与人数据库目录中获得数据有关的保留字。它也是动作查询的一部分。</li>
<li>DCL(数据库控制语言):它的语句通过 <code>GRANT</code> 或 <code>REVOKE</code> 获得许可，确定单个用户和用户组对数据库对象的访问。某些 <code>RDBMS</code> 可用 <code>GRANT</code> 或 <code>REVOKE</code> 控制对表单个列的访问。</li>
</ul>
<h3 id="3-2-Oracle-语法注意事项"><a href="#3-2-Oracle-语法注意事项" class="headerlink" title="3.2. Oracle 语法注意事项"></a>3.2. Oracle 语法注意事项</h3><h4 id="3-2-1-Oracle语句大小写问题"><a href="#3-2-1-Oracle语句大小写问题" class="headerlink" title="3.2.1. Oracle语句大小写问题"></a>3.2.1. Oracle语句大小写问题</h4><p>oracle中分为两种情况，单纯的sql语句不区分大小写，但是如果查询某个字符的话就需要区分大小写。</p>
<ol>
<li>如以下情况，是不区分大小写的，查询结果都是一致的：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> EMP;</span><br></pre></td></tr></table></figure>
<ol>
<li>如在emp表中查询ename为”SMITH”（不含引号）的信息，就必须注意大小写：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;SMITH&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-2-2-dual-伪表"><a href="#3-2-2-dual-伪表" class="headerlink" title="3.2.2. dual 伪表"></a>3.2.2. dual 伪表</h4><p><strong><em>dual：是oracle提供的一张伪表，用于补全sql语法</em></strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;abc&#x27;</span>);  <span class="operator">/</span><span class="operator">/</span> 执行会报错</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;abc&#x27;</span>) <span class="keyword">from</span> dual;  <span class="operator">/</span><span class="operator">/</span> 这样才可以执行</span><br></pre></td></tr></table></figure>
<h2 id="4-Oracle-查询操作"><a href="#4-Oracle-查询操作" class="headerlink" title="4. Oracle 查询操作"></a>4. Oracle 查询操作</h2><h3 id="4-1-Oracle-完整的查询-SQL-语法"><a href="#4-1-Oracle-完整的查询-SQL-语法" class="headerlink" title="4.1. Oracle 完整的查询 SQL 语法"></a>4.1. Oracle 完整的查询 SQL 语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    <span class="operator">*</span><span class="operator">|</span>指定的列名</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    表名</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    条件</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">    分组</span><br><span class="line"><span class="keyword">having</span></span><br><span class="line">    条件</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line">    排序</span><br></pre></td></tr></table></figure>
<h3 id="4-2-Select-语句的语法格式"><a href="#4-2-Select-语句的语法格式" class="headerlink" title="4.2. Select 语句的语法格式"></a>4.2. Select 语句的语法格式</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span><span class="operator">|</span>&#123;[<span class="keyword">distinct</span> <span class="keyword">column</span><span class="operator">|</span>expression [aliad],……]&#125;</span><br><span class="line">		<span class="keyword">from</span> <span class="keyword">table</span>;</span><br></pre></td></tr></table></figure>
<h4 id="4-2-1-查询语法"><a href="#4-2-1-查询语法" class="headerlink" title="4.2.1. 查询语法"></a>4.2.1. 查询语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span><span class="operator">|</span>列名 <span class="keyword">from</span> 表名</span><br></pre></td></tr></table></figure>
<p>示例</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 查询部分列</span></span><br><span class="line"><span class="keyword">select</span> ename,job <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<h4 id="4-2-2-别名用法"><a href="#4-2-2-别名用法" class="headerlink" title="4.2.2. 别名用法"></a>4.2.2. 别名用法</h4><p>在查询的结果列中可以使用别名，<font color=red><strong>后面的中文只能用双引号</strong></font>，一般的别名都不用中文</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 列名 别名, 列名 别名, …… <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure>
<font color=red>**别名中，有没有双引号的区别就在于别名中有没有特殊的符号或者关键字**</font>。示例如下：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 别名用法</span></span><br><span class="line"><span class="keyword">select</span> ename &quot;员工名称&quot;, job &quot;工作内容&quot; <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

#### 4.2.3. 消除重复的数据

使用 `distinct` 可以消除重复的行，如果查询多列的必须保证多列都重复才能去掉重复

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> <span class="operator">*</span><span class="operator">|</span>列名, ... <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure>

示例：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 消除重复的数据</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> ename <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

#### 4.2.4. 查询中四则运算

sql 中支持四则运算【`+`，`-`，`*`，`/`】

Code Dome:

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--查询员工的年薪:空值是oracle里面最大的</span></span><br><span class="line"><span class="keyword">select</span> ename, sal<span class="operator">*</span><span class="number">12</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 这里有点问题：如果comm是空的，那么所有数据都是空的</span></span><br><span class="line"><span class="keyword">select</span> ename, sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>comm <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">--nvl函数，判断空值用的 第一个参是值，第二参数：如果第一个参数是null，那么就用第二个参数来替换</span></span><br><span class="line"><span class="keyword">select</span> ename, sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>nvl(comm, <span class="number">0</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

### 4.3. 空值

空值是无效的，未指定的，未知的或不可预知的值。空值不是空格或者0。注意事项如下：

1. 包含 `null` 的表达式都为 `null`
2. 空值永远不等于空值
3. 空值是oracle里面最大的

### 4.4. 连接符 ||

字符串的连接使用“`||`”。示例如下：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用||拼接字符</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;abc&#x27;</span> <span class="operator">||</span> <span class="string">&#x27;def&#x27;</span> <span class="operator">||</span> <span class="string">&#x27;ghi&#x27;</span>  <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

### 4.5. 使用 where 语句对结果进行过滤语法

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span><span class="operator">|</span>&#123;[<span class="keyword">distinct</span> <span class="keyword">column</span><span class="operator">|</span>expression [aliad],……]&#125;</span><br><span class="line"><span class="keyword">from</span> <span class="keyword">table</span></span><br><span class="line">[<span class="keyword">where</span> <span class="keyword">condition</span>(s)]</span><br></pre></td></tr></table></figure>

### 4.6. 运算符

#### 4.6.1. 比较运算符

|   操作符    |      含义      |
| :--------: | ------------- |
|    `=`     | 等于(不是`==`) |
|    `>`     | 大于           |
|    `>=`    | 大于等于       |
|    `<`     | 小于           |
|    `<=`    | 小于等于       |
| `<>`或`!=` | 不等于         |

> <font color=red>**注：赋值使用 `:=` 符号**</font>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询薪资大于1500 </span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">1500</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询薪资大于600，并且有奖金的员工</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">600</span> <span class="keyword">and</span> comm <span class="operator">&gt;</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询薪资大于等于1500 并且小于等于3000</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;=</span> <span class="number">1500</span> <span class="keyword">and</span> sal <span class="operator">&lt;=</span> <span class="number">3000</span>;</span><br></pre></td></tr></table></figure>
<h4 id="4-6-2-其他比较运算符"><a href="#4-6-2-其他比较运算符" class="headerlink" title="4.6.2. 其他比较运算符"></a>4.6.2. 其他比较运算符</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">操作符</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>between … and …</code></td>
<td>在两个值之间(包含边界)</td>
</tr>
<tr>
<td style="text-align:center"><code>in(set)</code></td>
<td>等于值列表中的一个</td>
</tr>
<tr>
<td style="text-align:center"><code>like</code></td>
<td>模糊查询</td>
</tr>
<tr>
<td style="text-align:center"><code>is null</code></td>
<td>空值</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范围查询： between xx and XXX;   包括边界值</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="keyword">between</span> <span class="number">1500</span> <span class="keyword">and</span> <span class="number">3000</span>;</span><br></pre></td></tr></table></figure>
<h4 id="4-6-3-逻辑运算符"><a href="#4-6-3-逻辑运算符" class="headerlink" title="4.6.3. 逻辑运算符"></a>4.6.3. 逻辑运算符</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">操作符</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>and</code></td>
<td>逻辑并（与）</td>
</tr>
<tr>
<td style="text-align:center"><code>or</code></td>
<td>逻辑或</td>
</tr>
<tr>
<td style="text-align:center"><code>not</code></td>
<td>逻辑否</td>
</tr>
</tbody>
</table>
</div>
<h3 id="4-7-where-语句"><a href="#4-7-where-语句" class="headerlink" title="4.7. where 语句"></a>4.7. where 语句</h3><h4 id="4-7-1-非空和空的限制"><a href="#4-7-1-非空和空的限制" class="headerlink" title="4.7.1. 非空和空的限制"></a>4.7.1. 非空和空的限制</h4><p>只要字段中存在内容表示不为空，如果不存在内容就是 <code>null</code>，语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列不为空</span></span><br><span class="line">列名 <span class="keyword">IS</span> <span class="keyword">NOT NULL</span></span><br><span class="line"><span class="comment">-- 列为空</span></span><br><span class="line">列名 <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询薪资大于600，并且有奖金的员工</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">600</span> <span class="keyword">and</span> comm <span class="keyword">is</span> <span class="keyword">not null</span> <span class="keyword">and</span> comm <span class="operator">&gt;</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<h4 id="4-7-2-范围限制"><a href="#4-7-2-范围限制" class="headerlink" title="4.7.2. 范围限制"></a>4.7.2. 范围限制</h4><p>指定了查询范围，那么 sql 可以使用 <code>IN</code> 关键字。语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列的值在某个范围内</span></span><br><span class="line">列名 <span class="keyword">IN</span> (值<span class="number">1</span>, 值<span class="number">2</span>, ....)</span><br><span class="line"><span class="comment">-- 列的值不在某个范围内</span></span><br><span class="line">列名 <span class="keyword">NOT</span> <span class="keyword">IN</span> (值<span class="number">1</span>, 值<span class="number">2</span>,...)</span><br></pre></td></tr></table></figure>
<p>其中的值不仅可以是数值类型也可以是字符串</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- in操作 ：在某个数据内</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="keyword">in</span>(<span class="number">10</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<h4 id="4-7-3-模糊查询"><a href="#4-7-3-模糊查询" class="headerlink" title="4.7.3. 模糊查询"></a>4.7.3. 模糊查询</h4><p>在 <code>LIKE</code> 关键字中主要使用以下两种通配符</p>
<ul>
<li><code>%</code>：可以匹配任意长度的内容</li>
<li><code>_</code>：可以匹配一个长度的内容</li>
</ul>
<p>在 LIKE 中如果没有关键字表示查询全部</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 模糊查询 like</span></span><br><span class="line"><span class="comment">-- 查询名字中有个M 字符的</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;%M%&#x27;</span>;</span><br><span class="line"><span class="comment">-- 查询名字中第二个字母是M 字符的</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;_M%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-8-使用-order-by-对结果排序"><a href="#4-8-使用-order-by-对结果排序" class="headerlink" title="4.8. 使用 order by 对结果排序"></a>4.8. 使用 order by 对结果排序</h3><h4 id="4-8-1-排序语法"><a href="#4-8-1-排序语法" class="headerlink" title="4.8.1. 排序语法"></a>4.8.1. 排序语法</h4><p>在 sql 中可以使用 <code>ORDER BY</code> 对查询结果进行排序。语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="operator">|</span>列名</span><br><span class="line">    <span class="keyword">FROM</span> 表名</span><br><span class="line">    &#123;WEHRE 查询条件&#125;</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> 列名 <span class="number">1</span> <span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>，列名 <span class="number">2.</span>..<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span></span><br></pre></td></tr></table></figure>
<p><code>ORDER BY 列名</code>，默认的排序规则是升序排列，可以不指定 <code>ASC</code>，如果按着降序排列必须指定 <code>DESC</code>。如果存在多个排序字段可以用逗号分隔</p>
<blockquote>
<font color=red>**注意：`ORDER BY` 语句要放在 sql 的最后执行**</font>

</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 工资从小到大排列</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">asc</span>;</span><br><span class="line"><span class="comment">-- 如果存在多个排序字段可以用逗号分隔</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">asc</span>, hiredate <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 如果出现Null就要注意</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">400</span> <span class="keyword">order</span> <span class="keyword">by</span> comm <span class="keyword">asc</span> <span class="keyword">nulls first</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">400</span> <span class="keyword">order</span> <span class="keyword">by</span> comm <span class="keyword">desc</span> <span class="keyword">nulls last</span>;</span><br></pre></td></tr></table></figure>
<h4 id="4-8-2-排序中的空值问题"><a href="#4-8-2-排序中的空值问题" class="headerlink" title="4.8.2. 排序中的空值问题"></a>4.8.2. 排序中的空值问题</h4><p>当排序时有可能存在 <code>null</code> 时就会产生问题，可以用 <code>nulls first</code> , <code>nulls last</code> 来指定 <code>null</code> 值显示的位置</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">nulls first</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span> <span class="keyword">nulls last</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-9-Oracle分页查询"><a href="#4-9-Oracle分页查询" class="headerlink" title="4.9. Oracle分页查询"></a>4.9. Oracle分页查询</h3><p>分页操作需要伪列，<code>rownum</code></p>
<p>注意：不能使用大于号，如<code>rownum&gt;6</code>，因为是每查询一行分配一个<code>rownum</code>，后面的还没有分配，所以得到的查询永远结果为空</p>
<p><strong>Oracle 分页的语法</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> rownum <span class="keyword">as</span> xx,e.<span class="operator">*</span></span><br><span class="line">		<span class="keyword">from</span> emp e) t</span><br><span class="line"><span class="keyword">where</span> xx <span class="operator">&gt;</span>startIndex <span class="keyword">and</span> xx <span class="operator">&lt;=</span> maxResult;</span><br></pre></td></tr></table></figure>
<p><strong>相关参数</strong>：</p>
<ul>
<li><code>startIndex = (currentPage-1)*pageSize</code></li>
<li><code>maxResult = (currentPage-1)*pageSize + pageSize</code><ul>
<li><code>startIndex</code>: 开始页数</li>
<li><code>currentPage</code>: 当前页</li>
<li><code>pageSize</code>: 每页大小</li>
<li><code>maxResult</code>: 最大页数</li>
</ul>
</li>
</ul>
<p><strong>Code Dome</strong>:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- =======对员工表的工资排序【降序】之后，取出第二页每页3条记录</span></span><br><span class="line"><span class="comment">-- 先将表按工资进行排序</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>,empno;</span><br><span class="line"><span class="comment">-- 以上面查询结果做为新表，增加rownum列</span></span><br><span class="line"><span class="keyword">select</span> rownum rnum,t.<span class="operator">*</span></span><br><span class="line">       <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>,empno) t;</span><br><span class="line"><span class="comment">-- 再以上面查询结果做为新表，以rownum做为查询索引</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">   <span class="keyword">from</span> (</span><br><span class="line">        <span class="keyword">select</span> rownum rnum,t.<span class="operator">*</span></span><br><span class="line">        <span class="keyword">from</span> (</span><br><span class="line">             <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp</span><br><span class="line">             <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>,empno</span><br><span class="line">             ) t</span><br><span class="line">        ) e</span><br><span class="line">   <span class="keyword">where</span> e.rnum<span class="operator">&gt;</span><span class="number">3</span> <span class="keyword">and</span> e.rnum<span class="operator">&lt;=</span><span class="number">6</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-10-多表查询"><a href="#4-10-多表查询" class="headerlink" title="4.10. 多表查询"></a>4.10. 多表查询</h3><h4 id="4-10-1-Oracle-的连接条件的类型"><a href="#4-10-1-Oracle-的连接条件的类型" class="headerlink" title="4.10.1. Oracle 的连接条件的类型"></a>4.10.1. Oracle 的连接条件的类型</h4><ul>
<li>等值连接</li>
<li>不等值连接</li>
<li>外连接</li>
<li>自连接</li>
</ul>
<h4 id="4-10-2-多表连接基本查询"><a href="#4-10-2-多表连接基本查询" class="headerlink" title="4.10.2. 多表连接基本查询"></a>4.10.2. 多表连接基本查询</h4><p>使用一张以上的表做查询就是多表查询。语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> &#123;<span class="keyword">DISTINCT</span>&#125; <span class="operator">*</span><span class="operator">|</span>列名.. <span class="keyword">FROM</span> 表名 别名，表名 <span class="number">1</span> 别名</span><br><span class="line">	&#123;<span class="keyword">WHERE</span> 限制条件<span class="keyword">ORDER</span> <span class="keyword">BY</span> 排序字段 <span class="keyword">ASC</span><span class="operator">|</span>DESC...&#125;</span><br></pre></td></tr></table></figure>
<p>这种多表查询也<font color=violet>相当于内连接</font></p>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 多表查询（笛卡尔积）</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp,dept;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 多表关联查询</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e,dept d <span class="keyword">where</span> e.deptno<span class="operator">=</span>d.deptno;</span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,d.deptno,d.dname,d.loc <span class="keyword">from</span> emp e,dept d <span class="keyword">where</span> e.deptno<span class="operator">=</span>d.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 自关联查询</span></span><br><span class="line"><span class="comment">-- 需求：查询出每个员工的上级领导</span></span><br><span class="line"><span class="comment">-- emp表中的mgr字段是当前雇员的上级领导的编号，所以该字段对emp表产生了自身关联，可以使用mgr字段和empno来关联</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.mgr,e1.empno,e1.ename <span class="keyword">from</span> emp e,emp e1 <span class="keyword">where</span> e.mgr<span class="operator">=</span>e1.empno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 需求：在上一个例子的基础上查询该员工的部门名称</span></span><br><span class="line"><span class="comment">-- 只要在上一个例子基础上再加一张表dept的关联，使用deptno来做关联字段</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.mgr,e1.empno,e1.ename,e.deptno,d.dname</span><br><span class="line">       <span class="keyword">from</span> emp e,emp e1,dept d </span><br><span class="line">       <span class="keyword">where</span> e.mgr<span class="operator">=</span>e1.empno</span><br><span class="line">       <span class="keyword">and</span> e.deptno<span class="operator">=</span>d.deptno;</span><br><span class="line"><span class="comment">-- 需求：查询出每个员工编号，姓名，部门名称，工资等级和他的上级领导的姓名，工资等级</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.mgr,e.deptno,decode(s.grade,</span><br><span class="line">             <span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;等级1&#x27;</span>,</span><br><span class="line">             <span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;等级2&#x27;</span>,</span><br><span class="line">             <span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;等级3&#x27;</span>,</span><br><span class="line">             <span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;等级4&#x27;</span>,</span><br><span class="line">             <span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;等级5&#x27;</span>,</span><br><span class="line">             <span class="string">&#x27;?&#x27;</span>) <span class="keyword">as</span> &quot;员工薪级&quot;,</span><br><span class="line">       d.dname,e1.empno,e1.ename,</span><br><span class="line">             <span class="keyword">case</span> s1.grade</span><br><span class="line">               <span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> <span class="string">&#x27;等级1&#x27;</span></span><br><span class="line">               <span class="keyword">when</span> <span class="number">2</span> <span class="keyword">then</span> <span class="string">&#x27;等级2&#x27;</span></span><br><span class="line">               <span class="keyword">when</span> <span class="number">3</span> <span class="keyword">then</span> <span class="string">&#x27;等级3&#x27;</span></span><br><span class="line">               <span class="keyword">when</span> <span class="number">4</span> <span class="keyword">then</span> <span class="string">&#x27;等级4&#x27;</span></span><br><span class="line">               <span class="keyword">else</span> <span class="string">&#x27;等级5&#x27;</span></span><br><span class="line">             <span class="keyword">end</span></span><br><span class="line">             <span class="keyword">as</span> &quot;领导薪级&quot; </span><br><span class="line">       <span class="keyword">from</span> emp e,emp e1,dept d,salgrade s,salgrade s1</span><br><span class="line">       <span class="keyword">where</span> e.mgr<span class="operator">=</span>e1.empno</span><br><span class="line">       <span class="keyword">and</span> e.deptno<span class="operator">=</span>d.deptno</span><br><span class="line">       <span class="keyword">and</span> e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal</span><br><span class="line">       <span class="keyword">and</span> e1.sal <span class="keyword">between</span> s1.losal <span class="keyword">and</span> s1.hisal;</span><br></pre></td></tr></table></figure>
<h4 id="4-10-3-外连接（左右连接）"><a href="#4-10-3-外连接（左右连接）" class="headerlink" title="4.10.3. 外连接（左右连接）"></a>4.10.3. 外连接（左右连接）</h4><p><strong>右连接</strong></p>
<p>用右表的记录去匹配左表的记录，如果条件满足，则左边显示左表的记录；否则左边显示 null。（左表和右表取决于定义在实际语句的位置）</p>
<p><strong>右连接特点</strong>：如果右外连接，右边的表的记录一定会全部显示完整</p>
<p><strong>左连接</strong></p>
<p>用左表的记录去匹配右表的记录，如果条件满足，则右边显示右表的记录；否则右表显示 null。（左表和右表取决于定义在实际语句的位置）</p>
<p><strong>左连接特点</strong>：左边的表的记录一定会全部显示完整</p>
<font color=red>**外连接查询：判断以哪个表为基准表，如果是基准表，那么它的数据全部显示。使用(`+`)表示左连接或者右连接，等价于 `left join` 或者 `right join`**</font>

<p>因为（<code>+</code>）这种形式是 oracle 数据库独有的，所以优先掌握 <code>left join</code> 或 <code>right join</code> 方式的写法。想让哪个表为基准表，那么将(<code>+</code>)号放到对面一方。示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 右连接，特点：右表记录一定会全部显示完整</span></span><br><span class="line"><span class="comment">-- 需求：当我们在做基本连接查询的时候，查询出所有的部门下的员工</span></span><br><span class="line"><span class="comment">-- 编号为 40 的部门下没有员工，但是要求把该部门也展示出来</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e,dept d <span class="keyword">where</span> e.deptno(<span class="operator">+</span>)<span class="operator">=</span>d.deptno;</span><br><span class="line"><span class="comment">-- 等价于：</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">right</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.deptno<span class="operator">=</span>d.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左连接，特点：左表记录一定会全部显示完整</span></span><br><span class="line"><span class="comment">-- 需求：查询出所有员工的上级领导</span></span><br><span class="line"><span class="comment">--  KING 的上级领导没有被展示，需要使用外连接把他查询出来</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.mgr,e1.empno,e1.ename</span><br><span class="line">       <span class="keyword">from</span> emp e,emp e1</span><br><span class="line">       <span class="keyword">where</span> e.mgr<span class="operator">=</span>e1.empno(<span class="operator">+</span>);</span><br><span class="line"><span class="comment">-- 等价于：</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.mgr,e1.empno,e1.ename</span><br><span class="line">       <span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">join</span> emp e1</span><br><span class="line">       <span class="keyword">on</span> e.mgr<span class="operator">=</span>e1.empno;</span><br></pre></td></tr></table></figure>
<h3 id="4-11-子查询"><a href="#4-11-子查询" class="headerlink" title="4.11. 子查询"></a>4.11. 子查询</h3><h4 id="4-11-1-子查询概述"><a href="#4-11-1-子查询概述" class="headerlink" title="4.11.1. 子查询概述"></a>4.11.1. 子查询概述</h4><p>一条 SQL 语句(子查询)的查询结果做为另一条查询语句(父查询)的条件或查询结果，这种操作则称为子查询。</p>
<p>多条 SQL 语句嵌套使用，内部的 SQL 查询语句称为子查询。</p>
<h4 id="4-11-2-子查询的语法"><a href="#4-11-2-子查询的语法" class="headerlink" title="4.11.2. 子查询的语法"></a>4.11.2. 子查询的语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> select_list</span><br><span class="line">	<span class="keyword">from</span> <span class="keyword">table</span></span><br><span class="line">	<span class="keyword">where</span> expr operator</span><br><span class="line">		(<span class="keyword">select</span> select_list</span><br><span class="line">			<span class="keyword">from</span> <span class="keyword">table</span>);</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<ul>
<li><font color=red>**子查询 (内查询) 在主查询之前一次执行完成。**</font></li>
<li><font color=red>**子查询的结果被主查询使用 (外查询)。**</font>

</li>
</ul>
<h4 id="4-11-3-子查询的类型"><a href="#4-11-3-子查询的类型" class="headerlink" title="4.11.3. 子查询的类型"></a>4.11.3. 子查询的类型</h4><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415743.png" alt=""></p>
<h4 id="4-11-4-单行子查询"><a href="#4-11-4-单行子查询" class="headerlink" title="4.11.4. 单行子查询"></a>4.11.4. 单行子查询</h4><p>只返回一条记录。单行操作符</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单行子查询</span></span><br><span class="line"><span class="keyword">select</span> ename,job,sal <span class="keyword">from</span> emp </span><br><span class="line">       <span class="keyword">where</span> job<span class="operator">=</span></span><br><span class="line">             (<span class="keyword">select</span> job </span><br><span class="line">              <span class="keyword">from</span> emp</span><br><span class="line">              <span class="keyword">where</span> empno<span class="operator">=</span><span class="number">7566</span>)</span><br><span class="line">       <span class="keyword">and</span> sal<span class="operator">&gt;</span></span><br><span class="line">              (<span class="keyword">select</span> sal </span><br><span class="line">              <span class="keyword">from</span> emp</span><br><span class="line">              <span class="keyword">where</span> empno<span class="operator">=</span><span class="number">7782</span>);</span><br><span class="line"><span class="comment">-- 使用聚合函数作为子查询条件</span></span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">min</span>(sal) <span class="keyword">from</span> emp</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line">       <span class="keyword">having</span> <span class="built_in">min</span>(sal)<span class="operator">&gt;</span> </span><br><span class="line">              (<span class="keyword">select</span> <span class="built_in">min</span>(sal)</span><br><span class="line">               <span class="keyword">from</span> emp</span><br><span class="line">               <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">20</span>);</span><br><span class="line"><span class="comment">-- 需求：查询出比雇员7654的工资高，同时从事和7788的工作一样的员工</span></span><br><span class="line"><span class="keyword">select</span> e1.ename,e1.job,e1.sal</span><br><span class="line">       <span class="keyword">from</span> emp e1</span><br><span class="line">       <span class="keyword">where</span> e1.sal<span class="operator">&gt;</span></span><br><span class="line">             (<span class="keyword">select</span> e2.sal <span class="keyword">from</span> emp e2</span><br><span class="line">             <span class="keyword">where</span> e2.empno<span class="operator">=</span><span class="number">7654</span>)</span><br><span class="line">       <span class="keyword">and</span> e1.job<span class="operator">=</span></span><br><span class="line">             (<span class="keyword">select</span> e3.job <span class="keyword">from</span> emp e3</span><br><span class="line">             <span class="keyword">where</span> e3.empno<span class="operator">=</span><span class="number">7788</span>);</span><br><span class="line"><span class="comment">-- 需求：查询每个部门的最低工资和最低工资的雇员和部门名称</span></span><br><span class="line"><span class="keyword">select</span> e.ename,s.minsal,d.dname</span><br><span class="line">       <span class="keyword">from</span> emp e,</span><br><span class="line">       (<span class="keyword">select</span> e1.deptno,<span class="built_in">min</span>(e1.sal) minsal</span><br><span class="line">       <span class="keyword">from</span> emp e1</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> e1.deptno) s,</span><br><span class="line">       dept d</span><br><span class="line">       <span class="keyword">where</span> e.deptno<span class="operator">=</span>d.deptno</span><br><span class="line">       <span class="keyword">and</span> e.sal<span class="operator">=</span>s.minsal;</span><br></pre></td></tr></table></figure>
<h4 id="4-11-5-多行子查询"><a href="#4-11-5-多行子查询" class="headerlink" title="4.11.5. 多行子查询"></a>4.11.5. 多行子查询</h4><p>返回了多条记录，多行操作符</p>
<h4 id="4-11-6-子查询中的-null-值问题"><a href="#4-11-6-子查询中的-null-值问题" class="headerlink" title="4.11.6. 子查询中的 null 值问题"></a>4.11.6. 子查询中的 null 值问题</h4><p>多行子查询中 <code>null</code> 值需要注意的问题：查询结果为空，不会报错。</p>
<p>单行子查询中的 <code>null</code> 值问题</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415744.png" alt=""></p>
<p>多行子查询中的 null 值问题</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415745.png" alt=""></p>
<h4 id="4-11-7-Exists-用法"><a href="#4-11-7-Exists-用法" class="headerlink" title="4.11.7. Exists 用法"></a>4.11.7. Exists 用法</h4><p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">exists</span>(<span class="keyword">sql</span> 查询语句)</span><br></pre></td></tr></table></figure>
<p>函数的效果是：sql 查询语句为空，则返回值是 <code>false</code>；sql 查询语句有值，则返回值就是 <code>true</code></p>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">1</span>);</span><br><span class="line"><span class="comment">-- 等同于：select * from emp where 1=2</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">10</span>);</span><br><span class="line"><span class="comment">-- 等同于：select * from emp where 1=1</span></span><br><span class="line"><span class="comment">-- 范例：查询有员工的部门</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept d <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e <span class="keyword">where</span> e.deptno <span class="operator">=</span> d.deptno);</span><br><span class="line"><span class="comment">-- 使用in替换</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept d <span class="keyword">where</span> d.deptno <span class="keyword">in</span> (<span class="keyword">select</span>  <span class="keyword">distinct</span> deptno <span class="keyword">from</span> emp);</span><br></pre></td></tr></table></figure>
<blockquote>
<font color=red>如果是大数据量【百万级】的查询，建议使用 `exists`，使用 `in` 的话会全表查询</font>

</blockquote>
<h4 id="4-11-8-Oracle-中的伪列"><a href="#4-11-8-Oracle-中的伪列" class="headerlink" title="4.11.8. Oracle 中的伪列"></a>4.11.8. Oracle 中的伪列</h4><p>oracle提供的两个伪列</p>
<ul>
<li><code>ROWNUM</code>：表示行号，实际上只是一个列，但是这个列是一个伪列，此列可以在每张表中出现。【先查询数据，再分配序号。找出一条数据，分配一个<code>rownum</code>】</li>
<li><code>ROWID</code>：表中每行数据指向磁盘上的物理地址</li>
</ul>
<h3 id="4-12-Oracle-查询综合示例"><a href="#4-12-Oracle-查询综合示例" class="headerlink" title="4.12. Oracle 查询综合示例"></a>4.12. Oracle 查询综合示例</h3><h4 id="4-12-1-Oracle查询练习"><a href="#4-12-1-Oracle查询练习" class="headerlink" title="4.12.1. Oracle查询练习"></a>4.12.1. Oracle查询练习</h4><ul>
<li>找到员工表中工资最高的前三名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 先排序</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal</span><br><span class="line">       <span class="keyword">from</span> emp e</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> e.sal <span class="keyword">desc</span> <span class="keyword">nulls last</span>,e.empno <span class="keyword">asc</span>;</span><br><span class="line"><span class="comment">-- 使用伪列rownum</span></span><br><span class="line"><span class="keyword">select</span> rownum,t.empno,t.ename,t.sal</span><br><span class="line">       <span class="keyword">from</span> (<span class="keyword">select</span> e.empno,e.ename,e.sal</span><br><span class="line">            <span class="keyword">from</span> emp e</span><br><span class="line">            <span class="keyword">order</span> <span class="keyword">by</span> e.sal <span class="keyword">desc</span> <span class="keyword">nulls last</span>,e.empno <span class="keyword">asc</span>) t</span><br><span class="line">       <span class="keyword">where</span> rownum <span class="operator">&lt;=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>找到员工表中薪水大于本部门平均薪水的员工</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 先查询每个部门的平均薪水</span></span><br><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,t.avgsal</span><br><span class="line">       <span class="keyword">from</span> emp e,(<span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) avgsal</span><br><span class="line">              <span class="keyword">from</span> emp</span><br><span class="line">              <span class="keyword">group</span> <span class="keyword">by</span> deptno) t</span><br><span class="line">       <span class="keyword">where</span> e.sal <span class="operator">&gt;</span> t.avgsal</span><br><span class="line">       <span class="keyword">and</span> e.deptno<span class="operator">=</span>t.deptno</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> e.empno <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>统计每年入职的员工个数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- TO_CHAR 函数对日期的转换成字符串</span></span><br><span class="line"><span class="keyword">select</span> e.hdate,<span class="built_in">count</span>(<span class="operator">*</span>)</span><br><span class="line">       <span class="keyword">from</span> (<span class="keyword">select</span> to_char(hiredate, <span class="string">&#x27;yyyy&#x27;</span>) hdate <span class="keyword">from</span> emp) e</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> e.hdate</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> e.hdate <span class="keyword">asc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 把上面的当成一张表，这里的聚合函数是为了补全语法</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(t.dcount) <span class="keyword">as</span> &quot;Total&quot;,</span><br><span class="line">       <span class="built_in">sum</span>(decode(hdate,<span class="string">&#x27;1980&#x27;</span>,dcount)) <span class="keyword">as</span> &quot;1980&quot;,</span><br><span class="line">       <span class="built_in">sum</span>(decode(hdate,<span class="string">&#x27;1981&#x27;</span>,dcount)) <span class="keyword">as</span> &quot;1981&quot;,</span><br><span class="line">       <span class="built_in">sum</span>(decode(hdate,<span class="string">&#x27;1982&#x27;</span>,dcount)) <span class="keyword">as</span> &quot;1982&quot;,</span><br><span class="line">       <span class="built_in">sum</span>(decode(hdate,<span class="string">&#x27;1987&#x27;</span>,dcount)) <span class="keyword">as</span> &quot;1987&quot;</span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> e.hdate,<span class="built_in">count</span>(<span class="operator">*</span>) dcount</span><br><span class="line">       <span class="keyword">from</span> (<span class="keyword">select</span> to_char(hiredate, <span class="string">&#x27;yyyy&#x27;</span>) hdate <span class="keyword">from</span> emp) e</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> e.hdate) t;</span><br></pre></td></tr></table></figure>
<h4 id="4-12-2-Oracle-综合查询"><a href="#4-12-2-Oracle-综合查询" class="headerlink" title="4.12.2. Oracle 综合查询"></a>4.12.2. Oracle 综合查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 建表语句和插入数据</span></span><br><span class="line"><span class="comment">-- 案例【1.1】查询学员列表，显示学员姓名，电话，班级名称</span></span><br><span class="line"><span class="keyword">select</span> stu.name &quot;学员姓名&quot;,stu.tele &quot;电话&quot;,cla.name &quot;班级名称&quot;</span><br><span class="line">       <span class="keyword">from</span> T_STUDENT stu,T_CLASS cla</span><br><span class="line">       <span class="keyword">where</span> stu.classid<span class="operator">=</span>cla.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【1.2】查询学员成绩列表，显示班级类型名称，班级名称，学员姓名，课程名称，考试分数</span></span><br><span class="line"><span class="keyword">select</span> ct.name &quot;班级类型名称&quot;,cla.name &quot;班级名称&quot;,stu.name &quot;学员姓名&quot;,course.name &quot;课程名称&quot;,mark.score &quot;考试分数&quot;</span><br><span class="line">    <span class="keyword">from</span> T_STUDENT stu,T_CLASS cla,T_CLASS_TYPE ct,T_COURSE course,T_MARK mark</span><br><span class="line">    <span class="keyword">where</span> stu.classid<span class="operator">=</span>cla.id</span><br><span class="line">    <span class="keyword">and</span> cla.type<span class="operator">=</span>ct.id</span><br><span class="line">    <span class="keyword">and</span> stu.id<span class="operator">=</span>mark.studentid</span><br><span class="line">    <span class="keyword">and</span> course.id<span class="operator">=</span>mark.courseid</span><br><span class="line">    <span class="keyword">and</span> course.type<span class="operator">=</span>ct.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【1.3】查询学员成绩列表，显示学员姓名，考试分数，如果该学员没有考试记录也要列出姓名</span></span><br><span class="line"><span class="comment">-- 方式1</span></span><br><span class="line"><span class="keyword">select</span> s.name &quot;学员姓名&quot;,m.score &quot;分数&quot;</span><br><span class="line">       <span class="keyword">from</span> T_STUDENT s</span><br><span class="line">       <span class="keyword">left</span> <span class="keyword">join</span> T_MARK m</span><br><span class="line">       <span class="keyword">on</span> s.id<span class="operator">=</span>m.studentid;</span><br><span class="line"><span class="comment">-- 方式2 oracle特有方式</span></span><br><span class="line"><span class="keyword">select</span> s.name &quot;学员姓名&quot;,m.score &quot;分数&quot;</span><br><span class="line">       <span class="keyword">from</span> T_STUDENT s,T_MARK m</span><br><span class="line">       <span class="keyword">where</span> s.id<span class="operator">=</span>m.studentid(<span class="operator">+</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【1.4】统计每门课程的平均分</span></span><br><span class="line"><span class="keyword">select</span> courseid,round(<span class="built_in">avg</span>(score)) &quot;AVGSCORE&quot; <span class="keyword">from</span> T_MARK <span class="keyword">group</span> <span class="keyword">by</span> courseid;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【1.5】上例的基础上显示课程名称</span></span><br><span class="line"><span class="keyword">select</span> m.courseid,c.name,round(<span class="built_in">avg</span>(m.score)) &quot;AVGSCORE&quot;</span><br><span class="line">       <span class="keyword">from</span> T_MARK m,T_COURSE c</span><br><span class="line">       <span class="keyword">where</span> m.courseid<span class="operator">=</span>c.id</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> m.courseid,c.name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【1.6】继续在上例的基础上统计平均分大于60且小于80的课程，并按平均分由高到低排序</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span></span><br><span class="line">       (<span class="keyword">select</span> m.courseid,c.name,round(<span class="built_in">avg</span>(m.score)) &quot;AVGSCORE&quot;</span><br><span class="line">       <span class="keyword">from</span> T_MARK m,T_COURSE c</span><br><span class="line">       <span class="keyword">where</span> m.courseid<span class="operator">=</span>c.id</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> m.courseid,c.name) t</span><br><span class="line">       <span class="keyword">where</span> t.AVGSCORE <span class="operator">&gt;</span> <span class="number">60</span></span><br><span class="line">       <span class="keyword">and</span> t.AVGSCORE <span class="operator">&lt;</span> <span class="number">80</span></span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> t.AVGSCORE <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【1.7】查询唐浩然的同班同学</span></span><br><span class="line"><span class="comment">-- 先查询所在班级</span></span><br><span class="line"><span class="keyword">select</span> classid <span class="keyword">from</span> T_STUDENT</span><br><span class="line">       <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;唐浩然&#x27;</span>;</span><br><span class="line"><span class="comment">-- 以上表做为基础条件，再查询学生表，</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> T_STUDENT</span><br><span class="line">       <span class="keyword">where</span> classid<span class="operator">=</span>(</span><br><span class="line">             <span class="keyword">select</span> classid <span class="keyword">from</span> T_STUDENT</span><br><span class="line">             <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;唐浩然&#x27;</span></span><br><span class="line">       )</span><br><span class="line">       <span class="keyword">and</span> name <span class="operator">&lt;&gt;</span> <span class="string">&#x27;唐浩然&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【1.8】查询唐浩然的同班同学并且学历一样的同学</span></span><br><span class="line"><span class="comment">-- 查询学历</span></span><br><span class="line"><span class="keyword">select</span> edu <span class="keyword">from</span> T_STUDENT</span><br><span class="line">       <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;唐浩然&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 以上面查询学历做为子查询条件</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> T_STUDENT</span><br><span class="line">       <span class="keyword">where</span> classid<span class="operator">=</span>(</span><br><span class="line">             <span class="keyword">select</span> classid <span class="keyword">from</span> T_STUDENT</span><br><span class="line">             <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;唐浩然&#x27;</span>)</span><br><span class="line">       <span class="keyword">and</span> name <span class="operator">&lt;&gt;</span> <span class="string">&#x27;唐浩然&#x27;</span></span><br><span class="line">       <span class="keyword">and</span> edu<span class="operator">=</span>(</span><br><span class="line">           <span class="keyword">select</span> edu <span class="keyword">from</span> T_STUDENT</span><br><span class="line">           <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;唐浩然&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【1.9】查询每门科目最高分数</span></span><br><span class="line"><span class="comment">-- 方式1</span></span><br><span class="line"><span class="keyword">select</span> c.name,<span class="built_in">max</span>(m.score) maxscore <span class="keyword">from</span> T_COURSE c,T_MARK m</span><br><span class="line">       <span class="keyword">where</span> c.id<span class="operator">=</span>m.courseid</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> m.courseid,c.name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2,子查询方式</span></span><br><span class="line"><span class="keyword">select</span> courseid,<span class="built_in">max</span>(score) maxscore</span><br><span class="line">       <span class="keyword">from</span> T_MARK</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> courseid;</span><br><span class="line"><span class="comment">-- 以上表做为子表</span></span><br><span class="line"><span class="keyword">select</span> c.name,m.maxscore</span><br><span class="line">       <span class="keyword">from</span> T_COURSE c,(</span><br><span class="line">            <span class="keyword">select</span> courseid,<span class="built_in">max</span>(score) maxscore</span><br><span class="line">            <span class="keyword">from</span> T_MARK</span><br><span class="line">            <span class="keyword">group</span> <span class="keyword">by</span> courseid) m</span><br><span class="line">        <span class="keyword">where</span> c.id<span class="operator">=</span>m.courseid;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【2.0】分数在90分以上的同学</span></span><br><span class="line"><span class="comment">-- 查询90分以上所有学生的ID，并去重</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> STUDENTID <span class="keyword">from</span> T_MARK <span class="keyword">where</span> SCORE <span class="operator">&gt;</span> <span class="number">90</span>;</span><br><span class="line"><span class="comment">-- 以上表做为子查询条件</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> T_STUDENT</span><br><span class="line">       <span class="keyword">where</span> ID <span class="keyword">in</span> (</span><br><span class="line">             <span class="keyword">select</span> <span class="keyword">distinct</span> STUDENTID</span><br><span class="line">             <span class="keyword">from</span> T_MARK</span><br><span class="line">             <span class="keyword">where</span> SCORE <span class="operator">&gt;</span> <span class="number">90</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【2.1】查询曾经缺考的同学</span></span><br><span class="line"><span class="comment">-- 查询有参数考试的学生</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> STUDENTID <span class="keyword">from</span> T_MARK;</span><br><span class="line"><span class="comment">-- 以上表子查询条件</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> T_STUDENT</span><br><span class="line">       <span class="keyword">where</span> ID <span class="keyword">not</span> <span class="keyword">in</span> (</span><br><span class="line">             <span class="keyword">select</span> <span class="keyword">distinct</span> STUDENTID</span><br><span class="line">             <span class="keyword">from</span> T_MARK);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例【2.2】查询成绩排名表的第二页（按每页5条数据）</span></span><br><span class="line"><span class="comment">-- 先按成绩排名查询</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> T_MARK</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 以上面查询的表为基础，添加rownum</span></span><br><span class="line"><span class="keyword">select</span> rownum &quot;R&quot;,t.<span class="operator">*</span> <span class="keyword">from</span> (</span><br><span class="line">       <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> T_MARK</span><br><span class="line">       <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span>) t;</span><br><span class="line"><span class="comment">-- 以上表为基础，进行分页查询</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (</span><br><span class="line">       <span class="keyword">select</span> rownum &quot;R&quot;,t.<span class="operator">*</span> <span class="keyword">from</span> (</span><br><span class="line">              <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> T_MARK</span><br><span class="line">              <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span>) t)</span><br><span class="line">       <span class="keyword">where</span> r<span class="operator">&gt;</span><span class="number">5</span> <span class="keyword">and</span> r<span class="operator">&lt;=</span><span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-13-集合运算"><a href="#4-13-集合运算" class="headerlink" title="4.13. 集合运算"></a>4.13. 集合运算</h3><h4 id="4-13-1-什么是集合运算"><a href="#4-13-1-什么是集合运算" class="headerlink" title="4.13.1. 什么是集合运算"></a>4.13.1. 什么是集合运算</h4><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415746.png" alt=""></p>
<ul>
<li><code>union</code>/<code>union all</code> 并集<ul>
<li><code>union all</code> 合并多个结果集</li>
<li><code>union</code> 合并多个结果集，去除重复</li>
</ul>
</li>
<li><code>intersect</code> 交集</li>
<li><code>minus</code> 差集</li>
</ul>
<h4 id="4-13-2-并集，类似于or"><a href="#4-13-2-并集，类似于or" class="headerlink" title="4.13.2. 并集，类似于or"></a>4.13.2. 并集，类似于or</h4><p>范例：工资大于 1500，或者是 20 号部门下的员工（并集）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 并集</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> sal<span class="operator">&gt;</span><span class="number">1500</span> <span class="keyword">or</span> deptno<span class="operator">=</span><span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- or 关键字效率会很低，全表查询，索引用不了</span></span><br><span class="line"><span class="comment">-- 方式2</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">1500</span></span><br><span class="line"><span class="keyword">union</span> <span class="comment">-- 使用union all包括重复部分</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure>
<h4 id="4-13-3-交集，类似于and"><a href="#4-13-3-交集，类似于and" class="headerlink" title="4.13.3. 交集，类似于and"></a>4.13.3. 交集，类似于and</h4><p>范例：工资大于 1500，并且是 20 号部门下的员工（交集）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 交集</span></span><br><span class="line"><span class="comment">-- 方式1</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">where</span> sal<span class="operator">&gt;</span><span class="number">1500</span> <span class="keyword">and</span> deptno<span class="operator">=</span><span class="number">20</span>;</span><br><span class="line"><span class="comment">-- 方式2</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="number">1600</span></span><br><span class="line"><span class="keyword">intersect</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure>
<h4 id="4-13-4-差集"><a href="#4-13-4-差集" class="headerlink" title="4.13.4. 差集"></a>4.13.4. 差集</h4><p>范例：1981 年入职的普通员工（不包括总裁和经理）（差集）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 差集</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> to_char(hiredate,<span class="string">&#x27;yyyy&#x27;</span>)<span class="operator">=</span><span class="string">&#x27;1981&#x27;</span> <span class="comment">-- a</span></span><br><span class="line">minus</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> job<span class="operator">=</span><span class="string">&#x27;MANAGER&#x27;</span> <span class="keyword">or</span> job <span class="operator">=</span> <span class="string">&#x27;PRESIDENT&#x27;</span>; <span class="comment">-- b</span></span><br><span class="line"><span class="comment">-- 如果a minus b,a 中没有在b 中的数据，全部显示</span></span><br></pre></td></tr></table></figure>
<h4 id="4-13-5-集合运算的特征"><a href="#4-13-5-集合运算的特征" class="headerlink" title="4.13.5. 集合运算的特征"></a>4.13.5. 集合运算的特征</h4><font color=red>*集合运算两边查询的字段数量、字段类型、顺序必须一致*</font>

<h3 id="4-14-递归查询【了解】"><a href="#4-14-递归查询【了解】" class="headerlink" title="4.14. 递归查询【了解】"></a>4.14. 递归查询【了解】</h3><p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> 条件一 <span class="comment">--开始查询位置</span></span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> 条件二  <span class="comment">--指定查询当前的关系</span></span><br></pre></td></tr></table></figure>
<p><code>connect by</code> 条件二中使用到关键字<code>prior</code>：从哪个方向进行检索。如以下示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工的领导</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> empno<span class="operator">=</span><span class="number">7369</span></span><br><span class="line"><span class="comment">-- prior:从哪个方向进行检索</span></span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> empno<span class="operator">=</span>prior mgr;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询领导的下属是那些</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> empno<span class="operator">=</span><span class="number">7566</span></span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> mgr<span class="operator">=</span>prior empno;</span><br></pre></td></tr></table></figure>
<h2 id="5-SQL-函数"><a href="#5-SQL-函数" class="headerlink" title="5. SQL 函数"></a>5. SQL 函数</h2><h3 id="5-1-定义"><a href="#5-1-定义" class="headerlink" title="5.1. 定义"></a>5.1. 定义</h3><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415747.png" alt=""></p>
<p>注意：函数可以没有参数，但必须要有返回值</p>
<h3 id="5-2-函数的类型"><a href="#5-2-函数的类型" class="headerlink" title="5.2. 函数的类型"></a>5.2. 函数的类型</h3><ul>
<li>单行函数</li>
<li>多行函数</li>
</ul>
<font color=red>**注意：无论是单行函数还是多行函数，返回的结果都是一个**</font>

<h3 id="5-3-单行函数"><a href="#5-3-单行函数" class="headerlink" title="5.3. 单行函数"></a>5.3. 单行函数</h3><h4 id="5-3-1-单行函数分类"><a href="#5-3-1-单行函数分类" class="headerlink" title="5.3.1. 单行函数分类"></a>5.3.1. 单行函数分类</h4><ol>
<li>字符函数</li>
<li>数值函数</li>
<li>日期函数</li>
<li>转换函数</li>
<li>通用函数</li>
</ol>
<h4 id="5-3-2-字符函数"><a href="#5-3-2-字符函数" class="headerlink" title="5.3.2. 字符函数"></a>5.3.2. 字符函数</h4><p><strong>字符控制函数</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">关键字</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>concat</code></td>
<td>字符串的连接可以使用 <code>concat</code> 函数也可以使用“`</td>
<td></td>
<td><code>”。建议使用“</code></td>
<td></td>
<td><code>”&lt;br /&gt;</code>concat(参数1, 参数2)<code>：只能用有两个参数&lt;br /&gt;使用“</code></td>
<td></td>
<td>`”可以拼接多个参数</td>
</tr>
<tr>
<td style="text-align:center"><code>substr</code></td>
<td>字符串的截取，<code>substr(s, p1, p2)</code><br />第1个参数s是源字符串<br />第2个参数p1是开始索引，开始的索引使用 1 和 0 效果相同，第二个字符的索引是2<br />第3个参数p2是截取的长度</td>
</tr>
<tr>
<td style="text-align:center"><code>length</code>/<code>lengthb</code></td>
<td>获取字符串的长度</td>
</tr>
<tr>
<td style="text-align:center"><code>instr</code></td>
<td></td>
</tr>
<tr>
<td style="text-align:center"><code>lpad</code>/<code>rpad</code></td>
<td></td>
</tr>
<tr>
<td style="text-align:center"><code>trim</code></td>
<td></td>
</tr>
<tr>
<td style="text-align:center"><code>replace</code></td>
<td>字符串替换，第一个参数是源字符串，第二个参数被替换的字符串，第三个是替换字符串</td>
</tr>
</tbody>
</table>
</div>
<p><strong>大小写控制函数</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">关键字</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>lower</code></td>
<td>将结果转成小写字母</td>
</tr>
<tr>
<td style="text-align:center"><code>upper</code></td>
<td>将结果转成大写字母</td>
</tr>
<tr>
<td style="text-align:center"><code>initcap</code></td>
</tr>
</tbody>
</table>
</div>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 字符串拼接(只能是两个拼接)</span></span><br><span class="line"><span class="keyword">select</span> concat(<span class="string">&#x27;abc&#x27;</span>,<span class="string">&#x27;zxy&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 字符串拼接（三个拼接）建议使用||</span></span><br><span class="line"><span class="keyword">select</span> concat(<span class="number">123</span>,concat(<span class="string">&#x27;abc&#x27;</span>,<span class="string">&#x27;zxy&#x27;</span>)) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 大小写</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(<span class="string">&#x27;MOON&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;moon&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询用户名称小写的</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(ename) <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 字符串长度</span></span><br><span class="line"><span class="keyword">select</span> length(<span class="string">&#x27;abc123&#x27;</span>) <span class="keyword">as</span> &quot;字符长度&quot; <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 截取字符串</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   substr(v1,p1,p2)</span></span><br><span class="line"><span class="comment">           v1:要截取的字符串</span></span><br><span class="line"><span class="comment">           p1: 从哪里开始截取,0 和 1 都是一样的，都是开始下标</span></span><br><span class="line"><span class="comment">           p2: 截取的长度</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;moonzero&#x27;</span>,<span class="number">0</span>,<span class="number">3</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;moonzero&#x27;</span>,<span class="number">1</span>,<span class="number">3</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;moonzero&#x27;</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 字符串替换，第一个参数是源字符串，第二个参数被替换的字符串，第三个是替换字符串</span></span><br><span class="line"><span class="keyword">select</span> replace (<span class="string">&#x27;moonzero&#x27;</span>,<span class="string">&#x27;oo&#x27;</span>,<span class="string">&#x27;00&#x27;</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<h4 id="5-3-3-数值函数"><a href="#5-3-3-数值函数" class="headerlink" title="5.3.3. 数值函数"></a>5.3.3. 数值函数</h4><p>用于操作数字</p>
<h5 id="5-3-3-1-round：四舍五入"><a href="#5-3-3-1-round：四舍五入" class="headerlink" title="5.3.3.1. round：四舍五入"></a>5.3.3.1. round：四舍五入</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">round(数字, 保留的小数位)</span><br></pre></td></tr></table></figure>
<p>如果不写参数，默认情况下，只保留整数位</p>
<h5 id="5-3-3-2-trunc：截断，直接截断字符，不会进行四舍五入"><a href="#5-3-3-2-trunc：截断，直接截断字符，不会进行四舍五入" class="headerlink" title="5.3.3.2. trunc：截断，直接截断字符，不会进行四舍五入"></a>5.3.3.2. trunc：截断，直接截断字符，不会进行四舍五入</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">trunc(数字, 保留的小数位)</span><br></pre></td></tr></table></figure>
<p>如果不写保留的小数位，默认是直接切断只保留整数位</p>
<h5 id="5-3-3-3-mod：求余"><a href="#5-3-3-3-mod：求余" class="headerlink" title="5.3.3.3. mod：求余"></a>5.3.3.3. mod：求余</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mod</span>(被除数，除数)</span><br></pre></td></tr></table></figure>
<h5 id="5-3-3-4-示例"><a href="#5-3-3-4-示例" class="headerlink" title="5.3.3.4. 示例"></a>5.3.3.4. 示例</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--操作数字</span></span><br><span class="line"><span class="comment">-- 四舍五入</span></span><br><span class="line"><span class="comment">--只保留整数位(不写参数，默认只保留整数位)</span></span><br><span class="line"><span class="keyword">select</span> round(<span class="number">58.8888</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 第二个参数，保留两位小数</span></span><br><span class="line"><span class="keyword">select</span> round(<span class="number">58.8888</span>, <span class="number">2</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> round(<span class="number">58.8838</span>, <span class="number">2</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 直接截断</span></span><br><span class="line"><span class="keyword">select</span> trunc(<span class="number">58.8888</span>, <span class="number">2</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 求余</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">mod</span>(<span class="number">1200</span>, <span class="number">500</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<h4 id="5-3-4-日期函数"><a href="#5-3-4-日期函数" class="headerlink" title="5.3.4. 日期函数"></a>5.3.4. 日期函数</h4><p><code>sysdate</code>：当前数据库所在服务器的时间</p>
<h5 id="5-3-4-1-Oracle的日期"><a href="#5-3-4-1-Oracle的日期" class="headerlink" title="5.3.4.1. Oracle的日期"></a>5.3.4.1. Oracle的日期</h5><p>Oracle 中的日期型数据实际含有两个值:日期和时间</p>
<p>默认的日期格式是 <code>DD-MON-RR</code></p>
<h5 id="5-3-4-2-日期的数学运算"><a href="#5-3-4-2-日期的数学运算" class="headerlink" title="5.3.4.2. 日期的数学运算"></a>5.3.4.2. 日期的数学运算</h5><ol>
<li>在日期上加上或减去一个数字结果仍为日期。两个日期相减返回日期之间相差的天数，可以用数字除 24</li>
<li>获得两个时间段中的月数：<code>MONTHS_BETWEEN(date, date)</code></li>
<li>获得几个月后的日期：<code>ADD_MONTHS(sysdate, num)</code></li>
</ol>
<h5 id="5-3-4-3-示例"><a href="#5-3-4-3-示例" class="headerlink" title="5.3.4.3. 示例"></a>5.3.4.3. 示例</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- sysdate : 当前数据库所在服务器的时间</span></span><br><span class="line"><span class="keyword">select</span> sysdate <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询员工入职的天数</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> ename,round(sysdate <span class="operator">-</span> hiredate) &quot;入职天数&quot; <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 在上面的基础上，算一下入职的周数</span></span><br><span class="line"><span class="keyword">select</span> ename,round((sysdate <span class="operator">-</span> hiredate)<span class="operator">/</span><span class="number">7</span>) &quot;入职周数&quot; <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 计算入职的月数</span></span><br><span class="line"><span class="keyword">select</span> ename,round(months_between(sysdate,hiredate)) &quot;入职月数&quot; <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 获得几个月后的日期</span></span><br><span class="line"><span class="keyword">select</span> add_months(sysdate, <span class="number">3</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<h4 id="5-3-5-转换函数"><a href="#5-3-5-转换函数" class="headerlink" title="5.3.5. 转换函数"></a>5.3.5. 转换函数</h4><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415748.png" alt=""></p>
<h5 id="5-3-5-1-TO-CHAR-函数对日期的转换成字符串"><a href="#5-3-5-1-TO-CHAR-函数对日期的转换成字符串" class="headerlink" title="5.3.5.1. TO_CHAR 函数对日期的转换成字符串"></a>5.3.5.1. TO_CHAR 函数对日期的转换成字符串</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">to_char(<span class="type">date</span>, <span class="string">&#x27;format_model&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>日期的格式：</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415749.png" alt=""></p>
<blockquote>
<p>注：在设置<code>&#39;yyyy-mm-dd&#39;</code>格式后，10 以下的月份前面被被补了前导零，可以使用 <code>fm</code> 去掉前导零</p>
</blockquote>
<h5 id="5-3-5-2-TO-CHAR-函数对数字的转换成字符串"><a href="#5-3-5-2-TO-CHAR-函数对数字的转换成字符串" class="headerlink" title="5.3.5.2. TO_CHAR 函数对数字的转换成字符串"></a>5.3.5.2. TO_CHAR 函数对数字的转换成字符串</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">to_char(number, <span class="string">&#x27;format_model&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>数字转换的格式：</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415750.png" alt=""></p>
<h5 id="5-3-5-3-TO-NUMBER-和-TO-DATE-函数"><a href="#5-3-5-3-TO-NUMBER-和-TO-DATE-函数" class="headerlink" title="5.3.5.3. TO_NUMBER 和 TO_DATE 函数"></a>5.3.5.3. TO_NUMBER 和 TO_DATE 函数</h5><p>使用<code>TO_NUMBER</code>函数将字符转换成数字，转换后的数字可以进行运算</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">to_number(<span class="type">char</span>[, <span class="string">&#x27;format_model&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>使用TO_DATE函数将字符转换成日期</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">to_date(<span class="type">char</span>[, <span class="string">&#x27;format_model&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>Code Dome:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 把时间转成字符串,10以下的月前面被被补了前导零，可以使用 fm 去掉前导零</span></span><br><span class="line"><span class="keyword">select</span> to_char(sysdate, <span class="string">&#x27;yyyy/mm/dd&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> to_char(sysdate, <span class="string">&#x27;fmyyyy/mm/dd&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">--  把字符串转成时间</span></span><br><span class="line"><span class="keyword">select</span> to_date(<span class="string">&#x27;2018/9/10&#x27;</span>, <span class="string">&#x27;yyyy/mm/dd&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 把数字转成字符</span></span><br><span class="line"><span class="keyword">select</span> to_char(<span class="number">123</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 把字符串转成数字,转换后可以进行运算</span></span><br><span class="line"><span class="keyword">select</span> to_number(<span class="string">&#x27;123&#x27;</span>)<span class="operator">+</span>to_number(<span class="string">&#x27;321&#x27;</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<h4 id="5-3-6-通用函数"><a href="#5-3-6-通用函数" class="headerlink" title="5.3.6. 通用函数"></a>5.3.6. 通用函数</h4><h5 id="5-3-6-1-通用函数的定义"><a href="#5-3-6-1-通用函数的定义" class="headerlink" title="5.3.6.1. 通用函数的定义"></a>5.3.6.1. 通用函数的定义</h5><p>适用于任何数据类型，同时也适用于空值的函数</p>
<h5 id="5-3-6-2-常用的通用函数"><a href="#5-3-6-2-常用的通用函数" class="headerlink" title="5.3.6.2. 常用的通用函数"></a>5.3.6.2. 常用的通用函数</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 如果expr1为空，则输出expr2。前后的数据类型要一致。</span></span><br><span class="line">nvl(expr1, expr2)</span><br><span class="line">nvl2(expr1, expr2, expr3)</span><br><span class="line"><span class="built_in">nullif</span>(expr1, expr2)</span><br><span class="line"><span class="built_in">coalesce</span>(expr1, expr2,……, exprn)</span><br></pre></td></tr></table></figure>
<p>Code Dome:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- nvl（p1,p2） ,如果p1为空，就输出p2,前后的数据类型要一直</span></span><br><span class="line"><span class="keyword">select</span> ename,nvl(comm, <span class="number">0</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<h4 id="5-3-7-条件表达式"><a href="#5-3-7-条件表达式" class="headerlink" title="5.3.7. 条件表达式"></a>5.3.7. 条件表达式</h4><h5 id="5-3-7-1-条件表达式定义"><a href="#5-3-7-1-条件表达式定义" class="headerlink" title="5.3.7.1. 条件表达式定义"></a>5.3.7.1. 条件表达式定义</h5><p>在 SQL 语句中使用 <code>IF-THEN-ELSE</code></p>
<h5 id="5-3-7-2-实现方式1：case-表达式"><a href="#5-3-7-2-实现方式1：case-表达式" class="headerlink" title="5.3.7.2. 实现方式1：case 表达式"></a>5.3.7.2. 实现方式1：case 表达式</h5><p><code>CASE</code> 表达式：SQL99 的语法，类似 Basic，比较繁琐。语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> expr <span class="keyword">when</span> comparison_expr1 <span class="keyword">then</span> return_expr1</span><br><span class="line">		[<span class="keyword">when</span> comparison_expr2 <span class="keyword">then</span> return_expr2</span><br><span class="line">			……</span><br><span class="line">		<span class="keyword">when</span> comparison_exprn <span class="keyword">then</span> return_exprn</span><br><span class="line">		<span class="keyword">else</span> else_expr]</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h5 id="5-3-7-3-实现方式2：decode-函数（推荐）"><a href="#5-3-7-3-实现方式2：decode-函数（推荐）" class="headerlink" title="5.3.7.3. 实现方式2：decode 函数（推荐）"></a>5.3.7.3. 实现方式2：decode 函数（推荐）</h5><p><code>DECODE</code> 函数：Oracle 自己的语法，类似 Java，比较简洁。语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">decode(条件,值<span class="number">1</span>,翻译值<span class="number">1</span>,值<span class="number">2</span>,翻译值<span class="number">2</span>,...值n,翻译值n,缺省值)</span><br></pre></td></tr></table></figure>
<ul>
<li>作用：根据条件返回相应值</li>
<li>参数：c1, c2, …,cn,字符型/数值型/日期型，必须类型相同或 <code>null</code></li>
<li>注：值1……n 不能为条件表达式，这种情况只能用<code>case when then end</code>解决</li>
</ul>
<h5 id="5-3-7-4-示例"><a href="#5-3-7-4-示例" class="headerlink" title="5.3.7.4. 示例"></a>5.3.7.4. 示例</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 条件表达式</span></span><br><span class="line"><span class="keyword">select</span> ename,deptno <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 使用DECODE 函数</span></span><br><span class="line"><span class="keyword">select</span> ename,deptno,</span><br><span class="line">       decode(deptno,<span class="number">10</span>,<span class="string">&#x27;开发部&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;销售部&#x27;</span>,<span class="number">30</span>,<span class="string">&#x27;运维部&#x27;</span>,<span class="string">&#x27;大Boss&#x27;</span>)</span><br><span class="line">       <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 使用CASE 表达式</span></span><br><span class="line"><span class="keyword">select</span> ename,deptno,</span><br><span class="line">       <span class="keyword">case</span> deptno</span><br><span class="line">         <span class="keyword">when</span> <span class="number">10</span> <span class="keyword">then</span> <span class="string">&#x27;开发部&#x27;</span></span><br><span class="line">         <span class="keyword">when</span> <span class="number">20</span> <span class="keyword">then</span> <span class="string">&#x27;销售部&#x27;</span></span><br><span class="line">         <span class="keyword">when</span> <span class="number">30</span> <span class="keyword">then</span> <span class="string">&#x27;运维部&#x27;</span></span><br><span class="line">         <span class="keyword">else</span> <span class="string">&#x27;大Boss&#x27;</span></span><br><span class="line">       <span class="keyword">end</span></span><br><span class="line">       <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<h3 id="5-4-多行函数"><a href="#5-4-多行函数" class="headerlink" title="5.4. 多行函数"></a>5.4. 多行函数</h3><h4 id="5-4-1-多行函数的定义"><a href="#5-4-1-多行函数的定义" class="headerlink" title="5.4.1. 多行函数的定义"></a>5.4.1. 多行函数的定义</h4><p>也叫组函数、分组函数，即聚合查询。分组函数作用于一组数据，并对一组数据返回一个值。</p>
<font color=red>在where条件中不能写聚合函数，只能写在having中</font>

<font color=red>组函数会忽略空值；`NVL` 函数使分组函数无法忽略空值</font>

<h4 id="5-4-2-常用的多行函数"><a href="#5-4-2-常用的多行函数" class="headerlink" title="5.4.2. 常用的多行函数"></a>5.4.2. 常用的多行函数</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">函数名称</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>avg</code></td>
<td>查询平均值</td>
</tr>
<tr>
<td style="text-align:center"><code>count</code></td>
<td>统计记录数</td>
</tr>
<tr>
<td style="text-align:center"><code>max</code></td>
<td>最大值查询</td>
</tr>
<tr>
<td style="text-align:center"><code>min</code></td>
<td>最小值查询</td>
</tr>
<tr>
<td style="text-align:center"><code>sum</code></td>
<td>求和函数</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<font color=red>**注：所有的聚合函数都不统计`null`值**</font>

</blockquote>
<p><code>count(字段)</code> 是根据字段统计所有行，如果字段为 <code>null</code>，不进行统计</p>
<font color=red>**`count(1)` 与 `count(*)` 效果完全一样，但 `count(1)` 效率更高。`count(1)` 就是将所有行都看成“1”，不行的数据，所以查询效率更高**</font>

<h4 id="5-4-3-分组数据"><a href="#5-4-3-分组数据" class="headerlink" title="5.4.3. 分组数据"></a>5.4.3. 分组数据</h4><p>可以使用 <code>group by</code> 子句将表中的数据分成若干组。语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span><span class="operator">|</span>&#123;[<span class="keyword">distinct</span> <span class="keyword">column</span><span class="operator">|</span>expression [aliad],……]&#125;</span><br><span class="line">	<span class="keyword">from</span> <span class="keyword">table</span></span><br><span class="line">	[<span class="keyword">where</span> <span class="keyword">condition</span>(s)]</span><br><span class="line">	[<span class="keyword">group</span> <span class="keyword">by</span> group_by_expression]</span><br><span class="line">	[<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">column</span>]</span><br></pre></td></tr></table></figure>
<blockquote>
<font color=red>**注意：如果两个表关联使用分组查询，`group by` 后面的跟的条件是两个表的分组条件的列名。**</font>

</blockquote>
<h4 id="5-4-4-过滤分组数据"><a href="#5-4-4-过滤分组数据" class="headerlink" title="5.4.4. 过滤分组数据"></a>5.4.4. 过滤分组数据</h4><p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415751.png" alt=""></p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415752.png" alt=""></p>
<p>报了一个 ORA-00937 的错误</p>
<blockquote>
<p>注意：</p>
<ol>
<li>如果使用分组函数，SQL 只可以把 <code>GOURP BY</code> 分组条件字段和分组函数查询出来，不能有其他字段。</li>
<li>如果使用分组函数，不使用 <code>GROUP BY</code> 只可以查询出来分组函数的值</li>
</ol>
</blockquote>
<h4 id="5-4-5-WHERE-和-HAVING-的区别"><a href="#5-4-5-WHERE-和-HAVING-的区别" class="headerlink" title="5.4.5. WHERE 和 HAVING 的区别"></a>5.4.5. WHERE 和 HAVING 的区别</h4><font color=red>**最大区别在于：`where` 后面不能有聚合函数**</font>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 计算所有员工数</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 把所有员工的工资加起来</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(sal) <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算部门的平均工资</span></span><br><span class="line"><span class="keyword">select</span> round(<span class="built_in">avg</span>(sal),<span class="number">2</span>),decode(deptno,<span class="number">10</span>,<span class="string">&#x27;开发部&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;销售部&#x27;</span>,<span class="number">30</span>,<span class="string">&#x27;运维部&#x27;</span>,<span class="string">&#x27;大Boss&#x27;</span>)</span><br><span class="line">       <span class="keyword">from</span> emp</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算部门的平均工资大于2000</span></span><br><span class="line"><span class="keyword">select</span> round(<span class="built_in">avg</span>(sal)),decode(deptno,<span class="number">10</span>,<span class="string">&#x27;开发部&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;销售部&#x27;</span>,<span class="number">30</span>,<span class="string">&#x27;运维部&#x27;</span>,<span class="string">&#x27;大Boss&#x27;</span>)</span><br><span class="line">       <span class="keyword">from</span> emp</span><br><span class="line">       <span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line">       <span class="keyword">having</span> <span class="built_in">avg</span>(sal) <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br></pre></td></tr></table></figure>
<h2 id="6-使用-DDL-语句管理表"><a href="#6-使用-DDL-语句管理表" class="headerlink" title="6. 使用 DDL 语句管理表"></a>6. 使用 DDL 语句管理表</h2><h3 id="6-1-创建表空间"><a href="#6-1-创建表空间" class="headerlink" title="6.1. 创建表空间"></a>6.1. 创建表空间</h3><font color=red>表空间：ORACLE 数据库的逻辑单元，oracle面向的是表空间。</font>

<ul>
<li>一个实例（数据库）对应多个表空间</li>
<li>一个表空间可以与多个数据文件（物理结构）关联一个数据库下可以建立多个表空间</li>
<li>一个表空间可以建立多个用户、一个用户下可以建立多个表。</li>
</ul>
<font color=red>*我们(用户)操作表空间，真正存储数据，存到.dbf文件*</font>

<blockquote>
<font color=red>**注：创建表空间需要dba权限，创建表空间的语法顺序不能调换**</font>

</blockquote>
<p>创建表空间语法与相关参数：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>create tablespace 表空间名称</code></td>
<td>创建表空间</td>
</tr>
<tr>
<td style="text-align:center"><code>datafile</code></td>
<td>指定表空间对应的存储位置和数据文件</td>
</tr>
<tr>
<td style="text-align:center"><code>size</code></td>
<td>后定义的是表空间的初始大小</td>
</tr>
<tr>
<td style="text-align:center"><code>autoextend on</code></td>
<td>开启自动扩展，当表空间存储都占满时，自动扩展</td>
</tr>
<tr>
<td style="text-align:center"><code>next</code></td>
<td>指定的是下一次扩展的文件大小</td>
</tr>
</tbody>
</table>
</div>
<p>创建表空间示例:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表空间</span></span><br><span class="line"><span class="keyword">create</span> tablespace moonzero</span><br><span class="line">datafile <span class="string">&#x27;c:\test.dbf&#x27;</span></span><br><span class="line">size <span class="number">100</span>m</span><br><span class="line">autoextend <span class="keyword">on</span></span><br><span class="line">next <span class="number">10</span>m</span><br></pre></td></tr></table></figure>
<h3 id="6-2-用户"><a href="#6-2-用户" class="headerlink" title="6.2. 用户"></a>6.2. 用户</h3><h4 id="6-2-1-创建用户"><a href="#6-2-1-创建用户" class="headerlink" title="6.2.1. 创建用户"></a>6.2.1. 创建用户</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建用户</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> moon</span><br><span class="line">identified <span class="keyword">by</span> moon</span><br><span class="line"><span class="keyword">default</span> tablespace moonzero</span><br></pre></td></tr></table></figure>
<p>相关参数：</p>
<ul>
<li><code>create user</code>：创建用户</li>
<li><code>identified by</code>：设置用户的密码，不能是纯数字，经过测试，<em>如果想使用纯数字，必须使用双引号，如：”123456”</em></li>
<li><code>default tablespace</code>：用户管理（使用）的表空间名称</li>
</ul>
<p>oracle 数据库与其它数据库产品的区别在于，表和其它的数据库对象都是存储在用户下的</p>
<h4 id="6-2-2-用户赋权限"><a href="#6-2-2-用户赋权限" class="headerlink" title="6.2.2. 用户赋权限"></a>6.2.2. 用户赋权限</h4><p>新创建的用户没有任何权限，登陆后会提示没有权限，需要进行授权。</p>
<p>Oracle 中已存在三个重要的角色：connect 角色，resource 角色，dba 角色。</p>
<ul>
<li>CONNECT 角色： —是授予最终用户的典型权利，最基本的<ul>
<li>ALTER SESSION —修改会话</li>
<li>CREATE CLUSTER —建立聚簇</li>
<li>CREATE DATABASE LINK —建立数据库链接</li>
<li>CREATE SEQUENCE —建立序列</li>
<li>CREATE SESSION —建立会话</li>
<li>CREATE SYNONYM —建立同义词</li>
<li>CREATE VIEW —建立视图</li>
</ul>
</li>
<li>RESOURCE 角色： —是授予开发人员的<ul>
<li>CREATE CLUSTER —建立聚簇</li>
<li>CREATE PROCEDURE —建立过程</li>
<li>CREATE SEQUENCE —建立序列</li>
<li>CREATE TABLE —建表</li>
<li>CREATE TRIGGER —建立触发器</li>
<li>CREATE TYPE —建立类型</li>
</ul>
</li>
<li>DBA 角色：拥有全部特权，是系统最高权限，只有 DBA 才可以创建数据库结构，并且系统权限也需要 DBA 授出，且 DBA 用户可以操作全体用户的任意基表，包括删除</li>
</ul>
<p>进入 system 用户下给用户赋予权限（connect，resource，dba），否则无法正常登陆</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> dba <span class="keyword">to</span> 用户名</span><br></pre></td></tr></table></figure>
<h4 id="6-2-3-回收权限"><a href="#6-2-3-回收权限" class="headerlink" title="6.2.3. 回收权限"></a>6.2.3. 回收权限</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">revoke</span> <span class="keyword">connect</span>,resource <span class="keyword">from</span> 用户名;</span><br></pre></td></tr></table></figure>
<p>多个权限，使用“<code>,</code>”分隔</p>
<h3 id="6-3-Oracle-数据类型"><a href="#6-3-Oracle-数据类型" class="headerlink" title="6.3. Oracle 数据类型"></a>6.3. Oracle 数据类型</h3><h4 id="6-3-1-字符串"><a href="#6-3-1-字符串" class="headerlink" title="6.3.1. 字符串"></a>6.3.1. 字符串</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>char(size)</code></td>
<td>定长的字符串数据；<br/>例：<code>name char(10)</code>: 存储’xxxx’,实际占用10个字符，不够10个使用空格补全</td>
</tr>
<tr>
<td style="text-align:center"><code>varchar2(size)</code></td>
<td>可变长的字符串数据，最大长度是4000字节；<br/>例：<code>name varchar2(10)</code>: 存储’xxxx’，实际占用4个字符</td>
</tr>
<tr>
<td style="text-align:center"><code>long</code></td>
<td>存储字符串数据，最大为2G</td>
</tr>
</tbody>
</table>
</div>
<h4 id="6-3-2-数字"><a href="#6-3-2-数字" class="headerlink" title="6.3.2. 数字"></a>6.3.2. 数字</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>number(p1,p2)</code></td>
<td>标识数字类型，可变长数值数据<br/>参数p1：指定数字的总长度（注：总长度包括小数位）<br/>参数p2：指定几位小数</td>
</tr>
</tbody>
</table>
</div>
<h4 id="6-3-3-日期"><a href="#6-3-3-日期" class="headerlink" title="6.3.3. 日期"></a>6.3.3. 日期</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>date</code></td>
<td>日期类型数据，区分到时分秒，类似mysql的<code>datatime</code></td>
</tr>
<tr>
<td style="text-align:center"><code>timestamp</code></td>
<td>时间撮，区分到秒的后9位</td>
</tr>
</tbody>
</table>
</div>
<h4 id="6-3-4-大数据类型"><a href="#6-3-4-大数据类型" class="headerlink" title="6.3.4. 大数据类型"></a>6.3.4. 大数据类型</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>clob</code></td>
<td>存储字符数据，最大可达到4G</td>
</tr>
<tr>
<td style="text-align:center"><code>blob</code></td>
<td>存储二进制数据，最大可达到4G</td>
</tr>
</tbody>
</table>
</div>
<h4 id="6-3-5-其它类型"><a href="#6-3-5-其它类型" class="headerlink" title="6.3.5. 其它类型"></a>6.3.5. 其它类型</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>raw and long raw</code></td>
<td>原始的二进制数据</td>
</tr>
<tr>
<td style="text-align:center"><code>bfile</code></td>
<td>存储外部文件的二进制数据，最大可达到4G</td>
</tr>
<tr>
<td style="text-align:center"><code>rowid</code></td>
<td>行地址</td>
</tr>
</tbody>
</table>
</div>
<h3 id="6-4-uuid-生成值"><a href="#6-4-uuid-生成值" class="headerlink" title="6.4. uuid 生成值"></a>6.4. uuid 生成值</h3><p><code>sys_guid()</code> 函数，用于生成不同的uuid</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sys_guid() <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<h3 id="6-5-创建表"><a href="#6-5-创建表" class="headerlink" title="6.5. 创建表"></a>6.5. 创建表</h3><p>创建表语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> [schema.]<span class="keyword">table</span></span><br><span class="line">		(<span class="keyword">column</span> datatype [<span class="keyword">default</span> expr][,…]);</span><br></pre></td></tr></table></figure>
<p>使用子查询创建表的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create TABLE</span> <span class="keyword">table</span></span><br><span class="line">		[(<span class="keyword">column</span>, <span class="keyword">column</span>,……)]</span><br><span class="line"><span class="keyword">as</span> subquery;</span><br></pre></td></tr></table></figure>
<p>示例:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表</span></span><br><span class="line"><span class="keyword">create table</span> person(</span><br><span class="line">       pid number(<span class="number">10</span>),</span><br><span class="line">       name varchar2(<span class="number">10</span>),</span><br><span class="line">       gender number(<span class="number">1</span>) <span class="keyword">default</span> <span class="number">1</span>,</span><br><span class="line">       birthday <span class="type">date</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 插入数据，插入数据后，记得要点击提交</span></span><br><span class="line"><span class="keyword">insert into</span> person <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;剑圣&#x27;</span>,<span class="number">1</span>,to_date(<span class="string">&#x27;2018-2-2&#x27;</span>, <span class="string">&#x27;yyyy-mm-dd&#x27;</span>));</span><br></pre></td></tr></table></figure>
<h3 id="6-6-修改表"><a href="#6-6-修改表" class="headerlink" title="6.6. 修改表"></a>6.6. 修改表</h3><p>在 sql 中使用 <code>alter</code> 可以修改表</p>
<ul>
<li>添加语法：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> 表名称 <span class="keyword">ADD</span>(列名 <span class="number">1</span> 类型 [<span class="keyword">DEFAULT</span> 默认值]，列名 <span class="number">1</span> 类型 [<span class="keyword">DEFAULT</span> 默认值]...)</span><br></pre></td></tr></table></figure>
<ul>
<li>修改语法：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> 表名称 MODIFY(列名 <span class="number">1</span> 类型 [<span class="keyword">DEFAULT</span> 默认值]，列名 <span class="number">1</span> 类型 [<span class="keyword">DEFAULT</span> 默认值]...)</span><br></pre></td></tr></table></figure>
<ul>
<li>修改列名语法:</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> 表名称 RENAME <span class="keyword">COLUMN</span> 列名 <span class="number">1</span> <span class="keyword">TO</span> 列名 <span class="number">2</span></span><br></pre></td></tr></table></figure>
<ul>
<li>删除列语法：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名称 <span class="keyword">drop</span> <span class="keyword">column</span> 列名</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在 person 表中增加列 address</span></span><br><span class="line"><span class="keyword">alter table</span> person <span class="keyword">add</span>(address varchar2(<span class="number">10</span>));</span><br><span class="line"><span class="comment">-- 把 person 表的 address 列的长度修改成 20 长度</span></span><br><span class="line"><span class="keyword">alter table</span> person modify(address varchar2(<span class="number">20</span>));</span><br><span class="line"><span class="comment">-- 修改列名</span></span><br><span class="line"><span class="keyword">alter table</span> person rename <span class="keyword">column</span> ddd <span class="keyword">to</span> address;</span><br></pre></td></tr></table></figure>
<h3 id="6-7-删除表"><a href="#6-7-删除表" class="headerlink" title="6.7. 删除表"></a>6.7. 删除表</h3><p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> 表名;</span><br></pre></td></tr></table></figure>
<h3 id="6-8-复制整个表"><a href="#6-8-复制整个表" class="headerlink" title="6.8. 复制整个表"></a>6.8. 复制整个表</h3><p>使用子查询可以复制整个表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> 新表名 <span class="keyword">as</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 要复制的表名);</span><br></pre></td></tr></table></figure>
<h3 id="6-9-约束"><a href="#6-9-约束" class="headerlink" title="6.9. 约束"></a>6.9. 约束</h3><p>在数据库开发中，约束是必不可少，使用约束可以更好的保证数据的完整性。在 Oracle 数据库中。约束的类型包括：</p>
<ul>
<li>主键约束（Primary Key）</li>
<li>非空约束（Not Null）</li>
<li>唯一约束（Unique）</li>
<li>外键约束（Foreign Key）</li>
<li>检查性约束（Check）</li>
</ul>
<h4 id="6-9-1-主键约束"><a href="#6-9-1-主键约束" class="headerlink" title="6.9.1. 主键约束"></a>6.9.1. 主键约束</h4><p>主键约束都是在 id 上使用，而且本身已经默认了内容不能为空，可以在建表的时候指定。关键字：<code>primary key</code></p>
<p>指定主键约束的名字的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constraint</span> person_pk_pid <span class="keyword">primary key</span>(pid)</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> person(</span><br><span class="line">       pid number(<span class="number">10</span>),</span><br><span class="line">       name varchar2(<span class="number">10</span>),</span><br><span class="line">       gender number(<span class="number">1</span>) <span class="keyword">default</span> <span class="number">1</span>,</span><br><span class="line">       birthday <span class="type">date</span>,</span><br><span class="line">       <span class="keyword">constraint</span> person_pk_pid <span class="keyword">primary key</span>(pid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="6-9-2-非空约束"><a href="#6-9-2-非空约束" class="headerlink" title="6.9.2. 非空约束"></a>6.9.2. 非空约束</h4><p>使用非空约束，可以使指定的字段不可以为空。</p>
<p>关键字：<code>not null</code></p>
<h4 id="6-9-3-唯一约束（unique）"><a href="#6-9-3-唯一约束（unique）" class="headerlink" title="6.9.3. 唯一约束（unique）"></a>6.9.3. 唯一约束（unique）</h4><p>表中的一个字段的内容是唯一的。关键字：<code>unique</code></p>
<p>唯一约束的名字也可以自定义</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constraint</span> person_name_uk <span class="keyword">unique</span>(name)</span><br></pre></td></tr></table></figure>
<h4 id="6-9-4-检查约束"><a href="#6-9-4-检查约束" class="headerlink" title="6.9.4. 检查约束"></a>6.9.4. 检查约束</h4><p>使用检查约束可以来约束字段值的合法范围。关键字：<code>check(列名 in(值1,值2,...))</code></p>
<p>检查约束也可以自定义</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constraint</span> person_gender_ck <span class="keyword">check</span>(gender <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<h4 id="6-9-5-外键约束"><a href="#6-9-5-外键约束" class="headerlink" title="6.9.5. 外键约束"></a>6.9.5. 外键约束</h4><p>外键是两张表的约束，可以保证关联数据的完整性</p>
<p>外键关联注意：</p>
<ul>
<li>外键一定是主表的主键，外键的位置在从表中</li>
<li><font color=red>删表时一定先删子表再删主表</font>，如果直接删主表会出现由于约束存在无法删除的问题</li>
<li>可以强制删除主表 <code>drop table 主表名 cascade constraint;</code>【不建议使用】</li>
<li>删除主表的数据可以先删除子表的关联数据，再删主表，也可以使用级联删除</li>
<li>级联删除在外键约束上要加上 <code>on delete cascade</code>【不建议使用】</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constraint</span> order_detail_order_id_fk <span class="keyword">foreign key</span>(order_id)</span><br><span class="line">	<span class="keyword">references</span> orders(order_id) <span class="keyword">on</span> <span class="keyword">delete</span> cascade</span><br></pre></td></tr></table></figure>
<h2 id="7-使用-DML-语句处理数据"><a href="#7-使用-DML-语句处理数据" class="headerlink" title="7. 使用 DML 语句处理数据"></a>7. 使用 DML 语句处理数据</h2><h3 id="7-1-插入数据"><a href="#7-1-插入数据" class="headerlink" title="7.1. 插入数据"></a>7.1. 插入数据</h3><p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名[(列名 <span class="number">1</span>，列名 <span class="number">2</span>，...)] <span class="keyword">values</span> (值 <span class="number">1</span>，值 <span class="number">2</span>，...)</span><br></pre></td></tr></table></figure>
<p><strong>简单写法（不建议）</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名 <span class="keyword">values</span>(值 <span class="number">1</span>，值 <span class="number">2</span>，...)</span><br></pre></td></tr></table></figure>
<p>注意：使用简单的写法必须按照表中的字段的顺序来插入值，而且如果有为空的字段使用 null</p>
<h3 id="7-2-更新数据"><a href="#7-2-更新数据" class="headerlink" title="7.2. 更新数据"></a>7.2. 更新数据</h3><p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 全部修改：</span></span><br><span class="line"><span class="keyword">UPDATE</span> 表名 <span class="keyword">SET</span> 列名 <span class="number">1</span><span class="operator">=</span>值 <span class="number">1</span>，列名 <span class="number">2</span><span class="operator">=</span>值 <span class="number">2</span>，....</span><br><span class="line"><span class="comment">-- 局部修改：</span></span><br><span class="line"><span class="keyword">UPDATE</span> 表名 <span class="keyword">SET</span> 列名 <span class="number">1</span><span class="operator">=</span>值 <span class="number">1</span>，列名 <span class="number">2</span><span class="operator">=</span>值 <span class="number">2</span>，....<span class="keyword">WHERE</span> 修改条件；</span><br></pre></td></tr></table></figure>
<p>Code Dome:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在 update 中使用子查询：</span></span><br><span class="line"><span class="comment">-- 例如：给 NEW YORK 地区的所有员工涨 100 员工资</span></span><br><span class="line"><span class="keyword">update</span> emp <span class="keyword">set</span> sal<span class="operator">=</span>sal<span class="operator">+</span><span class="number">100</span></span><br><span class="line">       <span class="keyword">where</span> deptno <span class="keyword">in</span> (</span><br><span class="line">             <span class="keyword">select</span> deptno <span class="keyword">from</span> dept <span class="keyword">where</span> loc<span class="operator">=</span><span class="string">&#x27;NEW YORK&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="7-3-ORACLE-如果数据存在则执行更新，不存在则执行插入的方法"><a href="#7-3-ORACLE-如果数据存在则执行更新，不存在则执行插入的方法" class="headerlink" title="7.3. ORACLE 如果数据存在则执行更新，不存在则执行插入的方法"></a>7.3. ORACLE 如果数据存在则执行更新，不存在则执行插入的方法</h3><p>MERGE语句是Oracle9i新增的语法，用来合并 <code>UPDATE</code> 和 <code>INSERT</code> 语句。通过MERGE语句，根据一张表或子查询的连接条件对另外一张表进行查询，连接条件匹配上的进行 <code>UPDATE</code>，无法匹配的执行<code>INSERT</code>。</p>
<p>这个语法仅需要一次全表扫描就完成了全部工作，执行效率要高于 <code>INSERT＋UPDATE</code>。</p>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">MERGE</span> <span class="operator">&lt;</span>hint<span class="operator">&gt;</span> <span class="keyword">INTO</span> <span class="operator">&lt;</span>table_name<span class="operator">&gt;</span> <span class="comment">-- 表名称</span></span><br><span class="line"><span class="keyword">USING</span> <span class="operator">&lt;</span>table_view_or_query<span class="operator">&gt;</span> <span class="comment">-- 表查询信息</span></span><br><span class="line"><span class="keyword">ON</span> (<span class="operator">&lt;</span><span class="keyword">condition</span><span class="operator">&gt;</span>) <span class="comment">-- 条件</span></span><br><span class="line"><span class="keyword">WHEN</span> MATCHED <span class="keyword">THEN</span> <span class="operator">&lt;</span>update_clause<span class="operator">&gt;</span> <span class="comment">-- 更新操作</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="operator">&lt;</span>where_clause<span class="operator">&gt;</span> <span class="comment">-- 删除操作</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="keyword">NOT</span> MATCHED <span class="keyword">THEN</span> <span class="operator">&lt;</span>insert_clause<span class="operator">&gt;</span> <span class="comment">-- 插入操作</span></span><br><span class="line">[LOG ERRORS <span class="operator">&lt;</span>log_errors_clause<span class="operator">&gt;</span> <span class="operator">&lt;</span>reject limit <span class="operator">&lt;</span><span class="type">integer</span> <span class="operator">|</span> unlimited<span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 例子1：</span></span><br><span class="line"><span class="keyword">MERGE</span> <span class="keyword">INTO</span> USERINFO a</span><br><span class="line"><span class="keyword">USING</span> (</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">as</span> UNAME</span><br><span class="line">  <span class="keyword">FROM</span> dual</span><br><span class="line">  ) b</span><br><span class="line"><span class="keyword">ON</span> (a.UNAME <span class="operator">=</span> b.UNAME)</span><br><span class="line"><span class="keyword">WHEN</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">  <span class="keyword">UPDATE</span> <span class="keyword">SET</span> a.ADDR <span class="operator">=</span> <span class="string">&#x27;ddd&#x27;</span>, a.UTC <span class="operator">=</span> <span class="number">1234567</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="keyword">NOT</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">  <span class="keyword">INSERT</span> (a.ADDR, a.UTC, a.UNAME) <span class="keyword">VALUES</span> (<span class="string">&#x27;aaa&#x27;</span>, <span class="number">7654321</span>, <span class="string">&#x27;1&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 例子2：</span></span><br><span class="line"><span class="keyword">MERGE</span> <span class="keyword">INTO</span> T T1</span><br><span class="line"><span class="keyword">USING</span> (<span class="keyword">SELECT</span> <span class="string">&#x27;1001&#x27;</span> <span class="keyword">AS</span> a,<span class="number">2</span> <span class="keyword">AS</span> b <span class="keyword">FROM</span> dual) T2</span><br><span class="line"><span class="keyword">ON</span> ( T1.a<span class="operator">=</span>T2.a)</span><br><span class="line"><span class="keyword">WHEN</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">UPDATE</span> <span class="keyword">SET</span> T1.b <span class="operator">=</span> T2.b</span><br><span class="line"><span class="keyword">WHEN</span> <span class="keyword">NOT</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">INSERT</span> (a,b) <span class="keyword">VALUES</span>(T2.a,T2.b);</span><br></pre></td></tr></table></figure>
<h3 id="7-4-删除数据"><a href="#7-4-删除数据" class="headerlink" title="7.4. 删除数据"></a>7.4. 删除数据</h3><p>语法:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> 表名 <span class="keyword">where</span> 删除条件;</span><br></pre></td></tr></table></figure>
<p>在删除语句中如果不指定删除条件的话就会删除所有的数据</p>
<font color=red>***truncate table 实现数据删除，摧毁表结构，再重建，效率最高。*</font>

<p><strong>比较 <code>truncat</code> 与 <code>delete</code> 实现数据删除</strong></p>
<ul>
<li><code>delete</code> 删除的数据可以 <code>rollback</code>，也可以闪回</li>
<li><code>delete</code> 删除可能产生碎片，并且不释放空间</li>
<li><code>truncate</code> 是先摧毁表结构，再重构表结构</li>
</ul>
<font color=red>**注意：插入、更新和删除会引起数据的变化。我们就必须考虑数据的完整性。**</font>

<h3 id="7-5-Oracle-中的事务"><a href="#7-5-Oracle-中的事务" class="headerlink" title="7.5. Oracle 中的事务"></a>7.5. Oracle 中的事务</h3><p>oracle 的事务对数据库的变更的处理，必须做提交事务才能让数据真正的插入到数据库中，在同样在执行完数据库变更的操作后还可以把事务进行回滚，这样就不会插入到数据库。如果事务提交后则不可以再回滚。</p>
<ul>
<li>提交：<code>commit</code></li>
<li>回滚：<code>rollback to 保存点</code></li>
</ul>
<p>Oracle 中事务的保存点（<code>savepoint</code>）：回滚到某个保存点，这个保存点之前的数据插入，之后回滚。</p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415753.png" alt=""></p>
<p>事务的隔离级别和隔离性：</p>
<ul>
<li>Oracle 支持的 3 种事务隔离级别：<code>READ COMMITED</code>, <code>SERIALIZABLE</code>，<code>READ ONLY</code>。</li>
<li>Oracle 默认的事务隔离级别为: <code>READ COMMITED</code>。</li>
</ul>
<p>Oracle事务示例:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 事务保存点：savepoint</span></span><br><span class="line"><span class="comment">-- savepoint sp1;</span></span><br><span class="line"><span class="keyword">insert into</span> person <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;幽鬼&#x27;</span>,<span class="number">2</span>,<span class="keyword">null</span>,<span class="string">&#x27;dota2&#x27;</span>);</span><br><span class="line"><span class="comment">-- 设置保存点,保存点之前提交，保存点之后的回滚</span></span><br><span class="line"><span class="keyword">savepoint</span> sp1;</span><br><span class="line"><span class="keyword">insert into</span> person <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;插入不进去的&#x27;</span>,<span class="number">3</span>,<span class="keyword">null</span>,<span class="string">&#x27;xxoo&#x27;</span>);</span><br><span class="line"><span class="keyword">rollback</span> <span class="keyword">to</span> sp1;</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>
<h2 id="8-管理其他数据库对象"><a href="#8-管理其他数据库对象" class="headerlink" title="8. 管理其他数据库对象"></a>8. 管理其他数据库对象</h2><h3 id="8-1-视图"><a href="#8-1-视图" class="headerlink" title="8.1. 视图"></a>8.1. 视图</h3><p>视图，专门用于查询，里面不存储数据，数据都来源于真正的表。</p>
<font color=red>**注：创建视图需要dba权限**</font>

<p>视图的好处：</p>
<ol>
<li><font color=red><strong>视图就是封装了一条复杂查询的语句</strong></font>。视图是一个虚表。最大的优点就是简化复杂的查询。</li>
<li>用视图可以屏蔽一些敏感数据。</li>
</ol>
<h4 id="8-1-1-创建视图的语法1"><a href="#8-1-1-创建视图的语法1" class="headerlink" title="8.1.1. 创建视图的语法1"></a>8.1.1. 创建视图的语法1</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [<span class="keyword">or</span> replace] [force<span class="operator">|</span>noforce] <span class="keyword">view</span>视图名称</span><br><span class="line">	[(alias[, alias]...)]</span><br><span class="line"><span class="keyword">as</span> 查询语句</span><br><span class="line">[<span class="keyword">with</span> <span class="keyword">check</span> option [<span class="keyword">constraint</span> <span class="keyword">constraint</span>]]</span><br><span class="line">[<span class="keyword">with</span> read <span class="keyword">only</span> [<span class="keyword">constraint</span> <span class="keyword">constraint</span>]];</span><br></pre></td></tr></table></figure>
<p>创建视图示例:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建视图（权限不够，可以使用system开通全部特权，是系统最高权限）</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> empvd20 <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp t <span class="keyword">where</span> t.deptno<span class="operator">=</span><span class="number">20</span>;</span><br><span class="line"><span class="comment">-- 视图创建完毕就可以使用视图来查询（这个名字的虚表），查询出来的都是 20 部门的员工</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> empvd20;</span><br></pre></td></tr></table></figure>
<h4 id="8-1-2-创建视图的语法2"><a href="#8-1-2-创建视图的语法2" class="headerlink" title="8.1.2. 创建视图的语法2"></a>8.1.2. 创建视图的语法2</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> 视图名称 <span class="keyword">as</span> 查询语句</span><br></pre></td></tr></table></figure>
<p>使用语法2来创建视图，如果视图已经存在，这样已有的视图会被覆盖。</p>
<font color=red>*不建议通过视图对表中的数据进行修改，因为会受到很多的限制。*</font>

<h4 id="8-1-3-创建视图的语法3"><a href="#8-1-3-创建视图的语法3" class="headerlink" title="8.1.3. 创建视图的语法3"></a>8.1.3. 创建视图的语法3</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> 视图名称 <span class="keyword">as</span> 查询语句 <span class="keyword">with</span> read <span class="keyword">only</span></span><br></pre></td></tr></table></figure>
<p>创建只读视图</p>
<h3 id="8-2-序列【了解】"><a href="#8-2-序列【了解】" class="headerlink" title="8.2. 序列【了解】"></a>8.2. 序列【了解】</h3><p>在很多数据库中都存在一个自动增长的列，如果现在要想在oracle中完成自动增长的功能，则只能依靠序列完成，所有的自动增长操作，需要用户手工完成处理。并且Oracle将序列值装入内存可以提高访问效率</p>
<p>完整语法【了解】：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> sequence sequence(序列名称)</span><br><span class="line">		[increment <span class="keyword">by</span> n]		<span class="comment">-- 步长值，每次增加的数值</span></span><br><span class="line">		[<span class="keyword">start</span> <span class="keyword">with</span> n]		<span class="comment">-- 初始值</span></span><br><span class="line">		[&#123;maxvalue n <span class="operator">|</span> nomaxvalue&#125;]		<span class="comment">-- 使用最大值，必须循环</span></span><br><span class="line">		[&#123;minvalue n <span class="operator">|</span> nominvalue&#125;]</span><br><span class="line">		[&#123;cache n <span class="operator">|</span> nocache&#125;]		<span class="comment">-- 缓存n个值，默认值20</span></span><br><span class="line">		[&#123;<span class="keyword">cycle</span> <span class="operator">|</span> nocycle&#125;];		<span class="comment">-- 循环，循环结束都从1开始</span></span><br></pre></td></tr></table></figure>
<p>序列创建完成之后,所有的自动增长应该由用户自己处理,所以在序列中提供了以下的两种操作：</p>
<ul>
<li><code>nextval</code>：取得序列的下一个内容</li>
<li><code>currval</code>：取得序列的当前内容</li>
</ul>
<p><strong>创建序列: 在插入数据时需要自增的主键中可以这样使用</strong></p>
<p><img src="https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415754.png" alt=""></p>
<p><strong>序列可能产生裂缝的原因(中间跳过了数字)</strong>：</p>
<ul>
<li>回滚</li>
<li>系统异常</li>
<li>多个表共用一个序列</li>
</ul>
<h3 id="8-3-索引"><a href="#8-3-索引" class="headerlink" title="8.3. 索引"></a>8.3. 索引</h3><font color=red>**索引是用于加速数据存取的数据对象，提高检索数据效率**</font>。合理的使用索引可以大大降低 i/o 次数,从而提高数据访问性能。

#### 8.3.1. 单列索引

单列索引是基于单个列所建立的索引。语法：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index 索引名 <span class="keyword">on</span> 表名(列名)</span><br></pre></td></tr></table></figure>

#### 8.3.2. 复合索引

语法：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index 索引名 <span class="keyword">on</span> 表名(列名<span class="number">1</span>, 列名<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

复合索引是基于两个列或多个列的索引。在同一张表上可以有多个索引，但是要求列的组合必须不同，如：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx1 <span class="keyword">on</span> 表名(a列,b列);</span><br><span class="line"><span class="keyword">create</span> index idx1 <span class="keyword">on</span> 表名(b列,a列);</span><br></pre></td></tr></table></figure>

示例：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例：给 person 表的 name 建立索引</span></span><br><span class="line"><span class="keyword">create</span> index pname_index <span class="keyword">on</span> person(name);</span><br><span class="line"><span class="comment">-- 范例：给 person 表创建一个 name 和 gender 的索引</span></span><br><span class="line"><span class="keyword">create</span> index pname_gender_index <span class="keyword">on</span> person(name,gender);</span><br></pre></td></tr></table></figure>

#### 8.3.3. 索引使用原则

1. 在数据量大表中使用索引
2. 在经常使用字段上加索引
3. 触发复合索引【联合】条件（name,address）--必须有优先查询索引列

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> person <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;11&#x27;</span>;  会触发索引</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> person <span class="keyword">where</span> name <span class="operator">=</span><span class="string">&#x27;11&#x27;</span> <span class="keyword">and</span> address <span class="operator">=</span><span class="string">&#x27;22&#x27;</span>; 会触发</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> person <span class="keyword">where</span> name <span class="operator">=</span><span class="string">&#x27;11&#x27;</span> <span class="keyword">or</span> address <span class="operator">=</span><span class="string">&#x27;22&#x27;</span>; 不会触发</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> person <span class="keyword">where</span> address <span class="operator">=</span><span class="string">&#x27;22&#x27;</span>; 不会触发</span><br></pre></td></tr></table></figure>

4. 一般在不经常修改，添加，删除的表上添加索引。因为这些操作会引起索引重构

### 8.4. 同义词【了解】

同义词：给其他用户下的表起别名，在本用户下直接查询别名。属于跨库查询。

定义同义词需要dba权限。语法：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [public] synonym 同义词名称 <span class="keyword">for</span> 用户.表名;</span><br></pre></td></tr></table></figure>

示例：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> public synonym emp <span class="keyword">for</span> scott.emp;</span><br></pre></td></tr></table></figure>

**同义词作用**：

- 可以很方便的访问其它用户的数据库对象
- 缩短了对象名字的长度

## 9. 数据的导入导出

### 9.1. 使用 cmd 命令整库导出与导入

在安装了 oracle 的电脑上执行。**整库导出命令**：

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp system/密码 full=y</span><br></pre></td></tr></table></figure>

添加参数 `full=y` 表示整库导出。执行命令后会在当前目录下生成一个叫 `EXPDAT.DMP`，此文件为备份文件。

如果想指定备份文件的名称，则添加 `file` 参数即可，命令如下

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp system/密码 file=C:\文件名.dmp full=y</span><br></pre></td></tr></table></figure>

**整库导入命令**：

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp system/密码 full=y</span><br></pre></td></tr></table></figure>

此命令如果不指定 `file` 参数，则默认用备份文件 `EXPDAT.DMP` 进行导入

**如果指定 `file` 参数，则按照 `file` 指定的备份文件进行恢复**

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp system/密码 full=y file= C:\文件名.dmp</span><br></pre></td></tr></table></figure>

执行导入命令前需确保 oracle 数据库中无即将导入的对象，否则将报以下提示：

![](https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415755.png)

### 9.2. 使用 cmd 命令按用户导出与导入

**按用户导出**

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp 用户名/密码 owner=用户名 file= c:\文件名.dmp</span><br></pre></td></tr></table></figure>

**按用户导入**

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp 用户名/密码 file= c:\文件名.dmp fromuser=用户名1 touser=用户名2</span><br></pre></td></tr></table></figure>

### 9.3. 使用 cmd 命令按表导出与导入

**按表导出**

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp 用户名/密码 file=文件名.dmp tables=导入的表名</span><br></pre></td></tr></table></figure>

用 `tables` 参数指定需要导出的表，如果有多个表用逗号分割即可

**按表导入**

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp 用户名/密码 file=文件名.dmp fromuser=用户名1 touser=用户名2 tables=导入的表名</span><br></pre></td></tr></table></figure>

### 9.4. 使用 PLSQL Developer 导出数据

1. Tools → Export User Objects...选项，导出 .sql 文件。说明：此操作导出的是建表语句
2. Tools → Export Tables...导出表结构及数据

PL/SQL 工具包含三种方式导出 Oracle 表结构及数据，三种方式分别为：Oracle Export 、SQL Inserts、PL/SQL Developer,下面分别简单介绍下区别：

- 第一种方式导出.dmp 格式的文件，.dmp 是二进制文件，可跨平台，还能包含权限，效率不错，用的最为广泛。
- 第二种方式导出.sql 格式的文件，可用文本编辑器查看，通用性比较好，效率不如第一种，适合小数据量导入导出。尤其注意的是表中不能有大字段（blob,clob,long），如果有，会提示不能导出(提示如下： table contains one or more LONG columns cannot export in sql format,user Pl/sql developer format instead)。
- 第三种方式导出.pde 格式的文件，.pde 为 PL/SQL Developer 自有的文件格式，只能用 PL/SQL Developer 工具导入导出，不能用文本编辑器查看。

### 9.5. 使用 PLSQL Developer 导入数据

导入数据之前最好把以前的表删掉，当然导入另外的数据库数据除外

1. Tools → Import Tables...
2. 根据对应格式，在不同界面选择即将导入的文件。

![](https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415756.png)

![](https://gitee.com/Bluetom/img2/raw/master/img20240905/202410121415757.png)

## 10. PL/SQL 编程语言

### 10.1. PL/SQL 概述

PL/SQL（Procedure Language/SQL），PLSQL 是 Oracle 对 sql 语言的过程化扩展，指在 SQL 命令语言中增加了过程处理语句（如分支、循环等），使 SQL 语言具有过程处理能力。把 SQL 语言的数据操纵能力与过程语言的数据处理能力结合起来，使得 PLSQL 面向过程但比过程语言简单、高效、灵活和实用。

### 10.2. PL/SQL 的语法

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">	说明部分 (变量说明，光标申明，异常（例外）说明)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	语句序列 (DML语句)...</span><br><span class="line">	pl<span class="operator">/</span><span class="keyword">SQL</span>程序体</span><br><span class="line">exception</span><br><span class="line">	异常(例外)处理语句</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

注：

1. 如果不需要声明变量，`declare`可以省略
2. 变量不能在`begin`内定义，必须在`declare`里声明

### 10.3. 常量和变量的定义

变量的类型(char, varchar2, date, number, boolean, long)

|          说明变量例子          |                                      说明                                       |
| :--------------------------: | ------------------------------------------------------------------------------ |
|     `my_char char(15);`      | 说明变量名，数据类型和长度后用分号结束说明语句                                        |
| `my_boolean boolean :=true;` | 定义boolean类型的变量，并赋值(`:=`)                                                |
|   `my_number number(7,2);`   | 定义数字类型的变量                                                                |
|  `my_name emp.enmae%type;`   | 引用型变量，即my_name的类型与emp表中ename列类型一样<br/>**在sql中使用 `into` 来赋值** |
|    `emp_rec emp%rowtype;`    | 记录型变量，即为表格中的一条记录。类似一个对象<br/>**在sql中使用 `into` 来赋值**        |

> 注：在控制台输入的语法：在`declare`中定义变量时后写上【`:=&xx;`】，xx随便写，一般xx名字跟变量名一样

示例：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 引用变量</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 声明引用变量，即emprec的类型与emp表中ename列类型一样</span></span><br><span class="line">   emprec emp.ename<span class="operator">%</span>type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 在sql中使用into赋值</span></span><br><span class="line">  <span class="keyword">select</span> e.ename <span class="keyword">into</span> emprec <span class="keyword">from</span> emp e <span class="keyword">where</span> e.empno<span class="operator">=</span><span class="number">7369</span>;</span><br><span class="line">  <span class="comment">-- 输出引用变量</span></span><br><span class="line">  dbms_output.put_line(emprec);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 记录型变量</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 声明记录型变量</span></span><br><span class="line">   p emp<span class="operator">%</span>rowtype;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 对记录型变量赋值</span></span><br><span class="line">   <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> p <span class="keyword">from</span> emp e <span class="keyword">where</span> e.empno<span class="operator">=</span><span class="number">7369</span>;</span><br><span class="line">   <span class="comment">-- 输出记录型变量的属性值</span></span><br><span class="line">   dbms_output.put_line(p.ename <span class="operator">||</span> <span class="string">&#x27;===&#x27;</span> <span class="operator">||</span> p.sal);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

#### 10.3.1. 定义RECORD类型

与`%rowtype`不一样，`%rowtype`与表的字段类型一致，record是直接定义一个类型。语法：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">type xxx <span class="keyword">is</span> record(</span><br><span class="line">	x1 <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> <span class="type">varchar</span>,</span><br><span class="line">	x2 <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> number,</span><br><span class="line">	x3 表.字段名<span class="operator">%</span>type,</span><br><span class="line">	x4 表.字段名<span class="operator">%</span>type,</span><br><span class="line">	...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

### 10.4. if 分之语句

语法1：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if 条件 <span class="keyword">then</span> 语句<span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span> if;</span><br></pre></td></tr></table></figure>

语法2：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if 条件 <span class="keyword">then</span> 语句<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> 语句<span class="number">2</span>;</span><br><span class="line"><span class="keyword">end</span> if;</span><br></pre></td></tr></table></figure>

语法3：注意`elsif`中`els`没有`e`

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if 条件 <span class="keyword">then</span> 语句<span class="number">1</span>;</span><br><span class="line">elsif 条件 <span class="keyword">then</span> 语句<span class="number">2</span>;</span><br><span class="line"><span class="keyword">else</span> 语句<span class="number">3</span>;</span><br><span class="line"><span class="keyword">end</span> if;</span><br></pre></td></tr></table></figure>

三种if语句示例:

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例 1：如果从控制台输入 1 则输出我是 1</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 声明数字类型变量，&amp;num定义输入值，:=输入值后给pnum赋值</span></span><br><span class="line">   pnum number :<span class="operator">=</span><span class="operator">&amp;</span>num;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   if pnum <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;我是1&#x27;</span>);</span><br><span class="line">   <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 范例 2：如果从控制台输入 1 则输出我是 1 否则输出我不是 1</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 声明数字类型变量</span></span><br><span class="line">   pnum number :<span class="operator">=</span><span class="operator">&amp;</span>num;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   if pnum <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;我是1&#x27;</span>);</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">     dbms_output.put_line(<span class="string">&#x27;我不是1&#x27;</span>);</span><br><span class="line">   <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 范例 3:判断人的不同年龄段 18 岁以下是未成年人，18 岁以上 40 以下是成年人，40 以上是老年人</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 声明数字类型变量</span></span><br><span class="line">   page number :<span class="operator">=</span><span class="operator">&amp;</span>num;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 使用多重if判断</span></span><br><span class="line">   if page<span class="operator">&lt;</span><span class="number">18</span> <span class="keyword">then</span></span><br><span class="line">     dbms_output.put_line(<span class="string">&#x27;未成年人&#x27;</span>);</span><br><span class="line">   elsif page<span class="operator">&gt;=</span><span class="number">18</span> <span class="keyword">and</span> page<span class="operator">&lt;</span><span class="number">40</span> <span class="keyword">then</span></span><br><span class="line">     dbms_output.put_line(<span class="string">&#x27;成年人&#x27;</span>);</span><br><span class="line">   elsif page<span class="operator">&gt;=</span><span class="number">40</span> <span class="keyword">then</span></span><br><span class="line">     dbms_output.put_line(<span class="string">&#x27;老年人&#x27;</span>);</span><br><span class="line">   <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

### 10.5. loop 循环语句

`while`循环语法：类似java中的`while`循环

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while 循环条件</span><br><span class="line">loop</span><br><span class="line">	...循环内容;</span><br><span class="line"><span class="keyword">end</span> loop;</span><br></pre></td></tr></table></figure>

`loop`循环语法：类似java中的`do-while`

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">loop</span><br><span class="line">	...循环内容;</span><br><span class="line">exit [<span class="keyword">when</span> 退出条件];</span><br><span class="line"><span class="keyword">end</span> loop;</span><br></pre></td></tr></table></figure>

`for`循环语法：注意`in`后面是两个【`.`】。类似java中的`for`循环

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 变量 <span class="keyword">in</span> <span class="number">1.</span>.n</span><br><span class="line">loop</span><br><span class="line">	...循环内容;</span><br><span class="line"><span class="keyword">end</span> loop;</span><br></pre></td></tr></table></figure>

三种循环方式示例:

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例:使用语法 1 输出 1 到 10 的数字</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 声明数字类型变量，:=给变量赋值</span></span><br><span class="line">   i number :<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   while i<span class="operator">&lt;=</span><span class="number">10</span></span><br><span class="line">   loop</span><br><span class="line">     dbms_output.put_line(i);</span><br><span class="line">     i :<span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">   <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 范例:使用语法 2 输出 1 到 10 的数字</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   i number :<span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   loop</span><br><span class="line">     dbms_output.put_line(i);</span><br><span class="line">     i :<span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">     exit <span class="keyword">when</span> i <span class="operator">&gt;</span> <span class="number">10</span>;</span><br><span class="line">   <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 范例:使用语法 3 输出 1 到 10 的数字（declare可以省略）</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span></span><br><span class="line">  loop</span><br><span class="line">    dbms_output.put_line(i);</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

### 10.6. 数组

明确一个概念：Oracle中本是没有数组的概念的，数组其实就是一张表(Table),每个数组元素就是表中的一个记录。

使用数组时，用户可以使用 Oracle 已经定义好的数组类型，或可根据自己的需要定义数组类型。

#### 10.6.1. 使用 Oracle 自带的数组类型

使用时需要进行初始化，语法格式：`变量名 array;`

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> test(y <span class="keyword">out</span> <span class="keyword">array</span>) <span class="keyword">is</span></span><br><span class="line">  x <span class="keyword">array</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  x :<span class="operator">=</span> <span class="keyword">new</span> <span class="keyword">array</span>();</span><br><span class="line">  y :<span class="operator">=</span> x;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

#### 10.6.2. 自定义的数组类型

自定义数据类型时，建议通过创建 `Package` 的方式实现，以便于管理

### 10.7. 游标（光标 Cursor）

在pl/sql中会用到多条记录（类似java程序中的集合概念），<font color=red>**使用游标可以存储查询返回的多条数据，结果集**</font>。

游标的定义语法：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cursor</span> 游标名 [(参数名 数据类型,参数名 数据类型,...)] <span class="keyword">is</span> <span class="keyword">select</span> 语句;</span><br></pre></td></tr></table></figure>

示例：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cursor</span> c1 <span class="keyword">is</span> <span class="keyword">select</span> ename <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">-- 带参数：</span></span><br><span class="line"><span class="keyword">cursor</span> c(dno my_emp.deptno<span class="operator">%</span>type) <span class="keyword">is</span></span><br><span class="line">	<span class="keyword">select</span> e.empno <span class="keyword">from</span> my_emp e <span class="keyword">where</span> e.deptno <span class="operator">=</span> dno;</span><br></pre></td></tr></table></figure>

游标的使用语句：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> 游标名;</span><br><span class="line">loop</span><br><span class="line">	<span class="keyword">fetch</span> 游标名 <span class="keyword">into</span> 变量名;</span><br><span class="line">	exit <span class="keyword">when</span> 游标名<span class="operator">%</span>notfound;</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">close</span> 游标名;</span><br></pre></td></tr></table></figure>

游标的使用步骤（例子）:

1. 打开游标：`open c1;` (打开游标执行查询)
2. 取一行游标的值：`fetch c1 into 变量;` (取一行到变量中，指针自动往下移，类型java程序中的迭代器iterator)
3. 关闭游标：`close c1;`(关闭游标释放资源)
4. 游标的结束方式：`exit when c1%notfound`

> 注意：
>
> - 游标结束的条件要放在取出游标值后面，否则最好一个值会输出两次
> - 上面的 【变量】 必须与 emp 表中的指定的列类型一致：
> - 定义：pjob emp.empjob%type;

Code Dome:

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例 1：使用游标方式输出 emp 表中的员工编号和姓名</span></span><br><span class="line"><span class="comment">-- 方法1：</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 定义游标</span></span><br><span class="line">   <span class="keyword">cursor</span> c <span class="keyword">is</span> <span class="keyword">select</span> empno,ename <span class="keyword">from</span> emp;</span><br><span class="line">   <span class="comment">-- 声明引用变量，与emp表中的员工编号和姓名类型一致</span></span><br><span class="line">   pid emp.empno<span class="operator">%</span>type;</span><br><span class="line">   pname emp.ename<span class="operator">%</span>type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 打开游标</span></span><br><span class="line">  <span class="keyword">open</span> c;</span><br><span class="line">  <span class="comment">-- 使用循环将游标的值取出</span></span><br><span class="line">  loop</span><br><span class="line">    <span class="comment">-- 多个变量使用逗号分隔，顺序要与定义游标的语句一致</span></span><br><span class="line">    <span class="keyword">fetch</span> c <span class="keyword">into</span> pid,pname;</span><br><span class="line">    <span class="comment">-- 设置循环结束条件</span></span><br><span class="line">    exit <span class="keyword">when</span> c<span class="operator">%</span>notfound;</span><br><span class="line">    dbms_output.put_line(pid <span class="operator">||</span> <span class="string">&#x27; === &#x27;</span> <span class="operator">||</span> pname);</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line">  <span class="comment">-- 关闭游标</span></span><br><span class="line">  <span class="keyword">close</span> c;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 教材方法2：</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 定义游标</span></span><br><span class="line">   <span class="keyword">cursor</span> c <span class="keyword">is</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line">   <span class="comment">-- 声明记录型变量</span></span><br><span class="line">   pemp emp<span class="operator">%</span>rowtype;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 打开游标</span></span><br><span class="line">   <span class="keyword">open</span> c;</span><br><span class="line">   <span class="comment">-- 使用循环读取游标的记录</span></span><br><span class="line">   loop</span><br><span class="line">     <span class="comment">-- 从游标读取值</span></span><br><span class="line">     <span class="keyword">fetch</span> c <span class="keyword">into</span> pemp;</span><br><span class="line">     <span class="comment">-- 设置循环结束条件</span></span><br><span class="line">     exit <span class="keyword">when</span> c<span class="operator">%</span>notfound;</span><br><span class="line">     dbms_output.put_line(pemp.empno <span class="operator">||</span> <span class="string">&#x27; === &#x27;</span> <span class="operator">||</span> pemp.ename);</span><br><span class="line">    <span class="keyword">end</span> loop;</span><br><span class="line">   <span class="comment">-- 关闭游标</span></span><br><span class="line">   <span class="keyword">close</span> c;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 范例 2：写一段 PL/SQL 程序，为部门号为 10 的员工涨工资。</span></span><br><span class="line"><span class="comment">-- 方式1：自己的做法</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 定义游标，存储查询所有部门号为10的员工</span></span><br><span class="line">   <span class="keyword">cursor</span> c <span class="keyword">is</span> <span class="keyword">select</span> e.empno <span class="keyword">from</span> my_emp e <span class="keyword">where</span> e.deptno<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line">   <span class="comment">-- 声明引用型变量</span></span><br><span class="line">   pno my_emp.empno<span class="operator">%</span>type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 打开游标</span></span><br><span class="line">   <span class="keyword">open</span> c;</span><br><span class="line">   <span class="comment">-- 使用循环读取游标中的值</span></span><br><span class="line">   loop</span><br><span class="line">     <span class="comment">-- 从游标读取值</span></span><br><span class="line">     <span class="keyword">fetch</span> c <span class="keyword">into</span> pno;</span><br><span class="line">     <span class="comment">-- 设置结束循环条件</span></span><br><span class="line">     exit <span class="keyword">when</span> c<span class="operator">%</span>notfound;</span><br><span class="line">     <span class="comment">-- 执行sql语句</span></span><br><span class="line">     <span class="keyword">update</span> my_emp e <span class="keyword">set</span> e.sal<span class="operator">=</span>e.sal<span class="operator">+</span><span class="number">100</span> <span class="keyword">where</span> e.empno<span class="operator">=</span>pno;</span><br><span class="line">   <span class="keyword">end</span> loop;</span><br><span class="line">   <span class="keyword">commit</span>;</span><br><span class="line">   <span class="comment">-- 关闭游标</span></span><br><span class="line">   <span class="keyword">close</span> c;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2：教材做法</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="comment">-- 定义游标，存储查询所有部门号为10的员工</span></span><br><span class="line">  <span class="keyword">cursor</span> c(dno my_emp.deptno<span class="operator">%</span>type) <span class="keyword">is</span></span><br><span class="line">      <span class="keyword">select</span> e.empno <span class="keyword">from</span> my_emp e <span class="keyword">where</span> e.deptno <span class="operator">=</span> dno;</span><br><span class="line">  <span class="comment">-- 声明引用型变量</span></span><br><span class="line">  pno my_emp.empno<span class="operator">%</span>type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 打开游标</span></span><br><span class="line">  <span class="keyword">open</span> c(<span class="number">10</span>);</span><br><span class="line">  <span class="comment">-- 使用循环读取游标中的值</span></span><br><span class="line">  loop</span><br><span class="line">    <span class="comment">-- 从游标读取值</span></span><br><span class="line">    <span class="keyword">fetch</span> c <span class="keyword">into</span> pno;</span><br><span class="line">    <span class="comment">-- 设置结束循环条件</span></span><br><span class="line">    exit <span class="keyword">when</span> c<span class="operator">%</span>notfound;</span><br><span class="line">    <span class="comment">-- 执行sql语句</span></span><br><span class="line">    <span class="keyword">update</span> my_emp e <span class="keyword">set</span> e.sal<span class="operator">=</span>e.sal<span class="operator">+</span><span class="number">2</span> <span class="keyword">where</span> e.empno<span class="operator">=</span>pno;</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line">  <span class="keyword">commit</span>;</span><br><span class="line">  <span class="comment">-- 关闭游标</span></span><br><span class="line">  <span class="keyword">close</span> c;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

### 10.8. 异常【例外】

异常是程序设计语言提供的一种功能，用来增强程序的健壮性和容错性。异常语法：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">	声明语句;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	执行语句（出现异常）;</span><br><span class="line">exception</span><br><span class="line">	<span class="keyword">when</span> 系统定义异常<span class="number">1</span> <span class="keyword">then</span> 执行语句;</span><br><span class="line">	<span class="keyword">when</span> 系统定义异常<span class="number">2</span> <span class="keyword">then</span> 执行语句;</span><br><span class="line">		...</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

**系统定义异常**

- `no_data_found` (没有找到数据)
- `too_many_rows` (`select ...into` 语句匹配多个行)
- `zero_divide` (被零除)
- `value_error` (算术或转换错误)
- `timeout_on_resource` (在等待资源时发生超时)

系统定义异常示例:

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例 1：写出被 0 除的异常的 plsql 程序</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 声明变量</span></span><br><span class="line">   pnum number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 模拟异常</span></span><br><span class="line">   pnum :<span class="operator">=</span> <span class="number">1</span><span class="operator">/</span><span class="number">0</span>;</span><br><span class="line">exception</span><br><span class="line">   <span class="keyword">when</span> zero_divide <span class="keyword">then</span></span><br><span class="line">     dbms_output.put_line(<span class="string">&#x27;被0除&#x27;</span>);</span><br><span class="line">   <span class="keyword">when</span> value_error <span class="keyword">then</span></span><br><span class="line">     dbms_output.put_line(<span class="string">&#x27;数值转换错误&#x27;</span>);</span><br><span class="line">   <span class="keyword">when</span> others <span class="keyword">then</span></span><br><span class="line">     dbms_output.put_line(<span class="string">&#x27;其他错误&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

用户也可以自定义异常，在声明中来定义异常：

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">	<span class="comment">-- 定义异常</span></span><br><span class="line">	no_data_found exception;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	执行语句;</span><br><span class="line">	<span class="comment">--如果遇到异常我们要抛出</span></span><br><span class="line">	if c<span class="operator">%</span>notfound <span class="keyword">then</span> raise no_data_found;</span><br><span class="line">exception</span><br><span class="line">	<span class="keyword">when</span> no_data_found <span class="keyword">then</span> 执行语句;</span><br><span class="line">	<span class="keyword">when</span> others <span class="keyword">then</span> 执行语句;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

自定义异常:

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例 2：查询部门编号是 50 的员工</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 定义异常</span></span><br><span class="line">   no_data_found exception;</span><br><span class="line">   <span class="keyword">cursor</span> c <span class="keyword">is</span> <span class="keyword">select</span> e.ename <span class="keyword">from</span> emp e <span class="keyword">where</span> e.deptno<span class="operator">=</span><span class="number">50</span>;</span><br><span class="line">   pename emp.ename<span class="operator">%</span>type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 开启游标</span></span><br><span class="line">  <span class="keyword">open</span> c;</span><br><span class="line">  <span class="comment">-- 获取值</span></span><br><span class="line">  <span class="keyword">fetch</span> c <span class="keyword">into</span> pename;</span><br><span class="line">  if c<span class="operator">%</span>notfound <span class="keyword">then</span> raise no_data_found;</span><br><span class="line">  <span class="keyword">end</span> if;</span><br><span class="line">  <span class="keyword">close</span> c;</span><br><span class="line">exception</span><br><span class="line">  <span class="keyword">when</span> no_data_found <span class="keyword">then</span></span><br><span class="line">    dbms_output.put_line(<span class="string">&#x27;没有找到该员工&#x27;</span>);</span><br><span class="line">  <span class="keyword">when</span> others <span class="keyword">then</span></span><br><span class="line">    dbms_output.put_line(<span class="string">&#x27;其他错误&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

## 11. 存储过程

### 11.1. 存储过程概述

存储过程（Stored Procedure）是在大型数据库系统中，一组为了完成特定功能的 SQL 语句集，经编译后存储在数据库中，用户通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来执行它。存储过程是数据库中的一个重要对象，任何一个设计良好的数据库应用程序都应该用到存储过程

<font color=red>**存储过程：封装了一系列了sql语句，事先编译好，存储在数据库端，供其他程序员调用**</font>

<font color=red>**好处：效率高**</font>

<ul>
<li>创建好的存储过程会存在当前用户的<code>Procedures</code>中</li>
<li>创建好的存储函数会存在当前用户的<code>Functions</code>中</li>
</ul>
<h3 id="11-2-创建存储过程语法"><a href="#11-2-创建存储过程语法" class="headerlink" title="11.2. 创建存储过程语法"></a>11.2. 创建存储过程语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [<span class="keyword">or</span> replace] <span class="keyword">procedure</span> 过程名[(参数名<span class="number">1</span> <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> 数据类型<span class="number">1</span>, 参数名<span class="number">2</span> <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> 数据类型<span class="number">2</span>, ......)]</span><br><span class="line"><span class="keyword">as</span><span class="operator">/</span><span class="keyword">is</span></span><br><span class="line">	在存储过程中定义的变量</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	PLSQL 子程序体，封装多条<span class="keyword">sql</span>语句；</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<font color=red>注：如果参数是输入类型*in*，可以省略不写</font>

</blockquote>
<h3 id="11-3-调用存储过程"><a href="#11-3-调用存储过程" class="headerlink" title="11.3. 调用存储过程"></a>11.3. 调用存储过程</h3><p>方式1：不推荐，不能接收存储过程<code>out</code>的参数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> 过程名(参数<span class="number">1</span>, 参数<span class="number">2</span>, ......);</span><br></pre></td></tr></table></figure>
<font color=red>方式2：可以接收存储过程`out`的参数，注意传递的参数顺序必须按定义存储过程参数的顺序【推荐】</font>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">	声明变量，如果没有可以省略不写</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	过程名(参数<span class="number">1</span>, 参数<span class="number">2</span>, ......);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<font color=red>方式3：调用存储过程时，传递参数的方式写法不一样，此方式的好处是指定值对应变量顺序可变【推荐】</font>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">	声明变量，如果没有可以省略不写</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	过程名(定义的输入<span class="operator">/</span>输出参数名<span class="number">1</span><span class="operator">=</span><span class="operator">&gt;</span>值<span class="number">1</span>,</span><br><span class="line">			定义的输入<span class="operator">/</span>输出参数名<span class="number">2</span><span class="operator">=</span><span class="operator">&gt;</span>值<span class="number">2</span>,</span><br><span class="line">			定义的输入<span class="operator">/</span>输出参数名<span class="number">3</span><span class="operator">=</span><span class="operator">&gt;</span>值<span class="number">3</span>, ......);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 给某个员工涨工资，打印出涨前涨后的工资</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> pro_emp_sal (eno number, money number)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">       <span class="comment">-- 在存储过程定义变量</span></span><br><span class="line">       <span class="comment">-- 声明数字类型变量，存储涨前和涨后的工资</span></span><br><span class="line">       psal number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">       <span class="comment">-- 封装的sql语句</span></span><br><span class="line">       <span class="comment">-- 查询涨前工资</span></span><br><span class="line">       <span class="keyword">select</span> sal <span class="keyword">into</span> psal <span class="keyword">from</span> my_emp <span class="keyword">where</span> empno<span class="operator">=</span>eno;</span><br><span class="line">       dbms_output.put_line(<span class="string">&#x27;涨前工资&#x27;</span><span class="operator">||</span>psal);</span><br><span class="line">       <span class="comment">-- 修改工资</span></span><br><span class="line">       <span class="keyword">update</span> my_emp <span class="keyword">set</span> sal<span class="operator">=</span>sal<span class="operator">+</span>money <span class="keyword">where</span> empno<span class="operator">=</span>eno;</span><br><span class="line">       <span class="keyword">commit</span>;</span><br><span class="line">       <span class="comment">-- 查询涨后工资</span></span><br><span class="line">       <span class="keyword">select</span> sal <span class="keyword">into</span> psal <span class="keyword">from</span> my_emp <span class="keyword">where</span> empno<span class="operator">=</span>eno;</span><br><span class="line">       dbms_output.put_line(<span class="string">&#x27;涨后工资&#x27;</span><span class="operator">||</span>psal);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用存储过程</span></span><br><span class="line"><span class="comment">-- 方式1：不推荐，不能接收存储过程out的参数</span></span><br><span class="line"><span class="keyword">call</span> pro_emp_sal(<span class="number">7788</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式2：可以接收存储过程out的参数【推荐】</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="comment">-- 声明变量，如果没有可以省略不写</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  pro_emp_sal(<span class="number">7788</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<h3 id="11-4-创建包与体的存储过程"><a href="#11-4-创建包与体的存储过程" class="headerlink" title="11.4. 创建包与体的存储过程"></a>11.4. 创建包与体的存储过程</h3><h4 id="11-4-1-定义"><a href="#11-4-1-定义" class="headerlink" title="11.4.1. 定义"></a>11.4.1. 定义</h4><p>包用于组合逻辑相关的过程和函数，它由包规范和包体两个部分组成。包规范用于定义公用的常量、变量、过程和函数，创建包规范可以使用CREATE PACKAGE命令，创建包体可以使用CREATE PACKAGE BODY</p>
<h4 id="11-4-2-语法"><a href="#11-4-2-语法" class="headerlink" title="11.4.2. 语法"></a>11.4.2. 语法</h4><p>创建包规范</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace package PCKG_包名 <span class="keyword">is</span></span><br><span class="line"></span><br><span class="line">	定义一些全局的常量，或者是游标类型，如：</span><br><span class="line">	xxx_xxx_xxx   constant number :<span class="operator">=</span>  <span class="number">100</span>;</span><br><span class="line">	xxx_xxx_xxx   constant varchar2(<span class="number">30</span>) :<span class="operator">=</span>  <span class="string">&#x27;&#x27;</span></span><br><span class="line">	Type 游标名 <span class="keyword">is</span> <span class="keyword">ref</span> <span class="keyword">cursor</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">procedure</span> PROC_存储过程名 (参数名<span class="number">1</span> <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> 数据类型<span class="number">1</span>, 参数名<span class="number">2</span> <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> 数据类型<span class="number">2</span>, ......);</span><br><span class="line">	<span class="keyword">function</span> FUNC_存储函数名 (参数<span class="number">1</span> <span class="keyword">in</span><span class="operator">|</span><span class="keyword">out</span> 数据类型<span class="number">1</span>, 参数<span class="number">2</span> <span class="keyword">in</span><span class="operator">|</span><span class="keyword">out</span> 数据类型<span class="number">2</span>, ...) <span class="keyword">return</span> 数据类型;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> PCKG_包名;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace package body PCKG_包名</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">procedure</span> PROC_存储过程名 (参数名<span class="number">1</span> <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> 数据类型<span class="number">1</span>, 参数名<span class="number">2</span> <span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span> 数据类型<span class="number">2</span>, ......)</span><br><span class="line">	<span class="keyword">is</span><span class="operator">/</span><span class="keyword">as</span></span><br><span class="line">		v_变量名 数据类型;</span><br><span class="line">	<span class="keyword">begin</span></span><br><span class="line">		业务逻辑;</span><br><span class="line">	<span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">function</span> FUNC_存储函数名 (参数<span class="number">1</span> <span class="keyword">in</span><span class="operator">|</span><span class="keyword">out</span> 数据类型<span class="number">1</span>, 参数<span class="number">2</span> <span class="keyword">in</span><span class="operator">|</span><span class="keyword">out</span> 数据类型<span class="number">2</span>, ...) <span class="keyword">return</span> 数据类型 </span><br><span class="line">	<span class="keyword">is</span><span class="operator">/</span><span class="keyword">as</span></span><br><span class="line">		v_变量名 数据类型;</span><br><span class="line">	<span class="keyword">begin</span></span><br><span class="line">		业务逻辑;</span><br><span class="line">	<span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> PCKG_包名;</span><br><span class="line"><span class="operator">/</span></span><br></pre></td></tr></table></figure>
<h3 id="11-5-关于oracle存储过程的若干问题备忘"><a href="#11-5-关于oracle存储过程的若干问题备忘" class="headerlink" title="11.5. 关于oracle存储过程的若干问题备忘"></a>11.5. 关于oracle存储过程的若干问题备忘</h3><ol>
<li>在oracle的存储过程中，数据表别名不能加<code>as</code>。也许，是怕和oracle中的存储过程中的关键字<code>as</code>冲突的问题吧</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">selecta.appname <span class="keyword">from</span> appinfo a;     <span class="comment">-- 正确</span></span><br><span class="line">selecta.appname <span class="keyword">from</span> appinfo <span class="keyword">as</span> a;  <span class="comment">-- 错误</span></span><br></pre></td></tr></table></figure>
<ol>
<li>在存储过程中，<code>select</code> 某一字段时，后面必须紧跟 <code>into</code>，如果 <code>select</code> 整个记录，利用游标的话就另当别论了</li>
<li>在利用 <code>select...into...</code> 语法时，必须先确保数据库中有该条记录，否则会报出”no datafound”异常。<br> 可以在该语法之前，先利用 <code>select count(*) from</code> 查看数据库中是否存在该记录，如果存在，再利用 <code>select...into...</code></li>
<li>在存储过程中，别名不能和字段名称相同，否则虽然编译可以通过，但在运行阶段会报错</li>
</ol>
<h3 id="11-6-Oracle中的Packages与Packagebodies"><a href="#11-6-Oracle中的Packages与Packagebodies" class="headerlink" title="11.6. Oracle中的Packages与Packagebodies"></a>11.6. Oracle中的Packages与Packagebodies</h3><h4 id="11-6-1-package的作用"><a href="#11-6-1-package的作用" class="headerlink" title="11.6.1. package的作用"></a>11.6.1. package的作用</h4><p>可以简化应用设计、提高应用性能、实现信息隐藏、子程序重载</p>
<h4 id="11-6-2-packages-与-packagebodies比较"><a href="#11-6-2-packages-与-packagebodies比较" class="headerlink" title="11.6.2. packages 与 packagebodies比较"></a>11.6.2. packages 与 packagebodies比较</h4><p>定义:<code>packae</code>是一种将过程、函数和数据结构捆绑在一起的容器；</p>
<p>由两个部分组成：外部可视包规范，包括函数头，过程头，和外部可视数据结构；</p>
<p>另一部分是包主体(<code>package body</code>),包主体包含了所有被捆绑的过程和函数的声明、执行、异常处理部分。</p>
<p>简单说就是<font color=red><strong><code>packages</code> 中只有各个方法的定义，<code>bodies</code>中涉及具体的实现.</strong></font></p>
<p>所以 <code>packages</code> 和 <code>packagebodies</code> 是一体的，必须同时存在。如果要外部调用的，就在<code>package</code>里声明一下，包内调用的，只要在<code>body</code>里写就行了。</p>
<p><code>package</code>可包括<code>function</code>，<code>procedure</code>。</p>
<p>需要先创建<code>package</code>(也就是包的定义)，再创建<code>body</code>。</p>
<p>增加包中的过程或者修改包中过程的输入参数个数等也是要先改<code>package</code>再改<code>body</code></p>
<h2 id="12-存储函数"><a href="#12-存储函数" class="headerlink" title="12. 存储函数"></a>12. 存储函数</h2><h3 id="12-1-存储函数概述"><a href="#12-1-存储函数概述" class="headerlink" title="12.1. 存储函数概述"></a>12.1. 存储函数概述</h3><p>与存储过程类似，封装一些sql语句，事先编译好，存在数据库端，供其他程序员调用。</p>
<h3 id="12-2-存储函数语法"><a href="#12-2-存储函数语法" class="headerlink" title="12.2. 存储函数语法"></a>12.2. 存储函数语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [<span class="keyword">or</span> replace] <span class="keyword">function</span> 函数名(参数<span class="number">1</span> <span class="keyword">in</span><span class="operator">|</span><span class="keyword">out</span> 数据类型<span class="number">1</span>, 参数<span class="number">2</span> <span class="keyword">in</span><span class="operator">|</span><span class="keyword">out</span> 数据类型<span class="number">2</span>, ...) <span class="keyword">return</span> 数据类型</span><br><span class="line"><span class="keyword">as</span><span class="operator">|</span><span class="keyword">is</span></span><br><span class="line">	<span class="comment">-- 定义变量</span></span><br><span class="line">	结果变量 数据类型;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="comment">-- 变量必须跟函数返回类型一致</span></span><br><span class="line">	<span class="keyword">return</span> 结果变量;</span><br><span class="line"><span class="keyword">end</span>[函数名];</span><br></pre></td></tr></table></figure>
<font color=red>*注：如果参数是输入类型`in`，可以省略不写。黄色部分需要注意，与存储过程不一样，函数必须有一个返回值*</font>

<p>过程：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public void methodName(params....)&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>函数：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public String methodName(params....)&#123;<span class="keyword">return</span> &quot;&quot;;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="12-3-调用存储函数"><a href="#12-3-调用存储函数" class="headerlink" title="12.3. 调用存储函数"></a>12.3. 调用存储函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">	<span class="comment">-- 声明变量，如果没有可以省略不写</span></span><br><span class="line">	接收返回值变量 变量类型（与返回值类型一致）;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	返回值变量 :<span class="operator">=</span> 函数名(参数<span class="number">1</span>, 参数<span class="number">2</span>, ......);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<p><strong>存储函数与存储过程使用<code>out</code>参数返回值</strong>:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用存储函数查询某个员工的年薪</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">function</span> fun_total_sal(pno number)</span><br><span class="line"><span class="keyword">return</span> number</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">   <span class="comment">-- 定义一个number类型变量接收查询结果</span></span><br><span class="line">   totalSal number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 使用判空函数判断是否有奖金</span></span><br><span class="line">   <span class="keyword">select</span> sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>nvl(comm, <span class="number">0</span>) <span class="keyword">into</span> totalSal <span class="keyword">from</span> my_emp <span class="keyword">where</span> empno<span class="operator">=</span>pno;</span><br><span class="line">   <span class="comment">-- 返回查询结果</span></span><br><span class="line">   <span class="keyword">return</span> totalSal;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用函数</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 定义数字类型变量接收返回值</span></span><br><span class="line">   t number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 调用存储函数，获取函数中返回值</span></span><br><span class="line">   t :<span class="operator">=</span> fun_total_sal(<span class="number">7788</span>);</span><br><span class="line">   dbms_output.put_line(t);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用存储过程来完成：查询某个员工的年薪</span></span><br><span class="line"><span class="comment">-- 可以利用 out 参数，在过程和函数中实现返回多个值</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> pro_total_sal(pno number, totalSal <span class="keyword">out</span> number)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">   <span class="comment">-- 无声明的变量</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 将查询到结果赋值给out参数</span></span><br><span class="line">   <span class="keyword">select</span> sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>nvl(comm, <span class="number">0</span>) <span class="keyword">into</span> totalSal <span class="keyword">from</span> my_emp <span class="keyword">where</span> empno<span class="operator">=</span>pno;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用存储过程</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 定义一个变量接收年薪</span></span><br><span class="line">   t number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 调用过程，将定义的变量作为参数传递到out参数位置</span></span><br><span class="line">   pro_total_sal(<span class="number">7788</span>,t);</span><br><span class="line">   <span class="comment">-- 打印输出out参数</span></span><br><span class="line">   dbms_output.put_line(<span class="string">&#x27;员工的年薪是：&#x27;</span> <span class="operator">||</span> t);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<h3 id="12-4-存储过程和存储函数的区别"><a href="#12-4-存储过程和存储函数的区别" class="headerlink" title="12.4. 存储过程和存储函数的区别"></a>12.4. 存储过程和存储函数的区别</h3><ol>
<li>过程和函数最大的区别是：<ul>
<li>函数（function）总是向调用者返回数据，并且一般只返回一个值；</li>
<li>存储过程（procedure）不直接返回数据，但可以改变输出参数的值，这可以近似看作能返回值，且存储过程输出参数的值个数没有限制。</li>
<li>但过程和函数都可以通过 <code>out</code> 指定一个或多个输出参数。我们可以利用 <code>out</code> 参数，在过程和函数中实现返回多个值</li>
</ul>
</li>
<li>存储过程一般是作为一个独立的部分来执行（<code>CALL</code>语句执行），而函数可以作为查询语句的一个部分来调用（<code>SELECT</code>调用）。SQL语句中不可用存储过程，而可以使用函数</li>
</ol>
<p>以下需要注意的地方是：</p>
<ol>
<li>定义函数或者存储过程时，<code>IN</code>/<code>OUT</code>表示调用函数时，传进来或传出去的参数。如果没有说明<code>in</code>/<code>out</code>，则默认为<code>in</code>；</li>
<li>定义的函数必须要有<code>return</code>子句，其后紧跟着返回值得类型；</li>
<li>实际调用函数或存储过程时，在<code>declare</code>中声明的变量至少应该对应创建的函数或存储过程中的<code>OUT</code>参数和<code>return</code>参数合起来的个数；</li>
<li>可以建立不带参数（即没有返回的参数）、没有变量的存储过程。</li>
<li>执行方式略有不同，存储过程的执行方式有两种（1.使用<code>call</code>；2.使用<code>begin</code>和<code>end</code>），函数除了存储过程的两种方式外，还可以当做表达式使用，例如放在<code>select</code>中（<code>select f1() form dual;</code>）。</li>
</ol>
<p>过程与函数区别：1、语法不同，函数必须有返回值；2、函数可以用在<code>select</code>部分:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 编写函数：根据部门编号查询部门名称</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">function</span> findDNameByDNo(dno number) <span class="keyword">return</span> varchar2</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line">   <span class="comment">-- 定义返回值</span></span><br><span class="line">   dNameStr dept.dname<span class="operator">%</span>type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 接收查询返回值</span></span><br><span class="line">   <span class="keyword">select</span> dname <span class="keyword">into</span> dNameStr <span class="keyword">from</span> dept <span class="keyword">where</span> deptno<span class="operator">=</span>dno;</span><br><span class="line">   <span class="comment">-- 返回查询结果</span></span><br><span class="line">   <span class="keyword">return</span> dNameStr;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用存储函数</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">   <span class="comment">-- 声明返回值</span></span><br><span class="line">   pname dept.dname<span class="operator">%</span>type;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 获取查询返回值，并输出结果</span></span><br><span class="line">   pname :<span class="operator">=</span> findDNameByDNo(<span class="number">20</span>);</span><br><span class="line">   dbms_output.put_line(pname);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在select语句中使用函数</span></span><br><span class="line"><span class="keyword">select</span> ename,deptno,findDNameByDNo(deptno) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<h2 id="13-Java程序调用存储过程"><a href="#13-Java程序调用存储过程" class="headerlink" title="13. Java程序调用存储过程"></a>13. Java程序调用存储过程</h2><h3 id="13-1-java-连接-oracle-的-jar-包"><a href="#13-1-java-连接-oracle-的-jar-包" class="headerlink" title="13.1. java 连接 oracle 的 jar 包"></a>13.1. java 连接 oracle 的 jar 包</h3><p>在oracle的安装目录:\oracle\product\10.2.0\db_1\jdbc\lib</p>
<p>找到 jar 包：ojdbc14.jar</p>
<h3 id="13-2-数据库连接字符串"><a href="#13-2-数据库连接字符串" class="headerlink" title="13.2. 数据库连接字符串"></a>13.2. 数据库连接字符串</h3><p>数据库的连接要素可以在 hibernate-release-5.0.12.Final\project\etc\hibernate.propertie 找到</p>
<font color=red>**orcl是安装oracle时填写的全局数据库名！！！！！**</font>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String driver=<span class="string">&quot;oracle.jdbc.OracleDriver&quot;</span>;</span><br><span class="line">String url=<span class="string">&quot;jdbc:oracle:thin:@192.168.17.10:1521:orcl&quot;</span>;</span><br><span class="line">String username=<span class="string">&quot;scott&quot;</span>;</span><br><span class="line">String password=<span class="string">&quot;123456&quot;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="13-3-Connection-接口获取-CallableStatement"><a href="#13-3-Connection-接口获取-CallableStatement" class="headerlink" title="13.3. Connection 接口获取 CallableStatement"></a>13.3. Connection 接口获取 CallableStatement</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CallableStatement <span class="title function_">prepareCall</span><span class="params">(String sql)</span></span><br></pre></td></tr></table></figure>
<p>创建一个 <code>CallableStatement</code> 对象来调用数据库存储过程。<code>CallableStatement</code> 对象提供了设置其 <code>IN</code> 和 <code>OUT</code> 参数的方法，以及用来执行调用存储过程的方法。</p>
<p><code>prepareCall(String sql)</code>方法中的sql参数：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;?<span class="operator">=</span> <span class="keyword">call</span> <span class="operator">&lt;</span><span class="keyword">procedure</span><span class="operator">-</span>name<span class="operator">&gt;</span>[(<span class="operator">&lt;</span>arg1<span class="operator">&gt;</span>,<span class="operator">&lt;</span>arg2<span class="operator">&gt;</span>, ...)]&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>用于调用存储函数，第1个“?”是存储函数的返回值</li>
<li><code>procedure-name</code>：存储函数的名字</li>
<li><code>arg1,arg2...</code>：函数的形式参数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">call</span> <span class="operator">&lt;</span><span class="keyword">procedure</span><span class="operator">-</span>name<span class="operator">&gt;</span>[(<span class="operator">&lt;</span>arg1<span class="operator">&gt;</span>,<span class="operator">&lt;</span>arg2<span class="operator">&gt;</span>, ...)]&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>用于调用存储过程</li>
<li><code>procedure-name</code>：存储过程的名字</li>
<li><code>arg1,arg2...</code>：过程的形式参数</li>
</ul>
<h3 id="13-4-CallableStatement-接口"><a href="#13-4-CallableStatement-接口" class="headerlink" title="13.4. CallableStatement 接口"></a>13.4. CallableStatement 接口</h3><p>用于执行 SQL 存储过程的接口。JDBC API 提供了一个存储过程 SQL 转义语法，该语法允许对所有 RDBMS 使用标准方式调用存储过程。</p>
<p>此转义语法有一个包含结果参数的形式和一个不包含结果参数的形式。如果使用结果参数，则必须将其注册为 <code>OUT</code> 参数。其他参数可用于输入、输出或同时用于二者。</p>
<p>参数是根据编号按顺序引用的，第一个参数的编号是 1。</p>
<p><code>CallableStatement</code> 常用方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">setString</span><span class="params">(String parameterName, String x)</span></span><br></pre></td></tr></table></figure>
<p>设置String类型的参数。</p>
<ul>
<li><code>parameterIndex</code>：sql语句<code>?</code>参数的索引</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">setInt</span><span class="params">(<span class="type">int</span> parameterIndex, <span class="type">int</span> x)</span></span><br></pre></td></tr></table></figure>
<p>设置int类型的参数。</p>
<ul>
<li><code>parameterIndex</code>：sql语句<code>?</code>参数的索引</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">execute</span><span class="params">()</span></span><br></pre></td></tr></table></figure>
<p>执行 SQL 语句，该语句可以是任何种类的 SQL 语句。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">registerOutParameter</span><span class="params">(<span class="type">int</span> parameterIndex, <span class="type">int</span> sqlType)</span></span><br></pre></td></tr></table></figure>
<p>按顺序位置 parameterIndex 将 OUT 参数注册为 JDBC 类型 sqlType。所有 OUT 参数都必须在执行存储过程前注册。</p>
<ul>
<li>参数<code>sqlType</code>：使用oracle的驱动中类OracleTypes的常量</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object <span class="title function_">getObject</span><span class="params">(<span class="type">int</span> parameterIndex)</span></span><br></pre></td></tr></table></figure>
<p>获取指定参数存储过程返回的值。如果值为 SQL NULL，则驱动程序返回一个 Java null。</p>
<p>此方法返回一个 Java 对象，其类型对应于使用 registerOutParameter 方法为此参数注册的 JDBC 类型。</p>
<h3 id="13-5-JDBC调用Oracle对象-表"><a href="#13-5-JDBC调用Oracle对象-表" class="headerlink" title="13.5. JDBC调用Oracle对象-表"></a>13.5. JDBC调用Oracle对象-表</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jdbc:调用oracle数据库，查询emp表的数据打印到控制台</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcOracleDemo01</span> &#123;</span><br><span class="line">	<span class="comment">// 定义数据库连接4要素</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:oracle:thin:@192.168.187.10:1521:orcl&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;scott&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testOracle</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// 加载oracle驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置数据库连接其他要素，获取连接对象</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取预编译对象</span></span><br><span class="line">		<span class="type">PreparedStatement</span> <span class="variable">pstm</span> <span class="operator">=</span> conn.prepareStatement(<span class="string">&quot;select * from emp&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 执行</span></span><br><span class="line">		<span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> pstm.executeQuery();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 输出查询结果</span></span><br><span class="line">		<span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;员工姓名：&quot;</span> + rs.getString(<span class="string">&quot;ename&quot;</span>) + <span class="string">&quot; ,员工工作：&quot;</span> + rs.getString(<span class="string">&quot;job&quot;</span>));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 关闭资源</span></span><br><span class="line">		<span class="keyword">if</span> (pstm != <span class="literal">null</span>) &#123;</span><br><span class="line">			pstm.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">			conn.close();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="13-6-JDBC调用Oracle对象-过程：无返回"><a href="#13-6-JDBC调用Oracle对象-过程：无返回" class="headerlink" title="13.6. JDBC调用Oracle对象-过程：无返回"></a>13.6. JDBC调用Oracle对象-过程：无返回</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jdbc:调用oracle数据库 的存储过程 ： 没有返回值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcOracleDemo2</span> &#123;</span><br><span class="line">	<span class="comment">// 定义数据库连接4要素</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:oracle:thin:@192.168.187.10:1521:orcl&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;scott&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testOracle</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// 加载oracle驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置数据库连接其他要素，获取连接对象</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 存储过程:create or replace procedure pro_emp_sal (eno number, money number)</span></span><br><span class="line">		<span class="comment">// 获取CallableStatement对象，用于调用执行存储过程(没有返回)</span></span><br><span class="line">		<span class="type">CallableStatement</span> <span class="variable">callSt</span> <span class="operator">=</span> conn.prepareCall(<span class="string">&quot;&#123;call pro_emp_sal(?,?)&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置参数，第1个参数是?的索引，第2个参数是设置的值</span></span><br><span class="line">		callSt.setInt(<span class="number">1</span>, <span class="number">7788</span>);</span><br><span class="line">		callSt.setInt(<span class="number">2</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 执行</span></span><br><span class="line">		callSt.execute();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 关闭资源</span></span><br><span class="line">		<span class="keyword">if</span> (callSt != <span class="literal">null</span>) &#123;</span><br><span class="line">			callSt.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">			conn.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>对应的存储过程<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> pro_emp_sal (eno number, money number)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">       <span class="comment">-- 在存储过程定义变量</span></span><br><span class="line">       <span class="comment">-- 声明数字类型变量，存储涨前和涨后的工资</span></span><br><span class="line">       psal number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">       <span class="comment">-- 封装的sql语句</span></span><br><span class="line">       <span class="comment">-- 查询涨前工资</span></span><br><span class="line">       <span class="keyword">select</span> sal <span class="keyword">into</span> psal <span class="keyword">from</span> my_emp <span class="keyword">where</span> empno<span class="operator">=</span>eno;</span><br><span class="line">       dbms_output.put_line(<span class="string">&#x27;涨前工资&#x27;</span><span class="operator">||</span>psal);</span><br><span class="line">       <span class="comment">-- 修改工资</span></span><br><span class="line">       <span class="keyword">update</span> my_emp <span class="keyword">set</span> sal<span class="operator">=</span>sal<span class="operator">+</span>money <span class="keyword">where</span> empno<span class="operator">=</span>eno;</span><br><span class="line">       <span class="keyword">commit</span>;</span><br><span class="line">       <span class="comment">-- 查询涨后工资</span></span><br><span class="line">       <span class="keyword">select</span> sal <span class="keyword">into</span> psal <span class="keyword">from</span> my_emp <span class="keyword">where</span> empno<span class="operator">=</span>eno;</span><br><span class="line">       dbms_output.put_line(<span class="string">&#x27;涨后工资&#x27;</span><span class="operator">||</span>psal);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<h3 id="13-7-JDBC调用Oracle对象-过程：有返回"><a href="#13-7-JDBC调用Oracle对象-过程：有返回" class="headerlink" title="13.7. JDBC调用Oracle对象-过程：有返回"></a>13.7. JDBC调用Oracle对象-过程：有返回</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jdbc:调用oracle数据库 的存储过程 ： 有返回值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcOracleDemo3</span> &#123;</span><br><span class="line">	<span class="comment">// 定义数据库连接4要素</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:oracle:thin:@192.168.187.10:1521:orcl&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;scott&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testOracle</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// 加载oracle驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置数据库连接其他要素，获取连接对象</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 存储过程:create or replace procedure pro_total_sal(pno number, totalSal out number)</span></span><br><span class="line">		<span class="comment">// 获取CallableStatement对象，用于调用执行存储过程(有返回参数)</span></span><br><span class="line">		<span class="type">CallableStatement</span> <span class="variable">callSt</span> <span class="operator">=</span> conn.prepareCall(<span class="string">&quot;&#123;call pro_total_sal(?,?)&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置参数，第1个参数是?的索引，第2个参数是设置的值</span></span><br><span class="line">		callSt.setInt(<span class="number">1</span>, <span class="number">7788</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 第2个?是返回值，如果使用结果参数，则必须将其注册为OUT参数</span></span><br><span class="line">		callSt.registerOutParameter(<span class="number">2</span>, OracleTypes.NUMBER);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 执行</span></span><br><span class="line">		callSt.execute();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取返回值，方法参数为?符号的位置</span></span><br><span class="line">		<span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> callSt.getObject(<span class="number">2</span>);</span><br><span class="line">		System.out.println(obj);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 关闭资源</span></span><br><span class="line">		<span class="keyword">if</span> (callSt != <span class="literal">null</span>) &#123;</span><br><span class="line">			callSt.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">			conn.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>对应的存储过程<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> pro_total_sal(pno number, totalSal <span class="keyword">out</span> number)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">       <span class="comment">-- 无声明的变量</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">       <span class="comment">-- 将查询到结果赋值给out参数</span></span><br><span class="line">       <span class="keyword">select</span> sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>nvl(comm, <span class="number">0</span>) <span class="keyword">into</span> totalSal <span class="keyword">from</span> my_emp <span class="keyword">where</span> empno<span class="operator">=</span>pno;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<h3 id="13-8-JDBC调用Oracle对象-函数"><a href="#13-8-JDBC调用Oracle对象-函数" class="headerlink" title="13.8. JDBC调用Oracle对象-函数"></a>13.8. JDBC调用Oracle对象-函数</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jdbc:调用oracle数据库 的存储函数 ：肯定有返回值</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcOracleDemo4</span> &#123;</span><br><span class="line">	<span class="comment">// 定义数据库连接4要素</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:oracle:thin:@192.168.187.10:1521:orcl&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;scott&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testOracle</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// 加载oracle驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置数据库连接其他要素，获取连接对象</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 存储函数:create or replace function fun_total_sal(pno number)</span></span><br><span class="line">		<span class="comment">// 获取CallableStatement对象，用于调用执行存储函数(肯定有返回值)</span></span><br><span class="line">		<span class="type">CallableStatement</span> <span class="variable">callSt</span> <span class="operator">=</span> conn.prepareCall(<span class="string">&quot;&#123;?= call fun_total_sal(?)&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置参数，第1个参数是?的索引，第2个参数是设置的值</span></span><br><span class="line">		<span class="comment">// 注意参数的位置是2</span></span><br><span class="line">		callSt.setInt(<span class="number">2</span>, <span class="number">7788</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 第1个?是返回值，如果使用结果参数，则必须将其注册为OUT参数</span></span><br><span class="line">		callSt.registerOutParameter(<span class="number">1</span>, OracleTypes.NUMBER);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 执行</span></span><br><span class="line">		callSt.execute();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取返回值，参数是返回值的位置索引</span></span><br><span class="line">		<span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> callSt.getObject(<span class="number">1</span>);</span><br><span class="line">		System.out.println(obj);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 关闭资源</span></span><br><span class="line">		<span class="keyword">if</span> (callSt != <span class="literal">null</span>) &#123;</span><br><span class="line">			callSt.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">			conn.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>对应的存储函数<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="comment">-- 使用存储函数查询某个员工的年薪</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">function</span> fun_total_sal(pno number)</span><br><span class="line"><span class="keyword">return</span> number</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">   <span class="comment">-- 定义一个number类型变量接收查询结果</span></span><br><span class="line">   totalSal number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   <span class="comment">-- 使用判空函数判断是否有奖金</span></span><br><span class="line">   <span class="keyword">select</span> sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>nvl(comm, <span class="number">0</span>) <span class="keyword">into</span> totalSal <span class="keyword">from</span> my_emp <span class="keyword">where</span> empno<span class="operator">=</span>pno;</span><br><span class="line">   <span class="comment">-- 返回查询结果</span></span><br><span class="line">   <span class="keyword">return</span> totalSal;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<h3 id="13-9-JDBC调用存储过程返回：多个结果"><a href="#13-9-JDBC调用存储过程返回：多个结果" class="headerlink" title="13.9. JDBC调用存储过程返回：多个结果"></a>13.9. JDBC调用存储过程返回：多个结果</h3><p>sys_refcursor</p>
<ul>
<li>优点一：sys_refcursor，可以在存储过程中作为参数返回一个table格式的结构集（把它认为是table类型，容易理解，其实是一个游标集）， cursor 只能用在存储过程，函数，包等的实现体中，不能做参数使用。</li>
<li>优点二：sys_refcursor可以使用在包中做参数，进行数据库面向对象开放。</li>
</ul>
<p>获取sys_refcursor游标集的返回结果</p>
<ul>
<li>将<code>CallableStatement</code>强制成子类<code>OracleCallableStatement</code></li>
<li>使用<code>java.sql.ResultSet getCursor(int arg0)</code> 方法获取游标集的结果</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jdbc:调用oracle数据库 的存储过程 ：有多个值的情况</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcOracleDemo5</span> &#123;</span><br><span class="line">	<span class="comment">// 定义数据库连接4要素</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:oracle:thin:@192.168.187.10:1521:orcl&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;scott&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testOracle</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="comment">// 加载oracle驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置数据库连接其他要素，获取连接对象</span></span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 存储过程:create or replace procedure get_dept_emp_list(dno in number, emplist out sys_refcursor)</span></span><br><span class="line">		<span class="comment">// 获取CallableStatement对象，用于调用执行存储过程(多个返回值)</span></span><br><span class="line">		<span class="type">CallableStatement</span> <span class="variable">callSt</span> <span class="operator">=</span> conn.prepareCall(<span class="string">&quot;&#123;call get_dept_emp_list(?,?)&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 设置参数，第1个参数是?的索引，第2个参数是设置的值</span></span><br><span class="line">		callSt.setInt(<span class="number">1</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 第2个?是返回值，如果使用结果参数，则必须将其注册为OUT参数,类型是cursor</span></span><br><span class="line">		callSt.registerOutParameter(<span class="number">2</span>, OracleTypes.CURSOR);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 执行</span></span><br><span class="line">		callSt.execute();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取返回值,强制成子类</span></span><br><span class="line">		<span class="type">OracleCallableStatement</span> <span class="variable">ocs</span> <span class="operator">=</span> (OracleCallableStatement) callSt;</span><br><span class="line">		<span class="comment">// 使用子类的返回结果集的方法,getCursor的参数是?占位符的索引</span></span><br><span class="line">		<span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ocs.getCursor(<span class="number">2</span>);</span><br><span class="line">		<span class="comment">// 循环读取结果集</span></span><br><span class="line">		<span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;姓名：&quot;</span> + rs.getString(<span class="string">&quot;ename&quot;</span>) + <span class="string">&quot;   ==   工作：&quot;</span> + rs.getString(<span class="string">&quot;job&quot;</span>));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 关闭资源</span></span><br><span class="line">		<span class="keyword">if</span> (callSt != <span class="literal">null</span>) &#123;</span><br><span class="line">			callSt.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">			conn.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>对应的存储过程<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="comment">-- 查询某个部门的员工信息</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> get_dept_emp_list(dno <span class="keyword">in</span> number, emplist <span class="keyword">out</span> sys_refcursor)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="comment">-- sys_refcursor相当于一个游标集</span></span><br><span class="line">    <span class="keyword">open</span> emplist <span class="keyword">for</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> dno;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
<h2 id="14-触发器【了解】"><a href="#14-触发器【了解】" class="headerlink" title="14. 触发器【了解】"></a>14. 触发器【了解】</h2><p>触发器，监视器，监视表中记录，当对表中记录进行操作(增删改)触发器工作</p>
<p>数据库触发器是一个与表相关联的、存储的 PL/SQL 程序。每当一个特定的数据操作语句(<code>Insert</code>,<code>update</code>,<code>delete</code>)在指定的表上发出时，Oracle 自动地执行触发器中定义的语句序列</p>
<h3 id="14-1-触发器作用"><a href="#14-1-触发器作用" class="headerlink" title="14.1. 触发器作用"></a>14.1. 触发器作用</h3><ul>
<li>数据确认<ul>
<li>示例：员工涨后的工资不能少于涨前的工资</li>
</ul>
</li>
<li>实施复杂的安全性检查<ul>
<li>示例：禁止在非工作时间插入新员工</li>
</ul>
</li>
<li>做审计，跟踪表上所做的数据操作等</li>
<li>数据的备份和同步</li>
</ul>
<h3 id="14-2-触发器的类型"><a href="#14-2-触发器的类型" class="headerlink" title="14.2. 触发器的类型"></a>14.2. 触发器的类型</h3><ul>
<li>语句级触发器：在指定的操作语句操作之前或之后执行一次，不管这条语句影响了多少行</li>
<li>行级触发器（FOR EACH ROW）：触发语句作用的每一条记录都被触发。在行级触发器中使用old和new伪记录变量,识别值的状态</li>
</ul>
<h3 id="14-3-触发器的语法"><a href="#14-3-触发器的语法" class="headerlink" title="14.3. 触发器的语法"></a>14.3. 触发器的语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">or</span> REPLACE] <span class="keyword">trigger</span> 触发器名</span><br><span class="line">	&#123;BEFORE <span class="operator">|</span> AFTER&#125;</span><br><span class="line">	&#123;<span class="keyword">DELETE</span> <span class="operator">|</span> <span class="keyword">INSERT</span> <span class="operator">|</span> <span class="keyword">UPDATE</span> [<span class="keyword">OF</span> 列名]&#125;</span><br><span class="line">	<span class="keyword">ON</span> 表名</span><br><span class="line">	[<span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> [<span class="keyword">WHEN</span>(条件) ] ]</span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">	......</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	PLSQL 块</span><br><span class="line"><span class="keyword">end</span> [触发器名];</span><br></pre></td></tr></table></figure>
<p>在触发器中触发语句与伪记录变量的值</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">触发语句</th>
<th>:old</th>
<th>:new</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>insert</code></td>
<td>所有字段都是空(<code>null</code>)</td>
<td>将要插入的数据</td>
</tr>
<tr>
<td style="text-align:center"><code>update</code></td>
<td>更新以前该行的值</td>
<td>更新后的值</td>
</tr>
<tr>
<td style="text-align:center"><code>delete</code></td>
<td>删除以前该行的值</td>
<td>所有字段都是空(<code>null</code>)</td>
</tr>
</tbody>
</table>
</div>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- =============================== 触发器 ===============================</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">触发器：监视器，监视表中记录，当对表中记录进行操作（增删改）触发器工作</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--行级触发器：for each row 使用：:old, :new</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">create or replace trigger 触发器名称</span></span><br><span class="line"><span class="comment">after|before</span></span><br><span class="line"><span class="comment">insert|update|delete</span></span><br><span class="line"><span class="comment">on 表名</span></span><br><span class="line"><span class="comment">declare</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">begin</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">end;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">-- 当插入一条数据之后，输出一句“插入成功了....”</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">trigger</span> emp_insert_log</span><br><span class="line">after</span><br><span class="line"><span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> my_emp</span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">       dbms_output.put_line(<span class="string">&#x27;插入成功了....&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试</span></span><br><span class="line"><span class="keyword">insert into</span> my_emp (empno,ename,deptno) <span class="keyword">values</span> (<span class="number">9999</span>,<span class="string">&#x27;johnny&#x27;</span>,<span class="string">&#x27;10&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- =============================== 触发器应用 ===============================</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">实现跟MySQL数据中主键自增效果</span></span><br><span class="line"><span class="comment">insert into emp(ename) values(’zhangsna‘);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">oracle:</span></span><br><span class="line"><span class="comment">insert into emp(empno,ename) values(sequence.nextval,’zhangsna‘);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 配合序列使用</span></span><br><span class="line"><span class="keyword">create</span> sequence s_my_emp_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建触发器</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">trigger</span> emp_insertRow_before</span><br><span class="line">before</span><br><span class="line"><span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> my_emp</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 给将要添加记录，从某个序列中查询到一个值----设置主键值</span></span><br><span class="line">  <span class="keyword">select</span> s_my_emp_id.nextval <span class="keyword">into</span> :new.empno <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试</span></span><br><span class="line"><span class="keyword">insert into</span> my_emp (ename) <span class="keyword">values</span> (<span class="string">&#x27;jack&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="15-Oracle-其他知识"><a href="#15-Oracle-其他知识" class="headerlink" title="15. Oracle 其他知识"></a>15. Oracle 其他知识</h2><h3 id="15-1-系统表user-tables-all-tables-dba-tables"><a href="#15-1-系统表user-tables-all-tables-dba-tables" class="headerlink" title="15.1. 系统表user_tables/all_tables/dba_tables"></a>15.1. 系统表user_tables/all_tables/dba_tables</h3><ul>
<li>user_tables、all_tables、dba_tables关系：<ul>
<li>user_tables：可查询当前用户的表；</li>
<li>all_tables：可查询所有的(当前用户有权限)表；（只要对某个表有任何权限，即可在此视图中看到表的相关信息）</li>
<li>dba_tables：可查询包括系统表在内的所有表。需要DBA权限才能查询</li>
</ul>
</li>
<li>以上3个视图中，user_tables的范围最小，all_tables看到的东西稍多一些，而dba_tables看到最多的信息</li>
</ul>
<h3 id="15-2-数据库锁表"><a href="#15-2-数据库锁表" class="headerlink" title="15.2. 数据库锁表"></a>15.2. 数据库锁表</h3><p><code>for update</code>：会对所查询到得结果集进行加锁，不允许其他程序修改<br><code>for update nowait</code>：也会对所查询到得结果集进行加锁，别的线程对结果集进行操作时会报错ORA-00054，提示：内容是资源正忙，但指定以 NOWAIT 方式获取资源。<br><code>select t.*,t.rowid from 表名</code>：用ROWID来定位记录是最快的，比索引还快，不加锁查询。不会锁表</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://ktzxy.github.io">蓝桉</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://ktzxy.github.io/posts/eb5d336c.html">https://ktzxy.github.io/posts/eb5d336c.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://ktzxy.github.io" target="_blank">蓝桉`Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post-share"><div class="social-share" data-image="/bg/Image00002.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><link rel="stylesheet" href="/css/coin/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">不给糖果就捣蛋</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.webp" target="_blank"><img class="post-qr-code-img" src="/img/wechat.webp" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.webp" target="_blank"><img class="post-qr-code-img" src="/img/alipay.webp" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></button></div><audio id="coinAudio" src="https://cdn.cbd.int/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin/coin.js"></script><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/61d0b2a9.html" title="Oracle数据库速查知识文档"><img class="cover" src="/bg/Image00006.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Oracle数据库速查知识文档</div></div><div class="info-2"><div class="info-item-1">Oracle数据库速查知识文档项目介绍该项目记录了Oracle相关的速查知识汇总，主要涉及了oracle基础使用、SQL基础、oracle函数、oracle触发器、oracle高级查询、PL/SQL编程基础、PL/SQL存储过程等。若有新增，还将不断添加中。 SQL基础部分1.简介Oracle Database，又名Oracle RDBMS，或简称Oracle，是甲骨文公司的一款关系数据库管理系统。本课程主要介绍Oracle的SQL基础，包括表空间的概念，如何登录Oracle数据库，如何管理表及表中的数据，以及约束的应用。为后续课程的学习打下一个良好的基础。 2.安装好之后可以登录系统账户打开sqlplus，输入用户名system或sys（后者有最高权限）和自己设置的口令就可以登录了。 3.用户与表空间系统用户有哪些？ sys,system   前者高于后者，前者必须以管理员权限登录sysman   操作企业管理的用户，也是管理员用户 scott    普通用户 前三者用户的密码是安装时设置的，scott的默认密码是tiger 登录通用语句：1[username/password...</div></div></div></a><a class="pagination-related" href="/posts/f7ddf79e.html" title="笔记四：学习通习题部分"><img class="cover" src="/bg/Image00022.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">笔记四：学习通习题部分</div></div><div class="info-2"><div class="info-item-1">﻿### 定义一个用户标量函数,用以实现指定年月,当月有多少天123456789101112131415create function getDaysOfMonth(@year int,@month int) returns int as begin	declare @days int	if @year%400 =0 or (@year %4 =0 and @year %100 != 0)		set @days = 29	else		set @days = 28	set @days = 	case 		when @month = 2 then @days		when @month  = 4 or @month  = 6 or @month  = 9 or @month  = 11 then 30		else 31		end		return @days	end 用流程控制语句编写程序,求1×2×3×…×100的积。123456789101112131415create function getDaysOfMonth(@year int,@month int) returns int...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/a318ca1f.html" title="MySQL数据库150道高频面试题"><img class="cover" src="/bg/Image00018.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">MySQL数据库150道高频面试题</div></div><div class="info-2"><div class="info-item-1">[toc] 1. Mysql 索引1.1. Mysql如何实现的索引机制？MySQL中索引分三类：B+树索引、Hash索引、全文索引 1.1.1. InnoDB索引与MyISAM索引实现的区别是什么？ MyISAM的索引方式都是非聚簇的，与InnoDB包含1个聚簇索引是不同的。 在InnoDB存储引擎中，我们只需要根据主键值对聚簇索引进行一次查找就能找到对应的记录，而在MyISAM中却需要进行一次回表操作，意味着MyISAM中建立的索引相当于全部都是二级索引。 InnoDB的数据文件本身就是索引文件，而MyISAM索引文件和数据文件是分离的 ，索引文件仅保存数据记录的地址。 MyISAM的表在磁盘上存储在以下文件中：  *.sdi（描述表结构）、*.MYD（数据），*.MYI（索引） InnoDB的表在磁盘上存储在以下文件中： .ibd（表结构、索引和数据都存在一起）   InnoDB的非聚簇索引data域存储相应记录主键的值 ，而MyISAM索引记录的是地址 。换句话说，InnoDB的所有非聚簇索引都引用主键作为data域。 MyISAM的回表操作是十分快速的，因为是拿着地址偏...</div></div></div></a><a class="pagination-related" href="/posts/8f9b37aa.html" title="技术同学必会的MySQL设计规约"><img class="cover" src="/bg/Image00014.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">技术同学必会的MySQL设计规约</div></div><div class="info-2"><div class="info-item-1">在我们对数据库技术方案设计的时候，我们是否有自己的设计理念或者原则，还是更多的依据自己的直觉去设计，是否曾经懊悔线上发生过的一次低级故障，可能稍微注意点就可以避免，是否想过怎么才能很好的避免，下面规范的价值正是我们工作的检查清单，需要我们不断从错误中积累有效经验来指导未来的工作。以下规范在大型互联网公司经过了充分的验证，尤其适用于并发量大、数据量大的业务场景。先介绍的是安全规范，因为安全无小事，很多公司都曾经因为自己的数据泄露导致用户的惨痛损失，所以将安全规范放到了第一位。﻿ 一、安全规范1.【强制】禁止在数据库中存储明文密码，需把密码加密后存储 说明：对于加密操作建议由公司的中间件团队基于如mybatis的扩展，提供统一的加密算法及密钥管理，避免每个业务线单独开发一套，同时也与具体的业务进行了解耦 2.【强制】禁止在数据库中明文存储用户敏感信息，如手机号等 说明：对于手机号建议公司搭建统一的手机号查询服务，避免在每个业务线单独存储 3.【强制】禁止开发直接给业务同学导出或者查询涉及到用户敏感信息的数据，如需要需上级领导审批 4.【强制】涉及到导出数据功能的操作，如包含敏感字段都...</div></div></div></a><a class="pagination-related" href="/posts/dfdfdf4.html" title="数据库概述"><img class="cover" src="/bg/Image00002.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">数据库概述</div></div><div class="info-2"><div class="info-item-1">1. 数据库技术1.1. 概述数据库（DB）是一个以某种组织方式存储在磁盘上的数据的集合。简单理解就是用来存储数据的仓库。  数据库 DataBase（DB）：存储数据的仓库，数据是有组织的进行存储。 数据库管理系统 DataBase Management System (DBMS)：操纵和管理数据库的大型软件。  1.2. 数据库的分类  1.3. 不同的数据存储方式数据存储在集合（内存）中  优点：读写速度快 缺点：不能永久存储  数据存储在文件中  优点：可以永久存储 缺点：频繁的IO操作效率低，查询数据很不方便。  数据存储在数据库中  优点：可以永久存储。查询速度快，查询数据很方便 缺点：要使用 SQL 语言执行增删改查操作  2. 关系型数据库 关系型数据库 - 百度百科  2.1. 概念关系型数据库，是指采用了关系模型来组织数据的数据库，其以行和列的形式存储数据，以便于用户理解，关系型数据库这一系列的行和列被称为表，一组表组成了数据库。用户通过查询来检索数据库中的数据，而查询是一个用于限定数据库中某些区域的执行代码。关系模型可以简单理解为二维表格模型，而一个关系型数...</div></div></div></a><a class="pagination-related" href="/posts/75522c08.html" title="第4节-布隆过滤器"><img class="cover" src="/bg/Image00003.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">第4节-布隆过滤器</div></div><div class="info-2"><div class="info-item-1">第4节-布隆过滤器BloomFilter面试题： 现有50亿个电话号码，选定其中10w个电话号码，如何要快速准确的判断这些号码是否已经存在？ 思路：  1、通过数据库查询———-实现快速有点难。  2、数据预放到内存集合中：50亿*8字节大约40G，内存太大了。 1、布隆过滤器是什么？它实际上==是一个很长的二进制数组+一系列随机hash算法映射函数，主要用于判断一个元素是否在集合中==。 通常我们会遇到很多要判断一个元素是否在某个集合中的业务场景，一般想到的是将集合中所有元素保存起来，然后通过比较确定。 链表、树、散列表（又叫哈希表，Hash table）等等数据结构都是这种思路。 但是随着集合中元素的增加，我们需要的存储空间也会呈现线性增长，最终达到瓶颈。 同时检索速度也越来越慢，上述三种结构的检索时间复杂度分别为O(n),O(logn),O(1)。这个时候，布隆过滤器（Bloom Filter）就应运而生  一句话概述：由一个初值为零的bit数组和多个哈希函数构成，用来快速判断某个数据是否存在。 本质就是判断具体元素存不存在一个大的集合中。 布隆过滤器是一种类似set的数据...</div></div></div></a><a class="pagination-related" href="/posts/e4cd3c5b.html" title="第5节-缓存预热+缓存雪崩+缓存击穿+缓存穿透"><img class="cover" src="/bg/Image00008.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">第5节-缓存预热+缓存雪崩+缓存击穿+缓存穿透</div></div><div class="info-2"><div class="info-item-1">第5节-缓存预热+缓存雪崩+缓存击穿+缓存穿透1、缓存雪崩发生情况： ​    redis主机挂了，redis全盘崩溃，比如缓存中有大量数据同时过期。 解决方案：  redis缓存集群实现高可用，主从+哨兵|| redis cluster ehcache本地缓存 + hystrix 或者 阿里sentinel限流&amp;降级 开启Redis持久化机制/aof+rdb，尽快恢复缓存集群 2、缓存穿透 什么是缓存穿透  请求去查询一条记录，先redis后mysql发现，都查不到该条记录，但是每次请求都会打到数据库上面去，导致后台数据库压力暴增，这种现象我们称为缓存穿透，redis成为了一个摆设。 简单说就是，本来无一物，即不再redis中，也不在mysql中。  危害  数据库可能会被打崩。导致服务不可用。 第一次来查询后，一般我们会有回写redis机制， 第二次来查询的时候redis就有了，偶尔出现穿透现象一般情况无关紧要。  解决方案   1、返回空对象缓存或者缺省值 一般OK  但是存在黑客和恶意攻击情况 黑客会对你的系统进行攻击，拿到一个不存在的id，去查询数据，会产生大量...</div></div></div></a><a class="pagination-related" href="/posts/41ae0132.html" title="MongoDB-基础"><img class="cover" src="/bg/Image00026.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">MongoDB-基础</div></div><div class="info-2"><div class="info-item-1">1. MongoDb 概述MongoDB 是一个跨平台的，面向文档的数据库，是当前 NoSQL 数据库产品中最热门的一种。它介于关系数据库和非关系数据库之间，是非关系数据库当中功能最丰富，最像关系数据库的产品。它支持的数据结构非常松散，是类似 JSON 的 BSON 格式，因此可以存储比较复杂的数据类型。 1.1. MongoDB 特点MongoDB 最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。它是一个面向集合的，模式自由的文档型数据库，具体特点总结如下：  面向集合存储，易于存储对象类型的数据 模式自由 支持动态查询 支持完全索引，包含内部对象 支持复制和故障恢复 使用高效的二进制数据存储，包括大型对象（如视频等） 自动处理碎片，以支持云计算层次的扩展性 支持 Python，PHP，Ruby，Java，C，C#，Javascript，Perl 及 C++语言的驱动程序，社区中也提供了对 Erlang 及.NET 等平台的驱动程序 文件存储格式为 BSON（一种 JSON 的...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">蓝桉</div><div class="author-info-description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">生活、学习、技术</b>相关的问题和看法，还有<b style="color:#fff">文章教程</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">264</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">37</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ktzxy"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon faa-parent animated-hover" href="https://github.com/ktzxy" target="_blank" title="Github"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=2251511764@qq.com" target="_blank" title="Email"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-youxiang"></use></svg></a><a class="social-icon faa-parent animated-hover" href="/atom.xml" target="_blank" title="RSS"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-RSS"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/496148176" target="_blank" title="BiliBili"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QX-BILIBILI"></use></svg></a><a class="social-icon faa-parent animated-hover" href="tencent://Message/?Uin=2251511764&amp;amp;websiteName=local.edu.com:8888=&amp;amp;Menu=yes" target="_blank" title="QQ"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QQ"></use></svg></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Oracle-%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">1. Oracle 的基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%9C%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%AD%E5%AE%89%E8%A3%85Oracle"><span class="toc-number">1.1.</span> <span class="toc-text">1.1. 在虚拟机中安装Oracle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">1.2. 虚拟网卡设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-PLSQL-Developer-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-number">1.3.</span> <span class="toc-text">1.3. PLSQL Developer 客户端工具的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%AE%89%E8%A3%85-PLSQL-Developer-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">1.4.</span> <span class="toc-text">1.4. 安装 PLSQL Developer 客户端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">1.5.</span> <span class="toc-text">1.5. 中文乱码的处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-%E6%9C%AC%E6%AC%A1%E5%AE%89%E8%A3%85oracle%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF"><span class="toc-number">1.6.</span> <span class="toc-text">1.6. 本次安装oracle相关信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Oracle-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">2. Oracle 数据库的体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%9Adatabase"><span class="toc-number">2.1.</span> <span class="toc-text">2.1. 数据库：database</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%AE%9E%E4%BE%8B%EF%BC%9AOracle-Instance"><span class="toc-number">2.2.</span> <span class="toc-text">2.2. 实例：Oracle Instance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%EF%BC%88dbf%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">2.3. 数据文件（dbf）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E8%A1%A8%E7%A9%BA%E9%97%B4"><span class="toc-number">2.4.</span> <span class="toc-text">2.4. 表空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E7%94%A8%E6%88%B7"><span class="toc-number">2.5.</span> <span class="toc-text">2.5. 用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-SCOTT-%E7%94%A8%E6%88%B7%E5%92%8C-HR-%E7%94%A8%E6%88%B7"><span class="toc-number">2.6.</span> <span class="toc-text">2.6. SCOTT 用户和 HR 用户</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Oracle-%E7%9A%84-SQL-%E8%AF%AD%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">3. Oracle 的 SQL 语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-SQL%E7%AE%80%E4%BB%8B"><span class="toc-number">3.1.</span> <span class="toc-text">3.1. SQL简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Oracle-%E8%AF%AD%E6%B3%95%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">3.2.</span> <span class="toc-text">3.2. Oracle 语法注意事项</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-Oracle%E8%AF%AD%E5%8F%A5%E5%A4%A7%E5%B0%8F%E5%86%99%E9%97%AE%E9%A2%98"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1. Oracle语句大小写问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-dual-%E4%BC%AA%E8%A1%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2. dual 伪表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Oracle-%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">4.</span> <span class="toc-text">4. Oracle 查询操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-Oracle-%E5%AE%8C%E6%95%B4%E7%9A%84%E6%9F%A5%E8%AF%A2-SQL-%E8%AF%AD%E6%B3%95"><span class="toc-number">4.1.</span> <span class="toc-text">4.1. Oracle 完整的查询 SQL 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Select-%E8%AF%AD%E5%8F%A5%E7%9A%84%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.2.</span> <span class="toc-text">4.2. Select 语句的语法格式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95"><span class="toc-number">4.2.1.</span> <span class="toc-text">4.2.1. 查询语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E5%88%AB%E5%90%8D%E7%94%A8%E6%B3%95"><span class="toc-number">4.2.2.</span> <span class="toc-text">4.2.2. 别名用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-2-%E5%85%B6%E4%BB%96%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.2.3.</span> <span class="toc-text">4.6.2. 其他比较运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-3-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.2.4.</span> <span class="toc-text">4.6.3. 逻辑运算符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-where-%E8%AF%AD%E5%8F%A5"><span class="toc-number">4.3.</span> <span class="toc-text">4.7. where 语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-7-1-%E9%9D%9E%E7%A9%BA%E5%92%8C%E7%A9%BA%E7%9A%84%E9%99%90%E5%88%B6"><span class="toc-number">4.3.1.</span> <span class="toc-text">4.7.1. 非空和空的限制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-7-2-%E8%8C%83%E5%9B%B4%E9%99%90%E5%88%B6"><span class="toc-number">4.3.2.</span> <span class="toc-text">4.7.2. 范围限制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-7-3-%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.3.3.</span> <span class="toc-text">4.7.3. 模糊查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-%E4%BD%BF%E7%94%A8-order-by-%E5%AF%B9%E7%BB%93%E6%9E%9C%E6%8E%92%E5%BA%8F"><span class="toc-number">4.4.</span> <span class="toc-text">4.8. 使用 order by 对结果排序</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-8-1-%E6%8E%92%E5%BA%8F%E8%AF%AD%E6%B3%95"><span class="toc-number">4.4.1.</span> <span class="toc-text">4.8.1. 排序语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-8-2-%E6%8E%92%E5%BA%8F%E4%B8%AD%E7%9A%84%E7%A9%BA%E5%80%BC%E9%97%AE%E9%A2%98"><span class="toc-number">4.4.2.</span> <span class="toc-text">4.8.2. 排序中的空值问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-Oracle%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.5.</span> <span class="toc-text">4.9. Oracle分页查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-10-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.6.</span> <span class="toc-text">4.10. 多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-10-1-Oracle-%E7%9A%84%E8%BF%9E%E6%8E%A5%E6%9D%A1%E4%BB%B6%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.6.1.</span> <span class="toc-text">4.10.1. Oracle 的连接条件的类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-10-2-%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.6.2.</span> <span class="toc-text">4.10.2. 多表连接基本查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-10-3-%E5%A4%96%E8%BF%9E%E6%8E%A5%EF%BC%88%E5%B7%A6%E5%8F%B3%E8%BF%9E%E6%8E%A5%EF%BC%89"><span class="toc-number">4.6.3.</span> <span class="toc-text">4.10.3. 外连接（左右连接）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-11-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.7.</span> <span class="toc-text">4.11. 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-11-1-%E5%AD%90%E6%9F%A5%E8%AF%A2%E6%A6%82%E8%BF%B0"><span class="toc-number">4.7.1.</span> <span class="toc-text">4.11.1. 子查询概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-11-2-%E5%AD%90%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-number">4.7.2.</span> <span class="toc-text">4.11.2. 子查询的语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-11-3-%E5%AD%90%E6%9F%A5%E8%AF%A2%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.7.3.</span> <span class="toc-text">4.11.3. 子查询的类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-11-4-%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.7.4.</span> <span class="toc-text">4.11.4. 单行子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-11-5-%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.7.5.</span> <span class="toc-text">4.11.5. 多行子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-11-6-%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%B8%AD%E7%9A%84-null-%E5%80%BC%E9%97%AE%E9%A2%98"><span class="toc-number">4.7.6.</span> <span class="toc-text">4.11.6. 子查询中的 null 值问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-11-7-Exists-%E7%94%A8%E6%B3%95"><span class="toc-number">4.7.7.</span> <span class="toc-text">4.11.7. Exists 用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-11-8-Oracle-%E4%B8%AD%E7%9A%84%E4%BC%AA%E5%88%97"><span class="toc-number">4.7.8.</span> <span class="toc-text">4.11.8. Oracle 中的伪列</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-12-Oracle-%E6%9F%A5%E8%AF%A2%E7%BB%BC%E5%90%88%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.8.</span> <span class="toc-text">4.12. Oracle 查询综合示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-12-1-Oracle%E6%9F%A5%E8%AF%A2%E7%BB%83%E4%B9%A0"><span class="toc-number">4.8.1.</span> <span class="toc-text">4.12.1. Oracle查询练习</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-12-2-Oracle-%E7%BB%BC%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.8.2.</span> <span class="toc-text">4.12.2. Oracle 综合查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-13-%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97"><span class="toc-number">4.9.</span> <span class="toc-text">4.13. 集合运算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-13-1-%E4%BB%80%E4%B9%88%E6%98%AF%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97"><span class="toc-number">4.9.1.</span> <span class="toc-text">4.13.1. 什么是集合运算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-13-2-%E5%B9%B6%E9%9B%86%EF%BC%8C%E7%B1%BB%E4%BC%BC%E4%BA%8Eor"><span class="toc-number">4.9.2.</span> <span class="toc-text">4.13.2. 并集，类似于or</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-13-3-%E4%BA%A4%E9%9B%86%EF%BC%8C%E7%B1%BB%E4%BC%BC%E4%BA%8Eand"><span class="toc-number">4.9.3.</span> <span class="toc-text">4.13.3. 交集，类似于and</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-13-4-%E5%B7%AE%E9%9B%86"><span class="toc-number">4.9.4.</span> <span class="toc-text">4.13.4. 差集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-13-5-%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97%E7%9A%84%E7%89%B9%E5%BE%81"><span class="toc-number">4.9.5.</span> <span class="toc-text">4.13.5. 集合运算的特征</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-14-%E9%80%92%E5%BD%92%E6%9F%A5%E8%AF%A2%E3%80%90%E4%BA%86%E8%A7%A3%E3%80%91"><span class="toc-number">4.10.</span> <span class="toc-text">4.14. 递归查询【了解】</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-SQL-%E5%87%BD%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">5. SQL 函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%AE%9A%E4%B9%89"><span class="toc-number">5.1.</span> <span class="toc-text">5.1. 定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%87%BD%E6%95%B0%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.2.</span> <span class="toc-text">5.2. 函数的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.</span> <span class="toc-text">5.3. 单行函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-1-%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0%E5%88%86%E7%B1%BB"><span class="toc-number">5.3.1.</span> <span class="toc-text">5.3.1. 单行函数分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-%E5%AD%97%E7%AC%A6%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.2.</span> <span class="toc-text">5.3.2. 字符函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-3-%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.3.</span> <span class="toc-text">5.3.3. 数值函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-3-1-round%EF%BC%9A%E5%9B%9B%E8%88%8D%E4%BA%94%E5%85%A5"><span class="toc-number">5.3.3.1.</span> <span class="toc-text">5.3.3.1. round：四舍五入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-3-2-trunc%EF%BC%9A%E6%88%AA%E6%96%AD%EF%BC%8C%E7%9B%B4%E6%8E%A5%E6%88%AA%E6%96%AD%E5%AD%97%E7%AC%A6%EF%BC%8C%E4%B8%8D%E4%BC%9A%E8%BF%9B%E8%A1%8C%E5%9B%9B%E8%88%8D%E4%BA%94%E5%85%A5"><span class="toc-number">5.3.3.2.</span> <span class="toc-text">5.3.3.2. trunc：截断，直接截断字符，不会进行四舍五入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-3-3-mod%EF%BC%9A%E6%B1%82%E4%BD%99"><span class="toc-number">5.3.3.3.</span> <span class="toc-text">5.3.3.3. mod：求余</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-3-4-%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.3.3.4.</span> <span class="toc-text">5.3.3.4. 示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-4-%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.4.</span> <span class="toc-text">5.3.4. 日期函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-4-1-Oracle%E7%9A%84%E6%97%A5%E6%9C%9F"><span class="toc-number">5.3.4.1.</span> <span class="toc-text">5.3.4.1. Oracle的日期</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-4-2-%E6%97%A5%E6%9C%9F%E7%9A%84%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97"><span class="toc-number">5.3.4.2.</span> <span class="toc-text">5.3.4.2. 日期的数学运算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-4-3-%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.3.4.3.</span> <span class="toc-text">5.3.4.3. 示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-5-%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.5.</span> <span class="toc-text">5.3.5. 转换函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-5-1-TO-CHAR-%E5%87%BD%E6%95%B0%E5%AF%B9%E6%97%A5%E6%9C%9F%E7%9A%84%E8%BD%AC%E6%8D%A2%E6%88%90%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">5.3.5.1.</span> <span class="toc-text">5.3.5.1. TO_CHAR 函数对日期的转换成字符串</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-5-2-TO-CHAR-%E5%87%BD%E6%95%B0%E5%AF%B9%E6%95%B0%E5%AD%97%E7%9A%84%E8%BD%AC%E6%8D%A2%E6%88%90%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">5.3.5.2.</span> <span class="toc-text">5.3.5.2. TO_CHAR 函数对数字的转换成字符串</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-5-3-TO-NUMBER-%E5%92%8C-TO-DATE-%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.5.3.</span> <span class="toc-text">5.3.5.3. TO_NUMBER 和 TO_DATE 函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-6-%E9%80%9A%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.6.</span> <span class="toc-text">5.3.6. 通用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-6-1-%E9%80%9A%E7%94%A8%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">5.3.6.1.</span> <span class="toc-text">5.3.6.1. 通用函数的定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-6-2-%E5%B8%B8%E7%94%A8%E7%9A%84%E9%80%9A%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.6.2.</span> <span class="toc-text">5.3.6.2. 常用的通用函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-7-%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">5.3.7.</span> <span class="toc-text">5.3.7. 条件表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-7-1-%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AE%9A%E4%B9%89"><span class="toc-number">5.3.7.1.</span> <span class="toc-text">5.3.7.1. 条件表达式定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-7-2-%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F1%EF%BC%9Acase-%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">5.3.7.2.</span> <span class="toc-text">5.3.7.2. 实现方式1：case 表达式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-7-3-%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F2%EF%BC%9Adecode-%E5%87%BD%E6%95%B0%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="toc-number">5.3.7.3.</span> <span class="toc-text">5.3.7.3. 实现方式2：decode 函数（推荐）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-7-4-%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.3.7.4.</span> <span class="toc-text">5.3.7.4. 示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E5%A4%9A%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">5.4.</span> <span class="toc-text">5.4. 多行函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-1-%E5%A4%9A%E8%A1%8C%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">5.4.1.</span> <span class="toc-text">5.4.1. 多行函数的定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-2-%E5%B8%B8%E7%94%A8%E7%9A%84%E5%A4%9A%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">5.4.2.</span> <span class="toc-text">5.4.2. 常用的多行函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-3-%E5%88%86%E7%BB%84%E6%95%B0%E6%8D%AE"><span class="toc-number">5.4.3.</span> <span class="toc-text">5.4.3. 分组数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-4-%E8%BF%87%E6%BB%A4%E5%88%86%E7%BB%84%E6%95%B0%E6%8D%AE"><span class="toc-number">5.4.4.</span> <span class="toc-text">5.4.4. 过滤分组数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-5-WHERE-%E5%92%8C-HAVING-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">5.4.5.</span> <span class="toc-text">5.4.5. WHERE 和 HAVING 的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E4%BD%BF%E7%94%A8-DDL-%E8%AF%AD%E5%8F%A5%E7%AE%A1%E7%90%86%E8%A1%A8"><span class="toc-number">6.</span> <span class="toc-text">6. 使用 DDL 语句管理表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%A9%BA%E9%97%B4"><span class="toc-number">6.1.</span> <span class="toc-text">6.1. 创建表空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E7%94%A8%E6%88%B7"><span class="toc-number">6.2.</span> <span class="toc-text">6.2. 用户</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-1-%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">6.2.1.</span> <span class="toc-text">6.2.1. 创建用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-2-%E7%94%A8%E6%88%B7%E8%B5%8B%E6%9D%83%E9%99%90"><span class="toc-number">6.2.2.</span> <span class="toc-text">6.2.2. 用户赋权限</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-3-%E5%9B%9E%E6%94%B6%E6%9D%83%E9%99%90"><span class="toc-number">6.2.3.</span> <span class="toc-text">6.2.3. 回收权限</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-Oracle-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.3.</span> <span class="toc-text">6.3. Oracle 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-1-%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">6.3.1.</span> <span class="toc-text">6.3.1. 字符串</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-2-%E6%95%B0%E5%AD%97"><span class="toc-number">6.3.2.</span> <span class="toc-text">6.3.2. 数字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-3-%E6%97%A5%E6%9C%9F"><span class="toc-number">6.3.3.</span> <span class="toc-text">6.3.3. 日期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-4-%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.3.4.</span> <span class="toc-text">6.3.4. 大数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-5-%E5%85%B6%E5%AE%83%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.3.5.</span> <span class="toc-text">6.3.5. 其它类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-uuid-%E7%94%9F%E6%88%90%E5%80%BC"><span class="toc-number">6.4.</span> <span class="toc-text">6.4. uuid 生成值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-number">6.5.</span> <span class="toc-text">6.5. 创建表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-%E4%BF%AE%E6%94%B9%E8%A1%A8"><span class="toc-number">6.6.</span> <span class="toc-text">6.6. 修改表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="toc-number">6.7.</span> <span class="toc-text">6.7. 删除表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-%E5%A4%8D%E5%88%B6%E6%95%B4%E4%B8%AA%E8%A1%A8"><span class="toc-number">6.8.</span> <span class="toc-text">6.8. 复制整个表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-9-%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.9.</span> <span class="toc-text">6.9. 约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-9-1-%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.9.1.</span> <span class="toc-text">6.9.1. 主键约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-9-2-%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.9.2.</span> <span class="toc-text">6.9.2. 非空约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-9-3-%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F%EF%BC%88unique%EF%BC%89"><span class="toc-number">6.9.3.</span> <span class="toc-text">6.9.3. 唯一约束（unique）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-9-4-%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.9.4.</span> <span class="toc-text">6.9.4. 检查约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-9-5-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">6.9.5.</span> <span class="toc-text">6.9.5. 外键约束</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E4%BD%BF%E7%94%A8-DML-%E8%AF%AD%E5%8F%A5%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE"><span class="toc-number">7.</span> <span class="toc-text">7. 使用 DML 语句处理数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">7.1.</span> <span class="toc-text">7.1. 插入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-number">7.2.</span> <span class="toc-text">7.2. 更新数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-ORACLE-%E5%A6%82%E6%9E%9C%E6%95%B0%E6%8D%AE%E5%AD%98%E5%9C%A8%E5%88%99%E6%89%A7%E8%A1%8C%E6%9B%B4%E6%96%B0%EF%BC%8C%E4%B8%8D%E5%AD%98%E5%9C%A8%E5%88%99%E6%89%A7%E8%A1%8C%E6%8F%92%E5%85%A5%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">7.3.</span> <span class="toc-text">7.3. ORACLE 如果数据存在则执行更新，不存在则执行插入的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">7.4.</span> <span class="toc-text">7.4. 删除数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-Oracle-%E4%B8%AD%E7%9A%84%E4%BA%8B%E5%8A%A1"><span class="toc-number">7.5.</span> <span class="toc-text">7.5. Oracle 中的事务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E7%AE%A1%E7%90%86%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><span class="toc-number">8.</span> <span class="toc-text">8. 管理其他数据库对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E8%A7%86%E5%9B%BE"><span class="toc-number">8.1.</span> <span class="toc-text">8.1. 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-1-%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE%E7%9A%84%E8%AF%AD%E6%B3%951"><span class="toc-number">8.1.1.</span> <span class="toc-text">8.1.1. 创建视图的语法1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-2-%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE%E7%9A%84%E8%AF%AD%E6%B3%952"><span class="toc-number">8.1.2.</span> <span class="toc-text">8.1.2. 创建视图的语法2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-3-%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE%E7%9A%84%E8%AF%AD%E6%B3%953"><span class="toc-number">8.1.3.</span> <span class="toc-text">8.1.3. 创建视图的语法3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E5%BA%8F%E5%88%97%E3%80%90%E4%BA%86%E8%A7%A3%E3%80%91"><span class="toc-number">8.2.</span> <span class="toc-text">8.2. 序列【了解】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E7%B4%A2%E5%BC%95"><span class="toc-number">8.3.</span> <span class="toc-text">8.3. 索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E8%AF%AD%E6%B3%95"><span class="toc-number">8.4.</span> <span class="toc-text">11.2. 创建存储过程语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">8.5.</span> <span class="toc-text">11.3. 调用存储过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-4-%E5%88%9B%E5%BB%BA%E5%8C%85%E4%B8%8E%E4%BD%93%E7%9A%84%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">8.6.</span> <span class="toc-text">11.4. 创建包与体的存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-4-1-%E5%AE%9A%E4%B9%89"><span class="toc-number">8.6.1.</span> <span class="toc-text">11.4.1. 定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-4-2-%E8%AF%AD%E6%B3%95"><span class="toc-number">8.6.2.</span> <span class="toc-text">11.4.2. 语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-%E5%85%B3%E4%BA%8Eoracle%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E8%8B%A5%E5%B9%B2%E9%97%AE%E9%A2%98%E5%A4%87%E5%BF%98"><span class="toc-number">8.7.</span> <span class="toc-text">11.5. 关于oracle存储过程的若干问题备忘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-6-Oracle%E4%B8%AD%E7%9A%84Packages%E4%B8%8EPackagebodies"><span class="toc-number">8.8.</span> <span class="toc-text">11.6. Oracle中的Packages与Packagebodies</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-6-1-package%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">8.8.1.</span> <span class="toc-text">11.6.1. package的作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-6-2-packages-%E4%B8%8E-packagebodies%E6%AF%94%E8%BE%83"><span class="toc-number">8.8.2.</span> <span class="toc-text">11.6.2. packages 与 packagebodies比较</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">9.</span> <span class="toc-text">12. 存储函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E6%A6%82%E8%BF%B0"><span class="toc-number">9.1.</span> <span class="toc-text">12.1. 存储函数概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E8%AF%AD%E6%B3%95"><span class="toc-number">9.2.</span> <span class="toc-text">12.2. 存储函数语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">9.3.</span> <span class="toc-text">12.3. 调用存储函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-4-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">9.4.</span> <span class="toc-text">12.4. 存储过程和存储函数的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-Java%E7%A8%8B%E5%BA%8F%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">10.</span> <span class="toc-text">13. Java程序调用存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-java-%E8%BF%9E%E6%8E%A5-oracle-%E7%9A%84-jar-%E5%8C%85"><span class="toc-number">10.1.</span> <span class="toc-text">13.1. java 连接 oracle 的 jar 包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">10.2.</span> <span class="toc-text">13.2. 数据库连接字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-Connection-%E6%8E%A5%E5%8F%A3%E8%8E%B7%E5%8F%96-CallableStatement"><span class="toc-number">10.3.</span> <span class="toc-text">13.3. Connection 接口获取 CallableStatement</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-4-CallableStatement-%E6%8E%A5%E5%8F%A3"><span class="toc-number">10.4.</span> <span class="toc-text">13.4. CallableStatement 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-5-JDBC%E8%B0%83%E7%94%A8Oracle%E5%AF%B9%E8%B1%A1-%E8%A1%A8"><span class="toc-number">10.5.</span> <span class="toc-text">13.5. JDBC调用Oracle对象-表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-6-JDBC%E8%B0%83%E7%94%A8Oracle%E5%AF%B9%E8%B1%A1-%E8%BF%87%E7%A8%8B%EF%BC%9A%E6%97%A0%E8%BF%94%E5%9B%9E"><span class="toc-number">10.6.</span> <span class="toc-text">13.6. JDBC调用Oracle对象-过程：无返回</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-7-JDBC%E8%B0%83%E7%94%A8Oracle%E5%AF%B9%E8%B1%A1-%E8%BF%87%E7%A8%8B%EF%BC%9A%E6%9C%89%E8%BF%94%E5%9B%9E"><span class="toc-number">10.7.</span> <span class="toc-text">13.7. JDBC调用Oracle对象-过程：有返回</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-8-JDBC%E8%B0%83%E7%94%A8Oracle%E5%AF%B9%E8%B1%A1-%E5%87%BD%E6%95%B0"><span class="toc-number">10.8.</span> <span class="toc-text">13.8. JDBC调用Oracle对象-函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-9-JDBC%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E8%BF%94%E5%9B%9E%EF%BC%9A%E5%A4%9A%E4%B8%AA%E7%BB%93%E6%9E%9C"><span class="toc-number">10.9.</span> <span class="toc-text">13.9. JDBC调用存储过程返回：多个结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E8%A7%A6%E5%8F%91%E5%99%A8%E3%80%90%E4%BA%86%E8%A7%A3%E3%80%91"><span class="toc-number">11.</span> <span class="toc-text">14. 触发器【了解】</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-1-%E8%A7%A6%E5%8F%91%E5%99%A8%E4%BD%9C%E7%94%A8"><span class="toc-number">11.1.</span> <span class="toc-text">14.1. 触发器作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-%E8%A7%A6%E5%8F%91%E5%99%A8%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">11.2.</span> <span class="toc-text">14.2. 触发器的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-%E8%A7%A6%E5%8F%91%E5%99%A8%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-number">11.3.</span> <span class="toc-text">14.3. 触发器的语法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-Oracle-%E5%85%B6%E4%BB%96%E7%9F%A5%E8%AF%86"><span class="toc-number">12.</span> <span class="toc-text">15. Oracle 其他知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#15-1-%E7%B3%BB%E7%BB%9F%E8%A1%A8user-tables-all-tables-dba-tables"><span class="toc-number">12.1.</span> <span class="toc-text">15.1. 系统表user_tables&#x2F;all_tables&#x2F;dba_tables</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%94%81%E8%A1%A8"><span class="toc-number">12.2.</span> <span class="toc-text">15.2. 数据库锁表</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/a318ca1f.html" title="MySQL数据库150道高频面试题"><img src="/bg/Image00018.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL数据库150道高频面试题"/></a><div class="content"><a class="title" href="/posts/a318ca1f.html" title="MySQL数据库150道高频面试题">MySQL数据库150道高频面试题</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8f9b37aa.html" title="技术同学必会的MySQL设计规约"><img src="/bg/Image00014.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="技术同学必会的MySQL设计规约"/></a><div class="content"><a class="title" href="/posts/8f9b37aa.html" title="技术同学必会的MySQL设计规约">技术同学必会的MySQL设计规约</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dfdfdf4.html" title="数据库概述"><img src="/bg/Image00002.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库概述"/></a><div class="content"><a class="title" href="/posts/dfdfdf4.html" title="数据库概述">数据库概述</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/490575ab.html" title="24工厂模式俗话解释"><img src="/bg/Image00024.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="24工厂模式俗话解释"/></a><div class="content"><a class="title" href="/posts/490575ab.html" title="24工厂模式俗话解释">24工厂模式俗话解释</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/364ea8cc.html" title="设计模式"><img src="/bg/Image00014.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="设计模式"/></a><div class="content"><a class="title" href="/posts/364ea8cc.html" title="设计模式">设计模式</a><time datetime="2025-07-09T17:28:46.000Z" title="发表于 2025-07-09 17:28:46">2025-07-09</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2020 - 2025 By 蓝桉</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="8152976493" data-server="netease" data-type="playlist"   data-order="list" data-fixed="true" data-preload="auto" data-autoplay="false" data-mutex="true" ></div><script async src="//at.alicdn.com/t/c/font_4379924_273fk05h86zi.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat/cat.js"></script><script async data-pjax src="/js/meting/music_lanan.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script defer src="/js/day/lunar.js"></script><script defer src="/js/day/day.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = '10a7db1c41b6489db9c830c668a18304';
  var gaud_map_key = '82a64bc994fb6494830f157f319f9f69';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title=""><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.2.2" title=""><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://www.jsdelivr.com/" style="margin-inline:5px" data-title="本站使用JsDelivr为静态资源提供CDN加速" title=""><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime/runtime.min.js"></script><script async src="/js/font/ali_font_all.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('article-sort-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__slideInRight');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://cdn.cbd.int/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>